(function(d){function a(b,a,c,d,e){this._listener=a;this._isOnce=c;this.context=d;this._signal=b;this._priority=e||0}function e(b,a){if("function"!==typeof b)throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",a));}function b(){this._bindings=[];this._prevParams=null;var a=this;this.dispatch=function(){b.prototype.dispatch.apply(a,arguments)}}a.prototype={active:!0,params:null,execute:function(b){var a;this.active&&this._listener&&(b=this.params?this.params.concat(b):
b,a=this._listener.apply(this.context,b),this._isOnce&&this.detach());return a},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal;delete this._listener;delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+
", isBound:"+this.isBound()+", active:"+this.active+"]"}};b.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(b,c,d,e){var ca=this._indexOfListener(b,d);if(-1!==ca){if(b=this._bindings[ca],b.isOnce()!==c)throw Error("You cannot add"+(c?"":"Once")+"() then add"+(!c?"":"Once")+"() the same listener without removing the relationship first.");}else b=new a(this,b,c,d,e),this._addBinding(b);this.memorize&&this._prevParams&&b.execute(this._prevParams);return b},
_addBinding:function(b){var a=this._bindings.length;do--a;while(this._bindings[a]&&b._priority<=this._bindings[a]._priority);this._bindings.splice(a+1,0,b)},_indexOfListener:function(b,a){for(var c=this._bindings.length,d;c--;)if(d=this._bindings[c],d._listener===b&&d.context===a)return c;return-1},has:function(b,a){return-1!==this._indexOfListener(b,a)},add:function(b,a,c){e(b,"add");return this._registerListener(b,!1,a,c)},addOnce:function(b,a,c){e(b,"addOnce");return this._registerListener(b,!0,
a,c)},remove:function(b,a){e(b,"remove");var c=this._indexOfListener(b,a);-1!==c&&(this._bindings[c]._destroy(),this._bindings.splice(c,1));return b},removeAll:function(){for(var b=this._bindings.length;b--;)this._bindings[b]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(b){if(this.active){var a=Array.prototype.slice.call(arguments),c=this._bindings.length,d;this.memorize&&(this._prevParams=
a);if(c){d=this._bindings.slice();this._shouldPropagate=!0;do c--;while(d[c]&&this._shouldPropagate&&!1!==d[c].execute(a))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll();delete this._bindings;delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var c=b;c.Signal=b;"function"===typeof define&&define.amd?define(function(){return c}):"undefined"!==typeof module&&module.exports?module.exports=c:d.signals=
c})(this);var OB={updateAtInterval:new signals.Signal,displayInterval:new signals.Signal,start:new signals.Signal,stop:new signals.Signal,preStart:new signals.Signal,preStop:new signals.Signal,insert:new signals.Signal,update:new signals.Signal,reset:new signals.Signal,remove:new signals.Signal,removeAll:new signals.Signal,init:new signals.Signal,options:new signals.Signal,postItemRender:new signals.Signal,postAllItemRender:new signals.Signal,onLoad:new signals.Signal,onUnLoad:new signals.Signal,onBeforeUnLoad:new signals.Signal};(function(){var d=this.Store=function(a,d){var b;this.name=a;if(void 0!==d)for(b in d)d.hasOwnProperty(b)&&void 0===this.get(b)&&this.set(b,d[b])};d.prototype.get=function(a){a="store."+this.name+"."+a;if(null!==localStorage.getItem(a))try{return JSON.parse(localStorage.getItem(a))}catch(d){return null}};d.prototype.set=function(a,d){if(void 0===d)this.remove(a);else{if("function"===typeof d)d=null;else try{d=JSON.stringify(d)}catch(b){d=null}localStorage.setItem("store."+this.name+"."+a,d)}return this};
d.prototype.remove=function(a){localStorage.removeItem("store."+this.name+"."+a);return this};d.prototype.removeAll=function(){var a,d;a="store."+this.name+".";for(d=localStorage.length-1;0<=d;d--)localStorage.key(d).substring(0,a.length)===a&&localStorage.removeItem(localStorage.key(d));return this};d.prototype.toObject=function(){var a,d,b,c,h;a={};d="store."+this.name+".";for(b=localStorage.length-1;0<=b;b--)localStorage.key(b).substring(0,d.length)===d&&(c=localStorage.key(b).substring(d.length),
h=this.get(c),void 0!==h&&(a[c]=h));return a};d.prototype.fromObject=function(a,d){!0!==d&&this.removeAll();for(var b in a)a.hasOwnProperty(b)&&this.set(b,a[b]);return this}})();(function(d){function a(b,a){for(var c=0,d=b.length;c<d;c++)if(b[c]==a)return!e;return e}var e=!1,b=parseFloat,c=Math.min,h=/(-?\d+\.?\d*)$/g,g=[],O=[];d.tinysort={id:"TinySort",version:"1.4.29",copyright:"Copyright (c) 2008-2012 Ron Valstar",uri:"http://tinysort.sjeiti.com/",licensed:{MIT:"http://www.opensource.org/licenses/mit-license.php",GPL:"http://www.gnu.org/licenses/gpl.html"},plugin:function(b,a){g.push(b);O.push(a)},defaults:{order:"asc",attr:null,data:null,useVal:e,place:"start",returns:e,
cases:e,forceStrings:e,sortFunction:null}};d.fn.extend({tinysort:function(V,ca){V&&"string"!=typeof V&&(ca=V,V=null);var N=d.extend({},d.tinysort.defaults,ca),pa,va=d(this).length,q={},l=!(!V||""==V),R=!(null===N.attr||""==N.attr),ba=null!==N.data,S=l&&":"==V[0],s=S?this.filter(V):this,X=N.sortFunction,U="asc"==N.order?1:-1,Y=[];d.each(g,function(b,a){a.call(a,N)});X||(X="rand"==N.order?function(){return 0.5>Math.random()?1:-1}:function(a,c){var g=e,l=!N.cases?a.s&&a.s.toLowerCase?a.s.toLowerCase():
a.s:a.s,q=!N.cases?c.s&&c.s.toLowerCase?c.s.toLowerCase():c.s:c.s;if(!N.forceStrings){var u=l&&l.match(h),s=q&&q.match(h);if(u&&s){var R=l.substr(0,l.length-u[0].length),Q=q.substr(0,q.length-s[0].length);R==Q&&(g=!e,l=b(u[0]),q=b(s[0]))}}var V=U*(l<q?-1:l>q?1:0);d.each(O,function(b,a){V=a.call(a,g,l,q,V)});return V});this.each(function(b,a){var c=d(a),e=l?S?s.filter(a):c.find(V):c,h=ba?""+e.data(N.data):R?e.attr(N.attr):N.useVal?e.val():e.text(),g=c.parent();q[g]||(q[g]={s:[],n:[]});0<e.length?q[g].s.push({s:h,
e:c,n:b}):q[g].n.push({e:c,n:b})});for(pa in q)q[pa].s.sort(X);for(pa in q){var X=q[pa],aa=[],T=va,Q=[0,0],ka;switch(N.place){case "first":d.each(X.s,function(b,a){T=c(T,a.n)});break;case "org":d.each(X.s,function(b,a){aa.push(a.n)});break;case "end":T=X.n.length;break;default:T=0}for(ka=0;ka<va;ka++){var W=a(aa,ka)?!e:ka>=T&&ka<T+X.s.length,u=(W?X.s:X.n)[Q[W?0:1]].e;u.parent().append(u);(W||!N.returns)&&Y.push(u.get(0));Q[W?0:1]++}}this.length=0;Array.prototype.push.apply(this,Y);return this}});
d.fn.TinySort=d.fn.Tinysort=d.fn.tsort=d.fn.tinysort})(jQuery);Array.prototype.indexOf||(Array.prototype.indexOf=function(d,a){var e=this.length,b=Number(a)||0,b=0>b?Math.ceil(b):Math.floor(b);for(0>b&&(b+=e);b<e;b++)if(b in this&&this[b]===d)return b;return-1});jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(d,a,e,b,c){return jQuery.easing[jQuery.easing.def](d,a,e,b,c)},easeInQuad:function(d,a,e,b,c){return b*(a/=c)*a+e},easeOutQuad:function(d,a,e,b,c){return-b*(a/=c)*(a-2)+e},easeInOutQuad:function(d,a,e,b,c){return 1>(a/=c/2)?b/2*a*a+e:-b/2*(--a*(a-2)-1)+e},easeInCubic:function(d,a,e,b,c){return b*(a/=c)*a*a+e},easeOutCubic:function(d,a,e,b,c){return b*((a=a/c-1)*a*a+1)+e},easeInOutCubic:function(d,a,e,b,c){return 1>(a/=c/2)?b/2*a*a*a+e:
b/2*((a-=2)*a*a+2)+e},easeInQuart:function(d,a,e,b,c){return b*(a/=c)*a*a*a+e},easeOutQuart:function(d,a,e,b,c){return-b*((a=a/c-1)*a*a*a-1)+e},easeInOutQuart:function(d,a,e,b,c){return 1>(a/=c/2)?b/2*a*a*a*a+e:-b/2*((a-=2)*a*a*a-2)+e},easeInQuint:function(d,a,e,b,c){return b*(a/=c)*a*a*a*a+e},easeOutQuint:function(d,a,e,b,c){return b*((a=a/c-1)*a*a*a*a+1)+e},easeInOutQuint:function(d,a,e,b,c){return 1>(a/=c/2)?b/2*a*a*a*a*a+e:b/2*((a-=2)*a*a*a*a+2)+e},easeInSine:function(d,a,e,b,c){return-b*Math.cos(a/
c*(Math.PI/2))+b+e},easeOutSine:function(d,a,e,b,c){return b*Math.sin(a/c*(Math.PI/2))+e},easeInOutSine:function(d,a,e,b,c){return-b/2*(Math.cos(Math.PI*a/c)-1)+e},easeInExpo:function(d,a,e,b,c){return 0==a?e:b*Math.pow(2,10*(a/c-1))+e},easeOutExpo:function(d,a,e,b,c){return a==c?e+b:b*(-Math.pow(2,-10*a/c)+1)+e},easeInOutExpo:function(d,a,e,b,c){return 0==a?e:a==c?e+b:1>(a/=c/2)?b/2*Math.pow(2,10*(a-1))+e:b/2*(-Math.pow(2,-10*--a)+2)+e},easeInCirc:function(d,a,e,b,c){return-b*(Math.sqrt(1-(a/=c)*
a)-1)+e},easeOutCirc:function(d,a,e,b,c){return b*Math.sqrt(1-(a=a/c-1)*a)+e},easeInOutCirc:function(d,a,e,b,c){return 1>(a/=c/2)?-b/2*(Math.sqrt(1-a*a)-1)+e:b/2*(Math.sqrt(1-(a-=2)*a)+1)+e},easeInElastic:function(d,a,e,b,c){d=1.70158;var h=0,g=b;if(0==a)return e;if(1==(a/=c))return e+b;h||(h=0.3*c);g<Math.abs(b)?(g=b,d=h/4):d=h/(2*Math.PI)*Math.asin(b/g);return-(g*Math.pow(2,10*(a-=1))*Math.sin((a*c-d)*2*Math.PI/h))+e},easeOutElastic:function(d,a,e,b,c){d=1.70158;var h=0,g=b;if(0==a)return e;if(1==
(a/=c))return e+b;h||(h=0.3*c);g<Math.abs(b)?(g=b,d=h/4):d=h/(2*Math.PI)*Math.asin(b/g);return g*Math.pow(2,-10*a)*Math.sin((a*c-d)*2*Math.PI/h)+b+e},easeInOutElastic:function(d,a,e,b,c){d=1.70158;var h=0,g=b;if(0==a)return e;if(2==(a/=c/2))return e+b;h||(h=c*0.3*1.5);g<Math.abs(b)?(g=b,d=h/4):d=h/(2*Math.PI)*Math.asin(b/g);return 1>a?-0.5*g*Math.pow(2,10*(a-=1))*Math.sin((a*c-d)*2*Math.PI/h)+e:0.5*g*Math.pow(2,-10*(a-=1))*Math.sin((a*c-d)*2*Math.PI/h)+b+e},easeInBack:function(d,a,e,b,c,h){void 0==
h&&(h=1.70158);return b*(a/=c)*a*((h+1)*a-h)+e},easeOutBack:function(d,a,e,b,c,h){void 0==h&&(h=1.70158);return b*((a=a/c-1)*a*((h+1)*a+h)+1)+e},easeInOutBack:function(d,a,e,b,c,h){void 0==h&&(h=1.70158);return 1>(a/=c/2)?b/2*a*a*(((h*=1.525)+1)*a-h)+e:b/2*((a-=2)*a*(((h*=1.525)+1)*a+h)+2)+e},easeInBounce:function(d,a,e,b,c){return b-jQuery.easing.easeOutBounce(d,c-a,0,b,c)+e},easeOutBounce:function(d,a,e,b,c){return(a/=c)<1/2.75?b*7.5625*a*a+e:a<2/2.75?b*(7.5625*(a-=1.5/2.75)*a+0.75)+e:a<2.5/2.75?
b*(7.5625*(a-=2.25/2.75)*a+0.9375)+e:b*(7.5625*(a-=2.625/2.75)*a+0.984375)+e},easeInOutBounce:function(d,a,e,b,c){return a<c/2?0.5*jQuery.easing.easeInBounce(d,2*a,0,b,c)+e:0.5*jQuery.easing.easeOutBounce(d,2*a-c,0,b,c)+0.5*b+e}});var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(d){for(var a=0;a<d.length;a++){var e=d[a].string,b=d[a].prop;this.versionSearchString=d[a].versionSearch||d[a].identity;if(e){if(-1!=e.indexOf(d[a].subString))return d[a].identity}else if(b)return d[a].identity}},
searchVersion:function(d){var a=d.indexOf(this.versionSearchString);if(-1!=a)return parseFloat(d.substring(a+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",
identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",
identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();(function(d,a,e){(function(b){"function"==typeof define&&define.amd?define(["jquery"],b):jQuery&&!jQuery.fn.qtip&&b(jQuery)})(function(b){function c(b){ha={pageX:b.pageX,pageY:b.pageY,type:"mousemove",scrollX:d.pageXOffset||a.body.scrollLeft||a.documentElement.scrollLeft,scrollY:d.pageYOffset||a.body.scrollTop||a.documentElement.scrollTop}}function h(a){var c=function(a){return a===R||"object"!=typeof a},d=function(a){return!b.isFunction(a)&&(!a&&!a.attr||1>a.length||"object"==typeof a&&!a.jquery&&
!a.then)};if(!a||"object"!=typeof a)return l;c(a.metadata)&&(a.metadata={type:a.metadata});if("content"in a){if(c(a.content)||a.content.jquery)a.content={text:a.content};d(a.content.text||l)&&(a.content.text=l);"title"in a.content&&(c(a.content.title)&&(a.content.title={text:a.content.title}),d(a.content.title.text||l)&&(a.content.title.text=l))}return"position"in a&&c(a.position)&&(a.position={my:a.position,at:a.position}),"show"in a&&c(a.show)&&(a.show=a.show.jquery?{target:a.show}:{event:a.show}),
"hide"in a&&c(a.hide)&&(a.hide=a.hide.jquery?{target:a.hide}:{event:a.hide}),"style"in a&&c(a.style)&&(a.style={classes:a.style}),b.each(B,function(){this.sanitize&&this.sanitize(a)}),a}function g(I,m,v,g){function n(a){var b=0,c,d=m;for(a=a.split(".");d=d[a[b++]];)b<a.length&&(c=d);return[c||m,a.pop()]}function x(a){return na.concat("").join(a?"-"+a+" ":" ")}function la(){var a=m.style.widget,b=w.hasClass(Z);w.removeClass(Z);Z=a?"ui-state-disabled":"qtip-disabled";w.toggleClass(Z,b);w.toggleClass("ui-helper-reset "+
x(),a).toggleClass(wa,m.style.def&&!a);M.content&&M.content.toggleClass(x("content"),a);M.titlebar&&M.titlebar.toggleClass(x("header"),a);M.button&&M.button.toggleClass(da+"-icon",!a)}function t(a){M.title&&(M.titlebar.remove(),M.titlebar=M.title=M.button=R,a!==l&&k.reposition())}function p(){var a=m.content.title.button,c="string"==typeof a?a:"Close tooltip";M.button&&M.button.remove();a.jquery?M.button=a:M.button=b("<a />",{"class":"qtip-close "+(m.style.widget?"":da+"-icon"),title:c,"aria-label":c}).prepend(b("<span />",
{"class":"ui-icon ui-icon-close",html:"&times;"}));M.button.appendTo(M.titlebar||w).attr("role","button").click(function(a){return w.hasClass(Z)||k.hide(a),l})}function s(){var a=P+"-title";M.titlebar&&t();M.titlebar=b("<div />",{"class":da+"-titlebar "+(m.style.widget?x("header"):"")}).append(M.title=b("<div />",{id:a,"class":da+"-title","aria-atomic":q})).insertBefore(M.content).delegate(".qtip-close","mousedown keydown mouseup keyup mouseout",function(a){b(this).toggleClass("ui-state-active ui-state-focus",
"down"===a.type.substr(-4))}).delegate(".qtip-close","mouseover mouseout",function(a){b(this).toggleClass("ui-state-hover","mouseover"===a.type)});m.content.title.button&&p()}function G(a,c){var d=M.title;if(!k.rendered||!a)return l;b.isFunction(a)&&(a=a.call(I,C.event,k));if(a===l||!a&&""!==a)return t(l);a.jquery&&0<a.length?d.empty().append(a.css({display:"block"})):d.html(a);c!==l&&k.rendered&&0<w[0].offsetWidth&&k.reposition(C.event)}function H(a){a&&b.isFunction(a.done)&&a.done(function(a){z(a,
null,l)})}function z(a,c,d){function v(a){function d(m){m&&(delete E[m.src],clearTimeout(k.timers.img[m.src]),b(m).unbind(J));b.isEmptyObject(E)&&(c!==l&&k.reposition(C.event),a())}var m,E={};if(0===(m=h.find("img[src]:not([height]):not([width])")).length)return d();m.each(function(a,c){if(E[c.src]===e){var f=0;(function Ca(){if(c.height||c.width||3<f)return d(c);f+=1;k.timers.img[c.src]=setTimeout(Ca,700)})();b(c).bind("error"+J+" load"+J,function(){d(this)});E[c.src]=c}})}var h=M.content;return!k.rendered||
!a?l:(b.isFunction(a)&&(a=a.call(I,C.event,k)||""),d!==l&&H(m.content.deferred),a.jquery&&0<a.length?h.empty().append(a.css({display:"block"})):h.html(a),0>k.rendered?w.queue("fx",v):(ua=0,v(b.noop)),k)}function A(){function e(a){if(w.hasClass(Z))return l;clearTimeout(k.timers.show);clearTimeout(k.timers.hide);var b=function(){k.toggle(q,a)};0<m.show.delay?k.timers.show=setTimeout(b,m.show.delay):b()}function f(a){if(w.hasClass(Z)||D||ua)return l;var c=b(a.relatedTarget||a.target),d=c.closest(fa)[0]===
w[0],c=c[0]===n.show[0];clearTimeout(k.timers.show);clearTimeout(k.timers.hide);if("mouse"===A.target&&d||m.hide.fixed&&/mouse(out|leave|move)/.test(a.type)&&(d||c))try{a.preventDefault(),a.stopImmediatePropagation()}catch(f){}else 0<m.hide.delay?k.timers.hide=setTimeout(function(){k.hide(a)},m.hide.delay):k.hide(a)}function h(a){if(w.hasClass(Z))return l;clearTimeout(k.timers.inactive);k.timers.inactive=setTimeout(function(){k.hide(a)},m.hide.inactive)}function g(a){k.rendered&&0<w[0].offsetWidth&&
k.reposition(a)}var A=m.position,n={show:m.show.target,hide:m.hide.target,viewport:b(A.viewport),document:b(a),body:b(a.body),window:b(d)},L=b.trim(""+m.show.event).split(" "),G=b.trim(""+m.hide.event).split(" ");b.browser.msie&&parseInt(b.browser.version,10);w.bind("mouseenter"+J+" mouseleave"+J,function(a){var b="mouseenter"===a.type;b&&k.focus(a);w.toggleClass(Ba,b)});/mouse(out|leave)/i.test(m.hide.event)&&"window"===m.hide.leave&&n.window.bind("mouseout"+J+" blur"+J,function(a){!/select|option/.test(a.target.nodeName)&&
!a.relatedTarget&&k.hide(a)});m.hide.fixed?(n.hide=n.hide.add(w),w.bind("mouseover"+J,function(){w.hasClass(Z)||clearTimeout(k.timers.hide)})):/mouse(over|enter)/i.test(m.show.event)&&n.hide.bind("mouseleave"+J,function(a){clearTimeout(k.timers.show)});-1<(""+m.hide.event).indexOf("unfocus")&&A.container.closest("html").bind("mousedown"+J+" touchstart"+J,function(a){var c=b(a.target);k.rendered&&w.hasClass(Z);var d=0<c.parents(fa).filter(w[0]).length;c[0]!==I[0]&&c[0]!==w[0]&&!d&&!I.has(c[0]).length&&
!c.attr("disabled")&&k.hide(a)});"number"==typeof m.hide.inactive&&(n.show.bind("qtip-"+v+"-inactive",h),b.each(u.inactiveEvents,function(a,b){n.hide.add(M.tooltip).bind(b+J+"-inactive",h)}));b.each(G,function(a,c){var d=b.inArray(c,L),m=b(n.hide);-1<d&&m.add(n.show).length===m.length||"unfocus"===c?(n.show.bind(c+J,function(a){0<w[0].offsetWidth?f(a):e(a)}),delete L[d]):n.hide.bind(c+J,f)});b.each(L,function(a,b){n.show.bind(b+J,e)});"number"==typeof m.hide.distance&&n.show.add(w).bind("mousemove"+
J,function(a){var b=C.origin||{},c=m.hide.distance,d=Math.abs;(d(a.pageX-b.pageX)>=c||d(a.pageY-b.pageY)>=c)&&k.hide(a)});"mouse"===A.target&&(n.show.bind("mousemove"+J,c),A.adjust.mouse&&(m.hide.event&&(w.bind("mouseleave"+J,function(a){(a.relatedTarget||a.target)!==n.show[0]&&k.hide(a)}),M.target.bind("mouseenter"+J+" mouseleave"+J,function(a){C.onTarget="mouseenter"===a.type})),n.document.bind("mousemove"+J,function(a){k.rendered&&C.onTarget&&!w.hasClass(Z)&&0<w[0].offsetWidth&&k.reposition(a||
ha)})));(A.adjust.resize||n.viewport.length)&&(b.event.special.resize?n.viewport:n.window).bind("resize"+J,g);n.window.bind("scroll"+J,g)}function K(){var c=[m.show.target[0],m.hide.target[0],k.rendered&&M.tooltip[0],m.position.container[0],m.position.viewport[0],m.position.container.closest("html")[0],d,a];k.rendered?b([]).pushStack(b.grep(c,function(a){return"object"==typeof a})).unbind(J):m.show.target.unbind(J+"-create")}var k=this,P=da+"-"+v,D=0,ua=0,w=b(),J=".qtip-"+v,Z="qtip-disabled",M,C;
k.id=v;k.rendered=l;k.destroyed=l;k.elements=M={target:I};k.timers={img:{}};k.options=m;k.checks={};k.plugins={};k.cache=C={event:{},target:b(),disabled:l,attr:g,onTarget:l,lastClass:""};k.checks.builtin={"^id$":function(a,c,d){a=d===q?u.nextid:d;c=da+"-"+a;a!==l&&0<a.length&&!b("#"+c).length&&(w[0].id=c,M.content[0].id=c+"-content",M.title[0].id=c+"-title")},"^content.text$":function(a,b,c){z(m.content.text)},"^content.deferred$":function(a,b,c){H(m.content.deferred)},"^content.title.text$":function(a,
b,c){if(!c)return t();!M.title&&c&&s();G(c)},"^content.title.button$":function(a,b,c){a=M.button;k.rendered&&(c?p():a.remove())},"^position.(my|at)$":function(a,b,c){"string"==typeof c&&(a[b]=new B.Corner(c))},"^position.container$":function(a,b,c){k.rendered&&w.appendTo(c)},"^show.ready$":function(){k.rendered?k.toggle(q):k.render(1)},"^style.classes$":function(a,b,c){w.attr("class",da+" qtip "+c)},"^style.width|height":function(a,b,c){w.css(b,c)},"^style.widget|content.title":la,"^events.(render|show|move|hide|focus|blur)$":function(a,
c,d){w[(b.isFunction(d)?"":"un")+"bind"]("tooltip"+c,d)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){var a=m.position;w.attr("tracking","mouse"===a.target&&a.adjust.mouse);K();A()}};b.extend(k,{_triggerEvent:function(a,c,d){a=b.Event("tooltip"+a);return a.originalEvent=(d?b.extend({},d):R)||C.event||R,w.trigger(a,[k].concat(c||[])),!a.isDefaultPrevented()},render:function(a){if(k.rendered)return k;var c=m.content.text,d=m.content.title,e=m.position;
return b.attr(I[0],"aria-describedby",P),w=M.tooltip=b("<div/>",{id:P,"class":[da,wa,m.style.classes,da+"-pos-"+m.position.my.abbrev()].join(" "),width:m.style.width||"",height:m.style.height||"",tracking:"mouse"===e.target&&e.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":l,"aria-describedby":P+"-content","aria-hidden":q}).toggleClass(Z,C.disabled).data("qtip",k).appendTo(m.position.container).append(M.content=b("<div />",{"class":da+"-content",id:P+"-content","aria-atomic":q})),k.rendered=
-1,D=1,d.text?(s(),b.isFunction(d.text)||G(d.text,l)):d.button&&p(),(!b.isFunction(c)||c.then)&&z(c,l),k.rendered=q,la(),b.each(m.events,function(a,c){b.isFunction(c)&&w.bind("toggle"===a?"tooltipshow tooltiphide":"tooltip"+a,c)}),b.each(B,function(){"render"===this.initialize&&this(k)}),A(),w.queue("fx",function(b){k._triggerEvent("render");D=0;(m.show.ready||a)&&k.toggle(q,C.event,l);b()}),k},get:function(a){switch(a.toLowerCase()){case "dimensions":a={height:w.outerHeight(l),width:w.outerWidth(l)};
break;case "offset":a=B.offset(w,m.position.container);break;default:a=n(a.toLowerCase()),a=a[0][a[1]],a=a.precedance?a.string():a}return a},set:function(a,c){var d=/^position\.(my|at|adjust|target|container)|style|content|show\.ready/i,e=l,v=k.checks,I;return"string"==typeof a?(I=a,a={},a[I]=c):a=b.extend(q,{},a),b.each(a,function(c,f){var m=n(c.toLowerCase()),w;w=m[0][m[1]];m[0][m[1]]="object"==typeof f&&f.nodeType?b(f):f;a[c]=[m[0],m[1],f,w];e=d.test(c)||e}),h(m),D=1,b.each(a,function(a,b){var c,
d,f;for(c in v)for(d in v[c])if(f=RegExp(d,"i").exec(a))b.push(f),v[c][d].apply(k,b)}),D=0,k.rendered&&0<w[0].offsetWidth&&e&&k.reposition("mouse"===m.position.target?R:C.event),k},toggle:function(d,f,e){function h(){d?(b.browser.msie&&w[0].style.removeAttribute("filter"),w.css("overflow",""),"string"==typeof g.autofocus&&b(g.autofocus,w).focus(),g.target.trigger("qtip-"+v+"-inactive")):w.css({display:"",visibility:"",opacity:"",left:"",top:""});k._triggerEvent(d?"visible":"hidden")}if(f){if(/over|enter/.test(f.type)&&
/out|leave/.test(C.event.type)&&m.show.target.add(f.target).length===m.show.target.length&&w.has(f.relatedTarget).length)return k;C.event=b.extend({},f)}if(!k.rendered)return d?k.render(1):k;var I=d?"show":"hide",g=m[I],A=m.position,n=m.content,J=0<w[0].offsetWidth,L=d||1===g.target.length,K=!f||2>g.target.length||C.target[0]===f.target;return(typeof d).search("boolean|number")&&(d=!J),!w.is(":animated")&&J===d&&K?k:k._triggerEvent(I,[90])?(b.attr(w[0],"aria-hidden",!d),d?(C.origin=b.extend({},ha),
k.focus(f),b.isFunction(n.text)&&z(n.text,l),b.isFunction(n.title.text)&&G(n.title.text,l),!sa&&"mouse"===A.target&&A.adjust.mouse&&(b(a).bind("mousemove.qtip",c),sa=q),k.reposition(f,e),!g.solo||b(fa,g.solo).not(w).qtip("hide",b.Event("tooltipsolo"))):(clearTimeout(k.timers.show),delete C.origin,sa&&!b(fa+'[tracking="true"]:visible',g.solo).not(w).length&&(b(a).unbind("mousemove.qtip"),sa=l),k.blur(f)),g.effect===l||L===l?(w[I](),h.call(w)):b.isFunction(g.effect)?(w.stop(1,1),g.effect.call(w,k),
w.queue("fx",function(a){h();a()})):w.fadeTo(90,d?1:0,h),d&&g.target.trigger("qtip-"+v+"-inactive"),k):k},show:function(a){return k.toggle(q,a)},hide:function(a){return k.toggle(l,a)},focus:function(a){if(!k.rendered)return k;var c=b(fa),d=parseInt(w[0].style.zIndex,10),m=u.zindex+c.length;a=b.extend({},a);return w.hasClass(ja)||k._triggerEvent("focus",[m],a)&&(d!==m&&(c.each(function(){this.style.zIndex>d&&(this.style.zIndex-=1)}),c.filter("."+ja).qtip("blur",a)),w.addClass(ja)[0].style.zIndex=m),
k},blur:function(a){return w.removeClass(ja),k._triggerEvent("blur",[w.css("zIndex")],a),k},reposition:function(c,f){if(!k.rendered||D)return k;D=1;var e=m.position.target,v=m.position,h=v.my,I=v.at,g=v.adjust,A=g.method.split(" "),n=w.outerWidth(l),J=w.outerHeight(l),L=0,G=0,K=w.css("position"),Z=v.viewport,p={left:0,top:0},x=v.container,q=0<w[0].offsetWidth,z=c&&"scroll"===c.type,t=b(d),y,ga;if(b.isArray(e)&&2===e.length)I={x:Y,y:U},p={left:e[0],top:e[1]};else if("mouse"===e&&(c&&c.pageX||C.event.pageX))I=
{x:Y,y:U},c=ha&&ha.pageX&&(g.mouse||!c||!c.pageX)?{pageX:ha.pageX,pageY:ha.pageY}:(!c||"resize"!==c.type&&"scroll"!==c.type?c&&c.pageX&&"mousemove"===c.type?c:!g.mouse&&C.origin&&C.origin.pageX&&m.show.distance?C.origin:c:C.event)||c||C.event||ha||{},"static"!==K&&(p=x.offset()),p={left:c.pageX-p.left,top:c.pageY-p.top},g.mouse&&z&&(p.left-=ha.scrollX-t.scrollLeft(),p.top-=ha.scrollY-t.scrollTop());else{"event"===e&&c&&c.target&&"scroll"!==c.type&&"resize"!==c.type?C.target=b(c.target):"event"!==
e&&(C.target=b(e.jquery?e:M.target));e=C.target;e=b(e).eq(0);if(0===e.length)return k;e[0]===a||e[0]===d?(L=B.iOS?d.innerWidth:e.width(),G=B.iOS?d.innerHeight:e.height(),e[0]===d&&(p={top:(Z||e).scrollTop(),left:(Z||e).scrollLeft()})):B.imagemap&&e.is("area")?y=B.imagemap(k,e,I,B.viewport?A:l):B.svg&&e[0].ownerSVGElement?y=B.svg(k,e,I,B.viewport?A:l):(L=e.outerWidth(l),G=e.outerHeight(l),p=B.offset(e,x));y&&(L=y.width,G=y.height,ga=y.offset,p=y.position);if(3.1<B.iOS&&4.1>B.iOS||4.3<=B.iOS&&4.33>
B.iOS||!B.iOS&&"fixed"===K)p.left-=t.scrollLeft(),p.top-=t.scrollTop();p.left+=I.x===T?L:I.x===Q?L/2:0;p.top+=I.y===aa?G:I.y===Q?G/2:0}return p.left+=g.x+(h.x===T?-n:h.x===Q?-n/2:0),p.top+=g.y+(h.y===aa?-J:h.y===Q?-J/2:0),B.viewport?(p.adjusted=B.viewport(k,p,v,L,G,n,J),ga&&p.adjusted.left&&(p.left+=ga.left),ga&&p.adjusted.top&&(p.top+=ga.top)):p.adjusted={left:0,top:0},k._triggerEvent("move",[p,Z.elem||Z],c)?(delete p.adjusted,f===l||!q||isNaN(p.left)||isNaN(p.top)||"mouse"===e||!b.isFunction(v.effect)?
w.css(p):b.isFunction(v.effect)&&(v.effect.call(w,k,b.extend({},p)),w.queue(function(a){b(this).css({opacity:"",height:""});b.browser.msie&&this.style.removeAttribute("filter");a()})),D=0,k):k},disable:function(a){return"boolean"!=typeof a&&(a=!w.hasClass(Z)&&!C.disabled),k.rendered?(w.toggleClass(Z,a),b.attr(w[0],"aria-disabled",a)):C.disabled=!!a,k},enable:function(){return k.disable(l)},destroy:function(){var a=I[0],c=b.attr(a,oa),d=I.data("qtip");k.destroyed=q;k.rendered&&(w.stop(1,0).remove(),
b.each(k.plugins,function(){this.destroy&&this.destroy()}));clearTimeout(k.timers.show);clearTimeout(k.timers.hide);K();if(!d||k===d)b.removeData(a,"qtip"),m.suppress&&c&&(b.attr(a,"title",c),I.removeAttr(oa)),I.removeAttr("aria-describedby");return I.unbind(".qtip-"+v),delete ra[k.id],I}})}function O(c,d){var e,L,n,x,la,t=b(this),p=b(a.body),s=this===a?p:t;L=t.metadata?t.metadata(d.metadata):R;x="html5"===d.metadata.type&&L?L[d.metadata.name]:R;var G=t.data(d.metadata.name||"qtipopts");try{G="string"==
typeof G?b.parseJSON(G):G}catch(H){}x=b.extend(q,{},u.defaults,d,"object"==typeof G?h(G):R,h(x||L));L=x.position;x.id=c;if("boolean"==typeof x.content.text){n=t.attr(x.content.attr);if(x.content.attr===l||!n)return l;x.content.text=n}L.container.length||(L.container=p);L.target===l&&(L.target=s);x.show.target===l&&(x.show.target=s);x.show.solo===q&&(x.show.solo=L.container.closest("body"));x.hide.target===l&&(x.hide.target=s);x.position.viewport===q&&(x.position.viewport=L.container);L.container=
L.container.eq(0);L.at=new B.Corner(L.at);L.my=new B.Corner(L.my);if(b.data(this,"qtip"))if(x.overwrite)t.qtip("destroy");else if(x.overwrite===l)return l;return x.suppress&&(la=b.attr(this,"title"))&&b(this).removeAttr("title").attr(oa,la).attr("title",""),e=new g(t,x,c,!!n),b.data(this,"qtip",e),t.bind("remove.qtip-"+c+" removeqtip.qtip-"+c,function(){e.destroy()}),e}function V(a){var c=this,d=a.elements.tooltip,e=a.options.content.ajax,h=u.defaults.content.ajax,g=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
la=q,t=l,p;a.checks.ajax={"^content.ajax":function(a,b,h){"ajax"===b&&(e=h);"once"===b?c.init():e&&e.url?c.load():d.unbind(".qtip-ajax")}};b.extend(c,{init:function(){return e&&e.url&&d.unbind(".qtip-ajax")[e.once?"one":"bind"]("tooltipshow.qtip-ajax",c.load),c},load:function(d){function v(){var c;a.destroyed||(la=l,u&&(t=q,a.show(d.originalEvent)),(c=h.complete||e.complete)&&b.isFunction(c)&&c.apply(e.context||a,arguments))}function H(c,d,m){var v;a.destroyed||(k&&"string"==typeof c&&(c=b("<div/>").append(c.replace(g,
"")).find(k)),(v=h.success||e.success)&&b.isFunction(v)?v.call(e.context||a,c,d,m):a.set("content.text",c))}function z(c,b,d){a.destroyed||0===c.status||a.set("content.text",b+": "+d)}if(t)t=l;else{var A=e.url.lastIndexOf(" "),K=e.url,k,u=!e.loading&&la;if(u)try{d.preventDefault()}catch(D){}else if(d&&d.isDefaultPrevented())return c;p&&p.abort&&p.abort();-1<A&&(k=K.substr(A),K=K.substr(0,A));p=b.ajax(b.extend({error:h.error||z,context:a},e,{url:K,success:H,complete:v}))}},destroy:function(){p&&p.abort&&
p.abort();a.destroyed=q}});c.init()}function ca(a,c,b){var d=Math.ceil(c/2),e=Math.ceil(b/2);c={bottomright:[[0,0],[c,b],[c,0]],bottomleft:[[0,0],[c,0],[0,b]],topright:[[0,b],[c,0],[c,b]],topleft:[[0,0],[0,b],[c,b]],topcenter:[[0,b],[d,0],[c,b]],bottomcenter:[[0,0],[c,0],[d,b]],rightcenter:[[0,0],[c,e],[0,b]],leftcenter:[[c,0],[c,b],[0,e]]};return c.lefttop=c.bottomright,c.righttop=c.bottomleft,c.leftbottom=c.topright,c.rightbottom=c.topleft,c[a.string()]}function N(a,c){var d,h;function g(a){var c=
K.is(":visible");K.show();a();K.toggle(c)}function x(c,b,d,m){if(A.tip){c=H.corner.clone();b=d.adjusted;var h=a.options.position.adjust.method.split(" ");m=h[0];var h=h[1]||h[0],v=l,f=l,g=0,p=0,n,K={},G;H.corner.fixed!==q&&(m===W&&c.precedance===ba&&b.left&&c.y!==Q?c.precedance=c.precedance===ba?S:ba:m!==W&&b.left&&(c.x=c.x===Q?0<b.left?Y:T:c.x===Y?T:Y),h===W&&c.precedance===S&&b.top&&c.x!==Q?c.precedance=c.precedance===S?ba:S:h!==W&&b.top&&(c.y=c.y===Q?0<b.top?U:aa:c.y===U?aa:U),c.string()!==k.corner.string()&&
(k.top!==b.top||k.left!==b.left)&&H.update(c,l));n=H.position(c,b);n[c.x]+=u(c,c.x);n[c.y]+=u(c,c.y);n.right!==e&&(n.left=-n.right);n.bottom!==e&&(n.top=-n.bottom);n.user=Math.max(0,z.offset);if(v=m===W&&!!b.left)c.x===Q?K["margin-left"]=g=n["margin-left"]:(G=n.right!==e?[b.left,-n.left]:[-b.left,n.left],(g=Math.max(G[0],G[1]))>G[0]&&(d.left-=b.left,v=l),K[n.right!==e?T:Y]=g);if(f=h===W&&!!b.top)c.y===Q?K["margin-top"]=p=n["margin-top"]:(G=n.bottom!==e?[b.top,-n.top]:[-b.top,n.top],(p=Math.max(G[0],
G[1]))>G[0]&&(d.top-=b.top,f=l),K[n.bottom!==e?aa:U]=p);A.tip.css(K).toggle(!(g&&p||c.x===Q&&p||c.y===Q&&g));d.left-=n.left.charAt?n.user:m!==W||f||!v&&!f?n.left:0;d.top-=n.top.charAt?n.user:h!==W||v||!v&&!f?n.top:0;k.left=b.left;k.top=b.top;k.corner=c.clone()}}function u(a,c,b){c=c?c:a[a.precedance];var d=A.titlebar&&a.y===U?A.titlebar:K,e="border-"+c+"-width",m;return g(function(){m=(b?parseInt(b.css(e),10):parseInt(A.content.css(e),10)||parseInt(d.css(e),10)||parseInt(K.css(e),10))||0}),m}function t(a){var c=
A.titlebar&&a.y===U?A.titlebar:A.content,d=b.browser.mozilla?"-moz-":b.browser.webkit?"-webkit-":"",e="border-radius-"+a.y+a.x,m="border-"+a.y+"-"+a.x+"-radius",h=function(a){return parseInt(c.css(a),10)||parseInt(K.css(a),10)},f;return g(function(){f=h(m)||h(d+m)||h(d+e)||h(e)||0}),f}function p(a){function c(a,b,d){b=a.css(b)||I;return d&&b===a.css(d)?l:m.test(b)?l:b}var e=A.tip.css("cssText","");a=a||H.corner;var m=/rgba?\(0, 0, 0(, 0)?\)|transparent|#123456/i,k="border-"+a[a.precedance]+"-color",
I="transparent",f=A.titlebar,p=f&&(a.y===U||a.y===Q&&e.position().top+P.height/2+z.offset<f.outerHeight(q))?f:A.content;g(function(){d=c(e,"background-color")||c(p,"background-color")||c(A.content,"background-color")||c(K,"background-color")||e.css("background-color");h=c(e,k,"color")||c(p,k,"color")||c(A.content,k,"color")||c(K,k,"color")||K.css(k);b("*",e).add(e).css("cssText","background-color:"+I+" !important;border:0 !important;")})}function V(a){var c=a.precedance===S,b=P[c?s:X],d=P[c?X:s];
a=-1<a.string().indexOf(Q);var e=b*(a?0.5:1),m=Math.pow,f=Math.round,k,h,v,g=Math.sqrt(m(e,2)+m(d,2)),e=[D/e*g,D/d*g];return e[2]=Math.sqrt(m(e[0],2)-m(D,2)),e[3]=Math.sqrt(m(e[1],2)-m(D,2)),k=g+e[2]+e[3]+(a?0:e[0]),h=k/g,v=[f(h*d),f(h*b)],{height:v[c?0:1],width:v[c?1:0]}}function G(a,c,b){return"<qvml:"+a+' xmlns="urn:schemas-microsoft.com:vml" class="qtip-vml" '+(c||"")+' style="behavior: url(#default#VML); '+(b||"")+'" />'}var H=this,z=a.options.style.tip,A=a.elements,K=A.tooltip,k={top:0,left:0},
P={width:z.width,height:z.height};h=d=void 0;var D=z.border||0,O=!!(b("<canvas />")[0]||{}).getContext;H.corner=R;H.mimic=R;H.border=D;H.offset=z.offset;H.size=P;a.checks.tip={"^position.my|style.tip.(corner|mimic|border)$":function(){H.init()||H.destroy();a.reposition()},"^style.tip.(height|width)$":function(){P={width:z.width,height:z.height};H.create();H.update();a.reposition()},"^content.title.text|style.(classes|widget)$":function(){A.tip&&A.tip.length&&H.update()}};b.extend(H,{init:function(){var c=
z.corner,d=a.options.position,e=d.at,d=d.my.string?d.my.string():d.my,c=(c===l||d===l&&e===l?l:(c===q?H.corner=new B.Corner(d):c.string||(H.corner=new B.Corner(c),H.corner.fixed=q),k.corner=new B.Corner(H.corner.string()),"centercenter"!==H.corner.string()))&&(O||b.browser.msie);return c&&(H.create(),H.update(),K.unbind(".qtip-tip").bind("tooltipmove.qtip-tip",x)),c},create:function(){var a=P.width,c=P.height,d;A.tip&&A.tip.remove();A.tip=b("<div />",{"class":"qtip-tip"}).css({width:a,height:c}).prependTo(K);
O?b("<canvas />").appendTo(A.tip)[0].getContext("2d").save():(d=G("shape",'coordorigin="0,0"',"position:absolute;"),A.tip.html(d+d),b("*",A.tip).bind("click mousedown",function(a){a.stopPropagation()}))},update:function(a,c){var e=A.tip,m=e.children(),g=P.width,n=P.height,f=z.mimic,I=Math.round,x,t,s,N;a||(a=k.corner||H.corner);f===l?f=a:(f=new B.Corner(f),f.precedance=a.precedance,"inherit"===f.x?f.x=a.x:"inherit"===f.y?f.y=a.y:f.x===f.y&&(f[a.precedance]=a[a.precedance]));a.precedance===ba?(P.width=
z.height,P.height=z.width):(P.width=z.width,P.height=z.height);A.tip.css({width:g=P.width,height:n=P.height});p(a);"transparent"!==h?(D=u(a,R),0===z.border&&0<D&&(d=h),H.border=D=z.border!==q?z.border:D):H.border=D=0;t=ca(f,g,n);H.size=N=V(a);e.css(N).css("line-height",N.height+"px");a.precedance===S?s=[I(f.x===Y?D:f.x===T?N.width-g-D:(N.width-g)/2),I(f.y===U?N.height-n:0)]:s=[I(f.x===Y?N.width-g:0),I(f.y===U?D:f.y===aa?N.height-n-D:(N.height-n)/2)];O?(m.attr(N),x=m[0].getContext("2d"),x.restore(),
x.save(),x.clearRect(0,0,3E3,3E3),x.fillStyle=d,x.strokeStyle=h,x.lineWidth=2*D,x.lineJoin="miter",x.miterLimit=100,x.translate(s[0],s[1]),x.beginPath(),x.moveTo(t[0][0],t[0][1]),x.lineTo(t[1][0],t[1][1]),x.lineTo(t[2][0],t[2][1]),x.closePath(),D&&("border-box"===K.css("background-clip")&&(x.strokeStyle=d,x.stroke()),x.strokeStyle=h,x.stroke()),x.fill()):(t="m"+t[0][0]+","+t[0][1]+" l"+t[1][0]+","+t[1][1]+" "+t[2][0]+","+t[2][1]+" xe",s[2]=D&&/^(r|b)/i.test(a.string())?8===parseFloat(b.browser.version,
10)?2:1:0,m.css({coordsize:g+D+" "+(n+D),antialias:""+(-1<f.string().indexOf(Q)),left:s[0],top:s[1],width:g+D,height:n+D}).each(function(a){var c=b(this);c[c.prop?"prop":"attr"]({coordsize:g+D+" "+(n+D),path:t,fillcolor:d,filled:!!a,stroked:!a}).toggle(!!D||!!a);!a&&""===c.html()&&c.html(G("stroke",'weight="'+2*D+'px" color="'+h+'" miterlimit="1000" joinstyle="miter"'))}));c!==l&&H.position(a)},position:function(a){var c=A.tip,d={},e=Math.max(0,z.offset),m,h,f;return z.corner===l||!c?l:(a=a||H.corner,
m=a.precedance,h=V(a),f=[a.x,a.y],m===ba&&f.reverse(),b.each(f,function(c,b){var f,k,g;b===Q?(f=m===S?Y:U,d[f]="50%",d["margin-"+f]=-Math.round(h[m===S?s:X]/2)+e):(f=u(a,b),k=u(a,b,A.content),g=t(a),d[b]=c?k:e+(g>f?g:-f))}),d[a[m]]-=h[m===ba?s:X],c.css({top:"",bottom:"",left:"",right:"",margin:""}).css(d),d)},destroy:function(){A.tip&&A.tip.remove();A.tip=!1;K.unbind(".qtip-tip")}});H.init()}function pa(c){function e(){H=b(G,t).not("[disabled]").map(function(){return"function"==typeof this.focus?
this:null})}function h(a){1>H.length&&a.length?a.not("body").blur():H.first().focus()}function g(a){var c=b(a.target),d=c.closest(".qtip");!(1>d.length?l:parseInt(d[0].style.zIndex,10)>parseInt(t[0].style.zIndex,10))&&b(a.target).closest(fa)[0]!==t[0]&&h(c)}var n=this,x=c.options.show.modal,u=c.elements,t=u.tooltip,p=".qtipmodal"+c.id,s=b(a.body),G=B.modal.focusable.join(","),H={},z;c.checks.modal={"^show.modal.(on|blur)$":function(){n.init();u.overlay.toggle(t.is(":visible"))},"^content.text$":function(){e()}};
b.extend(n,{init:function(){return x.on?(z=n.create(),t.attr("is-modal-qtip",q).css("z-index",B.modal.zindex+b(fa+"[is-modal-qtip]").length).unbind(".qtipmodal").unbind(p).bind("tooltipshow.qtipmodal tooltiphide.qtipmodal",function(a,c,d){c=a.originalEvent;if(a.target===t[0])if(c&&"tooltiphide"===a.type&&/mouse(leave|enter)/.test(c.type)&&b(c.relatedTarget).closest(z[0]).length)try{a.preventDefault()}catch(e){}else(!c||c&&!c.solo)&&n[a.type.replace("tooltip","")](a,d)}).bind("tooltipfocus.qtipmodal",
function(a){if(!(a.isDefaultPrevented()||a.target!==t[0])){var c=b(fa).filter("[is-modal-qtip]"),d=B.modal.zindex+c.length,e=parseInt(t[0].style.zIndex,10);z[0].style.zIndex=d-2;c.each(function(){this.style.zIndex>e&&(this.style.zIndex-=1)});c.end().filter("."+ja).qtip("blur",a.originalEvent);t.addClass(ja)[0].style.zIndex=d;try{a.preventDefault()}catch(m){}}}).bind("tooltiphide.qtipmodal",function(a){a.target===t[0]&&b("[is-modal-qtip]").filter(":visible").not(t).last().qtip("focus",a)}),x.escape&&
b(a).unbind(p).bind("keydown"+p,function(a){27===a.keyCode&&t.hasClass(ja)&&c.hide(a)}),x.blur&&u.overlay.unbind(p).bind("click"+p,function(a){t.hasClass(ja)&&c.hide(a)}),e(),n):n},create:function(){function a(){z.css({height:e.height(),width:e.width()})}var c=b("#qtip-overlay"),e=b(d);return c.length?u.overlay=c.insertAfter(b(fa).last()):(z=u.overlay=b("<div />",{id:"qtip-overlay",html:"<div></div>",mousedown:function(){return l}}).hide().insertAfter(b(fa).last()),e.unbind(".qtipmodal").bind("resize.qtipmodal",
a),a(),z)},toggle:function(a,c,d){if(a&&a.isDefaultPrevented())return n;a=x.effect;var e=c?"show":"hide",m=z.is(":visible"),I=b("[is-modal-qtip]").filter(":visible").not(t);return z||(z=n.create()),z.is(":animated")&&m===c&&z.data("toggleState")!==l||!c&&I.length?n:(c?(z.css({left:0,top:0}),z.toggleClass("blurs",x.blur),x.stealfocus!==l&&(s.bind("focusin"+p,g),h(b("body :focus")))):s.unbind("focusin"+p),z.stop(q,l).data("toggleState",c),b.isFunction(a)?a.call(z,c):a===l?z[e]():z.fadeTo(parseInt(d,
10)||90,c?1:0,function(){c||b(this).hide()}),c||z.queue(function(a){z.css({left:"",top:""}).removeData("toggleState");a()}),n)},show:function(a,c){return n.toggle(a,q,c)},hide:function(a,c){return n.toggle(a,l,c)},destroy:function(){var d=z;return d&&(d=1>b("[is-modal-qtip]").not(t).length,d?(u.overlay.remove(),b(a).unbind(".qtipmodal")):u.overlay.unbind(".qtipmodal"+c.id),s.unbind("focusin"+p)),t.removeAttr("is-modal-qtip").unbind(".qtipmodal")}});n.init()}function va(c){var e=this,h=c.elements,
g=c.options,n=h.tooltip,x=".ie6-"+c.id,u=1>b("select, object").length,t=0,p=l,B;c.checks.ie6={"^content|style$":function(a,c,b){redraw()}};b.extend(e,{init:function(){var c=b(d),g;u&&(h.bgiframe=b('<iframe class="qtip-bgiframe" frameborder="0" tabindex="-1" src="javascript:\'\';"  style="display:block; position:absolute; z-index:-1; filter:alpha(opacity=0); -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";"></iframe>'),h.bgiframe.appendTo(n),n.bind("tooltipmove"+x,e.adjustBGIFrame));
B=b("<div/>",{id:"qtip-rcontainer"}).appendTo(a.body);e.redraw();h.overlay&&!p&&(g=function(){h.overlay[0].style.top=c.scrollTop()+"px"},c.bind("scroll.qtip-ie6, resize.qtip-ie6",g),g(),h.overlay.addClass("qtipmodal-ie6fix"),p=q)},adjustBGIFrame:function(){var a=c.get("dimensions"),b=c.plugins.tip,d=h.tip,e,m;m=parseInt(n.css("border-left-width"),10)||0;m={left:-m,top:-m};b&&d&&(e="x"===b.corner.precedance?["width","left"]:["height","top"],m[e[1]]-=d[e[0]]());h.bgiframe.css(m).css(a)},redraw:function(){if(1>
c.rendered||t)return e;var a=g.style,b=g.position.container,d,h,v,k;return t=1,a.height&&n.css(X,a.height),a.width?n.css(s,a.width):(n.css(s,"").appendTo(B),h=n.width(),1>h%2&&(h+=1),v=n.css("max-width")||"",k=n.css("min-width")||"",d=-1<(v+k).indexOf("%")?b.width()/100:0,v=(-1<v.indexOf("%")?d:1)*parseInt(v,10)||h,k=(-1<k.indexOf("%")?d:1)*parseInt(k,10)||0,h=v+k?Math.min(Math.max(h,k),v):h,n.css(s,Math.round(h)).appendTo(b)),t=0,e},destroy:function(){u&&h.bgiframe.remove();n.unbind(x)}});e.init()}
var q=!0,l=!1,R=null,ba="x",S="y",s="width",X="height",U="top",Y="left",aa="bottom",T="right",Q="center",ka="flipinvert",W="shift",u,B,ha,da="qtip",ra={},na=["ui-widget","ui-tooltip"],fa="div.qtip."+da,wa=da+"-default",ja=da+"-focus",Ba=da+"-hover",oa="oldtitle",sa;u=b.fn.qtip=function(a,c,d){var g=(""+a).toLowerCase(),n=R,x=b.makeArray(arguments).slice(1),s=x[x.length-1],t=this[0]?b.data(this[0],"qtip"):R;if(!arguments.length&&t||"api"===g)return t;if("string"==typeof a)return this.each(function(){var a=
b.data(this,"qtip");if(!a)return q;s&&s.timeStamp&&(a.cache.event=s);if("option"!==g&&"options"!==g||!c)a[g]&&a[g].apply(a[g],x);else{if(!b.isPlainObject(c)&&d===e)return n=a.get(c),l;a.set(c,d)}}),n!==R?n:this;if("object"==typeof a||!arguments.length)return t=h(b.extend(q,{},a)),u.bind.call(this,t,s)};u.bind=function(a,d){return this.each(function(h){function g(a){function c(){p.render("object"==typeof a||n.show.ready);x.show.add(x.hide).unbind(t)}if(p.cache.disabled)return l;p.cache.event=b.extend({},
a);p.cache.target=a?b(a.target):[e];0<n.show.delay?(clearTimeout(p.timers.show),p.timers.show=setTimeout(c,n.show.delay),s.show!==s.hide&&x.hide.bind(s.hide,function(){clearTimeout(p.timers.show)})):c()}var n,x,s,t,p;h=b.isArray(a.id)?a.id[h]:a.id;h=!h||h===l||1>h.length||ra[h]?u.nextid++:ra[h]=h;t=".qtip-"+h+"-create";p=O.call(this,h,a);if(p===l)return q;n=p.options;b.each(B,function(){"initialize"===this.initialize&&this(p)});x={show:n.show.target,hide:n.hide.target};s={show:b.trim(""+n.show.event).replace(/ /g,
t+" ")+t,hide:b.trim(""+n.hide.event).replace(/ /g,t+" ")+t};/mouse(over|enter)/i.test(s.show)&&!/mouse(out|leave)/i.test(s.hide)&&(s.hide+=" mouseleave"+t);x.show.bind("mousemove"+t,function(a){c(a);p.cache.onTarget=q});x.show.bind(s.show,g);(n.show.ready||n.prerender)&&g(d)}).attr("data-hasqtip",q)};B=u.plugins={Corner:function(a){a=(""+a).replace(/([A-Z])/," $1").replace(/middle/gi,Q).toLowerCase();this.x=(a.match(/left|right/i)||a.match(/center/)||["inherit"])[0].toLowerCase();this.y=(a.match(/top|bottom|center/i)||
["inherit"])[0].toLowerCase();a=a.charAt(0);this.precedance="t"===a||"b"===a?S:ba;this.string=function(){return this.precedance===S?this.y+this.x:this.x+this.y};this.abbrev=function(){var a=this.x.substr(0,1),c=this.y.substr(0,1);return a===c?a:this.precedance===S?c+a:a+c};this.invertx=function(a){this.x=this.x===Y?T:this.x===T?Y:a||this.x};this.inverty=function(a){this.y=this.y===U?aa:this.y===aa?U:a||this.y};this.clone=function(){return{x:this.x,y:this.y,precedance:this.precedance,string:this.string,
abbrev:this.abbrev,clone:this.clone,invertx:this.invertx,inverty:this.inverty}}},offset:function(c,d){var e=c.offset(),h=c.closest("body"),g=b.browser.msie&&"CSS1Compat"!==a.compatMode,l=d,s,t,p;if(l){do"static"!==l.css("position")&&(t=l.position(),e.left-=t.left+(parseInt(l.css("borderLeftWidth"),10)||0)+(parseInt(l.css("marginLeft"),10)||0),e.top-=t.top+(parseInt(l.css("borderTopWidth"),10)||0)+(parseInt(l.css("marginTop"),10)||0),!s&&"hidden"!==(p=l.css("overflow"))&&"visible"!==p&&(s=l));while((l=
b(l[0].offsetParent)).length);if(s&&s[0]!==h[0]||g)h=s||h,e.left+=1*h.scrollLeft(),e.top+=1*h.scrollTop()}return e},iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||l,fn:{attr:function(a,c){if(this.length){var d=this[0],e=b.data(d,"qtip");if("title"===a&&e&&"object"==typeof e&&e.options.suppress)return 2>arguments.length?b.attr(d,oa):(e&&"title"===e.options.content.attr&&
e.cache.attr&&e.set("content.text",c),this.attr(oa,c))}return b.fn.attr_replacedByqTip.apply(this,arguments)},clone:function(a){b([]);var c=b.fn.clone_replacedByqTip.apply(this,arguments);return a||c.filter("["+oa+"]").attr("title",function(){return b.attr(this,oa)}).removeAttr(oa),c}}};b.each(B.fn,function(a,c){if(!c||b.fn[a+"_replacedByqTip"])return q;var d=b.fn[a+"_replacedByqTip"]=b.fn[a];b.fn[a]=function(){return c.apply(this,arguments)||d.apply(this,arguments)}});b.ui||(b.cleanData_replacedByqTip=
b.cleanData,b.cleanData=function(a){for(var c=0,d;(d=a[c])!==e;c++)try{b(d).triggerHandler("removeqtip")}catch(h){}b.cleanData_replacedByqTip(a)});u.version="2.0.1";u.nextid=0;u.inactiveEvents="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" ");u.zindex=15E3;u.defaults={prerender:l,id:l,overwrite:q,suppress:q,content:{text:q,attr:"title",deferred:l,title:{text:l,button:l}},position:{my:"top left",at:"bottom right",target:l,container:l,viewport:l,adjust:{x:0,y:0,mouse:q,resize:q,
method:"flipinvert flipinvert"},effect:function(a,c,d){b(this).animate(c,{duration:200,queue:l})}},show:{target:l,event:"mouseenter",effect:q,delay:90,solo:l,ready:l,autofocus:l},hide:{target:l,event:"mouseleave",effect:q,delay:0,fixed:l,inactive:l,leave:"window",distance:l},style:{classes:"",widget:l,width:l,height:l,def:q},events:{render:R,move:R,show:R,hide:R,toggle:R,visible:R,hidden:R,focus:R,blur:R}};B.svg=function(c,d,e,h){c=b(a);var g=d[0];d={width:0,height:0,position:{top:1E10,left:1E10}};
for(var l;!g.getBBox;)g=g.parentNode;if(g.getBBox&&g.parentNode){e=g.getBBox();h=g.getScreenCTM();g=g.farthestViewportElement||g;if(!g.createSVGPoint)return d;g=g.createSVGPoint();g.x=e.x;g.y=e.y;l=g.matrixTransform(h);d.position.left=l.x;d.position.top=l.y;g.x+=e.width;g.y+=e.height;l=g.matrixTransform(h);d.width=l.x-d.position.left;d.height=l.y-d.position.top;d.position.left+=c.scrollLeft();d.position.top+=c.scrollTop()}return d};B.ajax=function(a){var c=a.plugins.ajax;return"object"==typeof c?
c:a.plugins.ajax=new V(a)};B.ajax.initialize="render";B.ajax.sanitize=function(a){var c=a.content,b;c&&"ajax"in c&&(b=c.ajax,"object"!=typeof b&&(b=a.content.ajax={url:b}),"boolean"!=typeof b.once&&b.once&&(b.once=!!b.once))};b.extend(q,u.defaults,{content:{ajax:{loading:q,once:q}}});B.tip=function(a){var c=a.plugins.tip;return"object"==typeof c?c:a.plugins.tip=new N(a)};B.tip.initialize="render";B.tip.sanitize=function(a){var c=a.style,b;c&&"tip"in c&&(b=a.style.tip,"object"!=typeof b&&(a.style.tip=
{corner:b}),/string|boolean/i.test(typeof b.corner)||(b.corner=q),"number"!=typeof b.width&&delete b.width,"number"!=typeof b.height&&delete b.height,"number"!=typeof b.border&&b.border!==q&&delete b.border,"number"!=typeof b.offset&&delete b.offset)};b.extend(q,u.defaults,{style:{tip:{corner:q,mimic:l,width:6,height:6,border:q,offset:0}}});B.modal=function(a){var c=a.plugins.modal;return"object"==typeof c?c:a.plugins.modal=new pa(a)};B.modal.initialize="render";B.modal.sanitize=function(a){a.show&&
("object"!=typeof a.show.modal?a.show.modal={on:!!a.show.modal}:"undefined"==typeof a.show.modal.on&&(a.show.modal.on=q))};B.modal.zindex=u.zindex-200;B.modal.focusable="a[href] area[href] input select textarea button iframe object embed [tabindex] [contenteditable]".split(" ");b.extend(q,u.defaults,{show:{modal:{on:l,effect:q,blur:q,stealfocus:q,escape:q}}});B.viewport=function(c,b,e,h,g,l,q){function t(a,c,d,e,f,h,g,l,n){var p=b[f],v=G[a],t=B[a],s=d===W,q=-P.offset[f]+k.offset[f]+k["scroll"+f],
u=v===f?n:v===h?-n:-n/2,x=D&&D.size?D.size[g]||0:0,A=D&&D.corner&&D.corner.precedance===a&&!s?x:0,z=q-p+A;n=p+n-k[g]-q+A;l=u-(G.precedance===a||v===G[c]?t===f?l:t===h?-l:-l/2:0)-(t===Q?l/2:0);return s?(A=D&&D.corner&&D.corner.precedance===c?x:0,l=(v===f?1:-1)*u-A,b[f]+=0<z?z:0<n?-n:0,b[f]=Math.max(-P.offset[f]+k.offset[f]+(A&&D.corner[a]===Q?D.offset:0),p-l,Math.min(Math.max(-P.offset[f]+k.offset[f]+k[g],p+l),b[f]))):(e*=d===ka?2:0,0<z&&(v!==f||0<n)?(b[f]-=l+e,w["invert"+a](f)):0<n&&(v!==h||0<z)&&
(b[f]-=(v===Q?-l:l)+e,w["invert"+a](h)),b[f]<q&&-b[f]>n&&(b[f]=p,w=G.clone())),b[f]-p}var p=e.target,u=c.elements.tooltip,G=e.my,B=e.at,z=e.adjust,A=z.method.split(" "),K=A[0],A=A[1]||A[0],k=e.viewport,P=e.container;e=c.cache;var D=c.plugins.tip,N={left:0,top:0},w,J;if(!k.jquery||p[0]===d||p[0]===a.body||"none"===z.method)return N;p="fixed"===u.css("position");k={elem:k,height:k[(k[0]===d?"h":"outerH")+"eight"](),width:k[(k[0]===d?"w":"outerW")+"idth"](),scrollleft:p?0:k.scrollLeft(),scrolltop:p?
0:k.scrollTop(),offset:k.offset()||{left:0,top:0}};P={elem:P,scrollLeft:P.scrollLeft(),scrollTop:P.scrollTop(),offset:P.offset()||{left:0,top:0}};if("shift"!==K||"shift"!==A)w=G.clone();return N={left:"none"!==K?t(ba,S,K,z.x,Y,T,s,h,l):0,top:"none"!==A?t(S,ba,A,z.y,U,aa,X,g,q):0},w&&e.lastClass!==(J=da+"-pos-"+w.abbrev())&&u.removeClass(c.cache.lastClass).addClass(c.cache.lastClass=J),N};B.imagemap=function(a,c,d,e){function h(a,c,b){for(var d=0,e=1,g=1,l=0,m=0,n=a.width,p=a.height;0<n&&0<p&&0<e&&
0<g;){n=Math.floor(n/2);p=Math.floor(p/2);b.x===Y?e=n:b.x===T?e=a.width-n:e+=Math.floor(n/2);b.y===U?g=p:b.y===aa?g=a.height-p:g+=Math.floor(p/2);for(d=c.length;d--&&!(2>c.length);)l=c[d][0]-a.position.left,m=c[d][1]-a.position.top,(b.x===Y&&l>=e||b.x===T&&l<=e||b.x===Q&&(l<e||l>a.width-e)||b.y===U&&m>=g||b.y===aa&&m<=g||b.y===Q&&(m<g||m>a.height-g))&&c.splice(d,1)}return{left:c[0][0],top:c[0][1]}}c.jquery||(c=b(c));a=a.cache.areas={};var g=(c[0].shape||c.attr("shape")).toLowerCase(),l=c[0].coords||
c.attr("coords"),t=l.split(","),p=[];c=b('img[usemap="#'+c.parent("map").attr("name")+'"]');var s=c.offset(),q={width:0,height:0,position:{top:1E10,right:0,bottom:0,left:1E10}},u=0,z=0;s.left+=Math.ceil((c.outerWidth()-c.width())/2);s.top+=Math.ceil((c.outerHeight()-c.height())/2);if("poly"===g)for(u=t.length;u--;)z=[parseInt(t[--u],10),parseInt(t[u+1],10)],z[0]>q.position.right&&(q.position.right=z[0]),z[0]<q.position.left&&(q.position.left=z[0]),z[1]>q.position.bottom&&(q.position.bottom=z[1]),
z[1]<q.position.top&&(q.position.top=z[1]),p.push(z);else for(u=-1;u++<t.length;)p.push(parseInt(t[u],10));switch(g){case "rect":q={width:Math.abs(p[2]-p[0]),height:Math.abs(p[3]-p[1]),position:{left:Math.min(p[0],p[2]),top:Math.min(p[1],p[3])}};break;case "circle":q={width:p[2]+2,height:p[2]+2,position:{left:p[0],top:p[1]}};break;case "poly":q.width=Math.abs(q.position.right-q.position.left),q.height=Math.abs(q.position.bottom-q.position.top),"c"===d.abbrev()?q.position={left:q.position.left+q.width/
2,top:q.position.top+q.height/2}:(a[d+l]||(q.position=h(q,p.slice(),d),e&&("flip"===e[0]||"flip"===e[1])&&(q.offset=h(q,p.slice(),{x:d.x===Y?T:d.x===T?Y:Q,y:d.y===U?aa:d.y===aa?U:Q}),q.offset.left-=q.position.left,q.offset.top-=q.position.top),a[d+l]=q),q=a[d+l]),q.width=q.height=0}return q.position.left+=s.left,q.position.top+=s.top,q};B.ie6=function(a){var c=b.browser,d=a.plugins.ie6;return!c.msie||"6"!==(""+c.version).charAt(0)?l:"object"==typeof d?d:a.plugins.ie6=new va(a)};B.ie6.initialize="render"})})(window,
document);var attask=function(){function d(a){f.set("general",!1);var c=f.get("host").replace(/[|&;$%@"<>()+,]/g,""),b=new Date;b.setHours(b.getHours()-b.getTimezoneOffset()/60);b=b.toJSON();c={url:"https://"+Ia+"/Tools/Subform/UsageTracker.aspx?f=Stopwatch",data:JSON.stringify({dateTime:b,activity:{request:c},userID:f.get("userID")}),dataType:"json",type:"POST"};c=jQuery.ajax(c);c.done(function(c,b,d){c.isValid?(f.set("ent",!0),c.message=JSON.parse(c.message),c.isWarn&&console.log(c.message.message),f.set("updateAtInterval",
void 0!=c.message.updateAtInterval?c.message.updateAtInterval:!1),f.set("userHostName",c.message.userHostName),f.set("stopOnClose",void 0!=c.message.stopOnClose?c.message.stopOnClose:!0),f.set("forceHourTypeID",c.message.forceHourTypeID),f.set("maxTaskTime",void 0!=c.message.maxTaskTime?parseFloat(c.message.maxTaskTime):8.5),f.set("hideTaskButtons",void 0!=c.message.hideTaskButtons?c.message.hideTaskButtons:!1),f.get("hideTaskButtons")&&f.set("sort","project"),b=function(){f.set("is_auth",!0);f.set("auth_key",
!0);f.set("sessionID",c.message.apiKey);f.set("password",null);a&&a();jQuery("#top-bar").show();ja()},(void 0!=c.message.forceLogin?c.message.forceLogin:1)?void 0==f.get("sessionID")?aa(b):b():b()):(f.set("access","demo"),f.set("is_auth",!1),console.log(c.message))});c.fail(function(a,c,b){})}function a(a){f.set("updateAtInterval",!1);f.set("general",!0);if(f.get("ent"))d(a);else{var c=-1==window.location.origin.indexOf("atappstore.com")?"https://"+Ga:window.location.origin,b=f.get("qr")?"shiftwatch-qr":
"stopwatch",c={url:c+"/api/authorize/",data:{product:b,host:f.get("host"),sessionID:f.get("sessionID"),user:f.get("username"),domain:f.get("domain")},type:"GET",dataType:"json"};u(c);c=jQuery.ajax(c);c.done(function(c,b,d){!1!=c.success&&(f.set("auth_key",c.auth_key),f.set("access",c.access),f.set("is_auth",c.is_auth),f.set("license_expiry_days",c.license_expiry_days),f.get("qr")&&(f.set("view","team"),f.set("sort","project"),f.set("logout_on_select",!0),f.set("multi",!0),f.set("hide_team_done",!0),
f.set("minuteBuffer",30),f.set("minuteBufferSnapToSched",!0),TASK_DB.userId=f.get("userID")),f.get("minuteBufferSnapToSched")&&A(),f.get("restrict_sched")?A(function(c){var b;void 0==c&&(b="Today is not a work day");var d=new Date,d=Date.parse("01/01/2011 "+d.getHours()+":"+d.getMinutes()),ea=Date.parse("01/01/2011 "+c.start),e=Date.parse("01/01/2011 "+c.stop),Da=f.get("minuteBuffer");null!=Da&&(ea.setMinutes(ea.getMinutes()-Da),e.setMinutes(e.getMinutes()+Da));void 0==c||ea>d||d>e?(b=b?b:"Please return at "+
c.start,TASK_CNTRL.showWindow('<div style="text-align: center; font-weight: bold;"><h3>Not scheduled to work</h3></div><div class="content"><p>'+b+'.</p><a href="#" class="btn btn-primary logout cancel" title="Logout">Logout</a></div>')):a()}):""==f.get("access")?U(a,function(){va()}):a&&a())});c.fail(function(a,c,b){})}}function e(){var a={url:v()+"user/count",type:"get",data:{},dataType:"json"};u(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==C[0]?s(function(){}):c(E[0],
"uCount,"+JSON.stringify(a.error)),y.hide(),F.hide()):(a=a.data,c(E[1],{uc:a.count}))});a.fail(function(a,c,b){m({response:a.responseText,type:c,msg:b},e,"uCount")})}function b(){var a={url:v()+"user/search?ID=$$USER.ID&fields=customer:name,customer:fullUsers,customer:limitedUsers,customer:teamUsers",type:"get",data:{},dataType:"json"};u(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==C[0]?s(function(){}):c(E[0],"uInfo,"+JSON.stringify(a.error)),y.hide(),F.hide()):(a=a.data,
c(E[1],a))});a.fail(function(a,c,d){m({response:a.responseText,type:c,msg:d},b,"uInfo")})}function c(a,c,b){TASK_DB.setEvent(a,JSON.stringify(c))}function h(){if(za||qa||void 0!=f.get("host")&&"full"==getQueryString("view"))window.clearInterval(Aa),Aa=window.setInterval(function(){if(navigator.onLine&&(qa||!document.hasFocus()))jQuery("#search-bar").is(":visible")&&jQuery("#search").click(),jQuery("#form-list").hide(),void 0==f.get("sessionID")?ba():ra()},1E3*(Ka+120))}function g(a,c){var b;return(b=
f.get("maxTaskTime"))&&void 0!=b&&b<=Number((c/3600).toFixed(2))?(a=TASK_DB.get(a.ID),a.disable=1,TASK_DB.setTask(a),TASK_CNTRL.toggleTimer(a),b=jQuery("#item"+a.ID),b.find(".timer").unbind("click").addClass("disabled"),b.find(".timer-info").text("Max Reached"),!0):!1}function O(){var a=new Date;a.setHours(23,59,0,0);var c=new Date;clearTimeout(Ca);Ca=setTimeout(function(){TASK_DB.running(function(a){TASK_CNTRL.toggleTimer(a)})},a-c);clearTimeout(La);La=setTimeout(function(){location.reload()},a-
c+65E3)}function V(){var a=!1;if(void 0==f.get("date")||(new Date(f.get("date"))).getDay()!=(new Date).getDay())ca(),a=!0;ra();return a}function ca(){jQuery("#form-list").empty();f.set("notified",!1);TASK_DB.dropTaskTable();TASK_DB.createDB();TASK_CNTRL.toggleRunText();var a=new Date;jQuery("#todayDate").html("Date: "+ka(a.getMonth())+" "+a.getDate());O();f.set("date",a.toDateString())}function N(){var a=f.get("view");void 0==a?L("task",function(){pa()}):"current"==a||"requested"==a||"recent"==a?
L("task",function(){jQuery("#button-"+a).click()}):jQuery("#button-"+a).click()}function pa(){jQuery("#button-current").click()}function va(){if(""==f.get("access")&&!f.get("notified")){f.set("notified",!0);var a='<div style="text-align: center; font-weight: bold;"><h3>Expired for '+f.get("host")+'</h3></div><div class="content"><div><p>To keep the ease of tracking your time, see due dates, and completing your tasks, please visit our site below to see licencing options for your company or to arrange an extended demo. If seeing this for the first time, another employee at your company has used this service 30 days ago, please contact info@atappstore.com to extend.</p></div><a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank"><img src="icons/AtAppStore.png" style=""></a><div style="font-size: 10px;">* this notification will only appear once daily.</div></div><div id="close" class="btn btn-primary" style="width:230px"><h3 style="line-height:0px">close</h3></div>';
TASK_CNTRL.showWindow(a);jQuery("#close").unbind("click").click(function(a){a.preventDefault();TASK_CNTRL.hideWindow()});c(E[1],{os:BrowserDetect.OS,browser:BrowserDetect.browser,version:BrowserDetect.version,extension:!za,user:f.get("userObj"),license_expiry_days:f.get("license_expiry_days")});e();b()}}function q(){document.onkeydown=function(a){a=window.event?event:a;if(66==a.keyCode&&a.ctrlKey){a=TASK_DB.getEvents();for(var c=0;c<a.length;c++)console.log("%c %s - %c %s - %c %s","color:blue",a[c].time,
"color:orange",a[c].type,"color:brown",a[c].message);console.log(TASK_DB.getEvents())}};var a=jQuery("#content");a.after('<form id="form-qrlogin" class="form" style="display: none"><h3>Login to Workfront</h3><span class="error"></span><p><div id="outdiv" style="text-align:center;"></div><canvas id="qr-canvas" width="640" height="480" style="display:none;"></canvas><h4 id="result" style="text-align:center;"></h4><button type="submit" class="btn btn-success needsclick" style="display:none;" id="button-appscan" value="scan" tabindex="3">Scan</button><button type="submit" class="btn needsclick" style="" id="button-standard" tabindex="5">Standard Login</button><button type="submit" class="btn btn-primary needsclick" style="display:none;" id="button-qrlogin" value="login" tabindex="4">Login</button></form><div class="spinner-bottom"><div id="blockG_1" class="metro_blockG"></div><div id="blockG_2" class="metro_blockG"></div><div id="blockG_3" class="metro_blockG"></div></div>');
jQuery("#button-standard").live("click",function(a){a.preventDefault();aa();jQuery("#form-qrlogin").show()});jQuery("#button-appscan").live("click",function(a){a.preventDefault();a=window.navigator.userAgent;a.match(/iPad/i)||a.match(/iPhone/i)?window.location="zxing://scan/?ret="+encodeURIComponent(window.location+"&code={CODE}"):window.location="http://zxing.appspot.com/scan?ret="+encodeURIComponent(window.location+"&code={CODE}")});a.after('<form id="form-login" class="form" style="display: none"><h3>Login to Workfront</h3><span class="error"></span><div><div style=""><label for="username">Username</label><input style="" type="text" name="username" id="username" class="text" tabindex="1"></div><div style="clear: both;" id="password-container"><label for="password">Password</label><input type="password" name="password" id="password" class="text" tabindex="2" autocomplete="off"/></div><div style="clear: both;"></div><label for="host">Subdomain</label><input type="text" name="host" id="host" class="text" tabindex="4"/></div><p>eg. <strong>Subdomain</strong>.my.workfront.com</p></p></br><button type="submit" class="btn btn-primary needsclick" id="button-login" value="login" tabindex="5">Login</button></form>');
jQuery("#singlesignon").live("click",function(a){jQuery("#password-container").toggle()});a='<div id="hourTypeWindow" class="window"><div style="text-align: center; font-weight: bold;"><h3>Track as Type:</h3></div><div class="content"><div><select id="hourTypeSelector" ></select><div><a href="#" id="done_hourType" class="btn btn-primary" rel="'+jQuery(this).attr("rel")+'" title="Start">Start</a><a href="#" id="cancel_hourType" class="btn" title="Cancel">Cancel</a><div><div></div>';jQuery("#window").after(a);
if(za||"full"==getQueryString("view")||qa)jQuery("#popout").replaceWith('<span id="refresh" style="float: right;" title="Manual Refresh"><img src="core/img/refresh.gif"></span>'),jQuery("html").css("width","100%"),jQuery("#refresh").live("click",function(a){a.preventDefault();jQuery("#form-list").hide();jQuery("#search-bar").is(":visible")&&jQuery("#search").click();na()});var a=new Date,c='<div id="top-menu"><div class="btn-group"><a id="filter" title="Filter for other assigned tasks and issues" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">Filters<span class="caret"></span></a><ul class="dropdown-menu">',
b;for(b in ya)ya.hasOwnProperty(b)&&(c+='<li><a href="#" id="button-'+b+'" class="filter" title="'+ya[b].d+'" >'+ya[b].t+"</a></li>");c+='<div id="custom-filters"><div id="task-filters" style="display:none;"></div><div id="opTask-filters" style="display:none;"></div></div><li><a href="#" class="logout" id="button-logout" >Login as New User</a></li></ul></div><span id="totalHours" title="Go To Timesheets" class="btn" style="">Today\'s Hours: 0</span><span id="todayDate" class="btn disabled" style="">Date: '+
ka(a.getMonth())+" "+a.getDate()+"</span></div>";jQuery("#bar").html(c);R(ya);jQuery("#totalHours").live("click",function(a){a.preventDefault();a="https://"+f.get("host")+"."+f.get("domain")+"/timesheets/current";qa?window.open(a,"_blank","location=yes"):window.open(a);return!1});var d=function(a,c){for(var b in ma)ma.hasOwnProperty(b)&&b!=c&&(ma[b]="desc");f.set("current_sort",{sort:c,order:ma[c]});ma[c]="asc"==ma[c]?"desc":"asc";jQuery("#sort-menu").find(">ul>li>a").removeClass();jQuery(a).addClass("btn active")};
jQuery("#sort-task").live("click",function(a){a.preventDefault();d(this,"task");jQuery("div#form-list>div").children().length&&tinysort("div#form-list>div",{order:"desc",useVal:!0,attr:"data-force-order"},{order:ma.task},{selector:".details",order:"desc"})});jQuery("#sort-project").live("click",function(a){a.preventDefault();d(this,"project");jQuery("div#form-list>div").children().length&&tinysort("div#form-list>div",{order:"desc",useVal:!0,attr:"data-force-order"},{selector:".details",order:ma.project},
{selector:".details",order:"desc",useVal:!0,attr:"data-days"})});jQuery("#sort-date").live("click",function(a){a.preventDefault();d(this,"date");jQuery("div#form-list>div").children().length&&tinysort("div#form-list>div",{order:"desc",useVal:!0,attr:"data-force-order"},{selector:".details",order:ma.date,useVal:!0,attr:"data-days"},{selector:".details",order:"desc"})});jQuery("#sort-priority").live("click",function(a){a.preventDefault();d(this,"priority");jQuery("div#form-list>div").children().length&&
tinysort("div#form-list>div",{order:"desc",useVal:!0,attr:"data-force-order"},{selector:".details",order:ma.priority,useVal:!0,attr:"data-priority"},{selector:".details",order:"desc"})});jQuery(".done").live("click",function(a){a.preventDefault();a=jQuery(this);var c=a.parent().parent(),b=c.children("span.name").attr("title"),c=c.children("span.details").attr("title");a='<div style="text-align: center; font-weight: bold;"><h3>Confirm</h3></div><div class="content"><div><p>Are you sure you completed <strong>'+
b+"</strong><br>from <br><strong>"+c+'?</strong></h3><div><a href="#" id="done_confirm" class="btn btn-primary" rel="'+a.attr("rel")+'" title="Done">Done</a><a href="#" class="btn cancel" title="Cancel">Cancel</a><div>';TASK_CNTRL.showWindow(a)});jQuery("#done_confirm").live("click",function(a){a.preventDefault();TASK_DB.updateValidate(jQuery(this).attr("rel"),function(a){k(a)});TASK_CNTRL.hideWindow()});jQuery("#cancel_confirm").live("click",function(a){a.preventDefault();TASK_CNTRL.hideWindow()});
jQuery(".percent").live("click",function(a){a.preventDefault();a=jQuery(this);var c=jQuery("#form-list");c.scrollTop(c.scrollTop()+jQuery("#item"+a.attr("rel")).offset().top-100);if(0==a.children("input").length){var b=a.text().slice(0,-1);a.html("<input type='number' class='inputbox' value=\""+b+'">');var d=function(a){a=jQuery(a);var c=Number(a.val()).toFixed(0);isNaN(c)||0>c||100<c||b==c?c=b:TASK_DB.updateValidate(a.parent().attr("rel"),function(a){J(a,c)});a.parent().text(c+"%")};jQuery("input.inputbox").focus().blur(function(){d(this)}).keypress(function(a){13==
a.which&&(d(this),a.preventDefault())})}});var e=jQuery("#form-list");e.scroll(function(){f.set("vpos",e.scrollTop())});F=jQuery(".spinner-bottom");y=jQuery(".spinner")}function l(a,c){var b=jQuery("#"+a+"-filters").first(),d="",e;for(e in c)c.hasOwnProperty(e)&&(d+='<li><a href="#" id="button-'+e+'" class="filter" title="'+c[e].d+'" >'+c[e].t+"</a></li>");b.append(d);R(c)}function R(a){var c=jQuery(".filter"),b;for(b in a)a.hasOwnProperty(b)&&jQuery("#button-"+b).attr("name",b).live("click",function(){var b=
jQuery(this),d=b.attr("name");ma=[];c.removeClass("btn");x();b.toggleClass("btn");f.set("view",d);a[d].f()})}function ba(){if(xa&&f.get("allowOffline"))f.remove("sessionID"),f.remove("userID"),f.remove("username"),f.remove("password"),f.remove("host"),f.remove("domain");else{var a=f.get("qr");f.removeAll();f.set("qr",a)}for(var c in TASK_CNTRL.update_intervals)window.clearInterval(TASK_CNTRL.update_intervals[c]);for(c in TASK_CNTRL.display_intervals)window.clearInterval(TASK_CNTRL.display_intervals[c]);
X()}function S(a){TASK_DB.loadAll(function(c){var b=c.length,d,e;if(0<b)for(d=0;d<b;d++)e=c[d],(null!=e&&"OPTASK"==e.details.objCode||"TASK"==e.details.objCode)&&jQuery("#item"+e.ID).hide();a()})}function s(a){f.get("ent")?U(a):ha(f.get("username"),f.get("password"),B(f.get("host")+"."+f.get("domain")),a,function(){X(a)})}function X(a){f.get("qr")?Y(a):aa(a)}function U(a,c){y.show();jQuery("#loading").hide();window.clearInterval(Aa);TASK_DB.dropTaskTable();TASK_DB.createDB();TASK_CNTRL.toggleRunText();
y.hide();F.hide();jQuery("#top-bar").hide();jQuery("#bar").hide();jQuery(".form").hide();d(function(){ra(function(){wa();void 0!=a&&a()},function(a){void 0!=c?c():X(a)})})}function Y(a){y.show();jQuery("#loading").hide();window.clearInterval(Aa);TASK_DB.dropTaskTable();TASK_DB.createDB();TASK_CNTRL.toggleRunText();resetForQR();y.hide();F.hide();jQuery("#top-bar").hide();jQuery("#bar").hide();jQuery(".form").hide();jQuery("webcamimg").show();var c=jQuery("#form-qrlogin");jQuery("#form-list").html("");
qa?c.show():c.slideDown(400,function(){});jQuery("#button-qrlogin").unbind("click").click(function(c){var b=jQuery("#form-qrlogin");c.preventDefault();F.show();ha(f.get("username"),f.get("password"),B(f.get("host")),function(){ignoreForQR();jQuery("#bar").show();qa?b.hide():b.slideUp();jQuery("#top-bar").show();jQuery("#loading").show();void 0!=a&&a()},function(){resetForQR()})})}function aa(a){y.show();jQuery("#loading").hide();window.clearInterval(Aa);TASK_DB.dropTaskTable();TASK_DB.createDB();
TASK_CNTRL.toggleRunText();y.hide();F.hide();jQuery("#top-bar").hide();jQuery("#bar").hide();jQuery(".form").hide();var c=jQuery("#form-login"),b=f.get("domain"),d=f.get("host");c.find(":input[name='username']").focus().val("");c.find(":input[name='host']").val(void 0==d||"undefined"==d?"":"my.workfront.com"!=b?d+"."+b:d);c.find(":input[name='password']").val("");jQuery("#form-list").html("");var e=jQuery("#username");qa?(c.show(),e.focus()):c.slideDown(400,function(){e.focus()});jQuery("#button-login").unbind("click").click(function(b){b.preventDefault();
F.show();ha(jQuery.trim(c.find(":input[name='username']").val()),jQuery.trim(c.find(":input[name='password']").val()),B(jQuery.trim(c.find(":input[name='host']").val())),function(){jQuery("#bar").show();qa?c.hide():c.slideUp();jQuery("#top-bar").show();jQuery("#loading").show();void 0!=a&&a()})})}function T(a,c,b){var d=new Date;a.dateStr=d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate();a.duration=c;navigator.onLine?M(a,Z,b):(c=f.get("offlineTasks"),void 0==c&&(c=[]),c.push(a),f.set("offlineTasks",
c),y.hide(),F.hide(),!0==f.get("logout_on_select")&&ba())}function Q(a){M(a,function(a,c){var b=new Date,d={entryDate:b.getFullYear()+"-"+(b.getMonth()+1)+"-"+b.getDate(),ownerID:f.get("userID")};d.extRefID=c&&c.extRefID?"ON!"+b.getHours()+":"+b.getMinutes()+";"+c.extRefID:"ON~"+b.getHours()+":"+b.getMinutes()+".";d.extRefID.substring(0,254);void 0==c||-1!=c.permissions.actions.indexOf("ADD_HOURS")&&-1!=c.permissions.actions.indexOf("CHANGE_STATUS")?(d.hours=0.01,d.method="post"):(d.method="put",
d.ID=c.ID);"GEN"==a.details.objCode?d.hourTypeID=a.syncID:("OPTASK"==a.details.objCode?d.opTaskID=a.syncID:d.taskID=a.syncID,d.hourTypeID=f.get("forceHourTypeID"),void 0==d.hourTypeID&&(void 0!=a.details.hourTypeID&&""!=a.details.hourTypeID)&&(d.hourTypeID=a.details.hourTypeID));b={url:v("api/v7.0")+"hour/",type:"get",data:d,dataType:"json",async:!1};u(b);b=jQuery.ajax(b);b.done(function(c){void 0!=c.error?c.error["class"]==C[0]?s(function(){setHourAttask()}):m({response:c.error,type:null,msg:null},
function(){Q(a)},"logStart,"+a.syncID+" "+a.name+" url: "+v()+" "+JSON.stringify(d)+" "+W(a)):(void 0!=d.taskID||void 0!=d.opTaskID)&&w(a)});b.fail(function(c,b,ga){m({response:c.responseText,type:b,msg:ga},function(){Q(a)},"logStart-fail,"+a.syncID+" "+a.name+" url: "+v()+" "+JSON.stringify(d)+" "+W(a)+","+a.duration+", "+c.responseText+", "+ga,c.responseText)})})}function ka(a){return"Jan. Feb. Mar. Apr. May June Jul. Aug. Sep. Oct. Nov. Dec.".split(" ")[a]}function W(a){return void 0!=a.details.project?
a.details.project.name.split(",").join(" ")+","+a.name.split(",").join(" "):a.details}function u(a,c){void 0==c&&(c=1E4);a.timeout=c;za&&!Ja&&(a.dataType="jsonp",a.crossDomain=!0,a.jsonp="jsonp",a.cache=!0);var b=f.get("sessionID");f.get("ent")?("PUT"==a.data.method&&(a.type="POST"),a.data.apiKey=b):a.data.sessionID=b}function B(a){if(1<a.split(".").length){var c=a.split("//");return 1<c.length?(c.shift(),c[0]):a}return a+".my.workfront.com"}function ha(c,b,d,e,g){if(void 0==c||void 0==b||void 0==
d)g();else{var l=jQuery(".error");l.html("");var k={url:"https://"+d+"/attask/api/v"+(-1!=location.origin.indexOf("localhost")?2:5)+".0/login",type:"post",data:{username:c,password:b,method:"post"},dataType:"json"};u(k);xa?(k=f.get(c),void 0!=k?(da(k.sessionID,k.userID,k.username,k.password,d),F.hide(),na(),h(),void 0!=e&&e()):l.html("OFFLINE")):(k=jQuery.ajax(k),k.done(function(k){void 0!=k.error?(f.get("qr")?l.html("Please Scan Again."):l.html(k.error.message),F.hide(),void 0!==g&&g()):(k=k.data,
da(k.sessionID,k.userID,c,b,d),f.set("userObj",JSON.stringify(k)),F.hide(),a(function(){f.get("ent")||na();h();void 0!=e&&e()}))}),k.fail(function(a,c,b){a.responseText&&""!==a.responseText?-1!=a.responseText.indexOf("<html>")?f.get("qr")?l.html("Please Scan Again."):l.html("Host Invalid: "+d):f.get("qr")?l.html("Please Scan Again."):l.html(JSON.parse(a.responseText).error.message):f.get("qr")?l.html("Please Scan Again."):l.html("Host Invalid: "+d);F.hide();void 0!==g&&g()}))}}function da(a,c,b,d,
e){f.set("sessionID",a);f.set("userID",c);f.set("username",b);f.set("password",d);e=e.split(".");f.set("host",e[0]);e.shift();f.set("domain",e.join("."));f.get("allowOffline")&&f.set(b,{sessionID:a,userID:c,username:b,password:d})}function ra(b,d){var e=f.get("sessionID");void 0==e||""==e?s(b):(y.show(),e={url:v()+"user/"+f.get("userID"),data:{method:"put",updates:"{isActive: true}"},type:"get",dataType:"json"},u(e),e=jQuery.ajax(e),e.done(function(e){void 0!=e.error?(e.error["class"]==C[0]?void 0!=
d?d(b):s(b):c(E[0],"sessionValid,"+f.get("sessionID")+","+JSON.stringify(e.error)),y.hide(),F.hide()):(y.hide(),F.hide(),void 0==f.get("auth_key")?a(na):na(),void 0!=b&&b())}),e.fail(function(a,e,Da){401==a.status?void 0!=d?d(b):s(b):"timeout"==e?ra(b):c(E[0],"sessionValid,"+f.get("sessionID")+","+a.responseText)}))}function na(){y.show();K();H();var a=f.get("userID"),b={url:v("api-internal")+"timeSheet/search",type:"get",data:{startDate:"$$TODAY+1",startDate_Mod:"lte",endDate:"$$TODAY-1",endDate_Mod:"gte",
fields:"extRefID,startDate,timesheetProfile:description,timesheetProfile:hourTypes:ID,timesheetProfile:hourTypes:name,timesheetProfile:hourTypes:description,timesheetProfile:hourTypes:isActive",userID:a},dataType:"json"};u(b,35E3);xa?f.get("allowOffline")?(a=TASK_DB.userRunningTasks(a),void 0!=a&&(ia=!0,TASK_DB.insert(a.name,{syncID:a.syncID,details:a.details},!0))):TASK_CNTRL.displayError("OFFLINE"):(a=jQuery.ajax(b),a.done(function(a){if(void 0!=a.error)a.error["class"]==C[0]?s(function(){na()}):
c(E[0],"addGeneralTasks-done,"+JSON.stringify(a.error));else{a=a.data;if(0!=a.length){var b=new Date(f.get("launched"));if(null==a[0].extRefID)fa(a[0].ID,b,0);else if(f.get("updateAtInterval")){var d=0,e=1;if(isNaN(parseInt(a[0].extRefID)))var ga=JSON.parse(a[0].extRefID),d=ga.last_launched,e=parseInt(ga.count);else d=a[0].extRefID;d=new Date(parseInt(d));if(0<d.getTime()){if(d.getTime()>b.getTime()){TASK_CNTRL.showWindow('<div class="content"><h3>Stopwatch has been launched on another computer at '+
d.toLocaleTimeString()+', Would you like to keep this stopwatch?</h3><div style="text-align:center"></div><div id="dupe-yes" class="btn btn-primary" style="width:230px"><h3 style="line-height:0px">Yes</h3></div><div id="dupe-no" class="btn btn-default" style="width:230px"><h3 style="line-height:0px">No</h3></div></div></div>');jQuery("#dupe-yes").unbind("click").click(function(c){c.preventDefault();y.show();TASK_CNTRL.hideWindow();c=new Date;f.set("launched",c.getTime());fa(a[0].ID,c,e,function(){na()})});
jQuery("#dupe-no").unbind("click").click(function(a){a.preventDefault();y.show();jQuery("#holder").empty();f.get("updateAtInterval")?(TASK_DB.running(function(a){T(a,-Ka)}),setTimeout(function(){ca();window.close();TASK_CNTRL.hideWindow()},2E3)):(ca(),window.close(),TASK_CNTRL.hideWindow())});return}d.getTime()!=b.getTime()&&fa(a[0].ID,b,e)}}}if(0!=a.length&&void 0!=a[0].timesheetProfile&&void 0!=a[0].timesheetProfile.hourTypes)if(a[0].timesheetProfile.description==Ma&&qa)jQuery(".holder").empty(),
TASK_CNTRL.showWindow('<div class="content"><h3>Please use Stopwatch on a desktop computer.</h3></div>'),y.hide(),F.hide();else if(b=f.get("userHostName"),void 0!=b&&-1==a[0].timesheetProfile.description.indexOf(b)&&!getQueryString("force_host"))jQuery(".holder").empty(),TASK_CNTRL.showWindow('<div class="content"><h3>Please use Stopwatch on a work computer.</h3></div>'),y.hide(),F.hide();else{if(0!=a[0].timesheetProfile.hourTypes.length){var b=0,d=a[0].timesheetProfile.hourTypes,ea;for(ea in d)d.hasOwnProperty(ea)&&
!0==d[ea].isActive&&(b++,TASK_DB.insert(d[ea].name,{syncID:d[ea].ID,details:{objCode:"GEN",description:null!=d[ea].description?"General - "+d[ea].description:"'General"}},0))}N()}else f.get("general")?I():N()}}),a.fail(function(a,c,d){m({response:a.responseText,type:c,msg:d,status:a.status},na,"addGeneralTasks-fail"+c+"-"+d+" "+a.responseText+" "+a.status+" "+JSON.stringify(b))}))}function fa(a,b,d,e){var f={url:v()+"timeSheet/",type:"get",data:{ID:a,extRefID:JSON.stringify({last_launched:b.getTime(),
count:++d}),method:"put"},dataType:"json"};u(f);var g=jQuery.ajax(f);g.done(function(f){void 0!=f.error?f.error["class"]==C[0]?s(function(){fa(a,b,d,e)}):c(E[0],"ownTimesheet,"+a+JSON.stringify(f.error)):void 0!=e&&e()});g.fail(function(c,g,h){m({response:c.responseText,type:g,msg:h,status:c.status},function(){fa(a,b,d,e)},"ownTimesheet-fail"+a+" "+g+"-"+h+" "+c.responseText+" "+c.status+" "+JSON.stringify(f))})}function wa(){var a={url:v()+"HourType/search",type:"get",data:{fields:"ID",description:"Stopwatch",
description_Mod:"cicontains"},dataType:"json"};u(a);var b=jQuery.ajax(a);b.done(function(a){if(void 0!=a.error)a.error["class"]==C[0]?s(function(){wa()}):c(E[0],"getStopwatchHourType-done,"+JSON.stringify(a.error));else if(0!==a.data.length){var b={};a.data.forEach(function(a,c){b[a.name]=a.ID});f.set("sw_hour_types",b)}});b.fail(function(c,b,d){m({response:c.responseText,type:b,msg:d,status:c.status},wa,"getStopwatchHourType-fail"+b+"-"+d+" "+c.responseText+" "+c.status+" "+JSON.stringify(a))})}
function ja(){y.show();var a={url:v("api/v9.0")+"uift/filtersForObjCode/",data:{enteredByID_Mod:"notnull",filterType:"STANDARD",fields:"name, definition, enteredByID",method:"get"},type:"GET",dataType:"json"};u(a);var b=jQuery.extend(!0,{},a);b.data.objCode="OPTASK";a.data.objCode="TASK";jQuery.when(jQuery.ajax(a),jQuery.ajax(b)).done(function(a,b){a=a[0];b=b[0];var d=void 0!=a.error?a.error:b.error;void 0!=d?d["class"]==C[0]?s(function(){ja()}):c(E[0],"addCustomFilters,"+JSON.stringify(r.error)):
(l("task",Ba("task",a.data)),l("opTask",Ba("opTask",b.data)),d=jQuery("#opTask-filters"),d.children().length&&d.show(),d=jQuery("#task-filters"),d.children().length&&d.show(),void 0==ya[f.get("view")]&&N())}).fail(function(a,c,b){m({response:a.responseText,type:c,msg:b,status:a.status},ja,"addCustomFilters-fail"+c+"-"+b+" "+a.responseText+" "+a.status)})}function Ba(a,c){var b="task"==a?"task":"issue",d={},e=-1;c.sort(function(a,c){return a.name.localeCompare(c.name)});for(var g in c)if(c.hasOwnProperty(g)&&
(e=c[g].name.indexOf(" - Stopwatch"),null!=c[g].enteredByID&&-1!=e)){var h={},k,l;for(l in c[g].definition)k=c[g].definition[l].replace(/&/g,"%26").replace("$$USER.ID",f.get("userID")),-1==k.indexOf("$$USER")&&(h[l]=k.split("\t"));d[c[g].ID]={q:jQuery.param(h).replace(RegExp("%5B%5D","g"),""),f:function(){return sa(a,this.q)},t:c[g].name.substr(e),d:"Custom "+b+" filter: "+oa(h)}}return d}function oa(a){var c="",b;for(b in a)a.hasOwnProperty(b)&&(c+=b+"="+a[b]+"\n");return c}function sa(a,b){var d=
{};a=void 0==a?"task":a;d.fields="parent,priority,project,project:hourTypes,plannedCompletionDate,permissions,canStart,status";"task"==a&&(d.fields+=",percentComplete");y.show();var e={url:v("api/v9.0")+a+"/search?"+b,type:"get",data:d,dataType:"json"};u(e);e=jQuery.ajax(e);e.done(function(b){void 0!=b.error?(b.error["class"]==C[0]?s(function(){sa(a,d)}):c(E[0],"addFilteredTasks,"+JSON.stringify(b.error)),y.hide(),F.hide()):(b=b.data,0==b.length?(ia=!0,S(function(){TASK_CNTRL.showAll()})):S(function(){var a=
b.length;ia=!0;for(var c=0;c<a;c++){var d=-1!=["CPL","DED","REJ","CLS","RLV"].indexOf(b[c].status)?1:!1==b[c].canStart||-1==b[c].permissions.actions.indexOf("ADD_HOURS")&&-1==b[c].permissions.actions.indexOf("CHANGE_STATUS");TASK_DB.insert(b[c].name,{syncID:b[c].ID,details:b[c],disable:d},c==a-1)}}))});e.fail(function(a,c,b){m({response:a.responseText,type:c,msg:b},sa(c,d),"addFilteredTasks")})}function I(){y.show();var a={url:v()+"HourType/search",type:"get",data:{fields:"ID,name,description",isActive:!0},
dataType:"json"};u(a,35E3);var b=jQuery.ajax(a);b.done(function(a){if(void 0!=a.error)a.error["class"]==C[0]?s(function(){I()}):c(E[0],"addAllGeneralTasks-done,"+JSON.stringify(a.error));else{a=a.data;var b=0,d;for(d in a)a.hasOwnProperty(d)&&("Task Time"!=a[d].name&&"Issue Time"!=a[d].name)&&(b++,TASK_DB.insert(a[d].name,{syncID:a[d].ID,details:{objCode:"GEN",description:null!=a[d].description?"General - "+a[d].description:"'General"}},0));N()}});b.fail(function(c,b,d){m({response:c.responseText,
type:b,msg:d,status:c.status},I,"addAllGeneralTasks-fail"+b+"-"+d+" "+c.responseText+" "+c.status+" "+JSON.stringify(a))})}function m(a,b,d,e){if(401==a.status)s(function(){b()});else if("timeout"==a.type)b();else{if(void 0!=a.response&&""!=a.response){var f;f="message"in a.response?a.response.message:JSON.stringify(a.response);TASK_CNTRL.displayError("Workfront Error: "+f+"<br>"+(void 0!=e&&""!=e?e:""))}else TASK_CNTRL.displayError("Error: "+(void 0!=e&&""!=e?e:""));c(E[0],d+","+a.msg+" "+a.type+
" "+JSON.stringify(a.response)+" "+e)}}function v(a){void 0==a&&(a="api/v7.0");return"https://"+f.get("host")+"."+f.get("domain")+"/attask/"+a+"/"}function L(a,b,d){a=void 0==a?"task":a;d=void 0==d?!1:d;y.show();var e={url:v()+"assgn/search?"+a+":status=NEW&"+a+":status=INP&project:status=CUR&project:status=QUE",type:"get",data:{},dataType:"json"};e.data[a+":canStart"]=!0;e.data[a+":status_Mod"]="in";e.data["project:status_Mod"]="in";e.data.fields=a+":parent,"+a+":priority,"+a+":project, "+a+":project:hourTypes,"+
a+":plannedCompletionDate,"+a+":permissions";e.data.status="DN";e.data.status_Mod="ne";e.data.assignedToID=f.get("userID");e.data.$$LIMIT=2E3;d&&(e.data["project:projectedCompletionDate"]="$$TODAYb-1w",e.data["project:projectedCompletionDate_Mod"]="gt");var g=f.get("currentRole");"role"==f.get("view")&&void 0!=g?e.data[a+":roleID"]=g.ID:e.data.assignedToID=f.get("userID");"task"==a&&(e.data.fields+=","+a+":percentComplete");u(e);e=jQuery.ajax(e);e.done(function(e){if(void 0!=e.error)e.error["class"]==
C[0]?s(function(){L(a,b,d)}):c(E[0],"addAllAssignedTasks-"+a+","+JSON.stringify(e.error)),y.hide(),F.hide();else{e=e.data;var g=!0,h=f.get("view");"all"!=h&&"role"!=h&&(g=!1);var k=f.get("hour_types");if("opTask"!=a)L("opTask",b,d),S(function(){var a=e.length;if(a)for(var c=0;c<a;c++){var b=e[c].task;if(-1!=b.permissions.actions.indexOf("ADD_HOURS")&&-1!=b.permissions.actions.indexOf("CHANGE_STATUS")){var d=!1,f=b.project.hourTypes.length;if(void 0!=k&&f)for(var ga=0;ga<f;ga++){if(void 0!=k[b.project.hourTypes[ga].ID]){d=
!0;break}}else d=!0;d&&TASK_DB.insert(b.name,{syncID:b.ID,details:b},g&&c==a-1)}}});else{h=e.length;ia=g;if(h)for(var l=0;l<h;l++){var m=e[l].opTask;if(-1!=m.permissions.actions.indexOf("ADD_HOURS")&&-1!=m.permissions.actions.indexOf("CHANGE_STATUS")){var Ha=!1,n=m.project.hourTypes.length;if(void 0!=k&&n)for(var p=0;p<n;p++){if(void 0!=k[m.project.hourTypes[p].ID]){Ha=!0;break}}else Ha=!0;Ha&&TASK_DB.insert(m.name,{syncID:m.ID,details:m},g&&l==h-1)}}else TASK_CNTRL.showAll(e);b&&b(e)}}});e.fail(function(a,
c,b){m({response:a.responseText,type:c,msg:b},function(a,c,b){L(a,c,b)},"addAllAssignedTasks-fail"+c+"-"+b+" "+a.responseText)})}function n(a){y.show();var b={url:v("api/v7.0")+"user/search",type:"get",data:{fields:"role:*,roles:*",ID:f.get("userID")},dataType:"json"};u(b);b=jQuery.ajax(b);b.done(function(b){if(void 0!=b.error)b.error["class"]==C[0]?s(function(){n(a)}):c(E[0],"addAllRoleTasks,"+JSON.stringify(b.error)),y.hide(),F.hide();else if(b=b.data[0],0==b.length)a&&a(),y.hide(),F.hide();else{var d=
jQuery("#role-filter"),e=function(){L("task",function(){d.css("display","inline-block");y.hide();F.hide()})},g=function(a,c){f.set("currentRole",{name:a,ID:c});d.find("button").html("<strong>Role: </strong><span>"+a+'</span><span class="caret"></span>');e()},h=f.get("currentRole");void 0!=h?g(h.name,h.ID):void 0!=b.role&&g(b.role.name,b.role.ID);if(void 0!=b.roles&&0!=b.roles.length)for(var h=d.find(".dropdown-menu").html("").first(),ea=0,k=b.roles.length;ea<k;ea++)h.append('<li><a href="#" id="'+
b.roles[ea].ID+'">'+b.roles[ea].name+"</a></li>"),h.find("#"+b.roles[ea].ID).click(function(){g(jQuery(this).text(),jQuery(this).attr("id"))});else x(),y.hide(),F.hide(),pa(),TASK_CNTRL.showWindow('<div style="text-align: center; font-weight: bold;"><h3>Roles</h3></div><div class="content"><div><p>No additional roles available.</strong></h3><div><a href="#" class="btn btn-primary cancel" title="Ok">Ok</a><div>')}});b.fail(function(a,c,b){m({response:a.responseText,type:c,msg:b},n,"addAllRoleTasks")})}
function x(){var a=jQuery("#role-filter");a.hide();a.find(".dropdown-menu").first().html("")}function la(a){y.show();var b={url:v()+"team/search",type:"get",data:{fields:"ID","users:ID":f.get("userID")},dataType:"json"};u(b);b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==C[0]?s(function(){la(a)}):c(E[0],"addAllGroupTasks,"+JSON.stringify(b.error)),y.hide(),F.hide()):(b=b.data,0==b.length?(a?a():jQuery("#form-list").hide(),y.hide(),F.hide(),TASK_CNTRL.showNoTaskWindow()):S(function(){for(var c=
b.length,d=function(b,d){if(0==--c){var e=ta.length;ia=!0;if(0==e)TASK_CNTRL.showAll(ta);else{for(var f=0;f<e;f++)TASK_DB.insert(ta[f].name,{syncID:ta[f].ID,details:ta[f]},f==e-1);ta=[];a&&a()}}},e=0;e<c;e++)t("task",b[e].ID,d)}))});b.fail(function(a,c,b){m({response:a.responseText,type:c,msg:b},la,"addAllGroupTasks")})}function t(a,b,d){a=void 0==a?"task":a;y.show();var e={url:v()+a+"/search?status=NEW&status=INP&project:status=CUR&project:status=QUE&project:status=INF",type:"get",data:{canStart:!0,
status_Mod:"in","project:status_Mod":"in",fields:"parent,priority,project,plannedCompletionDate",$$LIMIT:1E3,"team:ID":b},dataType:"json"};"task"==a&&(e.data.fields+=",percentComplete");u(e);e=jQuery.ajax(e);e.done(function(e){if(void 0!=e.error)e.error["class"]==C[0]?s(function(){t(a,b,d)}):c(E[0],"addGroupTasks-"+a+","+JSON.stringify(e.error)),y.hide(),F.hide();else if(e=e.data,0==e.length)d&&d(a,b);else if("opTask"!=a){t("opTask",b,d);for(var f=e.length,g=0;g<f;g++)ta.push(e[g])}else{f=e.length;
for(g=0;g<f;g++)ta.push(e[g]);d&&d(a,b)}});e.fail(function(a,c,b){m({response:a.responseText,type:c,msg:b},t,"addGroupTasks-fail"+c+"-"+b+" "+a.responseText)})}function p(){y.show();var a={url:v()+"hour/report",type:"get",data:{entryDate:"$$TODAY-14d",entryDate_Range:"$$TODAY",entryDate_Mod:"between","timesheet:userID":f.get("userID")},dataType:"json"};u(a);var b=jQuery.extend(!0,{},a);b.data["opTask:canStart"]=!0;b.data.opTaskID_1_GroupBy=!0;a.data["task:canStart"]=!0;a.data.taskID_1_GroupBy=!0;
jQuery.when(jQuery.ajax(a),jQuery.ajax(b)).done(function(a,b){a=a[0];b=b[0];var d=void 0!=a.error?a.error:b.error;if(void 0!=d)d["class"]==C[0]?s(function(){p()}):c(E[0],"addRecentTasks,"+JSON.stringify(d)),y.hide(),F.hide();else{var e=Object.keys(b.data).concat(Object.keys(a.data));0==e.length?(ia=!0,S(function(){TASK_CNTRL.showAll(e)})):S(function(){ia=!0;TASK_CNTRL.showAll(TASK_CNTRL.taskDB.loadSyncIds(e))})}}).fail(function(a,c,b){m({response:a.responseText,type:c,msg:b},p,"addRecentTasks")})}
function Ea(){function a(c){var b={url:v()+"assgn/search?"+c+":status=INP&project:status=CUR&project:status=QUE",type:"get",data:{},dataType:"json"};b.data[c+":status_Mod"]="in";b.data[c+":isComplete"]=!1;b.data.status="AD";b.data["project:status_Mod"]="in";b.data["project:projectedCompletionDate"]="$$TODAYb-1w";b.data["project:projectedCompletionDate_Mod"]="gt";b.data.assignedToID=f.get("userID");b.data.fields="project:status,status,"+c+":parent,"+c+":priority,"+c+":project, "+c+":plannedCompletionDate";
"task"==c&&(b.data.fields+=",task:percentComplete");u(b);return b}y.show();jQuery.when(jQuery.ajax(a("task")),jQuery.ajax(a("opTask"))).done(function(a,b){a=a[0];b=b[0];var d=void 0!=a.error?a.error:b.error;void 0!=d?(d["class"]==C[0]?s(function(){Ea()}):c(E[0],"addCurrentTasks,"+JSON.stringify(d)),y.hide(),F.hide()):0==a.data.length&&0==b.data.length?(ia=!0,S(function(){TASK_CNTRL.showAll()})):S(function(){function c(a,b){for(var d=a.length,e=0;e<d;e++){var f=a[e][b];TASK_DB.insert(f.name,{syncID:f.ID,
details:f},e==d-1)}}ia=!0;c(a.data,"task");c(b.data,"opTask")})}).fail(function(a,c,b){m({response:a.responseText,type:c,msg:b},function(){Ea()},"addCurrentTasks")})}function G(){function a(c){var b={url:v()+"assgn/search?"+c+":status=NEW&"+c+":status=INP&project:status=CUR&project:status=QUE",type:"get",data:{},dataType:"json"};b.data[c+":status_Mod"]="in";b.data[c+":isComplete"]=!1;b.data[c+":canStart"]=!0;b.data.status="AA";b.data["project:status_Mod"]="in";b.data["project:projectedCompletionDate"]=
"$$TODAYb-1w";b.data["project:projectedCompletionDate_Mod"]="gt";b.data.assignedToID=f.get("userID");b.data.fields="project:status,status,"+c+":parent,"+c+":priority,"+c+":project, "+c+":plannedCompletionDate";"task"==c&&(b.data.fields+=",task:percentComplete");u(b);return b}y.show();jQuery.when(jQuery.ajax(a("task")),jQuery.ajax(a("opTask"))).done(function(a,b){a=a[0];b=b[0];var d=void 0!=a.error?a.error:b.error;void 0!=d?(d["class"]==C[0]?s(function(){G()}):c(E[0],"addRequestedTasks,"+JSON.stringify(d)),
y.hide(),F.hide()):0==a.data.length&&0==b.data.length?(ia=!0,S(function(){TASK_CNTRL.showAll()})):S(function(){function c(a,b){for(var d=a.length,e=0;e<d;e++){var f=a[e][b];TASK_DB.insert(f.name,{syncID:f.ID,details:f},e==d-1)}}ia=!0;c(a.data,"task");c(b.data,"opTask")})}).fail(function(a,c,b){m({response:a.responseText,type:c,msg:b},function(){G()},"addRequestedTasks")})}function H(){var a={url:v()+"user/search",data:{"hourTypes:isActive":!0,fields:"hourTypes:ID,hourTypes:name,hourTypes:description,hourTypes:countAsRevenue",
ID:f.get("userID")},type:"get",dataType:"json"};u(a);Fa=!1;a=jQuery.ajax(a);a.done(function(a){if(void 0!=a.error)a.error["class"]==C[0]?s(function(){}):c(E[0],"getHourTypes,"+JSON.stringify(a.error)),y.hide(),F.hide();else if(a=a.data,void 0!=a&&0!=a.length&&0!=a[0].hourTypes.length){for(var b=[],d=0;d<a[0].hourTypes.length;d++)b[a[0].hourTypes[d].ID]=!0;f.set("hour_types",b);Fa=!0;var e=f.get("sw_hour_types"),g=jQuery("#hourTypeSelector");g.text("");jQuery.each(a[0].hourTypes,function(){var a=this.ID;
void 0!=e&&void 0!=e[this.name]&&(a=e[this.name]);g.append($("<option />").val(a).text(this.name))})}});a.fail(function(a,b,d){401==a.status?s(function(){}):"timeout"==b?H():c(E[0],"getHourTypes,"+a.responseText)})}function z(a,c){if("GEN"==a.details.objCode)c(a);else{var b=jQuery("#hourTypeSelector").children();1==b.length?(a.details.hourTypeID=b[0].value,TASK_DB.updateDetails(a.ID,a.details),c(a)):void 0!=a.details.project.hourTypes&&1==a.details.project.hourTypes.length?(a.details.hourTypeID=a.details.project.hourTypes[0].ID,
TASK_DB.updateDetails(a.ID,a.details),c(a)):(TASK_CNTRL.showWindow(null,"#hourTypeWindow"),jQuery("#done_hourType").unbind("click").bind("click",function(b){b.preventDefault();a.details.hourTypeID=jQuery("#hourTypeSelector").find(":selected").val();TASK_DB.updateDetails(a.ID,a.details);c(a);TASK_CNTRL.hideWindow("#hourTypeWindow")}),jQuery("#cancel_hourType").unbind("click").bind("click",function(a){a.preventDefault();TASK_CNTRL.hideWindow("#hourTypeWindow")}))}}function A(a){var b=f.get("todaySched");
null!=b?a(b):(b={url:v("api/v7.0")+"user/search?ID=$$USER.ID&fields=schedule:*,schedule:nonWorkDays:*",type:"get",data:{},dataType:"json"},u(b),b=jQuery.ajax(b),b.done(function(b){if(void 0!=b.error)b.error["class"]==C[0]?s(function(){}):c(E[0],"getSchedule,"+JSON.stringify(b.error)),y.hide(),F.hide();else if(b=b.data[0].schedule,0!=b.length){var d=new Date,e=b["sunday monday tuesday wednesday thursday friday saturday".split(" ")[d.getDay()]],g;if(!0==b.hasNonWorkDays){for(var h=0;h<b.nonWorkDays.length;h++)if(b.nonWorkDays[h].nonWorkDate==
d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate()&&(void 0!=g&&null!=b.nonWorkDays[h].userID||void 0==g))g=b.nonWorkDays[h].scheduleDay;void 0!=g&&(e=g)}void 0!=e&&0!=e.length&&(e={start:e[0],stop:e[1]},f.set("todaySched",e));a&&a(e)}}),b.fail(function(b,d,e){401==b.status?s(function(){}):"timeout"==d?A(a):c(E[0],"getSchedule,"+b.responseText)}))}function K(){var a=new Date,a={url:v()+"hour/report?hours_AggFunc=sum",type:"get",data:{entryDate:a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate(),
ownerID:f.get("userID")},dataType:"json"};u(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==C[0]?s(function(){}):c(E[0],"getTodaysTotalHours,"+JSON.stringify(a.error)),y.hide(),F.hide()):(a=a.data,jQuery("#totalHours").html("Today's Hours: "+(null==a.sum_hours?"0":a.sum_hours.toFixed(2))))});a.fail(function(a,b,d){401==a.status?s(function(){}):"timeout"==b?K():c(E[0],"getTodaysTotalHours,"+a.responseText)})}function k(a){y.show();var b={assignedToID:f.get("userID")};"OPTASK"==
a.details.objCode?b.opTaskID=a.syncID:b.taskID=a.syncID;b={url:v()+"assignment/search",type:"get",data:b,dataType:"json"};u(b);b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==C[0]?s(function(){k(a)}):c(E[0],"getTaskAssignment,"+a.syncID+","+JSON.stringify(b.error)),y.hide(),F.hide()):(b=b.data[0],a.running?(a.done=1,TASK_CNTRL.stopTask(a)):P(b,a))});b.fail(function(c,b,d){m({response:c.responseText,type:b,msg:d},function(){k(a)},"getTaskAssignment,"+a.syncID)})}function P(a,
b){y.show();var d={url:v()+"assignment/"+a.ID,data:{method:"PUT",status:"DN"},type:"get",dataType:"json"};u(d);d=jQuery.ajax(d);d.done(function(d){void 0!=d.error?(d.error["class"]==C[0]?s(function(){P(a,b)}):c(E[0],"setAssignmentDone,"+a.ID+","+JSON.stringify(d.error)),y.hide(),F.hide()):(TASK_DB.remove(b.ID),y.hide(),F.hide(),c(E[2],W(b)+",assignment done"),c(E[1],"assignment done"),D(b))});d.fail(function(c,d,e){m({response:c.responseText,type:d,msg:e},function(){P(a,b)},"setAssignmentDone,"+a.ID+
", "+c.responseText)})}function D(a){y.show();var b={url:v()+"assignment/count",data:{status:"DN",status_Mod:"ne"},type:"GET",dataType:"json"};"OPTASK"==a.details.objCode?b.data.opTaskID=a.syncID:b.data.taskID=a.syncID;u(b);b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==C[0]?s(function(){D(a)}):c(E[0],"getTaskDoneAssignmentCount,"+taskID+","+JSON.stringify(b.error)),y.hide(),F.hide()):(b=b.data,y.hide(),F.hide(),0==b.count&&ua(a))});b.fail(function(c,b,d){m({response:c.responseText,
type:b,msg:d},function(){D(a)},"getTaskDoneAssignmentCount,"+a.syncID)})}function ua(a){var b=a.syncID;y.show();var d="OPTASK"==a.details.objCode?"CLS":"CPL",d={url:v()+a.details.objCode.toLowerCase()+"/"+b,data:{method:"put",status:d},type:"get",dataType:"json"};u(d);d=jQuery.ajax(d);d.done(function(d){void 0!=d.error?(d.error["class"]==C[0]?s(function(){ua(a)}):m({response:d.error,type:null,msg:null},function(){ua(a)},"setTaskDone,"+b),y.hide(),F.hide()):(y.hide(),F.hide(),c(E[2],W(a)+",task done"),
c(E[1],"task done"))});d.fail(function(c,d,e){m({response:c.responseText,type:d,msg:e},function(){ua(a)},"setTaskDone,"+b+", "+c.responseText)})}function w(a){y.show();var c={url:v()+a.details.objCode.toLowerCase()+"/"+a.syncID,data:{status:"INP",method:"PUT"},type:"get",dataType:"json"};u(c);c=jQuery.ajax(c);c.done(function(c){void 0!=c.error?(c.error["class"]==C[0]?s(function(){w(a)}):m({response:c.error,type:null,msg:null},function(){w(a)},"setTaskInProgress,"+a.syncID),y.hide(),F.hide()):(y.hide(),
F.hide(),!0==f.get("logout_on_select")&&ba())});c.fail(function(c,b,d){m({response:c.responseText,type:b,msg:d},function(){w(a)},"setTaskInProgress-fail,"+a.syncID+", "+c.responseText)})}function J(a,c){y.show();var b={url:v()+a.details.objCode.toLowerCase()+"/"+a.syncID,data:{updates:"{ percentComplete: "+c+"}",method:"PUT"},type:"get",dataType:"json"};u(b);b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?b.error["class"]==C[0]?s(function(){J(a,c)}):m({response:b.error,type:null,msg:null},function(){J(a,
c)},"setTaskPercent,"+a.syncID):(a.details.percentComplete=c,TASK_DB.updateDetails(a.ID,a.details));y.hide();F.hide()});b.fail(function(b,d,e){m({response:b.responseText,type:d,msg:e},function(){J(a,c)},"setTaskPercent-fail,"+a.syncID+", "+b.responseText)})}function Z(a,b,d){var e,g={ownerID:f.get("userID")};void 0==b||-1!=b.permissions.actions.indexOf("ADD_HOURS")&&-1!=b.permissions.actions.indexOf("CHANGE_STATUS")?(e=0,g.method="post"):(e=b.hours,g.method="put",g.ID=b.ID);"GEN"==a.details.objCode?
g.hourTypeID=a.syncID:("OPTASK"==a.details.objCode?g.opTaskID=a.syncID:g.taskID=a.syncID,g.hourTypeID=f.get("forceHourTypeID"),void 0==g.hourTypeID&&(void 0!=a.details.hourTypeID&&""!=a.details.hourTypeID)&&(g.hourTypeID=a.details.hourTypeID));isNaN(e)&&(e=0);g.entryDate=a.dateStr;var h=Number((a.duration/3600).toFixed(2));f.get("nearestHour")&&(h=Math.round(h));g.hours=parseFloat((h+parseFloat((""+e).split(".").join("."))+" ").split(".").join(".")).toFixed(2);g.ownerID=f.get("userID");var l=new Date;
d||(g.extRefID=("OK~"+l.getHours()+":"+l.getMinutes()+"H"+g.hours+"D"+h+"T"+TASK_CNTRL.hms(a.time)+";"+(b&&b.extRefID?b.extRefID.replace("OK~","OK!"):".")).substring(0,254));c(E[1],"setHourAttask, oldhr: "+e+" method: "+g.method+" start: "+a.dateStr+" task: "+JSON.stringify(a)+" sid: "+f.get("sessionID")+" time: "+l.toTimeString());var n=function(){y.show();var b={url:v("api/v7.0")+"hour/",type:"get",data:g,dataType:"json",async:!1};u(b);b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==
C[0]?s(function(){n()}):m({response:b.error,type:null,msg:null},n,"setHourAttask,"+a.syncID+" "+a.name+" url: "+v()+" "+JSON.stringify(g)+" "+W(a)+","+a.duration,'Time was not tracked, please click on "View" for task: '+a.name+" to record time manually."),y.hide(),F.hide()):(TASK_DB.setTask(a),TASK_CNTRL.toggleRunText(),K(),void 0!=g.taskID||void 0!=g.opTaskID?w(a):!0==f.get("logout_on_select")&&ba(),y.hide(),F.hide(),c(E[2],W(a)),c(E[1],"time tracked newHr: "+g.hours+" "+a.duration+" oldHr: "+e),
a.done&&k(a))});b.fail(function(c,b,d){m({response:c.responseText,type:b,msg:d},n,"setHourAttask-fail,"+a.syncID+" "+a.name+" url: "+v()+" "+JSON.stringify(g)+" "+W(a)+","+a.duration+", "+c.responseText+", "+d,c.responseText+'<br>Time was not tracked, please click on "View" for task: '+a.name+" to record time manually.")})};n()}function M(a,b,d){var e=new Date,g={};g.entryDate=void 0!=a.dateStr?a.dateStr:e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate();g.fields="permissions,ID,hours,extRefID";
g.ownerID=f.get("userID");"GEN"==a.details.objCode?g.hourTypeID=a.syncID:("OPTASK"==a.details.objCode?g.opTaskID=a.syncID:g.taskID=a.syncID,void 0!=a.details.hourTypeID&&""!=a.details.hourTypeID&&(g.hourTypeID=a.details.hourTypeID));e={url:v()+"hour/search",type:"get",data:g,dataType:"json",async:!1};u(e);e=jQuery.ajax(e);e.done(function(e){if(void 0!=e.error)e.error["class"]==C[0]?s(function(){M(a,b,d)}):c(E[0],"getHour,"+a.syncID+","+JSON.stringify(e.error)),y.hide(),F.hide();else if(c(E[1],"getHour "+
e.data.length+" "+JSON.stringify(e.data)),b){for(var g=e.data.length,f=0;f<g;f++)if(-1!=e.data[f].permissions.actions.indexOf("ADD_HOURS")&&-1!=e.data[f].permissions.actions.indexOf("CHANGE_STATUS")){b(a,e.data[f],d);return}b(a,e.data[0],d)}});e.fail(function(b,d,e){c(E[0],"getHour,"+a.syncID+","+JSON.stringify(e))})}var C=["com.attask.common.AuthenticationException"],E=["error","debug","informational"],f,za=!(window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows")),qa=isMobile(),
Ga="www.atappstore.com",Ia="secure.atappstore.com",Ja=-1!==document.URL.indexOf("dashboard.directory")||-1!==document.URL.indexOf(Ga)||-1!==document.URL.indexOf(Ia),Fa=!1,xa=!1,Ma="Force Desktop Stopwatch Access",Ka=300,ta=[],ma=[],Ca,La,ya={current:{f:Ea,t:"Current",d:"Tasks and issues you're working on"},recent:{f:p,t:"Recent",d:"All tasks and issues tracked within 14 days"},requested:{f:G,t:"Requested",d:"Tasks and issues you can start on"},all:{f:L,t:"All Assigned",d:"All tasks and issues assigned to you"},
team:{f:la,t:"Team Assigned",d:"All tasks and issues assigned to your Teams"},role:{f:n,t:"Role Assigned",d:"All tasks and issues available to your Roles"}};!Ja&&-1==location.origin.indexOf("localhost")&&(location="https://"+Ga+"/client/enterprise-stopwatch/launch.html");O();f=za?{settings:[],set:function(a,c){switch(a){case "domain":case "host":case "userID":case "sessionID":case "username":case "date":case "view":case "current_sort":case "launched":case "ent":"object"===typeof c&&(c=JSON.stringify(c)),
this.setCookie(a,c,9999999999)}this.settings[a]=c},get:function(a){switch(a){case "domain":case "host":case "userID":case "sessionID":case "username":case "date":case "view":case "current_sort":case "launched":case "ent":var c=void 0===this.settings[a]?this.getCookie(a):this.settings[a];this.settings[a]=c;return"undefined"==c||void 0==c?void 0:c;default:return!this.settings.hasOwnProperty(a)||"undefined"==this.settings[a]||void 0==this.settings[a]?void 0:this.settings[a]}},removeAll:function(){var a=
new Date,c;for(c in this.settings)this.settings.hasOwnProperty(c)&&(document.cookie=c+"="+this.settings[c]+";expires="+a.toGMTString()+";;");this.settings=[]},setCookie:function(a,c,b){var d=new Date;d.setHours(0);d.setMinutes(0);d.setSeconds(0);d.setDate(d.getDate()+b);c=encodeURI(c)+(null==b?"":"; expires="+d.toUTCString());document.cookie=a+"="+c},getCookie:function(a){var c,b,d,e=document.cookie.split(";");for(c=0;c<e.length;c++)if(b=e[c].substr(0,e[c].indexOf("=")),d=e[c].substr(e[c].indexOf("=")+
1),b=b.replace(/^\s+|\s+$/g,""),b==a)return decodeURI(d);return"undefined"}}:new Store("Attask");f.set("launched",(new Date).getTime());window.addEventListener("offline",function(a){jQuery("#refresh").hide();jQuery(".done").hide();jQuery(".percent").hide();jQuery(".view").hide();xa=!0});window.addEventListener("online",function(a){jQuery("#refresh").show();jQuery(".done").show();jQuery(".percent").show();jQuery(".view").show();a=f.get("offlineTasks");if(void 0!=a)for(var c=a.length,b=0;b<c;b++)T(a[b],
a[b].duration);f.set("offlineTasks",[]);xa=!1});var Aa;OB.init.add(function(){void 0==f.get("qr")&&f.set("qr","true"==getQueryString("qr")||getQueryString("code"));q();jQuery(".logout").live("click",function(){ba()});h();var a=getQueryString("s"),c=getQueryString("d");if(c&&(a&&f.set("sessionID",a),a=c.split("."),f.set("host",a[0]),a.shift(),f.set("domain",a.join(".")),a=getQueryString("u"),c=f.get("userID"),void 0==c||a&&c&&a!=c)){f.set("sessionID","");f.set("username","");f.set("password","");f.set("userID",
a);f.set("ent",void 0!=f.get("userID"));U();return}V();!0==f.get("qr")&&void 0==f.get("sessionID")&&(getQueryString("code")?(document.getElementById("button-appscan").style.display="block",qrRead(getQueryString("code"),f)):qrLoad(f))});OB.onBeforeUnLoad.add(function(a){var c=TASK_CNTRL.getDuration(a);T(a,c.duration,!1)});OB.onUnLoad.add(function(){TASK_DB.running(function(a){f.get("stopOnClose")&&TASK_CNTRL.stopTask(a)})});OB.onLoad.add(function(){document.addEventListener("resume",function(){jQuery("#loading").show();
V()||h()},!1);document.addEventListener("pause",function(){jQuery("#form-list").html("")},!1);document.addEventListener("menubutton",function(){TASK_CNTRL.showWindow('<div style="text-align: center; font-weight: bold;"><h3>Welcome</h3></div><div class="content"><p>If you have any questions please visit <a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank" class="btn" >store.atappstore.com</a></p><a href="#" class="btn btn-primary cancel" title="Done">Done</a></div>')},
!1)});OB.displayInterval.add(function(a,c){g(a,c)&&(window.clearInterval(TASK_CNTRL.display_intervals[a.ID]),TASK_CNTRL.IS_EXTENSION||window.clearInterval(TASK_CNTRL.update_intervals[a.ID]),TASK_CNTRL.toggleRunText())});OB.updateAtInterval.add(function(a,c){f.get("updateAtInterval")&&(0==c?y.hide():(y.show(),T(a,c,!0),a.start=new Date,TASK_DB.setTask(a)))});OB.stop.add(function(a,b){y.show();var d,e;d=new Date(a.start);e=new Date;c(E[1],"stop: "+d+" == "+e+" dur:"+b+" totalDuration:"+a.time);if(f.get("minuteBufferSnapToSched")){var g=
f.get("todaySched"),h=f.get("minuteBuffer"),k=e.toLocaleDateString("en-US"),l=Date.parse(k+g.start),g=Date.parse(k+g.stop),k=new Date(l);d<l&&d>k.setMinutes(k.getMinutes()-h)&&(d=new Date(l));k=new Date(g);e>g&&e<k.setMinutes(k.getMinutes()+h)&&(e=new Date(g));if(d>=e){y.hide();return}b=Math.floor((e.getTime()-d.getTime())/1E3);c(E[1],"minuteBufferSnapToSched: "+d+" == "+e+" dur:"+b)}0==b||0==Number((b/3600).toFixed(2))?(y.hide(),TASK_DB.setTask(a)):T(a,b,!1)});OB.update.add(function(a,c){F.show();
T(a,c,!1)});OB.start.add(function(a){Q(a)});OB.preStart.add(function(a){a.running?TASK_CNTRL.toggleTimer(a):navigator.onLine&&!a.disable&&(g(a,a.time)||function(){TASK_DB.loadAll(function(c){var b,d,e=!1,g=c.length;for(b=0;b<g;b++)if(d=c[b],null!=d&&d.running&&a.ID!=d.ID){TASK_CNTRL.toggleTimer(d);e=!0;break}Fa?z(a,function(a){TASK_CNTRL.toggleTimer(a)}):(TASK_CNTRL.toggleTimer(a),!e&&!0==f.get("logout_on_select")&&ba())})}())});OB.postAllItemRender.add(function(){jQuery(".remove").css("display",
"none");jQuery(".update").css("display","none");jQuery(".reset").css("display","none");f.get("is_auth")?jQuery("#storelink").text("AtAppStore"):(jQuery("#sort-date").remove(),jQuery(".timer").remove(),jQuery(".done").remove(),jQuery(".percent").remove(),jQuery(".date").removeClass("date").addClass("date-tall").html('<a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank">Trial Expired</a>'),jQuery("#storelink").text("Trial Expired - AtAppStore"));f.get("hideTaskButtons")&&
(jQuery(".timer").addClass("timer-tall"),jQuery(".done").remove(),jQuery(".percent").remove(),jQuery(".task").remove(),jQuery(".view").remove(),jQuery(".date").remove(),jQuery("#sort-date").remove());f.get("ent")&&jQuery("#totalHours").attr("title","").attr("data-hasqtip",!1).unbind("click").addClass("disabled");if(ia){var a=jQuery("#form-list"),c=f.get("vpos");void 0!=c&&a.scrollTop(c);"team"==f.get("view")&&!0==f.get("hide_team_done")&&jQuery(".done").remove();xa?f.get("allowOffline")&&(jQuery(".done").remove(),
jQuery(".percent").remove(),jQuery(".view").remove(),jQuery("#bar").hide()):jQuery("#bar").show();c=f.get("current_sort");void 0!=c?("string"===typeof c&&(c=JSON.parse(c)),ma[c.sort]=c.order,c=c.sort):(c=f.get("sort"),void 0==c&&(c="date"));jQuery("#sort-"+c).click();jQuery("#search-bar").is(":visible")&&jQuery("#search").click();jQuery("#loading").hide();a.show();a=jQuery("#holder")[0];a.style.display="none";a.style.display="block";y.hide();ia=!1}});OB.postItemRender.add(function(a){var c=jQuery("#item"+
a.ID),b=c.find(".details");if(0==c.find("#buttons .view").length){var d=c.find("#buttons"),e=["",{label:"Low",css:"default"},{label:"Normal",css:"success"},{label:"High",css:"warning"},{label:"Urgent",css:"danger"}];"GEN"!=a.details.objCode&&(void 0!=a.details.priority&&0!=a.details.priority)&&(e=e[a.details.priority],d.append('<span class="task priority '+e.css+'" title="'+e.label+'" data-priority="'+a.details.priority+'">'+e.label[0]+"</span> "));var g;"GEN"==a.details.objCode?(g="General",c.attr("data-type",
g),c.attr("data-force-order",0),d.attr("class","days priority"),c.attr("class","item general")):"OPTASK"==a.details.objCode?(g="Issue",c.attr("data-type",g),c.attr("data-force-order",1),d.append('<span class="issue" title="Issue">I</span> ')):"TASK"==a.details.objCode&&(g="Task",c.attr("data-type",g),c.attr("data-force-order",1),d.append('<span class="task" title="Task">T</span> '));"General"!=g&&(d.append('<a href="https://'+f.get("host")+"."+f.get("domain")+"/"+g.toLowerCase()+"/view?ID="+a.syncID+
'" target="_blank" class="btn btn-mini view" rel="'+a.ID+'" title="View '+g+'">View</a> '),a.disable?(c.find(".timer").text("status: "+a.details.status).unbind("click").addClass("disabled"),c.find(".timer-info").text("status: "+a.details.status)):d.append('<a href="#" class="btn btn-mini done" rel="'+a.ID+'" title="Done '+g+'">Done</a> '));!a.disable&&("Task"==g&&void 0!=a.details.percentComplete)&&d.append('<a href="#" class="btn btn-mini percent" rel="'+a.ID+'" title="Percent Completed">'+a.details.percentComplete+
"%</a> ");e='<span class="date" style="background-color: #EEE;"></span>';if(!a.disable&&"General"!=g&&void 0!=a.details.plannedCompletionDate)if(d=a.details.plannedCompletionDate.replace(/:\d\d\d/,""),d=new Date(Date.parse(d)),console.re.log(d),console.re.log(Date.parse(d)),console.re.log(a.details.plannedCompletionDate.replace(/:\d\d\d/,"")),console.re.log(!isNaN(d.getTime())),isNaN(d.getTime()))b.attr("data-days",9999);else{var h=new Date;h.setHours(0);h.setMinutes(0);h.setSeconds(0);e="#D2E0FF";
h=Math.round((d.getTime()-h.getTime())/1E3/60/60/24);0>h?e="#FFCDCD":1>=h&&(e="#FFD7AB");var k;k=0<h?"days due: "+h:"days late: "+Math.abs(h);e='<div class="date" style="background-color: '+e+';"><div class="days">'+k+"</div><div>"+ka(d.getMonth())+" "+d.getDate()+", "+d.getFullYear()+"</div></div>";b.attr("data-days",h)}else b.attr("data-days",9999);d="";null!=a.details.parent&&(d="<br><br>Parent Task: <br>"+a.details.parent.name);c.find(".name").attr("title",g+": <br>"+a.name+d);"General"!=g?(g=
a.details.project.name,b.html(g).attr("title","Project: <br>"+g).attr("data-priority",a.details.priority),c.find(".c6").after(e)):b.html(a.details.description).attr("title",a.details.description)}});OB.remove.add(function(a){jQuery("#item"+a).remove()});OB.reset.add(function(a,c){OB.update.dispatch(c,-c.time);jQuery("#item"+a+" .timer").text(TASK_CNTRL.hms(0))});var ia=!1,F,y}();var QUERY_LOOKUP=null;function getQueryString(d){if(null==QUERY_LOOKUP){var a=location.search.substring(1),e=/([^&=]+)=([^&]*)/g,b;for(QUERY_LOOKUP={};b=e.exec(a);)QUERY_LOOKUP[decodeURIComponent(b[1])]=decodeURIComponent(b[2])}return d in QUERY_LOOKUP?QUERY_LOOKUP[d]:null}
function isMobile(){var d=!1,a=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4)))d=!0;return d}
function taskController(d){var a,e=window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows"),b=!e&&isMobile();OB.start.add(function(a){startNotify(a)});OB.stop.add(function(a,b,d){stopNotify(a)});OB.onLoad.add(function(){});OB.postAllItemRender.add(function(){b&&(jQuery("#form-list").height(0),a=124);if(!e||"full"==getQueryString("view")){var c=function(){var c=jQuery("#form-list"),b;b=c.height();b+=window.innerHeight-a;0!=window.innerHeight-a&&c.height(b);a=window.innerHeight};jQuery(window).unbind("resize");
jQuery(window).bind("resize",c);c()}var d=!1,c={style:{tip:{corner:!0,width:5,height:5},def:!1,classes:"qtip-info"},position:{adjust:{method:"flip flip"},at:"bottom left",my:"top left",viewport:jQuery(window)},show:{},events:{show:function(a,c){d=!0}},hide:{event:"unfocus",delay:0}};b?(jQuery("span[title]").qtip(c),jQuery("#form-list").bind("scroll",function(){d&&(jQuery("span[title]").qtip("hide"),d=!1)})):(jQuery("a[title]").qtip(c),jQuery("#form-list").bind("scroll",function(){d&&(jQuery("a[title]").qtip("hide"),
d=!1)}));c.content="time < 30 seconds<br> time was not tracked";c.show.event=!1;c.hide.delay=b?0:2E3;var g=jQuery(".timer");g.qtip(c);b||g.mouseover(function(){var a=jQuery(this).find(".time").hide(),c=jQuery(this).find(".timer-info").show();setTimeout(function(){a.show();c.hide()},3E3)}).mouseout(function(){jQuery(this).find(".time").show();jQuery(this).find(".timer-info").hide()});b&&(jQuery(".item").css("padding-right","5px"),jQuery(".task").css("padding-right","5px").css("padding-left","5px"),
jQuery(".issue").css("padding-right","5px").css("padding-left","5px"),jQuery("body").css("font-size","12px"));jQuery("#searchfor").domsearch("#form-list",{unit:"div.item:visible",criteria:["span[oldtitle]"]})});return{display_intervals:[],update_intervals:[],taskDB:d,init:function(){this.bind();this.toggleRunText();var c=jQuery("#form-list");!e||"full"==getQueryString("view")?c.addClass("full"):c.css("max-height","439px");!e&&(window.webkitNotifications&&0!=window.webkitNotifications.checkPermission())&&
window.open("core/js/permission.html","Permission","height=540,width=447");a=567},bind:function(){b&&jQuery("a[target='_blank']").live("click",function(a){a.preventDefault();window.open(jQuery(this).attr("href"),"_blank","location=yes");return!1});jQuery("#cover").hide();jQuery(".cancel").live("click",function(b){b.preventDefault();jQuery("#"+jQuery(this).attr("rel")).hide().hide().find("input:text").val("");jQuery("#form-list").show();jQuery("#top-bar").show();jQuery("#bar").show();a.hideWindow()});
jQuery("#search").live("click",function(a){a.preventDefault();jQuery("#sort-bar").toggle();jQuery("#search-bar").toggle();jQuery("#searchfor").focus().val("").domsearchClear()});jQuery("#popout").live("click",function(a){a.preventDefault();e&&window.chrome.windows.create({url:"index.html?view=full",type:"popup",width:450,height:600})});jQuery("#create").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#form-create").slideDown().find("input[name='task-name']").focus()});var a=
this;jQuery("#button-create").live("click",function(){var b=jQuery("#form-create");a.taskDB.insert(b.find(":input[name='task-name']").val());b.hide().find("input:text").val("")});jQuery("#task-name").keydown(function(b){13==b.keyCode&&(b=jQuery("#form-create"),a.taskDB.insert(b.find(":input[name='task-name']").val()),b.hide().find("input:text").val(""))});jQuery(".remove").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#button-remove").attr("rel",jQuery(this).attr("rel"));
jQuery("#remove-confirm").html("Are you sure? You want to <strong>delete "+jQuery(this).attr("title")+"</strong>?");jQuery("#form-remove").show()});jQuery("#button-remove").live("click",function(){jQuery("#form-remove").hide();a.taskDB.remove(jQuery(this).attr("rel"))});jQuery("#remove-all").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#form-remove-all").slideDown()});jQuery("#button-remove-all").live("click",function(){jQuery("#form-remove-all").hide();a.taskDB.removeall()});
jQuery(".update").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#top-bar").hide();jQuery("#bar").hide();this.taskDB.updateValidate(jQuery(this).attr("rel"),this.update)});jQuery("#button-update").live("click",function(){var b=jQuery("#form-update");b.hide();jQuery("#top-bar").show();jQuery("#bar").show();a.taskDB.update(b.find(":input[name='task-id']").val(),b.find(":input[name='task-name']").val(),b.find(":input[name='task-time']").val())});jQuery(".reset").live("click",
function(b){b.preventDefault();b=jQuery(this).attr("rel");a.taskDB.reset(b)});var d=function(b){b.preventDefault();a.taskDB.updateValidate(jQuery(this).attr("rel"),function(a){OB.preStart.dispatch(a)});return!1};jQuery(".timer").live("click",d);jQuery("#running").click(d);jQuery("#holder").show()},isMobile:b,displayError:function(a){this.showWindow('<h3><div style="text-align: center; font-weight: bold;">Error</div></h3><div class="content"><p>'+a+'</p><a href="#" id="cancel_confirm" class="btn btn-primary" title="Done">Done</a></div>')},
showWindow:function(a,d){var e=jQuery("#cover");d=void 0==d?"#window":d;null!=a&&jQuery(d).html(a);b?(e.css("height","100%").css("opacity","0.8").show(),jQuery(d).animate({top:60+window.pageYOffset+"px"},{easing:"easeInCubic",duration:400,complete:function(){}})):e.css("height","100%").show().animate({opacity:"0.8"},400,function(){jQuery(d).animate({top:60+window.pageYOffset+"px"},{easing:"easeInCubic",duration:400,complete:function(){}})})},hideWindow:function(a){var d=jQuery("#cover");a=void 0==
a?"#window":a;b?jQuery(a).animate({top:"-700px"},{easing:"easeOutCubic",duration:400,complete:function(){d.hide()}}):jQuery(a).animate({top:"-700px"},{easing:"easeOutCubic",duration:400,complete:function(){d.animate({opacity:"0"},{duration:400,complete:function(){d.hide()}})}})},update:function(a){var b=jQuery("#form-update");b.find(":input[name='task-id']").val(a.ID);b.find(":input[name='task-name']").val(a.name);b.find(":input[name='task-time']").val(this.hms(a.time));b.slideDown()},truncateString:function(a){return a},
showTask:function(a){var b,d="";b=jQuery("#item"+a.ID);0!=b.length?b.show():(d+='<div class="item'+(a.running?" running":"")+'" id="item'+a.ID+'" rel="'+a.ID+'">',d=d+'<div class="c3">'+('<span class="name c1" title="Task: <br>'+a.name+'" ><strong>'+this.truncateString(a.name)+"</strong></span><br>"),d+='<span class="details" title="'+a.details+'" >'+this.truncateString(a.details)+"</span><br>",d+='<span id="buttons"><a href="#" class="btn btn-mini update" rel="'+a.ID+'" title="Edit: '+a.name+'">Edit</a> ',
d+='<a href="#" class="btn btn-mini reset" rel="'+a.ID+'" title="Reset: '+a.name+'">Reset</a> ',d+='<a href="#" class="btn btn-mini remove" rel="'+a.ID+'" title="Delete: '+a.name+'">Delete</a></span>',d+="</div>",d+='<div class="c8"><div class="c6">',a.running?(b=new Date(a.start),b=Number(a.time)+Math.floor(((new Date).getTime()-b.getTime())/1E3),d+='<a href="#" class="btn timer btn-primary" rel="'+a.ID+'"><span class="time">'+this.hms(b)+"</span>"):d+='<a href="#" class="btn timer '+(a.disable?
"disabled":"")+'" rel="'+a.ID+'"><span class="time">'+this.hms(a.time)+"</span>",d+='<span class="timer-info" style="display: none;">'+(a.running?"Stop":a.disable?"Max Reached":"Start")+"</span></a>",d+="</div>",d+="</div></div>",a.running&&(this.startTask(a),this.toggleRunText()),jQuery("#form-list").append(d),OB.postItemRender.dispatch(a))},showAll:function(a){if(void 0!=a){var b,d=a.length;if(0!=d)for(b=0;b<d;b++)this.showTask(a[b])}0==jQuery(".item").length&&this.showNoTaskWindow();OB.postAllItemRender.dispatch()},
showNoTaskWindow:function(){this.showWindow('<h3><div style="text-align: center; font-weight: bold;">No Tasks</div></h3><div class="content"><p>Please assign a task to yourself.</p><a href="#" id="cancel_confirm" class="btn btn-primary cancel" title="Done">Done</a></div>')},toggleTimer:function(a){jQuery("#item"+a.ID+" .timer").toggleClass("btn-primary");a.running?this.stopTask(a):this.startTask(a);this.toggleRunText()},startTask:function(a){if(navigator.onLine){var b=this,d=jQuery("#item"+a.ID),
O=new Date;d.find(".timer .timer-info").text("Stop");window.clearInterval(b.display_intervals[a.ID]);e||window.clearInterval(b.update_intervals[a.ID]);a.running?O=new Date(a.start):this.taskDB.start(a.ID,O);b.display_intervals[a.ID]=window.setInterval(function(){var e=Number(a.time)+Math.floor(((new Date).getTime()-O.getTime())/1E3);d.find(".timer .time").text(b.hms(e));OB.displayInterval.dispatch(a,e)},500);e||(b.update_intervals[a.ID]=window.setInterval(function(){navigator.onLine&&b.taskDB.updateAtInterval(a.ID,
Number(a.time)+Math.floor(((new Date).getTime()-O.getTime())/1E3),300)},3E5))}},stopTask:function(a){var b=jQuery("#item"+a.ID),d=this.getDuration(a),O=Number(a.time),b=b.find(".timer"),O=d>O?d:O+d;window.clearInterval(this.display_intervals[a.ID]);e||window.clearInterval(this.update_intervals[a.ID]);this.taskDB.stop(a.ID,O,d,a.done);0==d&&b.qtip("show");b.find(".time").text(this.hms(O));b.find(".timer-info").text("Start")},getDuration:function(a){a=new Date(a.start);a=Math.floor(((new Date).getTime()-
a.getTime())/1E3);30>a?a=0:60>a&&29<a&&(a=60);return a},toggleRunText:function(){var a=jQuery("#running"),b=jQuery("#storelink");this.taskDB.running(function(d){e?window.chrome.browserAction.setBadgeText({text:"RUN"}):document.title="Stopwatch - Running: "+d.name;a.text("Running: "+d.name).attr("rel",d.ID).show();b.hide()},function(d){0==d&&(e?window.chrome.browserAction.setBadgeText({text:""}):document.title="Stopwatch",a.hide(),b.show())})},hms:function(a){a=[0,0,a];var b;for(b=2;0<b;b--)a[b-1]=
Math.floor(a[b]/60),a[b]%=60,10>a[b]&&(a[b]="0"+a[b]);return a.join(":")},sec:function(a){a=String(a).split(":");return Number(parseFloat(3600*a[0])+60*parseFloat(a[1])+parseFloat(a[2]))}}};function taskDB(){return{dm:[],log:[],lastId:0,sql:function(d,a,e,b,c,h){},init:function(){this.createDB();return this},setEvent:function(d,a){var e=this.log;20==e.length&&e.shift();e.push({type:d,message:a,time:(new Date).getTime()});this.log=e},getEvents:function(){return this.log},onError:function(d){},createDB:function(){this.dm=[];this.lastId=0},dropTaskTable:function(){this.createDB()},get:function(d){return this.dm[d]},start:function(d,a){this.dm[d].running=1;this.dm[d].start=a;OB.start.dispatch(this.dm[d])},
updateAtInterval:function(d,a,e){this.dm[d].running=1;this.dm[d].time=Number(a);OB.updateAtInterval.dispatch(this.dm[d],Number(e))},stop:function(d,a,e,b){d=this.dm[d];d.running=0;d.done=b;d.time=Number(a);OB.stop.dispatch(d,Number(e))},setTask:function(d){this.dm[d.ID]=d},running:function(d,a){for(var e in this.dm)if(null!=this.dm[e]&&this.dm[e].running)return d(this.dm[e]),!0;a();return!1},insert:function(d,a,e){var b="null",c="",h=0;void 0!=a&&(void 0!=a.syncID&&(b=a.syncID),void 0!=a.details&&
(c=a.details),void 0!=a.disable&&(h=a.disable));if("null"!=b){a=!1;for(var g in this.dm)if(null!=this.dm[g]&&this.dm[g].syncID==b){a=!0;break}a||(g=this.nextID(),this.dm[g]={ID:g,syncID:b,name:d,details:c,time:0,start:new Date,running:0,done:0,disable:h},OB.insert.dispatch(d,{syncID:b,details:c}));TASK_CNTRL.showTask(this.dm[g]);e&&OB.postAllItemRender.dispatch()}},nextID:function(){return this.lastId++},updateValidate:function(d,a){null!=this.dm[d]&&a(this.dm[d])},update:function(d,a,e){e=TASK_CNTRL.sec(e);
var b;null!=this.dm[d]&&(this.dm[d].name=a,b=this.dm[d].time,this.dm[d].time=e);OB.update.dispatch(this.dm[d],e-b)},updateDetails:function(d,a){null!=this.dm[d]&&(this.dm[d].details=a)},remove:function(d){this.dm[d]=null;void 0!=TASK_CNTRL.update_intervals[d]&&window.clearInterval(TASK_CNTRL.update_intervals[d]);void 0!=TASK_CNTRL.display_intervals[d]&&window.clearInterval(TASK_CNTRL.display_intervals[d]);OB.remove.dispatch(d)},removeall:function(){this.createDB();for(var d in TASK_CNTRL.update_intervals)window.clearInterval(TASK_CNTRL.update_intervals[d]);
for(d in TASK_CNTRL.display_intervals)window.clearInterval(TASK_CNTRL.display_intervals[d]);OB.removeall.dispatch()},reset:function(d){null!=this.dm[d]&&(OB.reset.dispatch(d,this.dm[d]),this.dm[d].time=0)},loadAll:function(d){d(this.dm)}}.init()};function taskDBls(){return{ls:null,ps:null,log:null,userId:null,sql:function(d,a,e,b,c,h){},init:function(){this.ps=new Store("AttaskPersistModel");this.log=new Store("StopwatchLog");null==this.log.get("trace")&&this.log.set("trace",[]);this.ls=new Store("AttaskModel");null==this.ls.get("list")&&this.createDB();return this},setEvent:function(d,a){var e=this.log.get("trace");20==e.length&&e.shift();e.push({type:d,message:a,time:(new Date).getTime()});this.log.set("trace",e)},getEvents:function(){return this.log.get("trace")},
onError:function(d){},createDB:function(){this.ls.set("lastId",0);this.ls.set("list",[])},dropTaskTable:function(){this.ls.removeAll()},userRunningTasks:function(d){return this.ps.get(d+""+this.ps.get(d))},start:function(d,a){var e=this.ls.get(d);null!=e&&void 0!=e&&(e.running=1,e.start=a,this.ls.set(d,e),null!=this.userId&&(this.ps.set(this.userId+""+e.syncID,e),this.ps.set(this.userId,e.syncID)),OB.start.dispatch(e))},updateAtInterval:function(d,a,e){var b=this.ls.get(d);null!=b&&void 0!=b&&(b.time=
Number(a),b.running=1,this.ls.set(d,b),OB.updateAtInterval.dispatch(b,Number(e)))},stop:function(d,a,e,b){d=this.ls.get(d);null!=d&&void 0!=d&&(d.running=0,d.done=b,d.time=Number(a),null!=this.userId&&(this.ps.remove(this.userId+""+d.syncID),this.ps.remove(this.userId)),OB.stop.dispatch(d,Number(e)))},setTask:function(d){this.ls.set(d.ID,d)},running:function(d,a){var e=this.ls.get("list"),b,c=0,h;for(h in e)e.hasOwnProperty(h)&&(b=this.ls.get(h),null!=b&&(void 0!=b&&b.running)&&(void 0!=d&&d(b),c++));
void 0!=a&&a(c);return 0!=c},getAllRunning:function(){return this.ps.toObject()},insert:function(d,a,e){var b=this,c="null",h="",g=0;void 0!=a&&(void 0!=a.syncID&&(c=a.syncID),void 0!=a.details&&(h=a.details),void 0!=a.disable&&(g=a.disable));a=function(a,c,d,e,g){var h=b.nextID();g={ID:h,syncID:a,name:c,details:d,time:0,start:new Date,running:0,disable:g};if(null!=b.userId){var O=b.ps.get(b.userId+""+a);null!=O&&O.running&&(g=O)}b.ls.set(h,g);O=b.ls.get("list");O[h]=a;b.ls.set("list",O);OB.insert.dispatch(c,
{syncID:a,details:d});TASK_CNTRL.showTask(g);e&&OB.postAllItemRender.dispatch()};if("null"!=c){var O=b.ls.get("list"),V=!1,ca;for(ca in O)if(O.hasOwnProperty(ca)&&null!=O[ca]&&O[ca]==c){V=!0;break}V?(c=b.ls.get(ca),c.name=d,h&&Object.assign(c.details,h),b.ls.set(ca,c),TASK_CNTRL.showTask(c),e&&OB.postAllItemRender.dispatch()):a(c,d,h,e,g)}else a(c,d,h,e,g)},nextID:function(){var d=this.ls.get("lastId");d++;this.ls.set("lastId",d);return d},updateValidate:function(d,a){var e=this.ls.get(d);null!=e&&
void 0!=e&&a(e)},get:function(d){return this.ls.get(d)},update:function(d,a,e){e=TASK_CNTRL.sec(e);d=this.ls.get(d);null!=d&&void 0!=d&&(d.name=a,a=d.time,d.time=e,OB.update.dispatch(d,e-a))},updateDetails:function(d,a){var e=this.ls.get(d);null!=e&&void 0!=e&&(e.details=a,this.ls.set(d,e))},remove:function(d){var a=this.ls.get("list");a[d]=null;this.ls.set("list",a);this.ls.remove(d);void 0!=TASK_CNTRL.update_intervals[d]&&window.clearInterval(TASK_CNTRL.update_intervals[d]);void 0!=TASK_CNTRL.display_intervals[d]&&
window.clearInterval(TASK_CNTRL.display_intervals[d]);OB.remove.dispatch(d)},removeall:function(){this.createDB();for(var d in TASK_CNTRL.update_intervals)window.clearInterval(TASK_CNTRL.update_intervals[d]);for(d in TASK_CNTRL.display_intervals)window.clearInterval(TASK_CNTRL.display_intervals[d]);OB.removeall.dispatch()},reset:function(d){var a=this.ls.get(d);null!=a&&void 0!=a&&(OB.reset.dispatch(d,a),a.time=0,this.ls.set(d,a))},loadAll:function(d){var a=this.ls.get("list"),e=[],b,c;for(c in a)a.hasOwnProperty(c)&&
(b=this.ls.get(c),null!=b&&void 0!=b&&e.push(b));d(e)},loadSyncIds:function(d){for(var a=this.ls.get("list"),e=[],b,c=d.length,h=0;h<c;h++)b=a.indexOf(d[h]),-1!=b&&(b=this.ls.get(b),null!=b&&void 0!=b&&e.push(b));return e}}.init()};var TASK_DB;TASK_DB=window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows")||-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")?taskDBls():lscheck()?taskDBls():taskDB();var TASK_CNTRL=taskController(TASK_DB);jQuery(function(){Offline.options={interceptRequests:!1,requests:!1,checks:{image:{url:"https://secure.atappstore.com/client/stopwatch/icons/timer32x32.png"},active:"image"}};TASK_CNTRL.init();OB.init.dispatch()});
function onLoad(){OB.onLoad.dispatch()}window.addEventListener("beforeunload",function(d){console.log("beforeunload");if(!TASK_CNTRL.IS_EXTENSION&&TASK_DB.running(function(a){OB.onBeforeUnLoad.dispatch(a)}))return(d||window.event).returnValue="Stopwatch has a task running, are you sure?"});window.addEventListener("unload",function(d){console.log("unload");OB.onUnLoad.dispatch()});
function lscheck(){try{return localStorage.setItem("stopwatch","stopwatch"),localStorage.removeItem("stopwatch"),!0}catch(d){return!1}};var interval,notifyWorkIntervalTime=30;function startNotify(d){interval=setInterval(function(){notifyWorking(d)},6E4*notifyWorkIntervalTime)}function stopNotify(){clearInterval(interval)}function notifyWorking(d){if(window.webkitNotifications){var a=webkitNotifications.createNotification("../icons/timer48x48.png","Still working on Task:",d.name+"\n"+d.details.split(", Due:")[0]);a.show();setTimeout(function(){a.cancel()},7E3)}else stopNotify()}
function notifyFriday(){var d=webkitNotifications.createNotification("icons/timer48x48.png","Remember: Submit Timesheet!","");d.show();setTimeout(function(){d.cancel()},7E3)};
