(function(d){function a(b,a,c,d,e){this._listener=a;this._isOnce=c;this.context=d;this._signal=b;this._priority=e||0}function e(b,a){if("function"!==typeof b)throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",a));}function b(){this._bindings=[];this._prevParams=null;var a=this;this.dispatch=function(){b.prototype.dispatch.apply(a,arguments)}}a.prototype={active:!0,params:null,execute:function(b){var a;this.active&&this._listener&&(b=this.params?this.params.concat(b):
b,a=this._listener.apply(this.context,b),this._isOnce&&this.detach());return a},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal;delete this._listener;delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+
", isBound:"+this.isBound()+", active:"+this.active+"]"}};b.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(b,c,d,e){var ma=this._indexOfListener(b,d);if(-1!==ma){if(b=this._bindings[ma],b.isOnce()!==c)throw Error("You cannot add"+(c?"":"Once")+"() then add"+(!c?"":"Once")+"() the same listener without removing the relationship first.");}else b=new a(this,b,c,d,e),this._addBinding(b);this.memorize&&this._prevParams&&b.execute(this._prevParams);return b},
_addBinding:function(b){var a=this._bindings.length;do--a;while(this._bindings[a]&&b._priority<=this._bindings[a]._priority);this._bindings.splice(a+1,0,b)},_indexOfListener:function(b,a){for(var c=this._bindings.length,d;c--;)if(d=this._bindings[c],d._listener===b&&d.context===a)return c;return-1},has:function(b,a){return-1!==this._indexOfListener(b,a)},add:function(b,a,c){e(b,"add");return this._registerListener(b,!1,a,c)},addOnce:function(b,a,c){e(b,"addOnce");return this._registerListener(b,!0,
a,c)},remove:function(b,a){e(b,"remove");var c=this._indexOfListener(b,a);-1!==c&&(this._bindings[c]._destroy(),this._bindings.splice(c,1));return b},removeAll:function(){for(var b=this._bindings.length;b--;)this._bindings[b]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(b){if(this.active){var a=Array.prototype.slice.call(arguments),c=this._bindings.length,d;this.memorize&&(this._prevParams=
a);if(c){d=this._bindings.slice();this._shouldPropagate=!0;do c--;while(d[c]&&this._shouldPropagate&&!1!==d[c].execute(a))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll();delete this._bindings;delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var c=b;c.Signal=b;"function"===typeof define&&define.amd?define(function(){return c}):"undefined"!==typeof module&&module.exports?module.exports=c:d.signals=
c})(this);var OB={start:new signals.Signal,stop:new signals.Signal,preStart:new signals.Signal,preStop:new signals.Signal,insert:new signals.Signal,update:new signals.Signal,reset:new signals.Signal,remove:new signals.Signal,removeAll:new signals.Signal,init:new signals.Signal,options:new signals.Signal,postItemRender:new signals.Signal,postAllItemRender:new signals.Signal,onLoad:new signals.Signal};(function(){var d=this.Store=function(a,d){var b;this.name=a;if(void 0!==d)for(b in d)d.hasOwnProperty(b)&&void 0===this.get(b)&&this.set(b,d[b])};d.prototype.get=function(a){a="store."+this.name+"."+a;if(null!==localStorage.getItem(a))try{return JSON.parse(localStorage.getItem(a))}catch(d){return null}};d.prototype.set=function(a,d){if(void 0===d)this.remove(a);else{if("function"===typeof d)d=null;else try{d=JSON.stringify(d)}catch(b){d=null}localStorage.setItem("store."+this.name+"."+a,d)}return this};
d.prototype.remove=function(a){localStorage.removeItem("store."+this.name+"."+a);return this};d.prototype.removeAll=function(){var a,d;a="store."+this.name+".";for(d=localStorage.length-1;0<=d;d--)localStorage.key(d).substring(0,a.length)===a&&localStorage.removeItem(localStorage.key(d));return this};d.prototype.toObject=function(){var a,d,b,c,k;a={};d="store."+this.name+".";for(b=localStorage.length-1;0<=b;b--)localStorage.key(b).substring(0,d.length)===d&&(c=localStorage.key(b).substring(d.length),
k=this.get(c),void 0!==k&&(a[c]=k));return a};d.prototype.fromObject=function(a,d){!0!==d&&this.removeAll();for(var b in a)a.hasOwnProperty(b)&&this.set(b,a[b]);return this}})();(function(d){function a(b,a){for(var c=0,d=b.length;c<d;c++)if(b[c]==a)return!e;return e}var e=!1,b=parseFloat,c=Math.min,k=/(-?\d+\.?\d*)$/g,h=[],la=[];d.tinysort={id:"TinySort",version:"1.4.29",copyright:"Copyright (c) 2008-2012 Ron Valstar",uri:"http://tinysort.sjeiti.com/",licensed:{MIT:"http://www.opensource.org/licenses/mit-license.php",GPL:"http://www.gnu.org/licenses/gpl.html"},plugin:function(b,a){h.push(b);la.push(a)},defaults:{order:"asc",attr:null,data:null,useVal:e,place:"start",returns:e,
cases:e,forceStrings:e,sortFunction:null}};d.fn.extend({tinysort:function(ba,ma){ba&&"string"!=typeof ba&&(ma=ba,ba=null);var W=d.extend({},d.tinysort.defaults,ma),fa,J=d(this).length,u={},l=!(!ba||""==ba),N=!(null===W.attr||""==W.attr),ea=null!==W.data,X=l&&":"==ba[0],M=X?this.filter(ba):this,Z=W.sortFunction,V="asc"==W.order?1:-1,Y=[];d.each(h,function(b,a){a.call(a,W)});Z||(Z="rand"==W.order?function(){return 0.5>Math.random()?1:-1}:function(a,c){var l=e,h=!W.cases?a.s&&a.s.toLowerCase?a.s.toLowerCase():
a.s:a.s,u=!W.cases?c.s&&c.s.toLowerCase?c.s.toLowerCase():c.s:c.s;if(!W.forceStrings){var K=h&&h.match(k),M=u&&u.match(k);if(K&&M){var J=h.substr(0,h.length-K[0].length),N=u.substr(0,u.length-M[0].length);J==N&&(l=!e,h=b(K[0]),u=b(M[0]))}}var O=V*(h<u?-1:h>u?1:0);d.each(la,function(b,a){O=a.call(a,l,h,u,O)});return O});this.each(function(b,a){var c=d(a),e=l?X?M.filter(a):c.find(ba):c,k=ea?""+e.data(W.data):N?e.attr(W.attr):W.useVal?e.val():e.text(),h=c.parent();u[h]||(u[h]={s:[],n:[]});0<e.length?
u[h].s.push({s:k,e:c,n:b}):u[h].n.push({e:c,n:b})});for(fa in u)u[fa].s.sort(Z);for(fa in u){var Z=u[fa],da=[],S=J,O=[0,0],Q;switch(W.place){case "first":d.each(Z.s,function(b,a){S=c(S,a.n)});break;case "org":d.each(Z.s,function(b,a){da.push(a.n)});break;case "end":S=Z.n.length;break;default:S=0}for(Q=0;Q<J;Q++){var K=a(da,Q)?!e:Q>=S&&Q<S+Z.s.length,R=(K?Z.s:Z.n)[O[K?0:1]].e;R.parent().append(R);(K||!W.returns)&&Y.push(R.get(0));O[K?0:1]++}}this.length=0;Array.prototype.push.apply(this,Y);return this}});
d.fn.TinySort=d.fn.Tinysort=d.fn.tsort=d.fn.tinysort})(jQuery);Array.prototype.indexOf||(Array.prototype.indexOf=function(d,a){var e=this.length,b=Number(a)||0,b=0>b?Math.ceil(b):Math.floor(b);for(0>b&&(b+=e);b<e;b++)if(b in this&&this[b]===d)return b;return-1});jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(d,a,e,b,c){return jQuery.easing[jQuery.easing.def](d,a,e,b,c)},easeInQuad:function(d,a,e,b,c){return b*(a/=c)*a+e},easeOutQuad:function(d,a,e,b,c){return-b*(a/=c)*(a-2)+e},easeInOutQuad:function(d,a,e,b,c){return 1>(a/=c/2)?b/2*a*a+e:-b/2*(--a*(a-2)-1)+e},easeInCubic:function(d,a,e,b,c){return b*(a/=c)*a*a+e},easeOutCubic:function(d,a,e,b,c){return b*((a=a/c-1)*a*a+1)+e},easeInOutCubic:function(d,a,e,b,c){return 1>(a/=c/2)?b/2*a*a*a+e:
b/2*((a-=2)*a*a+2)+e},easeInQuart:function(d,a,e,b,c){return b*(a/=c)*a*a*a+e},easeOutQuart:function(d,a,e,b,c){return-b*((a=a/c-1)*a*a*a-1)+e},easeInOutQuart:function(d,a,e,b,c){return 1>(a/=c/2)?b/2*a*a*a*a+e:-b/2*((a-=2)*a*a*a-2)+e},easeInQuint:function(d,a,e,b,c){return b*(a/=c)*a*a*a*a+e},easeOutQuint:function(d,a,e,b,c){return b*((a=a/c-1)*a*a*a*a+1)+e},easeInOutQuint:function(d,a,e,b,c){return 1>(a/=c/2)?b/2*a*a*a*a*a+e:b/2*((a-=2)*a*a*a*a+2)+e},easeInSine:function(d,a,e,b,c){return-b*Math.cos(a/
c*(Math.PI/2))+b+e},easeOutSine:function(d,a,e,b,c){return b*Math.sin(a/c*(Math.PI/2))+e},easeInOutSine:function(d,a,e,b,c){return-b/2*(Math.cos(Math.PI*a/c)-1)+e},easeInExpo:function(d,a,e,b,c){return 0==a?e:b*Math.pow(2,10*(a/c-1))+e},easeOutExpo:function(d,a,e,b,c){return a==c?e+b:b*(-Math.pow(2,-10*a/c)+1)+e},easeInOutExpo:function(d,a,e,b,c){return 0==a?e:a==c?e+b:1>(a/=c/2)?b/2*Math.pow(2,10*(a-1))+e:b/2*(-Math.pow(2,-10*--a)+2)+e},easeInCirc:function(d,a,e,b,c){return-b*(Math.sqrt(1-(a/=c)*
a)-1)+e},easeOutCirc:function(d,a,e,b,c){return b*Math.sqrt(1-(a=a/c-1)*a)+e},easeInOutCirc:function(d,a,e,b,c){return 1>(a/=c/2)?-b/2*(Math.sqrt(1-a*a)-1)+e:b/2*(Math.sqrt(1-(a-=2)*a)+1)+e},easeInElastic:function(d,a,e,b,c){d=1.70158;var k=0,h=b;if(0==a)return e;if(1==(a/=c))return e+b;k||(k=0.3*c);h<Math.abs(b)?(h=b,d=k/4):d=k/(2*Math.PI)*Math.asin(b/h);return-(h*Math.pow(2,10*(a-=1))*Math.sin((a*c-d)*2*Math.PI/k))+e},easeOutElastic:function(d,a,e,b,c){d=1.70158;var k=0,h=b;if(0==a)return e;if(1==
(a/=c))return e+b;k||(k=0.3*c);h<Math.abs(b)?(h=b,d=k/4):d=k/(2*Math.PI)*Math.asin(b/h);return h*Math.pow(2,-10*a)*Math.sin((a*c-d)*2*Math.PI/k)+b+e},easeInOutElastic:function(d,a,e,b,c){d=1.70158;var k=0,h=b;if(0==a)return e;if(2==(a/=c/2))return e+b;k||(k=c*0.3*1.5);h<Math.abs(b)?(h=b,d=k/4):d=k/(2*Math.PI)*Math.asin(b/h);return 1>a?-0.5*h*Math.pow(2,10*(a-=1))*Math.sin((a*c-d)*2*Math.PI/k)+e:0.5*h*Math.pow(2,-10*(a-=1))*Math.sin((a*c-d)*2*Math.PI/k)+b+e},easeInBack:function(d,a,e,b,c,k){void 0==
k&&(k=1.70158);return b*(a/=c)*a*((k+1)*a-k)+e},easeOutBack:function(d,a,e,b,c,k){void 0==k&&(k=1.70158);return b*((a=a/c-1)*a*((k+1)*a+k)+1)+e},easeInOutBack:function(d,a,e,b,c,k){void 0==k&&(k=1.70158);return 1>(a/=c/2)?b/2*a*a*(((k*=1.525)+1)*a-k)+e:b/2*((a-=2)*a*(((k*=1.525)+1)*a+k)+2)+e},easeInBounce:function(d,a,e,b,c){return b-jQuery.easing.easeOutBounce(d,c-a,0,b,c)+e},easeOutBounce:function(d,a,e,b,c){return(a/=c)<1/2.75?b*7.5625*a*a+e:a<2/2.75?b*(7.5625*(a-=1.5/2.75)*a+0.75)+e:a<2.5/2.75?
b*(7.5625*(a-=2.25/2.75)*a+0.9375)+e:b*(7.5625*(a-=2.625/2.75)*a+0.984375)+e},easeInOutBounce:function(d,a,e,b,c){return a<c/2?0.5*jQuery.easing.easeInBounce(d,2*a,0,b,c)+e:0.5*jQuery.easing.easeOutBounce(d,2*a-c,0,b,c)+0.5*b+e}});var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(d){for(var a=0;a<d.length;a++){var e=d[a].string,b=d[a].prop;this.versionSearchString=d[a].versionSearch||d[a].identity;if(e){if(-1!=e.indexOf(d[a].subString))return d[a].identity}else if(b)return d[a].identity}},
searchVersion:function(d){var a=d.indexOf(this.versionSearchString);if(-1!=a)return parseFloat(d.substring(a+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",
identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",
identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();(function(d,a,e){(function(b){"function"==typeof define&&define.amd?define(["jquery"],b):jQuery&&!jQuery.fn.qtip&&b(jQuery)})(function(b){function c(b){ia={pageX:b.pageX,pageY:b.pageY,type:"mousemove",scrollX:d.pageXOffset||a.body.scrollLeft||a.documentElement.scrollLeft,scrollY:d.pageYOffset||a.body.scrollTop||a.documentElement.scrollTop}}function k(a){var c=function(b){return b===N||"object"!=typeof b},d=function(a){return!b.isFunction(a)&&(!a&&!a.attr||1>a.length||"object"==typeof a&&!a.jquery&&
!a.then)};if(!a||"object"!=typeof a)return l;c(a.metadata)&&(a.metadata={type:a.metadata});if("content"in a){if(c(a.content)||a.content.jquery)a.content={text:a.content};d(a.content.text||l)&&(a.content.text=l);"title"in a.content&&(c(a.content.title)&&(a.content.title={text:a.content.title}),d(a.content.title.text||l)&&(a.content.title.text=l))}return"position"in a&&c(a.position)&&(a.position={my:a.position,at:a.position}),"show"in a&&c(a.show)&&(a.show=a.show.jquery?{target:a.show}:{event:a.show}),
"hide"in a&&c(a.hide)&&(a.hide=a.hide.jquery?{target:a.hide}:{event:a.hide}),"style"in a&&c(a.style)&&(a.style={classes:a.style}),b.each(D,function(){this.sanitize&&this.sanitize(a)}),a}function h(C,v,aa,h){function A(f){var n=0,b,a=v;for(f=f.split(".");a=a[f[n++]];)n<f.length&&(b=a);return[b||v,f.pop()]}function E(f){return ra.concat("").join(f?"-"+f+" ":" ")}function L(){var f=v.style.widget,b=q.hasClass(F);q.removeClass(F);F=f?"ui-state-disabled":"qtip-disabled";q.toggleClass(F,b);q.toggleClass("ui-helper-reset "+
E(),f).toggleClass(qa,v.style.def&&!f);n.content&&n.content.toggleClass(E("content"),f);n.titlebar&&n.titlebar.toggleClass(E("header"),f);n.button&&n.button.toggleClass(ca+"-icon",!f)}function y(f){n.title&&(n.titlebar.remove(),n.titlebar=n.title=n.button=N,f!==l&&m.reposition())}function s(){var f=v.content.title.button,a="string"==typeof f?f:"Close tooltip";n.button&&n.button.remove();f.jquery?n.button=f:n.button=b("<a />",{"class":"qtip-close "+(v.style.widget?"":ca+"-icon"),title:a,"aria-label":a}).prepend(b("<span />",
{"class":"ui-icon ui-icon-close",html:"&times;"}));n.button.appendTo(n.titlebar||q).attr("role","button").click(function(f){return q.hasClass(F)||m.hide(f),l})}function z(){var f=P+"-title";n.titlebar&&y();n.titlebar=b("<div />",{"class":ca+"-titlebar "+(v.style.widget?E("header"):"")}).append(n.title=b("<div />",{id:f,"class":ca+"-title","aria-atomic":u})).insertBefore(n.content).delegate(".qtip-close","mousedown keydown mouseup keyup mouseout",function(f){b(this).toggleClass("ui-state-active ui-state-focus",
"down"===f.type.substr(-4))}).delegate(".qtip-close","mouseover mouseout",function(f){b(this).toggleClass("ui-state-hover","mouseover"===f.type)});v.content.title.button&&s()}function g(f,a){var c=n.title;if(!m.rendered||!f)return l;b.isFunction(f)&&(f=f.call(C,r.event,m));if(f===l||!f&&""!==f)return y(l);f.jquery&&0<f.length?c.empty().append(f.css({display:"block"})):c.html(f);a!==l&&m.rendered&&0<q[0].offsetWidth&&m.reposition(r.event)}function B(f){f&&b.isFunction(f.done)&&f.done(function(f){x(f,
null,l)})}function x(f,a,c){function d(f){function n(c){c&&(delete pa[c.src],clearTimeout(m.timers.img[c.src]),b(c).unbind(t));b.isEmptyObject(pa)&&(a!==l&&m.reposition(r.event),f())}var c,pa={};if(0===(c=g.find("img[src]:not([height]):not([width])")).length)return n();c.each(function(f,a){if(pa[a.src]===e){var r=0;(function ta(){if(a.height||a.width||3<r)return n(a);r+=1;m.timers.img[a.src]=setTimeout(ta,700)})();b(a).bind("error"+t+" load"+t,function(){n(this)});pa[a.src]=a}})}var g=n.content;return!m.rendered||
!f?l:(b.isFunction(f)&&(f=f.call(C,r.event,m)||""),c!==l&&B(v.content.deferred),f.jquery&&0<f.length?g.empty().append(f.css({display:"block"})):g.html(f),0>m.rendered?q.queue("fx",d):(ha=0,d(b.noop)),m)}function G(){function f(f){if(q.hasClass(F))return l;clearTimeout(m.timers.show);clearTimeout(m.timers.hide);var n=function(){m.toggle(u,f)};0<v.show.delay?m.timers.show=setTimeout(n,v.show.delay):n()}function I(f){if(q.hasClass(F)||H||ha)return l;var n=b(f.relatedTarget||f.target),a=n.closest(ga)[0]===
q[0],n=n[0]===T.show[0];clearTimeout(m.timers.show);clearTimeout(m.timers.hide);if("mouse"===e.target&&a||v.hide.fixed&&/mouse(out|leave|move)/.test(f.type)&&(a||n))try{f.preventDefault(),f.stopImmediatePropagation()}catch(r){}else 0<v.hide.delay?m.timers.hide=setTimeout(function(){m.hide(f)},v.hide.delay):m.hide(f)}function pa(f){if(q.hasClass(F))return l;clearTimeout(m.timers.inactive);m.timers.inactive=setTimeout(function(){m.hide(f)},v.hide.inactive)}function g(f){m.rendered&&0<q[0].offsetWidth&&
m.reposition(f)}var e=v.position,T={show:v.show.target,hide:v.hide.target,viewport:b(e.viewport),document:b(a),body:b(a.body),window:b(d)},k=b.trim(""+v.show.event).split(" "),h=b.trim(""+v.hide.event).split(" ");b.browser.msie&&parseInt(b.browser.version,10);q.bind("mouseenter"+t+" mouseleave"+t,function(f){var n="mouseenter"===f.type;n&&m.focus(f);q.toggleClass(sa,n)});/mouse(out|leave)/i.test(v.hide.event)&&"window"===v.hide.leave&&T.window.bind("mouseout"+t+" blur"+t,function(f){!/select|option/.test(f.target.nodeName)&&
!f.relatedTarget&&m.hide(f)});v.hide.fixed?(T.hide=T.hide.add(q),q.bind("mouseover"+t,function(){q.hasClass(F)||clearTimeout(m.timers.hide)})):/mouse(over|enter)/i.test(v.show.event)&&T.hide.bind("mouseleave"+t,function(f){clearTimeout(m.timers.show)});-1<(""+v.hide.event).indexOf("unfocus")&&e.container.closest("html").bind("mousedown"+t+" touchstart"+t,function(f){var n=b(f.target);m.rendered&&q.hasClass(F);var a=0<n.parents(ga).filter(q[0]).length;n[0]!==C[0]&&n[0]!==q[0]&&!a&&!C.has(n[0]).length&&
!n.attr("disabled")&&m.hide(f)});"number"==typeof v.hide.inactive&&(T.show.bind("qtip-"+aa+"-inactive",pa),b.each(R.inactiveEvents,function(f,b){T.hide.add(n.tooltip).bind(b+t+"-inactive",pa)}));b.each(h,function(n,a){var r=b.inArray(a,k),c=b(T.hide);-1<r&&c.add(T.show).length===c.length||"unfocus"===a?(T.show.bind(a+t,function(n){0<q[0].offsetWidth?I(n):f(n)}),delete k[r]):T.hide.bind(a+t,I)});b.each(k,function(n,b){T.show.bind(b+t,f)});"number"==typeof v.hide.distance&&T.show.add(q).bind("mousemove"+
t,function(f){var n=r.origin||{},b=v.hide.distance,a=Math.abs;(a(f.pageX-n.pageX)>=b||a(f.pageY-n.pageY)>=b)&&m.hide(f)});"mouse"===e.target&&(T.show.bind("mousemove"+t,c),e.adjust.mouse&&(v.hide.event&&(q.bind("mouseleave"+t,function(f){(f.relatedTarget||f.target)!==T.show[0]&&m.hide(f)}),n.target.bind("mouseenter"+t+" mouseleave"+t,function(f){r.onTarget="mouseenter"===f.type})),T.document.bind("mousemove"+t,function(f){m.rendered&&r.onTarget&&!q.hasClass(F)&&0<q[0].offsetWidth&&m.reposition(f||
ia)})));(e.adjust.resize||T.viewport.length)&&(b.event.special.resize?T.viewport:T.window).bind("resize"+t,g);T.window.bind("scroll"+t,g)}function w(){var f=[v.show.target[0],v.hide.target[0],m.rendered&&n.tooltip[0],v.position.container[0],v.position.viewport[0],v.position.container.closest("html")[0],d,a];m.rendered?b([]).pushStack(b.grep(f,function(f){return"object"==typeof f})).unbind(t):v.show.target.unbind(t+"-create")}var m=this,P=ca+"-"+aa,H=0,ha=0,q=b(),t=".qtip-"+aa,F="qtip-disabled",n,
r;m.id=aa;m.rendered=l;m.destroyed=l;m.elements=n={target:C};m.timers={img:{}};m.options=v;m.checks={};m.plugins={};m.cache=r={event:{},target:b(),disabled:l,attr:h,onTarget:l,lastClass:""};m.checks.builtin={"^id$":function(f,a,r){f=r===u?R.nextid:r;a=ca+"-"+f;f!==l&&0<f.length&&!b("#"+a).length&&(q[0].id=a,n.content[0].id=a+"-content",n.title[0].id=a+"-title")},"^content.text$":function(f,n,b){x(v.content.text)},"^content.deferred$":function(f,n,b){B(v.content.deferred)},"^content.title.text$":function(f,
b,a){if(!a)return y();!n.title&&a&&z();g(a)},"^content.title.button$":function(f,b,a){f=n.button;m.rendered&&(a?s():f.remove())},"^position.(my|at)$":function(f,n,b){"string"==typeof b&&(f[n]=new D.Corner(b))},"^position.container$":function(f,n,b){m.rendered&&q.appendTo(b)},"^show.ready$":function(){m.rendered?m.toggle(u):m.render(1)},"^style.classes$":function(f,n,b){q.attr("class",ca+" qtip "+b)},"^style.width|height":function(f,n,b){q.css(n,b)},"^style.widget|content.title":L,"^events.(render|show|move|hide|focus|blur)$":function(f,
n,a){q[(b.isFunction(a)?"":"un")+"bind"]("tooltip"+n,a)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){var f=v.position;q.attr("tracking","mouse"===f.target&&f.adjust.mouse);w();G()}};b.extend(m,{_triggerEvent:function(f,n,a){f=b.Event("tooltip"+f);return f.originalEvent=(a?b.extend({},a):N)||r.event||N,q.trigger(f,[m].concat(n||[])),!f.isDefaultPrevented()},render:function(f){if(m.rendered)return m;var a=v.content.text,c=v.content.title,d=v.position;
return b.attr(C[0],"aria-describedby",P),q=n.tooltip=b("<div/>",{id:P,"class":[ca,qa,v.style.classes,ca+"-pos-"+v.position.my.abbrev()].join(" "),width:v.style.width||"",height:v.style.height||"",tracking:"mouse"===d.target&&d.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":l,"aria-describedby":P+"-content","aria-hidden":u}).toggleClass(F,r.disabled).data("qtip",m).appendTo(v.position.container).append(n.content=b("<div />",{"class":ca+"-content",id:P+"-content","aria-atomic":u})),m.rendered=
-1,H=1,c.text?(z(),b.isFunction(c.text)||g(c.text,l)):c.button&&s(),(!b.isFunction(a)||a.then)&&x(a,l),m.rendered=u,L(),b.each(v.events,function(f,n){b.isFunction(n)&&q.bind("toggle"===f?"tooltipshow tooltiphide":"tooltip"+f,n)}),b.each(D,function(){"render"===this.initialize&&this(m)}),G(),q.queue("fx",function(n){m._triggerEvent("render");H=0;(v.show.ready||f)&&m.toggle(u,r.event,l);n()}),m},get:function(f){switch(f.toLowerCase()){case "dimensions":f={height:q.outerHeight(l),width:q.outerWidth(l)};
break;case "offset":f=D.offset(q,v.position.container);break;default:f=A(f.toLowerCase()),f=f[0][f[1]],f=f.precedance?f.string():f}return f},set:function(f,n){var a=/^position\.(my|at|adjust|target|container)|style|content|show\.ready/i,c=l,d=m.checks,g;return"string"==typeof f?(g=f,f={},f[g]=n):f=b.extend(u,{},f),b.each(f,function(n,r){var I=A(n.toLowerCase()),d;d=I[0][I[1]];I[0][I[1]]="object"==typeof r&&r.nodeType?b(r):r;f[n]=[I[0],I[1],r,d];c=a.test(n)||c}),k(v),H=1,b.each(f,function(f,n){var a,
b,r;for(a in d)for(b in d[a])if(r=RegExp(b,"i").exec(f))n.push(r),d[a][b].apply(m,n)}),H=0,m.rendered&&0<q[0].offsetWidth&&c&&m.reposition("mouse"===v.position.target?N:r.event),m},toggle:function(f,n,d){function e(){f?(b.browser.msie&&q[0].style.removeAttribute("filter"),q.css("overflow",""),"string"==typeof C.autofocus&&b(C.autofocus,q).focus(),C.target.trigger("qtip-"+aa+"-inactive")):q.css({display:"",visibility:"",opacity:"",left:"",top:""});m._triggerEvent(f?"visible":"hidden")}if(n){if(/over|enter/.test(n.type)&&
/out|leave/.test(r.event.type)&&v.show.target.add(n.target).length===v.show.target.length&&q.has(n.relatedTarget).length)return m;r.event=b.extend({},n)}if(!m.rendered)return f?m.render(1):m;var t=f?"show":"hide",C=v[t],k=v.position,h=v.content,G=0<q[0].offsetWidth,F=f||1===C.target.length,s=!n||2>C.target.length||r.target[0]===n.target;return(typeof f).search("boolean|number")&&(f=!G),!q.is(":animated")&&G===f&&s?m:m._triggerEvent(t,[90])?(b.attr(q[0],"aria-hidden",!f),f?(r.origin=b.extend({},ia),
m.focus(n),b.isFunction(h.text)&&x(h.text,l),b.isFunction(h.title.text)&&g(h.title.text,l),!na&&"mouse"===k.target&&k.adjust.mouse&&(b(a).bind("mousemove.qtip",c),na=u),m.reposition(n,d),!C.solo||b(ga,C.solo).not(q).qtip("hide",b.Event("tooltipsolo"))):(clearTimeout(m.timers.show),delete r.origin,na&&!b(ga+'[tracking="true"]:visible',C.solo).not(q).length&&(b(a).unbind("mousemove.qtip"),na=l),m.blur(n)),C.effect===l||F===l?(q[t](),e.call(q)):b.isFunction(C.effect)?(q.stop(1,1),C.effect.call(q,m),
q.queue("fx",function(f){e();f()})):q.fadeTo(90,f?1:0,e),f&&C.target.trigger("qtip-"+aa+"-inactive"),m):m},show:function(f){return m.toggle(u,f)},hide:function(f){return m.toggle(l,f)},focus:function(f){if(!m.rendered)return m;var n=b(ga),a=parseInt(q[0].style.zIndex,10),r=R.zindex+n.length;f=b.extend({},f);return q.hasClass(ja)||m._triggerEvent("focus",[r],f)&&(a!==r&&(n.each(function(){this.style.zIndex>a&&(this.style.zIndex-=1)}),n.filter("."+ja).qtip("blur",f)),q.addClass(ja)[0].style.zIndex=
r),m},blur:function(f){return q.removeClass(ja),m._triggerEvent("blur",[q.css("zIndex")],f),m},reposition:function(f,c){if(!m.rendered||H)return m;H=1;var g=v.position.target,e=v.position,t=e.my,C=e.at,aa=e.adjust,k=aa.method.split(" "),h=q.outerWidth(l),G=q.outerHeight(l),F=0,s=0,A=q.css("position"),U=e.viewport,w={left:0,top:0},x=e.container,u=0<q[0].offsetWidth,E=f&&"scroll"===f.type,z=b(d),B,y;if(b.isArray(g)&&2===g.length)C={x:Y,y:V},w={left:g[0],top:g[1]};else if("mouse"===g&&(f&&f.pageX||r.event.pageX))C=
{x:Y,y:V},f=ia&&ia.pageX&&(aa.mouse||!f||!f.pageX)?{pageX:ia.pageX,pageY:ia.pageY}:(!f||"resize"!==f.type&&"scroll"!==f.type?f&&f.pageX&&"mousemove"===f.type?f:!aa.mouse&&r.origin&&r.origin.pageX&&v.show.distance?r.origin:f:r.event)||f||r.event||ia||{},"static"!==A&&(w=x.offset()),w={left:f.pageX-w.left,top:f.pageY-w.top},aa.mouse&&E&&(w.left-=ia.scrollX-z.scrollLeft(),w.top-=ia.scrollY-z.scrollTop());else{"event"===g&&f&&f.target&&"scroll"!==f.type&&"resize"!==f.type?r.target=b(f.target):"event"!==
g&&(r.target=b(g.jquery?g:n.target));g=r.target;g=b(g).eq(0);if(0===g.length)return m;g[0]===a||g[0]===d?(F=D.iOS?d.innerWidth:g.width(),s=D.iOS?d.innerHeight:g.height(),g[0]===d&&(w={top:(U||g).scrollTop(),left:(U||g).scrollLeft()})):D.imagemap&&g.is("area")?B=D.imagemap(m,g,C,D.viewport?k:l):D.svg&&g[0].ownerSVGElement?B=D.svg(m,g,C,D.viewport?k:l):(F=g.outerWidth(l),s=g.outerHeight(l),w=D.offset(g,x));B&&(F=B.width,s=B.height,y=B.offset,w=B.position);if(3.1<D.iOS&&4.1>D.iOS||4.3<=D.iOS&&4.33>D.iOS||
!D.iOS&&"fixed"===A)w.left-=z.scrollLeft(),w.top-=z.scrollTop();w.left+=C.x===S?F:C.x===O?F/2:0;w.top+=C.y===da?s:C.y===O?s/2:0}return w.left+=aa.x+(t.x===S?-h:t.x===O?-h/2:0),w.top+=aa.y+(t.y===da?-G:t.y===O?-G/2:0),D.viewport?(w.adjusted=D.viewport(m,w,e,F,s,h,G),y&&w.adjusted.left&&(w.left+=y.left),y&&w.adjusted.top&&(w.top+=y.top)):w.adjusted={left:0,top:0},m._triggerEvent("move",[w,U.elem||U],f)?(delete w.adjusted,c===l||!u||isNaN(w.left)||isNaN(w.top)||"mouse"===g||!b.isFunction(e.effect)?q.css(w):
b.isFunction(e.effect)&&(e.effect.call(q,m,b.extend({},w)),q.queue(function(f){b(this).css({opacity:"",height:""});b.browser.msie&&this.style.removeAttribute("filter");f()})),H=0,m):m},disable:function(f){return"boolean"!=typeof f&&(f=!q.hasClass(F)&&!r.disabled),m.rendered?(q.toggleClass(F,f),b.attr(q[0],"aria-disabled",f)):r.disabled=!!f,m},enable:function(){return m.disable(l)},destroy:function(){var f=C[0],n=b.attr(f,ka),a=C.data("qtip");m.destroyed=u;m.rendered&&(q.stop(1,0).remove(),b.each(m.plugins,
function(){this.destroy&&this.destroy()}));clearTimeout(m.timers.show);clearTimeout(m.timers.hide);w();if(!a||m===a)b.removeData(f,"qtip"),v.suppress&&n&&(b.attr(f,"title",n),C.removeAttr(ka)),C.removeAttr("aria-describedby");return C.unbind(".qtip-"+aa),delete oa[m.id],C}})}function la(c,d){var e,U,A,E,L,y=b(this),s=b(a.body),z=this===a?s:y;U=y.metadata?y.metadata(d.metadata):N;E="html5"===d.metadata.type&&U?U[d.metadata.name]:N;var g=y.data(d.metadata.name||"qtipopts");try{g="string"==typeof g?
b.parseJSON(g):g}catch(B){}E=b.extend(u,{},R.defaults,d,"object"==typeof g?k(g):N,k(E||U));U=E.position;E.id=c;if("boolean"==typeof E.content.text){A=y.attr(E.content.attr);if(E.content.attr===l||!A)return l;E.content.text=A}U.container.length||(U.container=s);U.target===l&&(U.target=z);E.show.target===l&&(E.show.target=z);E.show.solo===u&&(E.show.solo=U.container.closest("body"));E.hide.target===l&&(E.hide.target=z);E.position.viewport===u&&(E.position.viewport=U.container);U.container=U.container.eq(0);
U.at=new D.Corner(U.at);U.my=new D.Corner(U.my);if(b.data(this,"qtip"))if(E.overwrite)y.qtip("destroy");else if(E.overwrite===l)return l;return E.suppress&&(L=b.attr(this,"title"))&&b(this).removeAttr("title").attr(ka,L).attr("title",""),e=new h(y,E,c,!!A),b.data(this,"qtip",e),y.bind("remove.qtip-"+c+" removeqtip.qtip-"+c,function(){e.destroy()}),e}function ba(a){var c=this,d=a.elements.tooltip,e=a.options.content.ajax,k=R.defaults.content.ajax,h=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
L=u,y=l,s;a.checks.ajax={"^content.ajax":function(a,b,C){"ajax"===b&&(e=C);"once"===b?c.init():e&&e.url?c.load():d.unbind(".qtip-ajax")}};b.extend(c,{init:function(){return e&&e.url&&d.unbind(".qtip-ajax")[e.once?"one":"bind"]("tooltipshow.qtip-ajax",c.load),c},load:function(d){function g(){var c;a.destroyed||(L=l,P&&(y=u,a.show(d.originalEvent)),(c=k.complete||e.complete)&&b.isFunction(c)&&c.apply(e.context||a,arguments))}function aa(c,d,g){var v;a.destroyed||(m&&"string"==typeof c&&(c=b("<div/>").append(c.replace(h,
"")).find(m)),(v=k.success||e.success)&&b.isFunction(v)?v.call(e.context||a,c,d,g):a.set("content.text",c))}function x(b,c,d){a.destroyed||0===b.status||a.set("content.text",c+": "+d)}if(y)y=l;else{var G=e.url.lastIndexOf(" "),w=e.url,m,P=!e.loading&&L;if(P)try{d.preventDefault()}catch(H){}else if(d&&d.isDefaultPrevented())return c;s&&s.abort&&s.abort();-1<G&&(m=w.substr(G),w=w.substr(0,G));s=b.ajax(b.extend({error:k.error||x,context:a},e,{url:w,success:aa,complete:g}))}},destroy:function(){s&&s.abort&&
s.abort();a.destroyed=u}});c.init()}function ma(a,b,c){var d=Math.ceil(b/2),e=Math.ceil(c/2);b={bottomright:[[0,0],[b,c],[b,0]],bottomleft:[[0,0],[b,0],[0,c]],topright:[[0,c],[b,0],[b,c]],topleft:[[0,0],[0,c],[b,c]],topcenter:[[0,c],[d,0],[b,c]],bottomcenter:[[0,0],[b,0],[d,c]],rightcenter:[[0,0],[b,e],[0,c]],leftcenter:[[b,0],[b,c],[0,e]]};return b.lefttop=b.bottomright,b.righttop=b.bottomleft,b.leftbottom=b.topright,b.rightbottom=b.topleft,b[a.string()]}function W(a,c){var d,k;function h(a){var b=
w.is(":visible");w.show();a();w.toggle(b)}function E(b,c,d,n){if(G.tip){b=B.corner.clone();c=d.adjusted;var r=a.options.position.adjust.method.split(" ");n=r[0];var r=r[1]||r[0],f=l,I=l,g=0,v=0,k,h={},w;B.corner.fixed!==u&&(n===K&&b.precedance===ea&&c.left&&b.y!==O?b.precedance=b.precedance===ea?X:ea:n!==K&&c.left&&(b.x=b.x===O?0<c.left?Y:S:b.x===Y?S:Y),r===K&&b.precedance===X&&c.top&&b.x!==O?b.precedance=b.precedance===X?ea:X:r!==K&&c.top&&(b.y=b.y===O?0<c.top?V:da:b.y===V?da:V),b.string()!==m.corner.string()&&
(m.top!==c.top||m.left!==c.left)&&B.update(b,l));k=B.position(b,c);k[b.x]+=L(b,b.x);k[b.y]+=L(b,b.y);k.right!==e&&(k.left=-k.right);k.bottom!==e&&(k.top=-k.bottom);k.user=Math.max(0,x.offset);if(f=n===K&&!!c.left)b.x===O?h["margin-left"]=g=k["margin-left"]:(w=k.right!==e?[c.left,-k.left]:[-c.left,k.left],(g=Math.max(w[0],w[1]))>w[0]&&(d.left-=c.left,f=l),h[k.right!==e?S:Y]=g);if(I=r===K&&!!c.top)b.y===O?h["margin-top"]=v=k["margin-top"]:(w=k.bottom!==e?[c.top,-k.top]:[-c.top,k.top],(v=Math.max(w[0],
w[1]))>w[0]&&(d.top-=c.top,I=l),h[k.bottom!==e?da:V]=v);G.tip.css(h).toggle(!(g&&v||b.x===O&&v||b.y===O&&g));d.left-=k.left.charAt?k.user:n!==K||I||!f&&!I?k.left:0;d.top-=k.top.charAt?k.user:r!==K||f||!f&&!I?k.top:0;m.left=c.left;m.top=c.top;m.corner=b.clone()}}function L(b,a,c){a=a?a:b[b.precedance];var n=G.titlebar&&b.y===V?G.titlebar:w,r="border-"+a+"-width",f;return h(function(){f=(c?parseInt(c.css(r),10):parseInt(G.content.css(r),10)||parseInt(n.css(r),10)||parseInt(w.css(r),10))||0}),f}function y(a){var c=
G.titlebar&&a.y===V?G.titlebar:G.content,d=b.browser.mozilla?"-moz-":b.browser.webkit?"-webkit-":"",n="border-radius-"+a.y+a.x,r="border-"+a.y+"-"+a.x+"-radius",f=function(f){return parseInt(c.css(f),10)||parseInt(w.css(f),10)},I;return h(function(){I=f(r)||f(d+r)||f(d+n)||f(n)||0}),I}function s(a){function c(b,a,r){a=b.css(a)||f;return r&&a===b.css(r)?l:n.test(a)?l:a}var g=G.tip.css("cssText","");a=a||B.corner;var n=/rgba?\(0, 0, 0(, 0)?\)|transparent|#123456/i,r="border-"+a[a.precedance]+"-color",
f="transparent",I=G.titlebar,e=I&&(a.y===V||a.y===O&&g.position().top+P.height/2+x.offset<I.outerHeight(u))?I:G.content;h(function(){d=c(g,"background-color")||c(e,"background-color")||c(G.content,"background-color")||c(w,"background-color")||g.css("background-color");k=c(g,r,"color")||c(e,r,"color")||c(G.content,r,"color")||c(w,r,"color")||w.css(r);b("*",g).add(g).css("cssText","background-color:"+f+" !important;border:0 !important;")})}function z(b){var a=b.precedance===X,c=P[a?M:Z],n=P[a?Z:M];
b=-1<b.string().indexOf(O);var r=c*(b?0.5:1),f=Math.pow,d=Math.round,g,e,m,v=Math.sqrt(f(r,2)+f(n,2)),r=[H/r*v,H/n*v];return r[2]=Math.sqrt(f(r[0],2)-f(H,2)),r[3]=Math.sqrt(f(r[1],2)-f(H,2)),g=v+r[2]+r[3]+(b?0:r[0]),e=g/v,m=[d(e*n),d(e*c)],{height:m[a?0:1],width:m[a?1:0]}}function g(b,a,c){return"<qvml:"+b+' xmlns="urn:schemas-microsoft.com:vml" class="qtip-vml" '+(a||"")+' style="behavior: url(#default#VML); '+(c||"")+'" />'}var B=this,x=a.options.style.tip,G=a.elements,w=G.tooltip,m={top:0,left:0},
P={width:x.width,height:x.height};k=d=void 0;var H=x.border||0,J=!!(b("<canvas />")[0]||{}).getContext;B.corner=N;B.mimic=N;B.border=H;B.offset=x.offset;B.size=P;a.checks.tip={"^position.my|style.tip.(corner|mimic|border)$":function(){B.init()||B.destroy();a.reposition()},"^style.tip.(height|width)$":function(){P={width:x.width,height:x.height};B.create();B.update();a.reposition()},"^content.title.text|style.(classes|widget)$":function(){G.tip&&G.tip.length&&B.update()}};b.extend(B,{init:function(){var c=
x.corner,d=a.options.position,g=d.at,d=d.my.string?d.my.string():d.my,c=(c===l||d===l&&g===l?l:(c===u?B.corner=new D.Corner(d):c.string||(B.corner=new D.Corner(c),B.corner.fixed=u),m.corner=new D.Corner(B.corner.string()),"centercenter"!==B.corner.string()))&&(J||b.browser.msie);return c&&(B.create(),B.update(),w.unbind(".qtip-tip").bind("tooltipmove.qtip-tip",E)),c},create:function(){var a=P.width,c=P.height,d;G.tip&&G.tip.remove();G.tip=b("<div />",{"class":"qtip-tip"}).css({width:a,height:c}).prependTo(w);
J?b("<canvas />").appendTo(G.tip)[0].getContext("2d").save():(d=g("shape",'coordorigin="0,0"',"position:absolute;"),G.tip.html(d+d),b("*",G.tip).bind("click mousedown",function(b){b.stopPropagation()}))},update:function(a,c){var e=G.tip,n=e.children(),r=P.width,f=P.height,I=x.mimic,v=Math.round,h,C,T,A;a||(a=m.corner||B.corner);I===l?I=a:(I=new D.Corner(I),I.precedance=a.precedance,"inherit"===I.x?I.x=a.x:"inherit"===I.y?I.y=a.y:I.x===I.y&&(I[a.precedance]=a[a.precedance]));a.precedance===ea?(P.width=
x.height,P.height=x.width):(P.width=x.width,P.height=x.height);G.tip.css({width:r=P.width,height:f=P.height});s(a);"transparent"!==k?(H=L(a,N),0===x.border&&0<H&&(d=k),B.border=H=x.border!==u?x.border:H):B.border=H=0;C=ma(I,r,f);B.size=A=z(a);e.css(A).css("line-height",A.height+"px");a.precedance===X?T=[v(I.x===Y?H:I.x===S?A.width-r-H:(A.width-r)/2),v(I.y===V?A.height-f:0)]:T=[v(I.x===Y?A.width-r:0),v(I.y===V?H:I.y===da?A.height-f-H:(A.height-f)/2)];J?(n.attr(A),h=n[0].getContext("2d"),h.restore(),
h.save(),h.clearRect(0,0,3E3,3E3),h.fillStyle=d,h.strokeStyle=k,h.lineWidth=2*H,h.lineJoin="miter",h.miterLimit=100,h.translate(T[0],T[1]),h.beginPath(),h.moveTo(C[0][0],C[0][1]),h.lineTo(C[1][0],C[1][1]),h.lineTo(C[2][0],C[2][1]),h.closePath(),H&&("border-box"===w.css("background-clip")&&(h.strokeStyle=d,h.stroke()),h.strokeStyle=k,h.stroke()),h.fill()):(C="m"+C[0][0]+","+C[0][1]+" l"+C[1][0]+","+C[1][1]+" "+C[2][0]+","+C[2][1]+" xe",T[2]=H&&/^(r|b)/i.test(a.string())?8===parseFloat(b.browser.version,
10)?2:1:0,n.css({coordsize:r+H+" "+(f+H),antialias:""+(-1<I.string().indexOf(O)),left:T[0],top:T[1],width:r+H,height:f+H}).each(function(a){var n=b(this);n[n.prop?"prop":"attr"]({coordsize:r+H+" "+(f+H),path:C,fillcolor:d,filled:!!a,stroked:!a}).toggle(!!H||!!a);!a&&""===n.html()&&n.html(g("stroke",'weight="'+2*H+'px" color="'+k+'" miterlimit="1000" joinstyle="miter"'))}));c!==l&&B.position(a)},position:function(a){var c=G.tip,d={},n=Math.max(0,x.offset),r,f,g;return x.corner===l||!c?l:(a=a||B.corner,
r=a.precedance,f=z(a),g=[a.x,a.y],r===ea&&g.reverse(),b.each(g,function(b,c){var g,I,e;c===O?(g=r===X?Y:V,d[g]="50%",d["margin-"+g]=-Math.round(f[r===X?M:Z]/2)+n):(g=L(a,c),I=L(a,c,G.content),e=y(a),d[c]=b?I:n+(e>g?e:-g))}),d[a[r]]-=f[r===ea?M:Z],c.css({top:"",bottom:"",left:"",right:"",margin:""}).css(d),d)},destroy:function(){G.tip&&G.tip.remove();G.tip=!1;w.unbind(".qtip-tip")}});B.init()}function fa(c){function e(){B=b(g,y).not("[disabled]").map(function(){return"function"==typeof this.focus?
this:null})}function k(a){1>B.length&&a.length?a.not("body").blur():B.first().focus()}function h(a){var c=b(a.target),d=c.closest(".qtip");!(1>d.length?l:parseInt(d[0].style.zIndex,10)>parseInt(y[0].style.zIndex,10))&&b(a.target).closest(ga)[0]!==y[0]&&k(c)}var A=this,E=c.options.show.modal,L=c.elements,y=L.tooltip,s=".qtipmodal"+c.id,z=b(a.body),g=D.modal.focusable.join(","),B={},x;c.checks.modal={"^show.modal.(on|blur)$":function(){A.init();L.overlay.toggle(y.is(":visible"))},"^content.text$":function(){e()}};
b.extend(A,{init:function(){return E.on?(x=A.create(),y.attr("is-modal-qtip",u).css("z-index",D.modal.zindex+b(ga+"[is-modal-qtip]").length).unbind(".qtipmodal").unbind(s).bind("tooltipshow.qtipmodal tooltiphide.qtipmodal",function(a,c,d){c=a.originalEvent;if(a.target===y[0])if(c&&"tooltiphide"===a.type&&/mouse(leave|enter)/.test(c.type)&&b(c.relatedTarget).closest(x[0]).length)try{a.preventDefault()}catch(g){}else(!c||c&&!c.solo)&&A[a.type.replace("tooltip","")](a,d)}).bind("tooltipfocus.qtipmodal",
function(a){if(!(a.isDefaultPrevented()||a.target!==y[0])){var c=b(ga).filter("[is-modal-qtip]"),d=D.modal.zindex+c.length,g=parseInt(y[0].style.zIndex,10);x[0].style.zIndex=d-2;c.each(function(){this.style.zIndex>g&&(this.style.zIndex-=1)});c.end().filter("."+ja).qtip("blur",a.originalEvent);y.addClass(ja)[0].style.zIndex=d;try{a.preventDefault()}catch(e){}}}).bind("tooltiphide.qtipmodal",function(a){a.target===y[0]&&b("[is-modal-qtip]").filter(":visible").not(y).last().qtip("focus",a)}),E.escape&&
b(a).unbind(s).bind("keydown"+s,function(a){27===a.keyCode&&y.hasClass(ja)&&c.hide(a)}),E.blur&&L.overlay.unbind(s).bind("click"+s,function(a){y.hasClass(ja)&&c.hide(a)}),e(),A):A},create:function(){function a(){x.css({height:g.height(),width:g.width()})}var c=b("#qtip-overlay"),g=b(d);return c.length?L.overlay=c.insertAfter(b(ga).last()):(x=L.overlay=b("<div />",{id:"qtip-overlay",html:"<div></div>",mousedown:function(){return l}}).hide().insertAfter(b(ga).last()),g.unbind(".qtipmodal").bind("resize.qtipmodal",
a),a(),x)},toggle:function(a,c,d){if(a&&a.isDefaultPrevented())return A;a=E.effect;var g=c?"show":"hide",e=x.is(":visible"),v=b("[is-modal-qtip]").filter(":visible").not(y);return x||(x=A.create()),x.is(":animated")&&e===c&&x.data("toggleState")!==l||!c&&v.length?A:(c?(x.css({left:0,top:0}),x.toggleClass("blurs",E.blur),E.stealfocus!==l&&(z.bind("focusin"+s,h),k(b("body :focus")))):z.unbind("focusin"+s),x.stop(u,l).data("toggleState",c),b.isFunction(a)?a.call(x,c):a===l?x[g]():x.fadeTo(parseInt(d,
10)||90,c?1:0,function(){c||b(this).hide()}),c||x.queue(function(a){x.css({left:"",top:""}).removeData("toggleState");a()}),A)},show:function(a,b){return A.toggle(a,u,b)},hide:function(a,b){return A.toggle(a,l,b)},destroy:function(){var d=x;return d&&(d=1>b("[is-modal-qtip]").not(y).length,d?(L.overlay.remove(),b(a).unbind(".qtipmodal")):L.overlay.unbind(".qtipmodal"+c.id),z.unbind("focusin"+s)),y.removeAttr("is-modal-qtip").unbind(".qtipmodal")}});A.init()}function J(c){var e=this,k=c.elements,h=
c.options,A=k.tooltip,E=".ie6-"+c.id,L=1>b("select, object").length,y=0,s=l,z;c.checks.ie6={"^content|style$":function(a,b,c){redraw()}};b.extend(e,{init:function(){var c=b(d),h;L&&(k.bgiframe=b('<iframe class="qtip-bgiframe" frameborder="0" tabindex="-1" src="javascript:\'\';"  style="display:block; position:absolute; z-index:-1; filter:alpha(opacity=0); -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";"></iframe>'),k.bgiframe.appendTo(A),A.bind("tooltipmove"+E,e.adjustBGIFrame));
z=b("<div/>",{id:"qtip-rcontainer"}).appendTo(a.body);e.redraw();k.overlay&&!s&&(h=function(){k.overlay[0].style.top=c.scrollTop()+"px"},c.bind("scroll.qtip-ie6, resize.qtip-ie6",h),h(),k.overlay.addClass("qtipmodal-ie6fix"),s=u)},adjustBGIFrame:function(){var a=c.get("dimensions"),b=c.plugins.tip,d=k.tip,e,v;v=parseInt(A.css("border-left-width"),10)||0;v={left:-v,top:-v};b&&d&&(e="x"===b.corner.precedance?["width","left"]:["height","top"],v[e[1]]-=d[e[0]]());k.bgiframe.css(v).css(a)},redraw:function(){if(1>
c.rendered||y)return e;var a=h.style,b=h.position.container,d,k,l,m;return y=1,a.height&&A.css(Z,a.height),a.width?A.css(M,a.width):(A.css(M,"").appendTo(z),k=A.width(),1>k%2&&(k+=1),l=A.css("max-width")||"",m=A.css("min-width")||"",d=-1<(l+m).indexOf("%")?b.width()/100:0,l=(-1<l.indexOf("%")?d:1)*parseInt(l,10)||k,m=(-1<m.indexOf("%")?d:1)*parseInt(m,10)||0,k=l+m?Math.min(Math.max(k,m),l):k,A.css(M,Math.round(k)).appendTo(b)),y=0,e},destroy:function(){L&&k.bgiframe.remove();A.unbind(E)}});e.init()}
var u=!0,l=!1,N=null,ea="x",X="y",M="width",Z="height",V="top",Y="left",da="bottom",S="right",O="center",Q="flipinvert",K="shift",R,D,ia,ca="qtip",oa={},ra=["ui-widget","ui-tooltip"],ga="div.qtip."+ca,qa=ca+"-default",ja=ca+"-focus",sa=ca+"-hover",ka="oldtitle",na;R=b.fn.qtip=function(a,c,d){var h=(""+a).toLowerCase(),A=N,E=b.makeArray(arguments).slice(1),L=E[E.length-1],y=this[0]?b.data(this[0],"qtip"):N;if(!arguments.length&&y||"api"===h)return y;if("string"==typeof a)return this.each(function(){var a=
b.data(this,"qtip");if(!a)return u;L&&L.timeStamp&&(a.cache.event=L);if("option"!==h&&"options"!==h||!c)a[h]&&a[h].apply(a[h],E);else{if(!b.isPlainObject(c)&&d===e)return A=a.get(c),l;a.set(c,d)}}),A!==N?A:this;if("object"==typeof a||!arguments.length)return y=k(b.extend(u,{},a)),R.bind.call(this,y,L)};R.bind=function(a,d){return this.each(function(k){function h(a){function c(){s.render("object"==typeof a||A.show.ready);E.show.add(E.hide).unbind(y)}if(s.cache.disabled)return l;s.cache.event=b.extend({},
a);s.cache.target=a?b(a.target):[e];0<A.show.delay?(clearTimeout(s.timers.show),s.timers.show=setTimeout(c,A.show.delay),L.show!==L.hide&&E.hide.bind(L.hide,function(){clearTimeout(s.timers.show)})):c()}var A,E,L,y,s;k=b.isArray(a.id)?a.id[k]:a.id;k=!k||k===l||1>k.length||oa[k]?R.nextid++:oa[k]=k;y=".qtip-"+k+"-create";s=la.call(this,k,a);if(s===l)return u;A=s.options;b.each(D,function(){"initialize"===this.initialize&&this(s)});E={show:A.show.target,hide:A.hide.target};L={show:b.trim(""+A.show.event).replace(/ /g,
y+" ")+y,hide:b.trim(""+A.hide.event).replace(/ /g,y+" ")+y};/mouse(over|enter)/i.test(L.show)&&!/mouse(out|leave)/i.test(L.hide)&&(L.hide+=" mouseleave"+y);E.show.bind("mousemove"+y,function(a){c(a);s.cache.onTarget=u});E.show.bind(L.show,h);(A.show.ready||A.prerender)&&h(d)}).attr("data-hasqtip",u)};D=R.plugins={Corner:function(a){a=(""+a).replace(/([A-Z])/," $1").replace(/middle/gi,O).toLowerCase();this.x=(a.match(/left|right/i)||a.match(/center/)||["inherit"])[0].toLowerCase();this.y=(a.match(/top|bottom|center/i)||
["inherit"])[0].toLowerCase();a=a.charAt(0);this.precedance="t"===a||"b"===a?X:ea;this.string=function(){return this.precedance===X?this.y+this.x:this.x+this.y};this.abbrev=function(){var a=this.x.substr(0,1),b=this.y.substr(0,1);return a===b?a:this.precedance===X?b+a:a+b};this.invertx=function(a){this.x=this.x===Y?S:this.x===S?Y:a||this.x};this.inverty=function(a){this.y=this.y===V?da:this.y===da?V:a||this.y};this.clone=function(){return{x:this.x,y:this.y,precedance:this.precedance,string:this.string,
abbrev:this.abbrev,clone:this.clone,invertx:this.invertx,inverty:this.inverty}}},offset:function(c,d){var e=c.offset(),k=c.closest("body"),h=b.browser.msie&&"CSS1Compat"!==a.compatMode,l=d,u,y,s;if(l){do"static"!==l.css("position")&&(y=l.position(),e.left-=y.left+(parseInt(l.css("borderLeftWidth"),10)||0)+(parseInt(l.css("marginLeft"),10)||0),e.top-=y.top+(parseInt(l.css("borderTopWidth"),10)||0)+(parseInt(l.css("marginTop"),10)||0),!u&&"hidden"!==(s=l.css("overflow"))&&"visible"!==s&&(u=l));while((l=
b(l[0].offsetParent)).length);if(u&&u[0]!==k[0]||h)k=u||k,e.left+=1*k.scrollLeft(),e.top+=1*k.scrollTop()}return e},iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||l,fn:{attr:function(a,c){if(this.length){var d=this[0],e=b.data(d,"qtip");if("title"===a&&e&&"object"==typeof e&&e.options.suppress)return 2>arguments.length?b.attr(d,ka):(e&&"title"===e.options.content.attr&&
e.cache.attr&&e.set("content.text",c),this.attr(ka,c))}return b.fn.attr_replacedByqTip.apply(this,arguments)},clone:function(a){b([]);var c=b.fn.clone_replacedByqTip.apply(this,arguments);return a||c.filter("["+ka+"]").attr("title",function(){return b.attr(this,ka)}).removeAttr(ka),c}}};b.each(D.fn,function(a,c){if(!c||b.fn[a+"_replacedByqTip"])return u;var d=b.fn[a+"_replacedByqTip"]=b.fn[a];b.fn[a]=function(){return c.apply(this,arguments)||d.apply(this,arguments)}});b.ui||(b.cleanData_replacedByqTip=
b.cleanData,b.cleanData=function(a){for(var c=0,d;(d=a[c])!==e;c++)try{b(d).triggerHandler("removeqtip")}catch(k){}b.cleanData_replacedByqTip(a)});R.version="2.0.1";R.nextid=0;R.inactiveEvents="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" ");R.zindex=15E3;R.defaults={prerender:l,id:l,overwrite:u,suppress:u,content:{text:u,attr:"title",deferred:l,title:{text:l,button:l}},position:{my:"top left",at:"bottom right",target:l,container:l,viewport:l,adjust:{x:0,y:0,mouse:u,resize:u,
method:"flipinvert flipinvert"},effect:function(a,c,d){b(this).animate(c,{duration:200,queue:l})}},show:{target:l,event:"mouseenter",effect:u,delay:90,solo:l,ready:l,autofocus:l},hide:{target:l,event:"mouseleave",effect:u,delay:0,fixed:l,inactive:l,leave:"window",distance:l},style:{classes:"",widget:l,width:l,height:l,def:u},events:{render:N,move:N,show:N,hide:N,toggle:N,visible:N,hidden:N,focus:N,blur:N}};D.svg=function(c,d,e,k){c=b(a);var h=d[0];d={width:0,height:0,position:{top:1E10,left:1E10}};
for(var l;!h.getBBox;)h=h.parentNode;if(h.getBBox&&h.parentNode){e=h.getBBox();k=h.getScreenCTM();h=h.farthestViewportElement||h;if(!h.createSVGPoint)return d;h=h.createSVGPoint();h.x=e.x;h.y=e.y;l=h.matrixTransform(k);d.position.left=l.x;d.position.top=l.y;h.x+=e.width;h.y+=e.height;l=h.matrixTransform(k);d.width=l.x-d.position.left;d.height=l.y-d.position.top;d.position.left+=c.scrollLeft();d.position.top+=c.scrollTop()}return d};D.ajax=function(a){var b=a.plugins.ajax;return"object"==typeof b?
b:a.plugins.ajax=new ba(a)};D.ajax.initialize="render";D.ajax.sanitize=function(a){var b=a.content,c;b&&"ajax"in b&&(c=b.ajax,"object"!=typeof c&&(c=a.content.ajax={url:c}),"boolean"!=typeof c.once&&c.once&&(c.once=!!c.once))};b.extend(u,R.defaults,{content:{ajax:{loading:u,once:u}}});D.tip=function(a){var b=a.plugins.tip;return"object"==typeof b?b:a.plugins.tip=new W(a)};D.tip.initialize="render";D.tip.sanitize=function(a){var b=a.style,c;b&&"tip"in b&&(c=a.style.tip,"object"!=typeof c&&(a.style.tip=
{corner:c}),/string|boolean/i.test(typeof c.corner)||(c.corner=u),"number"!=typeof c.width&&delete c.width,"number"!=typeof c.height&&delete c.height,"number"!=typeof c.border&&c.border!==u&&delete c.border,"number"!=typeof c.offset&&delete c.offset)};b.extend(u,R.defaults,{style:{tip:{corner:u,mimic:l,width:6,height:6,border:u,offset:0}}});D.modal=function(a){var b=a.plugins.modal;return"object"==typeof b?b:a.plugins.modal=new fa(a)};D.modal.initialize="render";D.modal.sanitize=function(a){a.show&&
("object"!=typeof a.show.modal?a.show.modal={on:!!a.show.modal}:"undefined"==typeof a.show.modal.on&&(a.show.modal.on=u))};D.modal.zindex=R.zindex-200;D.modal.focusable="a[href] area[href] input select textarea button iframe object embed [tabindex] [contenteditable]".split(" ");b.extend(u,R.defaults,{show:{modal:{on:l,effect:u,blur:u,stealfocus:u,escape:u}}});D.viewport=function(b,c,e,k,h,l,u){function y(a,b,r,f,d,e,k,h,l){var t=c[d],s=g[a],u=B[a],w=r===K,y=-D.offset[d]+m.offset[d]+m["scroll"+d],
x=s===d?l:s===e?-l:-l/2,z=H&&H.size?H.size[k]||0:0,A=H&&H.corner&&H.corner.precedance===a&&!w?z:0,C=y-t+A;l=t+l-m[k]-y+A;h=x-(g.precedance===a||s===g[b]?u===d?h:u===e?-h:-h/2:0)-(u===O?h/2:0);return w?(A=H&&H.corner&&H.corner.precedance===b?z:0,h=(s===d?1:-1)*x-A,c[d]+=0<C?C:0<l?-l:0,c[d]=Math.max(-D.offset[d]+m.offset[d]+(A&&H.corner[a]===O?H.offset:0),t-h,Math.min(Math.max(-D.offset[d]+m.offset[d]+m[k],t+h),c[d]))):(f*=r===Q?2:0,0<C&&(s!==d||0<l)?(c[d]-=h+f,q["invert"+a](d)):0<l&&(s!==e||0<C)&&
(c[d]-=(s===O?-h:h)+f,q["invert"+a](e)),c[d]<y&&-c[d]>l&&(c[d]=t,q=g.clone())),c[d]-t}var s=e.target,z=b.elements.tooltip,g=e.my,B=e.at,x=e.adjust,G=x.method.split(" "),w=G[0],G=G[1]||G[0],m=e.viewport,D=e.container;e=b.cache;var H=b.plugins.tip,J={left:0,top:0},q,t;if(!m.jquery||s[0]===d||s[0]===a.body||"none"===x.method)return J;s="fixed"===z.css("position");m={elem:m,height:m[(m[0]===d?"h":"outerH")+"eight"](),width:m[(m[0]===d?"w":"outerW")+"idth"](),scrollleft:s?0:m.scrollLeft(),scrolltop:s?
0:m.scrollTop(),offset:m.offset()||{left:0,top:0}};D={elem:D,scrollLeft:D.scrollLeft(),scrollTop:D.scrollTop(),offset:D.offset()||{left:0,top:0}};if("shift"!==w||"shift"!==G)q=g.clone();return J={left:"none"!==w?y(ea,X,w,x.x,Y,S,M,k,l):0,top:"none"!==G?y(X,ea,G,x.y,V,da,Z,h,u):0},q&&e.lastClass!==(t=ca+"-pos-"+q.abbrev())&&z.removeClass(b.cache.lastClass).addClass(b.cache.lastClass=t),J};D.imagemap=function(a,c,d,e){function k(a,b,c){for(var d=0,e=1,g=1,h=0,l=0,s=a.width,n=a.height;0<s&&0<n&&0<e&&
0<g;){s=Math.floor(s/2);n=Math.floor(n/2);c.x===Y?e=s:c.x===S?e=a.width-s:e+=Math.floor(s/2);c.y===V?g=n:c.y===da?g=a.height-n:g+=Math.floor(n/2);for(d=b.length;d--&&!(2>b.length);)h=b[d][0]-a.position.left,l=b[d][1]-a.position.top,(c.x===Y&&h>=e||c.x===S&&h<=e||c.x===O&&(h<e||h>a.width-e)||c.y===V&&l>=g||c.y===da&&l<=g||c.y===O&&(l<g||l>a.height-g))&&b.splice(d,1)}return{left:b[0][0],top:b[0][1]}}c.jquery||(c=b(c));a=a.cache.areas={};var h=(c[0].shape||c.attr("shape")).toLowerCase(),l=c[0].coords||
c.attr("coords"),u=l.split(","),s=[];c=b('img[usemap="#'+c.parent("map").attr("name")+'"]');var z=c.offset(),g={width:0,height:0,position:{top:1E10,right:0,bottom:0,left:1E10}},B=0,x=0;z.left+=Math.ceil((c.outerWidth()-c.width())/2);z.top+=Math.ceil((c.outerHeight()-c.height())/2);if("poly"===h)for(B=u.length;B--;)x=[parseInt(u[--B],10),parseInt(u[B+1],10)],x[0]>g.position.right&&(g.position.right=x[0]),x[0]<g.position.left&&(g.position.left=x[0]),x[1]>g.position.bottom&&(g.position.bottom=x[1]),
x[1]<g.position.top&&(g.position.top=x[1]),s.push(x);else for(B=-1;B++<u.length;)s.push(parseInt(u[B],10));switch(h){case "rect":g={width:Math.abs(s[2]-s[0]),height:Math.abs(s[3]-s[1]),position:{left:Math.min(s[0],s[2]),top:Math.min(s[1],s[3])}};break;case "circle":g={width:s[2]+2,height:s[2]+2,position:{left:s[0],top:s[1]}};break;case "poly":g.width=Math.abs(g.position.right-g.position.left),g.height=Math.abs(g.position.bottom-g.position.top),"c"===d.abbrev()?g.position={left:g.position.left+g.width/
2,top:g.position.top+g.height/2}:(a[d+l]||(g.position=k(g,s.slice(),d),e&&("flip"===e[0]||"flip"===e[1])&&(g.offset=k(g,s.slice(),{x:d.x===Y?S:d.x===S?Y:O,y:d.y===V?da:d.y===da?V:O}),g.offset.left-=g.position.left,g.offset.top-=g.position.top),a[d+l]=g),g=a[d+l]),g.width=g.height=0}return g.position.left+=z.left,g.position.top+=z.top,g};D.ie6=function(a){var c=b.browser,d=a.plugins.ie6;return!c.msie||"6"!==(""+c.version).charAt(0)?l:"object"==typeof d?d:a.plugins.ie6=new J(a)};D.ie6.initialize="render"})})(window,
document);var attask=function(){function d(a){var b={url:"https://www.atappstore.com/api/authorize/",data:{product:g.get("qr")?"shiftwatch-qr":"stopwatch",host:g.get("host"),sessionID:g.get("sessionID"),user:g.get("username"),domain:g.get("domain")},type:"GET",dataType:"json"};M(b);b=jQuery.ajax(b);b.done(function(b,c,r){!1!=b.success&&(g.set("auth_key",b.auth_key),g.set("access",b.access),g.set("is_auth",b.is_auth),g.set("license_expiry_days",b.license_expiry_days),g.get("qr")&&(g.set("view","team"),g.set("sort",
"project"),g.set("logout_on_select",!0),g.set("multi",!0),g.set("hide_team_done",!0),g.set("minuteBuffer",30),g.set("minuteBufferSnapToSched",!0),TASK_DB.userId=g.get("userID")),g.get("minuteBufferSnapToSched")&&ka(),g.get("restrict_sched")?ka(function(b){var c;void 0==b&&(c="Today is not a work day");var f=new Date,f=Date.parse("01/01/2011 "+f.getHours()+":"+f.getMinutes()),r=Date.parse("01/01/2011 "+b.start),d=Date.parse("01/01/2011 "+b.stop),e=g.get("minuteBuffer");null!=e&&(r.setMinutes(r.getMinutes()-
e),d.setMinutes(d.getMinutes()+e));void 0==b||r>f||f>d?(c=c?c:"Please return at "+b.start,TASK_CNTRL.showWindow('<h3><div style="text-align: center; font-weight: bold;">Not scheduled to work</div></h3><div class="content"><p>'+c+'.</p><a href="#" class="btn btn-primary logout cancel" title="Logout">Logout</a></div>')):a()}):(a&&a(),la()))});b.fail(function(a,b,c){})}function a(){var c={url:K()+"user/count",type:"get",data:{sessionID:g.get("sessionID")},dataType:"json"};M(c);c=jQuery.ajax(c);c.done(function(a){void 0!=
a.error?(a.error["class"]==s[0]?J(function(){}):b(z[0],"uCount,"+JSON.stringify(a.error)),t.hide(),q.hide()):(a=a.data,b(z[1],{uc:a.count}))});c.fail(function(b,c,n){Q({response:b.responseText,type:c,msg:n},a,"uCount")})}function e(){var a={url:K()+"user/search?ID=$$USER.ID&fields=customer:name,customer:fullUsers,customer:limitedUsers,customer:teamUsers",type:"get",data:{sessionID:g.get("sessionID")},dataType:"json"};M(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==s[0]?
J(function(){}):b(z[0],"uInfo,"+JSON.stringify(a.error)),t.hide(),q.hide()):(a=a.data,b(z[1],a))});a.fail(function(a,b,c){Q({response:a.responseText,type:b,msg:c},e,"uInfo")})}function b(a,c,f){var e={url:"https://www.atappstore.com/api/appevent/",data:{auth_key:g.get("auth_key"),message_type:a,message:JSON.stringify(c),method:"post"},type:"POST",dataType:"json"};M(e);e=jQuery.ajax(e);e.done(function(e){e.success?f&&f():"unauthorized"==e.reason&&d(function(){b(a,c,f)})});e.fail(function(a,b,c){})}
function c(){if((B||x||"full"==getQueryString().view)&&void 0!=g.get("host"))clearInterval(H),H=self.setInterval(function(){if(!document.hasFocus()||x)jQuery("#search-bar").is(":visible")&&jQuery("#search").click(),jQuery("#form-list").hide(),void 0==g.get("sessionID")?W():k()||S()},12E4)}function k(){var a=new Date,b=!1;g.get("date")!=a.getDay()&&(jQuery("#form-list").empty(),g.set("notified",!1),TASK_DB.dropTaskTable(),TASK_DB.createDB(),jQuery("#todayDate").html("Date: "+ea(a.getMonth())+" "+a.getDate()),
g.set("date",a.getDay()),b=!0);da();return b}function h(){var a=g.get("view");void 0==a||"current"==a?R("task",function(){jQuery("#button-current").click()}):"requested"==a?R("task",function(){jQuery("#button-requested").click()}):"all"==a?jQuery("#button-all").click():"team"==a?jQuery("#button-team").click():"role"==a?jQuery("#button-role").click():"recent"==a&&jQuery("#button-recent").click()}function la(){if(""==g.get("access")&&!g.get("notified")){g.set("notified",!0);var c='<h3><div style="text-align: center; font-weight: bold;">Expired for '+
g.get("host")+'</div></h3><div class="content"><div><p>To keep the ease of tracking your time, see due dates, and completing your tasks, please visit our site below to see licencing options for your company or to arrange an extended demo. If seeing this for the first time, another employee at your company has used this service 30 days ago, please contact info@atappstore.com to extend.</p></div><a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank"><img src="icons/AtAppStore.png" style=""></a><div style="font-size: 10px;">* this notification will only appear once daily.</div></div><div id="close" class="btn btn-primary" style="width:230px"><h3 style="line-height:0px">close</h3></div>';
TASK_CNTRL.showWindow(c);jQuery("#close").unbind("click").click(function(a){a.preventDefault();TASK_CNTRL.hideWindow()});var c=g.get("userObj"),d=g.get("license_expiry_days");b(z[1],{os:BrowserDetect.OS,browser:BrowserDetect.browser,version:BrowserDetect.version,extension:!B,user:c,license_expiry_days:d});a();e()}}function ba(){var a=jQuery("#content");a.after('<form id="form-qrlogin" class="form" style="display: none"><h3>Login to Workfront</h3><span class="error"></span><p><div id="outdiv" style="text-align:center;"></div><canvas id="qr-canvas" width="640" height="480" style="display:none;"></canvas><h4 id="result" style="text-align:center;"></h4><button type="submit" class="btn btn-success needsclick" style="display:none;" id="button-appscan" value="scan" tabindex="3">Scan</button><button type="submit" class="btn needsclick" style="" id="button-standard" tabindex="5">Standard Login</button><button type="submit" class="btn btn-primary needsclick" style="display:none;" id="button-qrlogin" value="login" tabindex="4">Login</button></form><div class="spinner-bottom"><div id="blockG_1" class="metro_blockG"></div><div id="blockG_2" class="metro_blockG"></div><div id="blockG_3" class="metro_blockG"></div></div>');
jQuery("#button-standard").live("click",function(a){a.preventDefault();l();jQuery("#form-qrlogin").show()});jQuery("#button-appscan").live("click",function(a){a.preventDefault();a=window.navigator.userAgent;a.match(/iPad/i)||a.match(/iPhone/i)?window.location="zxing://scan/?ret="+encodeURIComponent(window.location+"&code={CODE}"):window.location="http://zxing.appspot.com/scan?ret="+encodeURIComponent(window.location+"&code={CODE}")});a.after('<form id="form-login" class="form" style="display: none"><h3>Login to Workfront</h3><span class="error"></span><p><label for="username">Username</label><input type="text" name="username" id="username" class="text" tabindex="1"/></p><p><label for="password">Password</label><input type="password" name="password" id="password" class="text" tabindex="2" autocomplete="off"/></p><p><label for="host">Subdomain</label><input type="text" name="host" id="host" class="text" tabindex="3"/></p><p>eg. <strong>Subdomain</strong>.attask-ondemand.com</p></p></br><button type="submit" class="btn btn-primary needsclick" id="button-login" value="login" tabindex="4">Login</button><div class="spinner-bottom"><div id="blockG_1" class="metro_blockG"></div><div id="blockG_2" class="metro_blockG"></div><div id="blockG_3" class="metro_blockG"></div></div></form>');
a='<div id="hourTypeWindow" class="window"><h3><div style="text-align: center; font-weight: bold;">Track as Type:</div></h3><div class="content"><div><select id="hourTypeSelector" ></select><div><a href="#" id="done_hourType" class="btn btn-primary" rel="'+jQuery(this).attr("rel")+'" title="Done">Done</a><div></div>';jQuery("#window").after(a);if(B||"full"==getQueryString().view||x)jQuery("#popout").replaceWith('<span id="refresh" style="float: right;" title="Manual Refresh"><img src="core/img/refresh.gif"></span>'),
jQuery("html").css("width","100%"),jQuery("#refresh").live("click",function(a){a.preventDefault();jQuery("#form-list").hide();jQuery("#search-bar").is(":visible")&&jQuery("#search").click();S()});a=new Date;a='<div class="btn-group"><a id="filter" title="Filter for other assigned tasks and issues" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">Filters<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="#" id="button-current" title="Tasks and issues you\'re working on" >Current</a></li><li><a href="#" id="button-recent" title="All tasks and issues tracked within 14 days" >Recent</a></li><li><a href="#" id="button-requested" title="Tasks and issues you can start on" >Requested</a></li><li><a href="#" id="button-all" title="All tasks and issues assigned to you" >All Assigned</a></li><li><a href="#" id="button-team" title="All tasks and issues assigned to your Teams" >Team Assigned</a></li><li><a href="#" id="button-role" title="All tasks and issues available to your Roles" >Role Assigned</a></li><li><a href="#" class="logout" id="button-logout" >Login as New User</a></li></ul></div><span id="totalHours" title="Go To Timesheets" class="btn" style="">Today\'s Hours: 0</span><span id="todayDate" class="btn disabled" style="">Date: '+
ea(a.getMonth())+" "+a.getDate()+"</span>";jQuery("#bar").html(a);jQuery("#totalHours").live("click",function(a){a.preventDefault();a="https://"+g.get("host")+"."+g.get("domain")+"/timesheets/current";x?window.open(a,"_blank","location=yes"):window.open(a);return!1});jQuery("#sort-task").live("click",function(a){a.preventDefault();F.priority="asc";F.project=F.date=F.priority="desc";F.task="asc"==F.task?"desc":"asc";jQuery("div#form-list>div").tsort({order:F.task})});jQuery("#sort-project").live("click",
function(a){a.preventDefault();F.priority="asc";F.task=F.date=F.priority="desc";F.project="asc"==F.project?"desc":"asc";jQuery("div#form-list>div").tsort(".details",{order:F.project})});jQuery("#sort-date").live("click",function(a){a.preventDefault();F.priority="asc";F.task=F.project="desc";F.date="asc"==F.date?"desc":"asc";jQuery("div#form-list>div").tsort(".days",{order:F.date,useVal:!0,attr:"data-days"})});jQuery("#sort-priority").live("click",function(a){a.preventDefault();F.task=F.project=F.date=
"desc";F.priority="asc"==F.priority?"desc":"asc";jQuery("div#form-list>div").tsort(".priority",{order:F.priority,useVal:!0,attr:"data-priority"})});jQuery(".done").live("click",function(a){a.preventDefault();a=jQuery(this).parent().parent().children("span.name").attr("title");var b=jQuery(this).parent().parent().children("span.details").attr("title");a='<h3><div style="text-align: center; font-weight: bold;">Confirm</div></h3><div class="content"><div><p>Are you sure you completed <strong>'+a+"</strong><br>from <br><strong>"+
b+'?</strong></h3><div><a href="#" id="done_confirm" class="btn btn-primary" rel="'+jQuery(this).attr("rel")+'" title="Done">Done</a><a href="#" class="btn cancel" title="Cancel">Cancel</a><div>';TASK_CNTRL.showWindow(a)});jQuery("#done_confirm").live("click",function(a){a.preventDefault();TASK_DB.updateValidate(jQuery(this).attr("rel"),function(a){C(a)});TASK_CNTRL.hideWindow()});jQuery("#cancel_confirm").live("click",function(a){a.preventDefault();TASK_CNTRL.hideWindow()});jQuery(".percent").live("click",
function(a){a.preventDefault();jQuery("#form-list").scrollTop(jQuery("#form-list").scrollTop()+jQuery("#item"+jQuery(this).attr("rel")).offset().top-100);if(0==jQuery(this).children("input").length){var b=jQuery(this).text().slice(0,-1);jQuery(this).html("<input type='number' class='inputbox' value=\""+b+'">');var c=function(a){var c=Number(jQuery(a).val()).toFixed(0);isNaN(c)||0>c||100<c||b==c?c=b:TASK_DB.updateValidate(jQuery(a).parent().attr("rel"),function(a){E(a,c)});jQuery(a).parent().text(c+
"%")};jQuery("input.inputbox").focus().blur(function(){c(this)}).keypress(function(a){13==a.which&&(c(this),a.preventDefault())})}});jQuery("#form-list").scroll(function(){g.set("vpos",jQuery("#form-list").scrollTop())});q=jQuery(".spinner-bottom");t=jQuery(".spinner")}function ma(){var a=function(a){jQuery("#button-current").removeClass("btn");jQuery("#button-requested").removeClass("btn");jQuery("#button-all").removeClass("btn");jQuery("#button-team").removeClass("btn");jQuery("#button-role").removeClass("btn");
jQuery("#button-recent").removeClass("btn");ia();jQuery(a).toggleClass("btn")};jQuery("#button-current").live("click",function(){F=[];a("#button-current");g.set("view","current");ga()});jQuery("#button-requested").live("click",function(){F=[];a("#button-requested");g.set("view","requested");qa()});jQuery("#button-all").live("click",function(){F=[];a("#button-all");g.set("view","all");R()});jQuery("#button-team").live("click",function(){F=[];a("#button-team");g.set("view","team");ca()});jQuery("#button-role").live("click",
function(){F=[];a("#button-role");g.set("view","role");D()});jQuery("#button-recent").live("click",function(){F=[];a("#button-recent");g.set("view","recent");ra()});jQuery(".logout").live("click",function(){W()})}function W(){if(m&&g.get("allowOffline"))g.remove("sessionID"),g.remove("userID"),g.remove("username"),g.remove("password"),g.remove("host"),g.remove("domain");else{var a=g.get("qr");g.removeAll();g.set("qr",a)}for(var b in TASK_CNTRL.intervals)window.clearInterval(TASK_CNTRL.intervals[b]);
g.get("qr")?u(void 0):l(void 0)}function fa(a){TASK_DB.loadAll(function(b){var c=b.length,d,e;if(0<c)for(d=0;d<c;d++)e=b[d],(null!=e&&"OPTASK"==e.details.objCode||"TASK"==e.details.objCode)&&jQuery("#item"+e.ID).hide();a()})}function J(a){V(g.get("username"),g.get("password"),Z(g.get("host")+"."+g.get("domain")),a,function(){g.get("qr")?u(a):l(a)})}function u(a){t.show();jQuery("#loading").hide();clearInterval(H);TASK_DB.dropTaskTable();TASK_DB.createDB();TASK_CNTRL.toggleRunText();resetForQR();t.hide();
q.hide();jQuery("#top-bar").hide();jQuery("#bar").hide();jQuery(".form").hide();jQuery("webcamimg").show();var b=jQuery("#form-qrlogin");jQuery("#form-list").html("");x?b.show():b.slideDown(400,function(){});jQuery("#button-qrlogin").unbind("click").click(function(b){var c=jQuery("#form-qrlogin");b.preventDefault();q.show();V(g.get("username"),g.get("password"),Z(g.get("host")),function(){ignoreForQR();jQuery("#bar").show();x?c.hide():c.slideUp();jQuery("#top-bar").show();jQuery("#loading").show();
void 0!=a&&a()},function(){resetForQR()})})}function l(a){t.show();jQuery("#loading").hide();clearInterval(H);TASK_DB.dropTaskTable();TASK_DB.createDB();TASK_CNTRL.toggleRunText();t.hide();q.hide();jQuery("#top-bar").hide();jQuery("#bar").hide();jQuery(".form").hide();var b=jQuery("#form-login"),c=g.get("domain"),d=g.get("host");b.find(":input[name='username']").focus().val("");b.find(":input[name='host']").val(void 0==d||"undefined"==d?"":"attask-ondemand.com"!=c?d+"."+c:d);b.find(":input[name='password']").val("");
jQuery("#form-list").html("");var e=jQuery("#username");x?(b.show(),e.focus()):b.slideDown(400,function(){e.focus()});jQuery("#button-login").unbind("click").click(function(c){c.preventDefault();q.show();V(jQuery.trim(b.find(":input[name='username']").val()),jQuery.trim(b.find(":input[name='password']").val()),Z(jQuery.trim(b.find(":input[name='host']").val())),function(){jQuery("#bar").show();x?b.hide():b.slideUp();jQuery("#top-bar").show();jQuery("#loading").show();void 0!=a&&a()})})}function N(a,
b){var c=new Date;a.dateStr=c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate();a.duration=b;m&&g.get("allowOffline")?(a.username=g.get("username"),a.userID=g.get("userID"),c=g.get("offlineTasks"),void 0==c&&(c=[]),c.push(a),g.set("offlineTasks"),t.hide(),q.hide(),!0==g.get("logout_on_select")&&W()):y(a,L)}function ea(a){return"jan. feb. mar. apr. may june jul. aug. sep. oct. nov. dec.".split(" ")[a]}function X(a){return void 0!=a.details.project?a.details.project.name.split(",").join(" ")+","+a.name.split(",").join(" "):
a.details}function M(a,b){void 0==b&&(b=1E4);a.timeout=b;B&&(!x&&!G)&&(a.dataType="jsonp",a.crossDomain=!0,a.jsonp="jsonp",a.cache=!0)}function Z(a){if(1<a.split(".").length){var b=a.split("//");return 1<b.length?(b.shift(),b[0]):a}return a+".attask-ondemand.com"}function V(a,b,f,e,k){if(void 0==a||void 0==b||void 0==f)k();else{var h=jQuery(".error");h.html("");var l={url:"https://"+f+"/attask/api/v2.0/login",type:"get",data:{username:a,password:b},dataType:"json"};M(l);m?g.get("allowOffline")?(l=
g.get(a),void 0!=l?(Y(l.sessionID,l.userID,l.username,l.password,f),q.hide(),S(),c(),void 0!=e&&e()):h.html("OFFLINE")):h.html("OFFLINE"):(l=jQuery.ajax(l),l.done(function(l){void 0!=l.error?(g.get("qr")?h.html("Please Scan Again."):h.html(l.error.message),q.hide(),void 0!==k&&k()):(l=l.data,Y(l.sessionID,l.userID,a,b,f),g.set("userObj",JSON.stringify(l)),q.hide(),d(function(){S();c();void 0!=e&&e()}))}),l.fail(function(a,b,c){a.responseText&&""!==a.responseText?-1!=a.responseText.indexOf("<html>")?
g.get("qr")?h.html("Please Scan Again."):h.html("Host Invalid: "+f):g.get("qr")?h.html("Please Scan Again."):h.html(JSON.parse(a.responseText).error.message):g.get("qr")?h.html("Please Scan Again."):h.html("Host Invalid: "+f);q.hide();void 0!==k&&k()}))}}function Y(a,b,c,d,e){g.set("sessionID",a);g.set("userID",b);g.set("username",c);g.set("password",d);e=e.split(".");g.set("host",e[0]);e.shift();g.set("domain",e.join("."));g.get("allowOffline")&&g.set(c,{sessionID:a,userID:b,username:c,password:d})}
function da(){var a=g.get("sessionID");void 0==a||""==a?J():(t.show(),a={url:K()+"user/"+g.get("userID")+"?updates={isActive: true}&sessionID="+a,type:"PUT",dataType:"json"},B&&(a.data={method:"put"},M(a)),a=jQuery.ajax(a),a.done(function(a){void 0!=a.error?(a.error["class"]==s[0]?J():b(z[0],"sessionValid,"+g.get("sessionID")+","+JSON.stringify(a.error)),t.hide(),q.hide()):(t.hide(),q.hide(),void 0==g.get("auth_key")?d(S):S())}),a.fail(function(a,c,d){401==a.status?J():"timeout"==c?da():b(z[0],"sessionValid,"+
g.get("sessionID")+","+a.responseText)}))}function S(){t.show();var a=g.get("userID"),c={url:"https://"+g.get("host")+"."+g.get("domain")+"/attask/api-unsupported/timeSheet/search",type:"get",data:{startDate:"$$TODAY+1",startDate_Mod:"lte",endDate:"$$TODAY-1",endDate_Mod:"gte",fields:"timesheetProfile:hourTypes:ID,timesheetProfile:hourTypes:name,timesheetProfile:hourTypes:description,timesheetProfile:hourTypes:isActive",sessionID:g.get("sessionID"),userID:a},dataType:"json"};M(c,35E3);m?g.get("allowOffline")?
(a=TASK_DB.userRunningTasks(a),void 0!=a&&(ha=!0,TASK_DB.insert(a.name,{syncID:a.syncID,details:a.details},!0))):TASK_CNTRL.displayError("OFFLINE"):(a=jQuery.ajax(c),a.done(function(a){if(void 0!=a.error)a.error["class"]==s[0]?J(function(){S()}):b(z[0],"addGeneralTasks-done,"+JSON.stringify(a.error));else if(a=a.data,0!=a.length&&void 0!=a[0].timesheetProfile&&void 0!=a[0].timesheetProfile.hourTypes){if(0!=a[0].timesheetProfile.hourTypes.length){var c=0;a=a[0].timesheetProfile.hourTypes;for(var d in a)a.hasOwnProperty(d)&&
!0==a[d].isActive&&(c++,TASK_DB.insert(a[d].name,{syncID:a[d].ID,details:{objCode:"GEN",description:null!=a[d].description?"General - "+a[d].description:"'General"}},0))}h();na();ja()}else O()}),a.fail(function(a,b,d){Q({response:a.responseText,type:b,msg:d,status:a.status},S,"addGeneralTasks-fail"+b+"-"+d+" "+a.responseText+" "+a.status+" "+JSON.stringify(c))}))}function O(){t.show();var a={url:K()+"HourType/search",type:"get",data:{fields:"ID,name,description",isActive:!0,sessionID:g.get("sessionID")},
dataType:"json"};M(a,35E3);var c=jQuery.ajax(a);c.done(function(a){if(void 0!=a.error)a.error["class"]==s[0]?J(function(){O()}):b(z[0],"addAllGeneralTasks-done,"+JSON.stringify(a.error));else{a=a.data;var c=0,d;for(d in a)a.hasOwnProperty(d)&&("Task Time"!=a[d].name&&"Issue Time"!=a[d].name)&&(c++,TASK_DB.insert(a[d].name,{syncID:a[d].ID,details:{objCode:"GEN",description:null!=a[d].description?"General - "+a[d].description:"'General"}},0));h();na();ja()}});c.fail(function(b,c,d){Q({response:b.responseText,
type:c,msg:d,status:b.status},O,"addAllGeneralTasks-fail"+c+"-"+d+" "+b.responseText+" "+b.status+" "+JSON.stringify(a))})}function Q(a,c,f,d){if(401==a.status)J(function(){c()});else if("timeout"==a.type)c();else{if(void 0!=a.response&&""!=a.response){var e;e="message"in a.response?a.response.message:JSON.stringify(a.response);TASK_CNTRL.displayError("Workfront Error: "+e+"<br>"+(void 0!=d&&""!=d?d:""))}b(z[0],f+","+a.msg+" "+a.type+" "+JSON.stringify(a.response)+" "+d)}}function K(a){void 0==a&&
(a="v5.0");return"https://"+g.get("host")+"."+g.get("domain")+"/attask/api/"+a+"/"}function R(a,c){a=void 0==a?"task":a;t.show();var f={url:K()+a+"/search",type:"get",data:{canStart:!0,status:"N",status_Mod:"contains","project:status":"CUR",fields:"parent,priority,project,plannedCompletionDate,permissions","assignments:status":"DN","assignments:status_Mod":"ne",$$LIMIT:2E3,sessionID:g.get("sessionID")},dataType:"json"},d=g.get("currentRole");"role"==g.get("view")&&void 0!=d?f.data.roleID=d.ID:f.data["assignments:assignedToID"]=
g.get("userID");"task"==a&&(f.data.fields+=",percentComplete");M(f);f=jQuery.ajax(f);f.done(function(f){if(void 0!=f.error)f.error["class"]==s[0]?J(function(){R(a,c)}):b(z[0],"addAllAssignedTasks-"+a+","+JSON.stringify(f.error)),t.hide(),q.hide();else{f=f.data;var d=!0,e=g.get("view");"all"!=e&&"role"!=e&&(d=!1);if("optask"!=a)R("optask",c),fa(function(){var a=f.length;if(a)for(var b=0;b<a;b++)-1!=f[b].permissions.actions.indexOf("ADD_HOURS")&&-1!=f[b].permissions.actions.indexOf("CHANGE_STATUS")&&
TASK_DB.insert(f[b].name,{syncID:f[b].ID,details:f[b]},d&&b==a-1)});else{e=f.length;ha=d;if(e)for(var h=0;h<e;h++)-1!=f[h].permissions.actions.indexOf("ADD_HOURS")&&-1!=f[h].permissions.actions.indexOf("CHANGE_STATUS")&&TASK_DB.insert(f[h].name,{syncID:f[h].ID,details:f[h]},d&&h==e-1);else TASK_CNTRL.showAll(f);c&&c()}}});f.fail(function(a,b,c){Q({response:a.responseText,type:b,msg:c},R,"addAllAssignedTasks-fail"+b+"-"+c+" "+a.responseText)})}function D(a){t.show();var c={url:K("v5.0")+"user/search",
type:"get",data:{fields:"role:*,roles:*",ID:g.get("userID")},dataType:"json"};M(c);c=jQuery.ajax(c);c.done(function(c){if(void 0!=c.error)c.error["class"]==s[0]?J(function(){D(a)}):b(z[0],"addAllRoleTasks,"+JSON.stringify(c.error)),t.hide(),q.hide();else if(c=c.data[0],0==c.length)a&&a(),t.hide(),q.hide();else{var d=jQuery("#role-filter"),e=function(){R("task",function(){d.css("display","inline-block");t.hide();q.hide()})},r=function(a,b){g.set("currentRole",{name:a,ID:b});d.find("button").html("<strong>Role: </strong><span>"+
a+'</span><span class="caret"></span>');e()},h=g.get("currentRole");void 0!=h?r(h.name,h.ID):void 0!=c.role&&r(c.role.name,c.role.ID);if(void 0!=c.roles&&0!=c.roles.length)for(var h=d.find(".dropdown-menu").html("").first(),k=0,l=c.roles.length;k<l;k++)h.append('<li><a href="#" id="'+c.roles[k].ID+'">'+c.roles[k].name+"</a></li>"),h.find("#"+c.roles[k].ID).click(function(){r(jQuery(this).text(),jQuery(this).attr("id"))});else ia(),t.hide(),q.hide(),jQuery("#button-current").click(),TASK_CNTRL.showWindow('<h3><div style="text-align: center; font-weight: bold;">Roles</div></h3><div class="content"><div><p>No additional roles available.</strong></h3><div><a href="#" class="btn btn-primary cancel" title="Ok">Ok</a><div>')}});
c.fail(function(a,b,c){Q({response:a.responseText,type:b,msg:c},D,"addAllRoleTasks")})}function ia(){var a=jQuery("#role-filter");a.hide();a.find(".dropdown-menu").first().html("")}function ca(a){t.show();var c={url:K()+"team/search",type:"get",data:{fields:"ID","users:ID":g.get("userID")},dataType:"json"};M(c);c=jQuery.ajax(c);c.done(function(c){void 0!=c.error?(c.error["class"]==s[0]?J(function(){ca(a)}):b(z[0],"addAllGroupTasks,"+JSON.stringify(c.error)),t.hide(),q.hide()):(c=c.data,0==c.length?
(a?a():jQuery("#form-list").hide(),t.hide(),q.hide(),TASK_CNTRL.showNoTaskWindow()):fa(function(){for(var b=c.length,d=function(c,d){if(0==--b){var f=P.length;ha=!0;if(0==f)TASK_CNTRL.showAll(P);else{for(var e=0;e<f;e++)TASK_DB.insert(P[e].name,{syncID:P[e].ID,details:P[e]},e==f-1);P=[];a&&a()}}},e=0;e<b;e++)oa("task",c[e].ID,d)}))});c.fail(function(a,b,c){Q({response:a.responseText,type:b,msg:c},ca,"addAllGroupTasks")})}function oa(a,c,d){a=void 0==a?"task":a;t.show();var e={url:K()+a+"/search?project:status=INF",
type:"get",data:{canStart:!0,status:"N",status_Mod:"contains","project:status":"CUR",fields:"parent,priority,project,plannedCompletionDate",$$LIMIT:1E3,"team:ID":c,sessionID:g.get("sessionID")},dataType:"json"};"task"==a&&(e.data.fields+=",percentComplete");M(e);e=jQuery.ajax(e);e.done(function(e){if(void 0!=e.error)e.error["class"]==s[0]?J(function(){oa(a,c,d)}):b(z[0],"addGroupTasks-"+a+","+JSON.stringify(e.error)),t.hide(),q.hide();else if(e=e.data,0==e.length)d&&d(a,c);else if("optask"!=a){oa("optask",
c,d);for(var g=e.length,h=0;h<g;h++)P.push(e[h])}else{g=e.length;for(h=0;h<g;h++)P.push(e[h]);d&&d(a,c)}});e.fail(function(a,b,c){Q({response:a.responseText,type:b,msg:c},oa,"addGroupTasks-fail"+b+"-"+c+" "+a.responseText)})}function ra(){t.show();var a={url:K()+"hour/report",type:"get",data:{"task:canStart":!0,taskID_1_GroupBy:!0,entryDate:"$$TODAY-14d",entryDate_Range:"$$TODAY",entryDate_Mod:"between",sessionID:g.get("sessionID")},dataType:"json"};M(a);a=jQuery.ajax(a);a.done(function(a){void 0!=
a.error?(a.error["class"]==s[0]?J(function(){ra()}):b(z[0],"addRecentTasks,"+JSON.stringify(a.error)),t.hide(),q.hide()):(a=Object.keys(a.data),0==a.length?(ha=!0,fa(function(){TASK_CNTRL.showAll(a)})):fa(function(){ha=!0;TASK_CNTRL.showAll(TASK_CNTRL.taskDB.loadSyncIds(a))}))});a.fail(function(a,b,c){Q({response:a.responseText,type:b,msg:c},ra,"addRecentTasks")})}function ga(){t.show();var a={url:K()+"work/myWork",type:"get",data:{fields:"parent,priority,project,plannedCompletionDate",sessionID:g.get("sessionID")},
dataType:"json"};M(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==s[0]?J(function(){ga()}):b(z[0],"addCurrentTasks,"+JSON.stringify(a.error)),t.hide(),q.hide()):(a=a.data,0==a.length?(ha=!0,fa(function(){TASK_CNTRL.showAll(a)})):fa(function(){var b=a.length;ha=!0;for(var c=0;c<b;c++)TASK_DB.insert(a[c].name,{syncID:a[c].ID,details:a[c]},c==b-1)}))});a.fail(function(a,b,c){Q({response:a.responseText,type:b,msg:c},ga,"addCurrentTasks")})}function qa(){t.show();var a={url:K()+
"work/workRequests",type:"get",data:{canStart:!0,fields:"parent,priority,project,plannedCompletionDate",sessionID:g.get("sessionID")},dataType:"json"};M(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==s[0]?J(function(){qa()}):b(z[0],"addRequestedTasks,"+JSON.stringify(a.error)),t.hide(),q.hide()):(a=a.data,0==a.length?(ha=!0,fa(function(){TASK_CNTRL.showAll(a)})):fa(function(){var b=a.length;ha=!0;for(var c=0;c<b;c++)TASK_DB.insert(a[c].name,{syncID:a[c].ID,details:a[c]},
c==b-1)}))});a.fail(function(a,b,c){Q({response:a.responseText,type:b,msg:c},qa,"addRequestedTasks")})}function ja(){var a={url:K()+"user/search?hourTypes:isActive=true&fields=hourTypes:ID,hourTypes:name,hourTypes:description,hourTypes:countAsRevenue&ID="+g.get("userID")+"&sessionID="+g.get("sessionID"),type:"get",dataType:"json"};M(a);w=!1;a=jQuery.ajax(a);a.done(function(a){if(void 0!=a.error)a.error["class"]==s[0]?J(function(){}):b(z[0],"getHourTypes,"+JSON.stringify(a.error)),t.hide(),q.hide();
else if(a=a.data,void 0!=a&&0!=a.length&&0!=a[0].hourTypes.length){w=!0;var c=jQuery("#hourTypeSelector");c.text("");c.append(jQuery("<option />").val(null).text("Task Time"));jQuery.each(a[0].hourTypes,function(){c.append($("<option />").val(this.ID).text(this.name))})}});a.fail(function(a,c,d){401==a.status?J(function(){}):"timeout"==c?ja():b(z[0],"getHourTypes,"+a.responseText)})}function sa(a,b){TASK_CNTRL.showWindow(null,"#hourTypeWindow");jQuery("#done_hourType").unbind("click").bind("click",
function(c){c.preventDefault();a.hourTypeID=jQuery("#hourTypeSelector").find(":selected").val();b(a);TASK_CNTRL.hideWindow("#hourTypeWindow")})}function ka(a){var c=g.get("todaySched");null!=c?a(c):(c={url:K("v4.0")+"user/search?ID=$$USER.ID&fields=schedule:*,schedule:nonWorkDays:*",type:"get",data:{sessionID:g.get("sessionID")},dataType:"json"},M(c),c=jQuery.ajax(c),c.done(function(c){if(void 0!=c.error)c.error["class"]==s[0]?J(function(){}):b(z[0],"getSchedule,"+JSON.stringify(c.error)),t.hide(),
q.hide();else if(c=c.data[0].schedule,0!=c.length){var d=new Date,e=c["sunday monday tuesday wednesday thursday friday saturday".split(" ")[d.getDay()]],h;if(!0==c.hasNonWorkDays){for(var k=0;k<c.nonWorkDays.length;k++)if(c.nonWorkDays[k].nonWorkDate==d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate()&&(void 0!=h&&null!=c.nonWorkDays[k].userID||void 0==h))h=c.nonWorkDays[k].scheduleDay;void 0!=h&&(e=h)}void 0!=e&&0!=e.length&&(e={start:e[0],stop:e[1]},g.set("todaySched",e));a&&a(e)}}),c.fail(function(c,
d,e){401==c.status?J(function(){}):"timeout"==d?ka(a):b(z[0],"getSchedule,"+c.responseText)}))}function na(){var a=new Date,a={url:K()+"hour/report?hours_AggFunc=sum",type:"get",data:{entryDate:a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate(),ownerID:g.get("userID"),sessionID:g.get("sessionID")},dataType:"json"};M(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==s[0]?J(function(){}):b(z[0],"getTodaysTotalHours,"+JSON.stringify(a.error)),t.hide(),q.hide()):(a=a.data,jQuery("#totalHours").html("Today's Hours: "+
(null==a.sum_hours?"0":a.sum_hours.toFixed(2))))});a.fail(function(a,c,d){401==a.status?J(function(){}):"timeout"==c?na():b(z[0],"getTodaysTotalHours,"+a.responseText)})}function C(a){t.show();var c={assignedToID:g.get("userID"),sessionID:g.get("sessionID")};"OPTASK"==a.details.objCode?c.opTaskID=a.syncID:c.taskID=a.syncID;c={url:K()+"assignment/search",type:"get",data:c,dataType:"json"};M(c);c=jQuery.ajax(c);c.done(function(c){void 0!=c.error?(c.error["class"]==s[0]?J(function(){C(a)}):b(z[0],"getTaskAssignment,"+
a.syncID+","+JSON.stringify(c.error)),t.hide(),q.hide()):(c=c.data[0],a.running?(a.done=1,TASK_CNTRL.stopTask(a),TASK_CNTRL.toggleRunText()):v(c,a))});c.fail(function(c,b,d){Q({response:c.responseText,type:b,msg:d},function(){C(a)},"getTaskAssignment,"+a.syncID)})}function v(a,c){t.show();var d={url:K()+"assignment/"+a.ID+"?status=DN&sessionID="+g.get("sessionID"),type:"PUT",dataType:"json"};B&&(d.data={method:"put"},M(d));d=jQuery.ajax(d);d.done(function(d){void 0!=d.error?(d.error["class"]==s[0]?
J(function(){v(a,c)}):b(z[0],"setAssignmentDone,"+a.ID+","+JSON.stringify(d.error)),t.hide(),q.hide()):(TASK_DB.remove(c.ID),t.hide(),q.hide(),b(z[2],X(c)+",assignment done"),b(z[1],"assignment done"),aa(c))});d.fail(function(b,d,f){Q({response:b.responseText,type:d,msg:f},function(){v(a,c)},"setAssignmentDone,"+a.ID+", "+b.responseText)})}function aa(a){var c="?taskID="+a.syncID;"OPTASK"==a.details.objCode&&(c="?opTaskID="+a.syncID);t.show();var d={url:K()+"assignment/count"+c+"&status=DN&status_Mod=ne&sessionID="+
g.get("sessionID"),type:"GET",dataType:"json"};M(d);d=jQuery.ajax(d);d.done(function(d){void 0!=d.error?(d.error["class"]==s[0]?J(function(){aa(a)}):b(z[0],"getTaskDoneAssignmentCount,"+c+","+JSON.stringify(d.error)),t.hide(),q.hide()):(d=d.data,t.hide(),q.hide(),0==d.count&&U(a))});d.fail(function(b,d,f){Q({response:b.responseText,type:d,msg:f},function(){aa(a)},"getTaskDoneAssignmentCount,"+c)})}function U(a){var c=a.syncID;t.show();var d="OPTASK"==a.details.objCode?"CLS":"CPL",d={url:K()+a.details.objCode.toLowerCase()+
"/"+c+"?status="+d+"&sessionID="+g.get("sessionID"),type:"PUT",dataType:"json"};B&&(d.data={method:"put"},M(d));d=jQuery.ajax(d);d.done(function(d){void 0!=d.error?(d.error["class"]==s[0]?J(function(){U(a)}):Q({response:d.error,type:null,msg:null},function(){U(a)},"setTaskDone,"+c),t.hide(),q.hide()):(t.hide(),q.hide(),b(z[2],X(a)+",task done"),b(z[1],"task done"))});d.fail(function(b,d,f){Q({response:b.responseText,type:d,msg:f},function(){U(a)},"setTaskDone,"+c+", "+b.responseText)})}function A(a){t.show();
var c={url:K()+a.details.objCode.toLowerCase()+"/"+a.syncID+"?status=INP&sessionID="+g.get("sessionID"),type:"PUT",dataType:"json"};B&&(c.data={method:"put"},M(c));c=jQuery.ajax(c);c.done(function(c){void 0!=c.error?(c.error["class"]==s[0]?J(function(){A(a)}):Q({response:c.error,type:null,msg:null},function(){A(a)},"setTaskInProgress,"+a.syncID),t.hide(),q.hide()):(t.hide(),q.hide(),!0==g.get("logout_on_select")&&W())});c.fail(function(c,b,d){Q({response:c.responseText,type:b,msg:d},function(){A(a)},
"setTaskInProgress-fail,"+a.syncID+", "+c.responseText)})}function E(a,c){t.show();var b={url:K()+a.details.objCode.toLowerCase()+"/"+a.syncID+"?updates={ percentComplete: "+c+"}&sessionID="+g.get("sessionID"),type:"PUT",dataType:"json"};B&&(b.data={method:"put"},M(b));b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?b.error["class"]==s[0]?J(function(){E(a,c)}):Q({response:b.error,type:null,msg:null},function(){E(a,c)},"setTaskPercent,"+a.syncID):(a.details.percentComplete=c,TASK_DB.updateDetails(a.ID,
a.details));t.hide();q.hide()});b.fail(function(b,d,e){Q({response:b.responseText,type:d,msg:e},function(){E(a,c)},"setTaskPercent-fail,"+a.syncID+", "+b.responseText)})}function L(a,c){var d,e={ownerID:g.get("userID")};void 0==c||-1!=c.permissions.actions.indexOf("ADD_HOURS")&&-1!=c.permissions.actions.indexOf("CHANGE_STATUS")?(d=0,e.method="post"):(d=c.hours,e.method="put",e.ID=c.ID);"GEN"==a.details.objCode?(e.hourTypeID=a.syncID,e.ID=null,e.projectID=null,e.taskID=null,e.opTaskID=null):("OPTASK"==
a.details.objCode?e.opTaskID=a.syncID:e.taskID=a.syncID,void 0!=a.hourTypeID&&""!=a.hourTypeID&&(e.hourTypeID=a.hourTypeID));isNaN(d)&&(d=0);e.entryDate=a.dateStr;var h=Number((a.duration/3600).toFixed(2));g.get("nearestHour")&&(h=Math.round(h));e.hours=parseFloat((h+parseFloat((""+d).split(".").join("."))+" ").split(".").join("."));e.sessionID=g.get("sessionID");e.ownerID=g.get("userID");b(z[1],"setHourAttask, oldhr: "+d+" method: "+e.method+" start: "+a.dateStr+" task: "+JSON.stringify(a)+" sid: "+
g.get("sessionID")+" time: "+(new Date).toTimeString());var k=function(){t.show();var c={url:K("v5.0")+"hour/",type:"get",data:e,dataType:"json"};M(c);c=jQuery.ajax(c);c.done(function(c){void 0!=c.error?(c.error["class"]==s[0]?J(function(){k()}):(Q({response:c.error,type:null,msg:null},k,"setHourAttask,"+a.syncID+" "+a.name+" url: "+K()+" "+JSON.stringify(e)+" "+X(a)+","+a.duration,'Time was not tracked, please click on "View" for task: '+a.name+" to record time manually."),y(a)),t.hide(),q.hide()):
(na(),void 0!=e.taskID||void 0!=e.opTaskID?A(a):!0==g.get("logout_on_select")&&W(),t.hide(),q.hide(),b(z[2],X(a)),b(z[1],"time tracked newHr: "+e.hours+" "+a.duration+" oldHr: "+d),a.done&&C(a))});c.fail(function(c,b,d){Q({response:c.responseText,type:b,msg:d},k,"setHourAttask-fail,"+a.syncID+" "+a.name+" url: "+K()+" "+JSON.stringify(e)+" "+X(a)+","+a.duration+", "+c.responseText+", "+d,c.responseText+'<br>Time was not tracked, please click on "View" for task: '+a.name+" to record time manually.");
y(a)})};k()}function y(a,c){var d={};d.entryDate=a.dateStr;d.sessionID=g.get("sessionID");d.fields="permissions,ID,hours";d.ownerID=g.get("userID");"GEN"==a.details.objCode?(d.hourTypeID=a.syncID,d.projectID=null,d.taskID=null,d.opTaskID=null):("OPTASK"==a.details.objCode?d.opTaskID=a.syncID:d.taskID=a.syncID,void 0!=a.hourTypeID&&""!=a.hourTypeID&&(d.hourTypeID=a.hourTypeID));d={url:K()+"hour/search",type:"get",data:d,dataType:"json"};M(d);d=jQuery.ajax(d);d.done(function(d){if(void 0!=d.error)d.error["class"]==
s[0]?J(function(){y(a,c)}):b(z[0],"getHour,"+a.syncID+","+JSON.stringify(d.error)),t.hide(),q.hide();else if(b(z[1],"getHour "+d.data.length+" "+JSON.stringify(d.data)),c){for(var e=d.data.length,f=0;f<e;f++)if(-1!=d.data[f].permissions.actions.indexOf("ADD_HOURS")&&-1!=d.data[f].permissions.actions.indexOf("CHANGE_STATUS")){c(a,d.data[f]);return}c(a,d.data[0])}});d.fail(function(c,d,e){b(z[0],"getHour,"+a.syncID+","+JSON.stringify(e))})}var s=["com.attask.common.AuthenticationException"],z=["error",
"debug","informational"],g,B=!(window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows")),x=-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")&&B,G=-1!==document.URL.indexOf("dashboard.directory"),w=!1,m=!1,P=[];g=!B||x?new Store("Attask"):{settings:[],set:function(a,c){switch(a){case "domain":case "host":case "userID":case "sessionID":case "username":case "date":case "view":this.setCookie(a,c,9999999999)}this.settings[a]=c},get:function(a){switch(a){case "domain":case "host":case "userID":case "sessionID":case "username":case "date":case "view":var c=
void 0===this.settings[a]?this.getCookie(a):this.settings[a];this.settings[a]=c;return"undefined"==c||void 0==c?void 0:c;default:return!this.settings.hasOwnProperty(a)||"undefined"==this.settings[a]||void 0==this.settings[a]?void 0:this.settings[a]}},removeAll:function(){var a=new Date,c;for(c in this.settings)this.settings.hasOwnProperty(c)&&(document.cookie=c+"="+this.settings[c]+";expires="+a.toGMTString()+";;");this.settings=[]},setCookie:function(a,c,b){var d=new Date;d.setHours(0);d.setMinutes(0);
d.setSeconds(0);d.setDate(d.getDate()+b);c=encodeURI(c)+(null==b?"":"; expires="+d.toUTCString());document.cookie=a+"="+c},getCookie:function(a){var c,b,d,e=document.cookie.split(";");for(c=0;c<e.length;c++)if(b=e[c].substr(0,e[c].indexOf("=")),d=e[c].substr(e[c].indexOf("=")+1),b=b.replace(/^\s+|\s+$/g,""),b==a)return decodeURI(d);return"undefined"}};var H;OB.init.add(function(){void 0==g.get("qr")&&g.set("qr","true"==jQuery.urlParam("qr")||!1!=jQuery.urlParam("code"));ba();ma();c();var a=jQuery.urlParam("s"),
b=jQuery.urlParam("d");0!=b&&0!=a&&(g.set("sessionID",a),a=b.split("."),g.set("host",a[0]),a.shift(),g.set("domain",a.join(".")));k();!0==g.get("qr")&&void 0==g.get("sessionID")&&(!1!=jQuery.urlParam("code")?(document.getElementById("button-appscan").style.display="block",qrRead(jQuery.urlParam("code"),g)):qrLoad(g))});OB.onLoad.add(function(){document.addEventListener("resume",function(){jQuery("#loading").show();k()||c()},!1);document.addEventListener("pause",function(){jQuery("#form-list").html("")},
!1);document.addEventListener("menubutton",function(){TASK_CNTRL.showWindow('<h3><div style="text-align: center; font-weight: bold;">Welcome</div></h3><div class="content"><p>If you have any questions please visit <a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank" class="btn" >store.atappstore.com</a></p><a href="#" class="btn btn-primary cancel" title="Done">Done</a></div>')},!1);document.addEventListener("offline",function(a){m=!0});document.addEventListener("online",
function(a){a=g.get("offlineTasks");b(z[0],JSON.stringify(a));g.set("offlineTasks",[]);m=!1})});OB.stop.add(function(a,c){t.show();var d,e;d=new Date(a.start);e=new Date;b(z[1],"stop: "+d+" == "+e+" dur:"+c+" totalDuration:"+a.time);if(g.get("minuteBufferSnapToSched")){var h=g.get("todaySched"),k=g.get("minuteBuffer"),l=e.toLocaleDateString("en-US"),m=Date.parse(l+h.start),h=Date.parse(l+h.stop),l=new Date(m);d<m&&d>l.setMinutes(l.getMinutes()-k)&&(d=new Date(m));l=new Date(h);e>h&&e<l.setMinutes(l.getMinutes()+
k)&&(e=new Date(h));if(d>=e){t.hide();return}c=Math.floor((e.getTime()-d.getTime())/1E3);b(z[1],"minuteBufferSnapToSched: "+d+" == "+e+" dur:"+c)}0==c?t.hide():w?sa(a,function(a){N(a,c)}):N(a,c)});OB.update.add(function(a,c){q.show();N(a,c)});OB.preStart.add(function(a){a.running?TASK_CNTRL.toggleTimer(a):function(){TASK_DB.loadAll(function(c){var b,d,e=!1,h=c.length;for(b=0;b<h;b++)if(d=c[b],null!=d&&d.running&&a.ID!=d.ID){TASK_CNTRL.toggleTimer(d);e=!0;break}TASK_CNTRL.toggleTimer(a);!e&&!0==g.get("logout_on_select")&&
W()})}()});OB.postAllItemRender.add(function(){jQuery(".remove").css("display","none");jQuery(".update").css("display","none");jQuery(".reset").css("display","none");g.get("is_auth")?jQuery("#storelink").text("AtAppStore"):(jQuery("#sort-date").remove(),jQuery(".timer").remove(),jQuery(".done").remove(),jQuery(".percent").remove(),jQuery(".date").removeClass("date").addClass("date-tall").html('<a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank">Trial Expired</a>'),
jQuery("#storelink").text("Trial Expired - AtAppStore"));if(ha){var a=jQuery("#form-list"),c=g.get("vpos");void 0!=c&&a.scrollTop(c);"team"==g.get("view")&&!0==g.get("hide_team_done")&&jQuery(".done").remove();m?g.get("allowOffline")&&(jQuery(".done").remove(),jQuery(".percent").remove(),jQuery(".view").remove(),jQuery("#bar").hide()):jQuery("#bar").show();c=g.get("sort");void 0==c&&(c="date");jQuery("#sort-"+c).click();jQuery("#search-bar").is(":visible")&&jQuery("#search").click();jQuery("#loading").hide();
a.show();a=jQuery("#holder")[0];a.style.display="none";a.style.display="block";t.hide();ha=!1}});OB.postItemRender.add(function(a){if(0==jQuery("#item"+a.ID+" #buttons .view").length){var c=jQuery("#item"+a.ID+" #buttons"),b=["",{label:"Low",css:"default"},{label:"Normal",css:"success"},{label:"High",css:"warning"},{label:"Urgent",css:"danger"}];"GEN"!=a.details.objCode&&(void 0!=a.details.priority&&0!=a.details.priority)&&(b=b[a.details.priority],c.append('<span class="task priority '+b.css+'" title="'+
b.label+'" data-priority="'+a.details.priority+'">'+b.label[0]+"</span> "));var d;"GEN"==a.details.objCode?(d="General",jQuery("#item"+a.ID).css({background:"aliceblue"})):"OPTASK"==a.details.objCode?(d="Issue",c.append('<span class="issue" title="Issue">I</span> ')):"TASK"==a.details.objCode&&(d="Task",c.append('<span class="task" title="Task">T</span> '));"General"!=d&&(c.append('<a href="https://'+g.get("host")+"."+g.get("domain")+"/"+d.toLowerCase()+"/view?ID="+a.syncID+'" target="_blank" class="btn btn-mini view" rel="'+
a.ID+'" title="View '+d+'">View</a> '),c.append('<a href="#" class="btn btn-mini done" rel="'+a.ID+'" title="Done '+d+'">Done</a> '));"Task"==d&&void 0!=a.details.percentComplete&&c.append('<a href="#" class="btn btn-mini percent" rel="'+a.ID+'" title="Percent Completed">'+a.details.percentComplete+"%</a> ");c="#D2E0FF";b='<span class="date" style="background-color: #EEE;"></span>';if("General"!=d&&void 0!=a.details.plannedCompletionDate){var b=a.details.plannedCompletionDate.split("T")[0],b=b.split("-"),
b=new Date(b[0],Number(b[1])-1,b[2]),e=new Date;e.setHours(0);e.setMinutes(0);e.setSeconds(0);e=Math.round((b-e)/1E3/60/60/24);0>e?c="#FFCDCD":1>=e&&(c="#FFD7AB");var h;h=0<e?"days due: "+e:"days late: "+Math.abs(e);b='<div class="date" style="background-color: '+c+';"><div class="days" data-days="'+e+'">'+h+"</div><div>"+ea(b.getMonth())+" "+b.getDate()+", "+b.getFullYear()+"</div></div>"}c="";null!=a.details.parent&&(c="<br><br>Parent Task: <br>"+a.details.parent.name);jQuery("#item"+a.ID+" .name").attr("title",
d+": <br>"+a.name+c);"General"!=d?(d=a.details.project.name,jQuery("#item"+a.ID+" .details").html(d).attr("title","Project: <br>"+d).attr("data-priority",a.details.priority),jQuery("#item"+a.ID+" .c6").after(b)):jQuery("#item"+a.ID+" .details").html("~"+a.details.description).attr("title",a.details.description)}});OB.remove.add(function(a){jQuery("#item"+a).remove()});OB.reset.add(function(a,c){OB.update.dispatch(c,-c.time);jQuery("#item"+a+" .timer").text(TASK_CNTRL.hms(0))});var ha=!1,q,t,F=[]}();/*
 MIT
 @version 3.12.2010

 Special thanks to jTrack for inspiration !
 http://bulgaria-web-developers.com/projects/javascript/jtrack/

 MIT
 @version 4

*/
function taskController(d){var a,e=window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows"),b=-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")&&!e;jQuery.urlParam=function(a){a=RegExp("[\\?&]"+a+"=([^&#]*)").exec(window.location.href);return!a?0:a[1]||0};OB.start.add(function(a){startNotify(a)});OB.stop.add(function(a){stopNotify(a)});OB.onLoad.add(function(){});OB.postAllItemRender.add(function(){b&&(jQuery("#form-list").height(0),a=124);if(!e||"full"==
getQueryString().view){var c=function(){var c=jQuery("#form-list"),b;b=c.height();b+=window.innerHeight-a;0!=window.innerHeight-a&&c.height(b);a=window.innerHeight};jQuery(window).unbind("resize");jQuery(window).bind("resize",c);c()}c={style:{tip:{corner:!0,width:5,height:5},def:!1,classes:"qtip-info"},position:{adjust:{method:"flip flip"},at:"bottom left",my:"top left",viewport:jQuery(window)},show:{},hide:{delay:0}};jQuery("span[title]").qtip(c);b||jQuery("a[title]").qtip(c);c.content="time < 30 seconds<br> time was not tracked";
c.show.event=!1;c.hide.delay=b?0:2E3;var d=jQuery(".timer");d.qtip(c);b||d.mouseover(function(){var a=jQuery(this).find(".time").hide(),c=jQuery(this).find(".timer-info").show();setTimeout(function(){a.show();c.hide()},3E3)}).mouseout(function(){jQuery(this).find(".time").show();jQuery(this).find(".timer-info").hide()});b&&(jQuery(".item").css("padding-right","5px"),jQuery(".task").css("padding-right","5px").css("padding-left","5px"),jQuery(".issue").css("padding-right","5px").css("padding-left",
"5px"),jQuery("body").css("font-size","12px"));jQuery("#searchfor").domsearch("#form-list",{unit:"div.item:visible",criteria:["span[oldtitle]"]})});return{intervals:[],taskDB:d,init:function(){this.bind();this.toggleRunText();var c=jQuery("#form-list");!e||"full"==getQueryString().view?(c.css("max-height","100%"),c.css("height","439px")):c.css("max-height","439px");!e&&(window.webkitNotifications&&0!=window.webkitNotifications.checkPermission())&&window.open("core/js/permission.html","Permission",
"height=540,width=447");a=567},bind:function(){b&&jQuery("a[target='_blank']").live("click",function(a){a.preventDefault();window.open(jQuery(this).attr("href"),"_blank","location=yes");return!1});jQuery("#cover").hide();jQuery(".cancel").live("click",function(a){a.preventDefault();jQuery("#"+jQuery(this).attr("rel")).hide().hide().find("input:text").val("");jQuery("#form-list").show();jQuery("#top-bar").show();jQuery("#bar").show()});jQuery("#search").live("click",function(a){a.preventDefault();
jQuery("#sort-bar").toggle();jQuery("#search-bar").toggle();jQuery("#searchfor").focus().val("").domsearchClear()});jQuery("#popout").live("click",function(a){a.preventDefault();e&&window.chrome.windows.create({url:"index.html?view=full",type:"popup",width:393,height:600})});jQuery("#create").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#form-create").slideDown().find("input[name='task-name']").focus()});var a=this;jQuery("#button-create").live("click",function(){a.taskDB.insert(jQuery("#form-create :input[name='task-name']").val());
jQuery("#form-create").hide().find("input:text").val("")});jQuery("#task-name").keydown(function(b){13==b.keyCode&&(a.taskDB.insert(jQuery("#form-create :input[name='task-name']").val()),jQuery("#form-create").hide().find("input:text").val(""))});jQuery(".remove").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#button-remove").attr("rel",jQuery(this).attr("rel"));jQuery("#remove-confirm").html("Are you sure? You want to <strong>delete "+jQuery(this).attr("title")+"</strong>?");
jQuery("#form-remove").show()});jQuery("#button-remove").live("click",function(){jQuery("#form-remove").hide();a.taskDB.remove(jQuery(this).attr("rel"))});jQuery("#remove-all").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#form-remove-all").slideDown()});jQuery("#button-remove-all").live("click",function(){jQuery("#form-remove-all").hide();a.taskDB.removeall()});jQuery(".update").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#top-bar").hide();
jQuery("#bar").hide();a=jQuery(this).attr("rel");this.taskDB.updateValidate(a,this.update)});jQuery("#button-update").live("click",function(){jQuery("#form-update").hide();jQuery("#top-bar").show();jQuery("#bar").show();var b=jQuery("#form-update :input[name='task-id']").val(),d=jQuery("#form-update :input[name='task-name']").val(),e=jQuery("#form-update :input[name='task-time']").val();a.taskDB.update(b,d,e)});jQuery(".cancel").live("click",function(b){b.preventDefault();a.hideWindow()});jQuery(".reset").live("click",
function(b){b.preventDefault();b=jQuery(this).attr("rel");a.taskDB.reset(b)});var d=function(b){b.preventDefault();a.taskDB.updateValidate(jQuery(this).attr("rel"),function(a){OB.preStart.dispatch(a)});return!1};jQuery(".timer").live("click",d);jQuery("#running").click(d);jQuery("#holder").show()},displayError:function(a){this.showWindow('<h3><div style="text-align: center; font-weight: bold;">Error</div></h3><div class="content"><p>'+a+'</p><a href="#" id="cancel_confirm" class="btn btn-primary" title="Done">Done</a></div>')},
showWindow:function(a,d){d=void 0==d?"#window":d;null!=a&&jQuery(d).html(a);b?(jQuery("#cover").css("height","100%").css("opacity","0.8").show(),jQuery(d).animate({top:60+window.pageYOffset+"px"},{easing:"easeInCubic",duration:400,complete:function(){}})):jQuery("#cover").css("height","100%").show().animate({opacity:"0.8"},400,function(){jQuery(d).animate({top:60+window.pageYOffset+"px"},{easing:"easeInCubic",duration:400,complete:function(){}})})},hideWindow:function(a){a=void 0==a?"#window":a;b?
jQuery(a).animate({top:"-700px"},{easing:"easeOutCubic",duration:400,complete:function(){jQuery("#cover").hide()}}):jQuery(a).animate({top:"-700px"},{easing:"easeOutCubic",duration:400,complete:function(){jQuery("#cover").animate({opacity:"0"},{duration:400,complete:function(){jQuery("#cover").hide()}})}})},update:function(a){jQuery("#form-update :input[name='task-id']").val(a.ID);jQuery("#form-update :input[name='task-name']").val(a.name);jQuery("#form-update :input[name='task-time']").val(this.hms(a.time));
jQuery("#form-update").slideDown()},truncateString:function(a){return a},showTask:function(a){var b,d="";b=jQuery("#item"+a.ID);0!=b.length?b.show():(d+='<div class="item'+(a.running?" running":"")+'" id="item'+a.ID+'" rel="'+a.ID+'">',d=d+'<div class="c3">'+('<span class="name c1" title="Task: <br>'+a.name+'" ><strong>'+this.truncateString(a.name)+"</strong></span><br>"),d+='<span class="details" title="'+a.details+'" >'+this.truncateString(a.details)+"</span><br>",d+='<span id="buttons"><a href="#" class="btn btn-mini update" rel="'+
a.ID+'" title="Edit: '+a.name+'">Edit</a> ',d+='<a href="#" class="btn btn-mini reset" rel="'+a.ID+'" title="Reset: '+a.name+'">Reset</a> ',d+='<a href="#" class="btn btn-mini remove" rel="'+a.ID+'" title="Delete: '+a.name+'">Delete</a></span>',d+="</div>",d+='<div class="c8"><div class="c6">',a.running?(b=new Date(a.start),b=Number(a.time)+Math.floor(((new Date).getTime()-b.getTime())/1E3),d+='<a href="#" class="btn timer btn-primary" rel="'+a.ID+'"><span class="time">'+this.hms(b)+"</span>"):d+=
'<a href="#" class="btn timer" rel="'+a.ID+'"><span class="time">'+this.hms(a.time)+"</span>",d+='<span class="timer-info" style="display: none;">'+(a.running?"Stop":"Start")+"</span></a>",d+="</div>",d+="</div></div>",a.running&&(this.startTask(a),this.toggleRunText()),jQuery("#form-list").append(d),OB.postItemRender.dispatch(a))},showAll:function(a){var b,d=a.length;if(0!=d)for(b=0;b<d;b++)this.showTask(a[b]);0==jQuery(".item").length&&this.showNoTaskWindow();OB.postAllItemRender.dispatch()},showNoTaskWindow:function(){this.showWindow('<h3><div style="text-align: center; font-weight: bold;">No Tasks</div></h3><div class="content"><p>Please assign a task to yourself.</p><a href="#" id="cancel_confirm" class="btn btn-primary cancel" title="Done">Done</a></div>')},
toggleTimer:function(a){jQuery("#item"+a.ID+" .timer").toggleClass("btn-primary");a.running?this.stopTask(a):this.startTask(a);this.toggleRunText()},startTask:function(a){var b=this;window.clearInterval(b.intervals[a.ID]);var d=new Date;a.running?d=new Date(a.start):this.taskDB.start(a.ID,d);jQuery("#item"+a.ID+" .timer .timer-info").text("Stop");b.intervals[a.ID]=window.setInterval(function(){var e=Number(a.time)+Math.floor(((new Date).getTime()-d.getTime())/1E3);jQuery("#item"+a.ID+" .timer .time").text(b.hms(e))},
500)},stopTask:function(a){window.clearInterval(this.intervals[a.ID]);var b,d=Number(a.time);b=new Date(a.start);b=Math.floor(((new Date).getTime()-b.getTime())/1E3);30>b?(jQuery("#item"+a.ID+" .timer").qtip("show"),b=0):60>b&&29<b&&(b=60);d+=b;this.taskDB.stop(a.ID,d,b,a.done);jQuery("#item"+a.ID+" .timer .time").text(this.hms(d));jQuery("#item"+a.ID+" .timer .timer-info").text("Start")},toggleRunText:function(){this.taskDB.running(function(a){e?window.chrome.browserAction.setBadgeText({text:"RUN"}):
document.title="Stopwatch - Running: "+a.name;jQuery("#running").text("Running: "+a.name).attr("rel",a.ID).show();jQuery("#storelink").hide()},function(a){0==a&&(e?window.chrome.browserAction.setBadgeText({text:""}):document.title="Stopwatch",jQuery("#running").hide(),jQuery("#storelink").show())})},hms:function(a){a=[0,0,a];var b;for(b=2;0<b;b--)a[b-1]=Math.floor(a[b]/60),a[b]%=60,10>a[b]&&(a[b]="0"+a[b]);return a.join(":")},sec:function(a){a=String(a).split(":");return Number(parseFloat(3600*a[0])+
60*parseFloat(a[1])+parseFloat(a[2]))}}}function getQueryString(){for(var d={},a=location.search.substring(1),e=/([^&=]+)=([^&]*)/g,b;b=e.exec(a);)d[decodeURIComponent(b[1])]=decodeURIComponent(b[2]);return d};function taskDB(){return{dm:[],lastId:0,sql:function(d,a,e,b,c,k){},init:function(){this.createDB();return this},onError:function(d){},createDB:function(){this.dm=[];this.lastId=0},dropTaskTable:function(){this.createDB()},start:function(d,a){this.dm[d].running=1;this.dm[d].start=a;OB.start.dispatch(this.dm[d])},stop:function(d,a,e,b){this.dm[d].running=0;this.dm[d].done=b;this.dm[d].time=Number(a);OB.stop.dispatch(this.dm[d],Number(e))},running:function(d,a){for(var e in this.dm)if(null!=this.dm[e]&&
this.dm[e].running){d(this.dm[e]);return}a()},insert:function(d,a,e){var b="null",c="";void 0!=a&&(void 0!=a.syncID&&(b=a.syncID),void 0!=a.details&&(c=a.details));if("null"!=b){a=!1;for(var k in this.dm)if(null!=this.dm[k]&&this.dm[k].syncID==b){a=!0;break}a||(k=this.nextID(),this.dm[k]={ID:k,syncID:b,name:d,details:c,time:0,start:new Date,running:0,done:0},OB.insert.dispatch(d,{syncID:b,details:c}));TASK_CNTRL.showTask(this.dm[k]);e&&OB.postAllItemRender.dispatch()}},nextID:function(){return this.lastId++},
updateValidate:function(d,a){null!=this.dm[d]&&a(this.dm[d])},update:function(d,a,e){e=TASK_CNTRL.sec(e);var b;null!=this.dm[d]&&(this.dm[d].name=a,b=this.dm[d].time,this.dm[d].time=e);OB.update.dispatch(this.dm[d],e-b)},updateDetails:function(d,a){null!=this.dm[d]&&(this.dm[d].details=a)},remove:function(d){this.dm[d]=null;window.clearInterval(TASK_CNTRL.intervals[d]);OB.remove.dispatch(d)},removeall:function(){this.createDB();for(var d in TASK_CNTRL.intervals)window.clearInterval(TASK_CNTRL.intervals[d]);
OB.removeall.dispatch()},reset:function(d){null!=this.dm[d]&&(OB.reset.dispatch(d,this.dm[d]),this.dm[d].time=0)},loadAll:function(d){d(this.dm)}}.init()};function taskDBls(){return{ls:null,ps:null,userId:null,sql:function(d,a,e,b,c,k){},init:function(){this.ps=new Store("AttaskPersistModel");this.ls=new Store("AttaskModel");null==this.ls.get("list")&&this.createDB();return this},onError:function(d){},createDB:function(){this.ls.set("lastId",0);this.ls.set("list",[])},dropTaskTable:function(){this.ls.removeAll()},userRunningTasks:function(d){return p.ps.get(d+""+p.ps.get(d))},start:function(d,a){var e=this.ls.get(d);null!=e&&void 0!=e&&(e.running=1,
e.start=a,this.ls.set(d,e),null!=this.userId&&(this.ps.set(this.userId+""+e.syncID,e),this.ps.set(this.userId,e.syncID)),OB.start.dispatch(e))},stop:function(d,a,e,b){var c=this.ls.get(d);null!=c&&void 0!=c&&(c.running=0,c.done=b,c.time=Number(a),this.ls.set(d,c),null!=this.userId&&(this.ps.remove(this.userId+""+c.syncID),this.ps.remove(this.userId)),OB.stop.dispatch(c,Number(e)))},running:function(d,a){var e=this.ls.get("list"),b,c=0,k;for(k in e)e.hasOwnProperty(k)&&(b=this.ls.get(k),null!=b&&(void 0!=
b&&b.running)&&(d(b),c++));a(c)},getAllRunning:function(){return this.ps.toObject()},insert:function(d,a,e){var b=this,c="null",k="";void 0!=a&&(void 0!=a.syncID&&(c=a.syncID),void 0!=a.details&&(k=a.details));a=function(a,c,d,e){var h=b.nextID(),k={ID:h,syncID:a,name:c,details:d,time:0,start:new Date,running:0};if(null!=b.userId){var N=b.ps.get(b.userId+""+a);null!=N&&N.running&&(k=N)}b.ls.set(h,k);N=b.ls.get("list");N[h]=a;b.ls.set("list",N);OB.insert.dispatch(c,{syncID:a,details:d});TASK_CNTRL.showTask(k);
e&&OB.postAllItemRender.dispatch()};if("null"!=c){var h=b.ls.get("list"),la=!1,ba;for(ba in h)if(h.hasOwnProperty(ba)&&null!=h[ba]&&h[ba]==c){la=!0;break}la?(TASK_CNTRL.showTask(b.ls.get(ba)),e&&OB.postAllItemRender.dispatch()):a(c,d,k,e)}else a(c,d,k,e)},nextID:function(){var d=this.ls.get("lastId");d++;this.ls.set("lastId",d);return d},updateValidate:function(d,a){var e=this.ls.get(d);null!=e&&void 0!=e&&a(e)},update:function(d,a,e){e=TASK_CNTRL.sec(e);d=this.ls.get(d);null!=d&&void 0!=d&&(d.name=
a,a=d.time,d.time=e,OB.update.dispatch(d,e-a))},updateDetails:function(d,a){var e=this.ls.get(d);null!=e&&void 0!=e&&(e.details=a)},remove:function(d){var a=this.ls.get("list");a[d]=null;this.ls.set("list",a);this.ls.remove(d);window.clearInterval(TASK_CNTRL.intervals[d]);OB.remove.dispatch(d)},removeall:function(){this.createDB();for(var d=TASK_CNTRL.intervals.length,a=0;a<d;a++)window.clearInterval(TASK_CNTRL.intervals[a]);OB.removeall.dispatch()},reset:function(d){var a=this.ls.get(d);null!=a&&
void 0!=a&&(OB.reset.dispatch(d,a),a.time=0,this.ls.set(d,a))},loadAll:function(d){var a=this.ls.get("list"),e=[],b,c;for(c in a)a.hasOwnProperty(c)&&(b=this.ls.get(c),null!=b&&void 0!=b&&e.push(b));d(e)},loadSyncIds:function(d){for(var a=this.ls.get("list"),e=[],b,c=d.length,k=0;k<c;k++)b=a.indexOf(d[k]),-1!=b&&(b=this.ls.get(b),null!=b&&void 0!=b&&e.push(b));return e}}.init()};var TASK_DB;TASK_DB=window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows")||-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")?taskDBls():lscheck()?taskDBls():taskDB();var TASK_CNTRL=taskController(TASK_DB);jQuery(function(){TASK_CNTRL.init();OB.init.dispatch()});function onLoad(){OB.onLoad.dispatch()}function lscheck(){try{return localStorage.setItem("stopwatch","stopwatch"),localStorage.removeItem("stopwatch"),!0}catch(d){return!1}};var interval,notifyWorkIntervalTime=30;function startNotify(d){interval=setInterval(function(){notifyWorking(d)},6E4*notifyWorkIntervalTime)}function stopNotify(){clearInterval(interval)}function notifyWorking(d){if(window.webkitNotifications){var a=webkitNotifications.createNotification("../icons/timer48x48.png","Still working on Task:",d.name+"\n"+d.details.split(", Due:")[0]);a.show();setTimeout(function(){a.cancel()},7E3)}else stopNotify()}
function notifyFriday(){var d=webkitNotifications.createNotification("icons/timer48x48.png","Remember: Submit Timesheet!","");d.show();setTimeout(function(){d.cancel()},7E3)};
