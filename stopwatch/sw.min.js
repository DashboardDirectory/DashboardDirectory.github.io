(function(d){function a(b,a,c,d,e){this._listener=a;this._isOnce=c;this.context=d;this._signal=b;this._priority=e||0}function e(b,a){if("function"!==typeof b)throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",a));}function b(){this._bindings=[];this._prevParams=null;var a=this;this.dispatch=function(){b.prototype.dispatch.apply(a,arguments)}}a.prototype={active:!0,params:null,execute:function(b){var a;this.active&&this._listener&&(b=this.params?this.params.concat(b):
b,a=this._listener.apply(this.context,b),this._isOnce&&this.detach());return a},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal;delete this._listener;delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+
", isBound:"+this.isBound()+", active:"+this.active+"]"}};b.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(b,c,d,e){var ra=this._indexOfListener(b,d);if(-1!==ra){if(b=this._bindings[ra],b.isOnce()!==c)throw Error("You cannot add"+(c?"":"Once")+"() then add"+(!c?"":"Once")+"() the same listener without removing the relationship first.");}else b=new a(this,b,c,d,e),this._addBinding(b);this.memorize&&this._prevParams&&b.execute(this._prevParams);return b},
_addBinding:function(b){var a=this._bindings.length;do--a;while(this._bindings[a]&&b._priority<=this._bindings[a]._priority);this._bindings.splice(a+1,0,b)},_indexOfListener:function(b,a){for(var c=this._bindings.length,d;c--;)if(d=this._bindings[c],d._listener===b&&d.context===a)return c;return-1},has:function(b,a){return-1!==this._indexOfListener(b,a)},add:function(b,a,c){e(b,"add");return this._registerListener(b,!1,a,c)},addOnce:function(b,a,c){e(b,"addOnce");return this._registerListener(b,!0,
a,c)},remove:function(b,a){e(b,"remove");var c=this._indexOfListener(b,a);-1!==c&&(this._bindings[c]._destroy(),this._bindings.splice(c,1));return b},removeAll:function(){for(var b=this._bindings.length;b--;)this._bindings[b]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(b){if(this.active){var a=Array.prototype.slice.call(arguments),c=this._bindings.length,d;this.memorize&&(this._prevParams=
a);if(c){d=this._bindings.slice();this._shouldPropagate=!0;do c--;while(d[c]&&this._shouldPropagate&&!1!==d[c].execute(a))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll();delete this._bindings;delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var c=b;c.Signal=b;"function"===typeof define&&define.amd?define(function(){return c}):"undefined"!==typeof module&&module.exports?module.exports=c:d.signals=
c})(this);var OB={updateAtInterval:new signals.Signal,start:new signals.Signal,stop:new signals.Signal,preStart:new signals.Signal,preStop:new signals.Signal,insert:new signals.Signal,update:new signals.Signal,reset:new signals.Signal,remove:new signals.Signal,removeAll:new signals.Signal,init:new signals.Signal,options:new signals.Signal,postItemRender:new signals.Signal,postAllItemRender:new signals.Signal,onLoad:new signals.Signal,onUnLoad:new signals.Signal,onBeforeUnLoad:new signals.Signal};(function(){var d=this.Store=function(a,d){var b;this.name=a;if(void 0!==d)for(b in d)d.hasOwnProperty(b)&&void 0===this.get(b)&&this.set(b,d[b])};d.prototype.get=function(a){a="store."+this.name+"."+a;if(null!==localStorage.getItem(a))try{return JSON.parse(localStorage.getItem(a))}catch(d){return null}};d.prototype.set=function(a,d){if(void 0===d)this.remove(a);else{if("function"===typeof d)d=null;else try{d=JSON.stringify(d)}catch(b){d=null}localStorage.setItem("store."+this.name+"."+a,d)}return this};
d.prototype.remove=function(a){localStorage.removeItem("store."+this.name+"."+a);return this};d.prototype.removeAll=function(){var a,d;a="store."+this.name+".";for(d=localStorage.length-1;0<=d;d--)localStorage.key(d).substring(0,a.length)===a&&localStorage.removeItem(localStorage.key(d));return this};d.prototype.toObject=function(){var a,d,b,c,g;a={};d="store."+this.name+".";for(b=localStorage.length-1;0<=b;b--)localStorage.key(b).substring(0,d.length)===d&&(c=localStorage.key(b).substring(d.length),
g=this.get(c),void 0!==g&&(a[c]=g));return a};d.prototype.fromObject=function(a,d){!0!==d&&this.removeAll();for(var b in a)a.hasOwnProperty(b)&&this.set(b,a[b]);return this}})();(function(d){function a(b,a){for(var c=0,d=b.length;c<d;c++)if(b[c]==a)return!e;return e}var e=!1,b=parseFloat,c=Math.min,g=/(-?\d+\.?\d*)$/g,l=[],na=[];d.tinysort={id:"TinySort",version:"1.4.29",copyright:"Copyright (c) 2008-2012 Ron Valstar",uri:"http://tinysort.sjeiti.com/",licensed:{MIT:"http://www.opensource.org/licenses/mit-license.php",GPL:"http://www.gnu.org/licenses/gpl.html"},plugin:function(b,a){l.push(b);na.push(a)},defaults:{order:"asc",attr:null,data:null,useVal:e,place:"start",returns:e,
cases:e,forceStrings:e,sortFunction:null}};d.fn.extend({tinysort:function(Z,ra){Z&&"string"!=typeof Z&&(ra=Z,Z=null);var ba=d.extend({},d.tinysort.defaults,ra),ta,oa=d(this).length,r={},k=!(!Z||""==Z),K=!(null===ba.attr||""==ba.attr),ia=null!==ba.data,da=k&&":"==Z[0],ka=da?this.filter(Z):this,R=ba.sortFunction,V="asc"==ba.order?1:-1,W=[];d.each(l,function(b,a){a.call(a,ba)});R||(R="rand"==ba.order?function(){return 0.5>Math.random()?1:-1}:function(a,c){var k=e,l=!ba.cases?a.s&&a.s.toLowerCase?a.s.toLowerCase():
a.s:a.s,r=!ba.cases?c.s&&c.s.toLowerCase?c.s.toLowerCase():c.s:c.s;if(!ba.forceStrings){var w=l&&l.match(g),K=r&&r.match(g);if(w&&K){var M=l.substr(0,l.length-w[0].length),L=r.substr(0,r.length-K[0].length);M==L&&(k=!e,l=b(w[0]),r=b(K[0]))}}var R=V*(l<r?-1:l>r?1:0);d.each(na,function(b,a){R=a.call(a,k,l,r,R)});return R});this.each(function(b,a){var c=d(a),e=k?da?ka.filter(a):c.find(Z):c,g=ia?""+e.data(ba.data):K?e.attr(ba.attr):ba.useVal?e.val():e.text(),l=c.parent();r[l]||(r[l]={s:[],n:[]});0<e.length?
r[l].s.push({s:g,e:c,n:b}):r[l].n.push({e:c,n:b})});for(ta in r)r[ta].s.sort(R);for(ta in r){var R=r[ta],w=[],Y=oa,M=[0,0],qa;switch(ba.place){case "first":d.each(R.s,function(b,a){Y=c(Y,a.n)});break;case "org":d.each(R.s,function(b,a){w.push(a.n)});break;case "end":Y=R.n.length;break;default:Y=0}for(qa=0;qa<oa;qa++){var ea=a(w,qa)?!e:qa>=Y&&qa<Y+R.s.length,L=(ea?R.s:R.n)[M[ea?0:1]].e;L.parent().append(L);(ea||!ba.returns)&&W.push(L.get(0));M[ea?0:1]++}}this.length=0;Array.prototype.push.apply(this,
W);return this}});d.fn.TinySort=d.fn.Tinysort=d.fn.tsort=d.fn.tinysort})(jQuery);Array.prototype.indexOf||(Array.prototype.indexOf=function(d,a){var e=this.length,b=Number(a)||0,b=0>b?Math.ceil(b):Math.floor(b);for(0>b&&(b+=e);b<e;b++)if(b in this&&this[b]===d)return b;return-1});jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(d,a,e,b,c){return jQuery.easing[jQuery.easing.def](d,a,e,b,c)},easeInQuad:function(d,a,e,b,c){return b*(a/=c)*a+e},easeOutQuad:function(d,a,e,b,c){return-b*(a/=c)*(a-2)+e},easeInOutQuad:function(d,a,e,b,c){return 1>(a/=c/2)?b/2*a*a+e:-b/2*(--a*(a-2)-1)+e},easeInCubic:function(d,a,e,b,c){return b*(a/=c)*a*a+e},easeOutCubic:function(d,a,e,b,c){return b*((a=a/c-1)*a*a+1)+e},easeInOutCubic:function(d,a,e,b,c){return 1>(a/=c/2)?b/2*a*a*a+e:
b/2*((a-=2)*a*a+2)+e},easeInQuart:function(d,a,e,b,c){return b*(a/=c)*a*a*a+e},easeOutQuart:function(d,a,e,b,c){return-b*((a=a/c-1)*a*a*a-1)+e},easeInOutQuart:function(d,a,e,b,c){return 1>(a/=c/2)?b/2*a*a*a*a+e:-b/2*((a-=2)*a*a*a-2)+e},easeInQuint:function(d,a,e,b,c){return b*(a/=c)*a*a*a*a+e},easeOutQuint:function(d,a,e,b,c){return b*((a=a/c-1)*a*a*a*a+1)+e},easeInOutQuint:function(d,a,e,b,c){return 1>(a/=c/2)?b/2*a*a*a*a*a+e:b/2*((a-=2)*a*a*a*a+2)+e},easeInSine:function(d,a,e,b,c){return-b*Math.cos(a/
c*(Math.PI/2))+b+e},easeOutSine:function(d,a,e,b,c){return b*Math.sin(a/c*(Math.PI/2))+e},easeInOutSine:function(d,a,e,b,c){return-b/2*(Math.cos(Math.PI*a/c)-1)+e},easeInExpo:function(d,a,e,b,c){return 0==a?e:b*Math.pow(2,10*(a/c-1))+e},easeOutExpo:function(d,a,e,b,c){return a==c?e+b:b*(-Math.pow(2,-10*a/c)+1)+e},easeInOutExpo:function(d,a,e,b,c){return 0==a?e:a==c?e+b:1>(a/=c/2)?b/2*Math.pow(2,10*(a-1))+e:b/2*(-Math.pow(2,-10*--a)+2)+e},easeInCirc:function(d,a,e,b,c){return-b*(Math.sqrt(1-(a/=c)*
a)-1)+e},easeOutCirc:function(d,a,e,b,c){return b*Math.sqrt(1-(a=a/c-1)*a)+e},easeInOutCirc:function(d,a,e,b,c){return 1>(a/=c/2)?-b/2*(Math.sqrt(1-a*a)-1)+e:b/2*(Math.sqrt(1-(a-=2)*a)+1)+e},easeInElastic:function(d,a,e,b,c){d=1.70158;var g=0,l=b;if(0==a)return e;if(1==(a/=c))return e+b;g||(g=0.3*c);l<Math.abs(b)?(l=b,d=g/4):d=g/(2*Math.PI)*Math.asin(b/l);return-(l*Math.pow(2,10*(a-=1))*Math.sin((a*c-d)*2*Math.PI/g))+e},easeOutElastic:function(d,a,e,b,c){d=1.70158;var g=0,l=b;if(0==a)return e;if(1==
(a/=c))return e+b;g||(g=0.3*c);l<Math.abs(b)?(l=b,d=g/4):d=g/(2*Math.PI)*Math.asin(b/l);return l*Math.pow(2,-10*a)*Math.sin((a*c-d)*2*Math.PI/g)+b+e},easeInOutElastic:function(d,a,e,b,c){d=1.70158;var g=0,l=b;if(0==a)return e;if(2==(a/=c/2))return e+b;g||(g=c*0.3*1.5);l<Math.abs(b)?(l=b,d=g/4):d=g/(2*Math.PI)*Math.asin(b/l);return 1>a?-0.5*l*Math.pow(2,10*(a-=1))*Math.sin((a*c-d)*2*Math.PI/g)+e:0.5*l*Math.pow(2,-10*(a-=1))*Math.sin((a*c-d)*2*Math.PI/g)+b+e},easeInBack:function(d,a,e,b,c,g){void 0==
g&&(g=1.70158);return b*(a/=c)*a*((g+1)*a-g)+e},easeOutBack:function(d,a,e,b,c,g){void 0==g&&(g=1.70158);return b*((a=a/c-1)*a*((g+1)*a+g)+1)+e},easeInOutBack:function(d,a,e,b,c,g){void 0==g&&(g=1.70158);return 1>(a/=c/2)?b/2*a*a*(((g*=1.525)+1)*a-g)+e:b/2*((a-=2)*a*(((g*=1.525)+1)*a+g)+2)+e},easeInBounce:function(d,a,e,b,c){return b-jQuery.easing.easeOutBounce(d,c-a,0,b,c)+e},easeOutBounce:function(d,a,e,b,c){return(a/=c)<1/2.75?b*7.5625*a*a+e:a<2/2.75?b*(7.5625*(a-=1.5/2.75)*a+0.75)+e:a<2.5/2.75?
b*(7.5625*(a-=2.25/2.75)*a+0.9375)+e:b*(7.5625*(a-=2.625/2.75)*a+0.984375)+e},easeInOutBounce:function(d,a,e,b,c){return a<c/2?0.5*jQuery.easing.easeInBounce(d,2*a,0,b,c)+e:0.5*jQuery.easing.easeOutBounce(d,2*a-c,0,b,c)+0.5*b+e}});var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(d){for(var a=0;a<d.length;a++){var e=d[a].string,b=d[a].prop;this.versionSearchString=d[a].versionSearch||d[a].identity;if(e){if(-1!=e.indexOf(d[a].subString))return d[a].identity}else if(b)return d[a].identity}},
searchVersion:function(d){var a=d.indexOf(this.versionSearchString);if(-1!=a)return parseFloat(d.substring(a+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",
identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",
identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();(function(d,a,e){(function(b){"function"==typeof define&&define.amd?define(["jquery"],b):jQuery&&!jQuery.fn.qtip&&b(jQuery)})(function(b){function c(b){ja={pageX:b.pageX,pageY:b.pageY,type:"mousemove",scrollX:d.pageXOffset||a.body.scrollLeft||a.documentElement.scrollLeft,scrollY:d.pageYOffset||a.body.scrollTop||a.documentElement.scrollTop}}function g(a){var c=function(b){return b===K||"object"!=typeof b},d=function(a){return!b.isFunction(a)&&(!a&&!a.attr||1>a.length||"object"==typeof a&&!a.jquery&&
!a.then)};if(!a||"object"!=typeof a)return k;c(a.metadata)&&(a.metadata={type:a.metadata});if("content"in a){if(c(a.content)||a.content.jquery)a.content={text:a.content};d(a.content.text||k)&&(a.content.text=k);"title"in a.content&&(c(a.content.title)&&(a.content.title={text:a.content.title}),d(a.content.title.text||k)&&(a.content.title.text=k))}return"position"in a&&c(a.position)&&(a.position={my:a.position,at:a.position}),"show"in a&&c(a.show)&&(a.show=a.show.jquery?{target:a.show}:{event:a.show}),
"hide"in a&&c(a.hide)&&(a.hide=a.hide.jquery?{target:a.hide}:{event:a.hide}),"style"in a&&c(a.style)&&(a.style={classes:a.style}),b.each(C,function(){this.sanitize&&this.sanitize(a)}),a}function l(v,n,P,l){function s(a){var b=0,c,d=n;for(a=a.split(".");d=d[a[b++]];)b<a.length&&(c=d);return[c||n,a.pop()]}function E(a){return T.concat("").join(a?"-"+a+" ":" ")}function O(){var a=n.style.widget,b=u.hasClass(X);u.removeClass(X);X=a?"ui-state-disabled":"qtip-disabled";u.toggleClass(X,b);u.toggleClass("ui-helper-reset "+
E(),a).toggleClass(wa,n.style.def&&!a);I.content&&I.content.toggleClass(E("content"),a);I.titlebar&&I.titlebar.toggleClass(E("header"),a);I.button&&I.button.toggleClass(ca+"-icon",!a)}function t(a){I.title&&(I.titlebar.remove(),I.titlebar=I.title=I.button=K,a!==k&&h.reposition())}function A(){var a=n.content.title.button,c="string"==typeof a?a:"Close tooltip";I.button&&I.button.remove();a.jquery?I.button=a:I.button=b("<a />",{"class":"qtip-close "+(n.style.widget?"":ca+"-icon"),title:c,"aria-label":c}).prepend(b("<span />",
{"class":"ui-icon ui-icon-close",html:"&times;"}));I.button.appendTo(I.titlebar||u).attr("role","button").click(function(a){return u.hasClass(X)||h.hide(a),k})}function xa(){var a=D+"-title";I.titlebar&&t();I.titlebar=b("<div />",{"class":ca+"-titlebar "+(n.style.widget?E("header"):"")}).append(I.title=b("<div />",{id:a,"class":ca+"-title","aria-atomic":r})).insertBefore(I.content).delegate(".qtip-close","mousedown keydown mouseup keyup mouseout",function(a){b(this).toggleClass("ui-state-active ui-state-focus",
"down"===a.type.substr(-4))}).delegate(".qtip-close","mouseover mouseout",function(a){b(this).toggleClass("ui-state-hover","mouseover"===a.type)});n.content.title.button&&A()}function y(a,c){var d=I.title;if(!h.rendered||!a)return k;b.isFunction(a)&&(a=a.call(v,Q.event,h));if(a===k||!a&&""!==a)return t(k);a.jquery&&0<a.length?d.empty().append(a.css({display:"block"})):d.html(a);c!==k&&h.rendered&&0<u[0].offsetWidth&&h.reposition(Q.event)}function F(a){a&&b.isFunction(a.done)&&a.done(function(a){B(a,
null,k)})}function B(a,c,d){function f(a){function d(x){x&&(delete N[x.src],clearTimeout(h.timers.img[x.src]),b(x).unbind(z));b.isEmptyObject(N)&&(c!==k&&h.reposition(Q.event),a())}var x,N={};if(0===(x=q.find("img[src]:not([height]):not([width])")).length)return d();x.each(function(a,x){if(N[x.src]===e){var c=0;(function Ca(){if(x.height||x.width||3<c)return d(x);c+=1;h.timers.img[x.src]=setTimeout(Ca,700)})();b(x).bind("error"+z+" load"+z,function(){d(this)});N[x.src]=x}})}var q=I.content;return!h.rendered||
!a?k:(b.isFunction(a)&&(a=a.call(v,Q.event,h)||""),d!==k&&F(n.content.deferred),a.jquery&&0<a.length?q.empty().append(a.css({display:"block"})):q.html(a),0>h.rendered?u.queue("fx",f):(fa=0,f(b.noop)),h)}function G(){function e(a){if(u.hasClass(X))return k;clearTimeout(h.timers.show);clearTimeout(h.timers.hide);var x=function(){h.toggle(r,a)};0<n.show.delay?h.timers.show=setTimeout(x,n.show.delay):x()}function g(a){if(u.hasClass(X)||f||fa)return k;var x=b(a.relatedTarget||a.target),c=x.closest(aa)[0]===
u[0],x=x[0]===m.show[0];clearTimeout(h.timers.show);clearTimeout(h.timers.hide);if("mouse"===q.target&&c||n.hide.fixed&&/mouse(out|leave|move)/.test(a.type)&&(c||x))try{a.preventDefault(),a.stopImmediatePropagation()}catch(d){}else 0<n.hide.delay?h.timers.hide=setTimeout(function(){h.hide(a)},n.hide.delay):h.hide(a)}function l(a){if(u.hasClass(X))return k;clearTimeout(h.timers.inactive);h.timers.inactive=setTimeout(function(){h.hide(a)},n.hide.inactive)}function G(a){h.rendered&&0<u[0].offsetWidth&&
h.reposition(a)}var q=n.position,m={show:n.show.target,hide:n.hide.target,viewport:b(q.viewport),document:b(a),body:b(a.body),window:b(d)},s=b.trim(""+n.show.event).split(" "),x=b.trim(""+n.hide.event).split(" ");b.browser.msie&&parseInt(b.browser.version,10);u.bind("mouseenter"+z+" mouseleave"+z,function(a){var x="mouseenter"===a.type;x&&h.focus(a);u.toggleClass(ya,x)});/mouse(out|leave)/i.test(n.hide.event)&&"window"===n.hide.leave&&m.window.bind("mouseout"+z+" blur"+z,function(a){!/select|option/.test(a.target.nodeName)&&
!a.relatedTarget&&h.hide(a)});n.hide.fixed?(m.hide=m.hide.add(u),u.bind("mouseover"+z,function(){u.hasClass(X)||clearTimeout(h.timers.hide)})):/mouse(over|enter)/i.test(n.show.event)&&m.hide.bind("mouseleave"+z,function(a){clearTimeout(h.timers.show)});-1<(""+n.hide.event).indexOf("unfocus")&&q.container.closest("html").bind("mousedown"+z+" touchstart"+z,function(a){var x=b(a.target);h.rendered&&u.hasClass(X);var c=0<x.parents(aa).filter(u[0]).length;x[0]!==v[0]&&x[0]!==u[0]&&!c&&!v.has(x[0]).length&&
!x.attr("disabled")&&h.hide(a)});"number"==typeof n.hide.inactive&&(m.show.bind("qtip-"+P+"-inactive",l),b.each(L.inactiveEvents,function(a,x){m.hide.add(I.tooltip).bind(x+z+"-inactive",l)}));b.each(x,function(a,x){var c=b.inArray(x,s),d=b(m.hide);-1<c&&d.add(m.show).length===d.length||"unfocus"===x?(m.show.bind(x+z,function(a){0<u[0].offsetWidth?g(a):e(a)}),delete s[c]):m.hide.bind(x+z,g)});b.each(s,function(a,x){m.show.bind(x+z,e)});"number"==typeof n.hide.distance&&m.show.add(u).bind("mousemove"+
z,function(a){var x=Q.origin||{},b=n.hide.distance,c=Math.abs;(c(a.pageX-x.pageX)>=b||c(a.pageY-x.pageY)>=b)&&h.hide(a)});"mouse"===q.target&&(m.show.bind("mousemove"+z,c),q.adjust.mouse&&(n.hide.event&&(u.bind("mouseleave"+z,function(a){(a.relatedTarget||a.target)!==m.show[0]&&h.hide(a)}),I.target.bind("mouseenter"+z+" mouseleave"+z,function(a){Q.onTarget="mouseenter"===a.type})),m.document.bind("mousemove"+z,function(a){h.rendered&&Q.onTarget&&!u.hasClass(X)&&0<u[0].offsetWidth&&h.reposition(a||
ja)})));(q.adjust.resize||m.viewport.length)&&(b.event.special.resize?m.viewport:m.window).bind("resize"+z,G);m.window.bind("scroll"+z,G)}function J(){var c=[n.show.target[0],n.hide.target[0],h.rendered&&I.tooltip[0],n.position.container[0],n.position.viewport[0],n.position.container.closest("html")[0],d,a];h.rendered?b([]).pushStack(b.grep(c,function(a){return"object"==typeof a})).unbind(z):n.show.target.unbind(z+"-create")}var h=this,D=ca+"-"+P,f=0,fa=0,u=b(),z=".qtip-"+P,X="qtip-disabled",I,Q;
h.id=P;h.rendered=k;h.destroyed=k;h.elements=I={target:v};h.timers={img:{}};h.options=n;h.checks={};h.plugins={};h.cache=Q={event:{},target:b(),disabled:k,attr:l,onTarget:k,lastClass:""};h.checks.builtin={"^id$":function(a,c,d){a=d===r?L.nextid:d;c=ca+"-"+a;a!==k&&0<a.length&&!b("#"+c).length&&(u[0].id=c,I.content[0].id=c+"-content",I.title[0].id=c+"-title")},"^content.text$":function(a,b,c){B(n.content.text)},"^content.deferred$":function(a,b,c){F(n.content.deferred)},"^content.title.text$":function(a,
b,c){if(!c)return t();!I.title&&c&&xa();y(c)},"^content.title.button$":function(a,b,c){a=I.button;h.rendered&&(c?A():a.remove())},"^position.(my|at)$":function(a,b,c){"string"==typeof c&&(a[b]=new C.Corner(c))},"^position.container$":function(a,b,c){h.rendered&&u.appendTo(c)},"^show.ready$":function(){h.rendered?h.toggle(r):h.render(1)},"^style.classes$":function(a,b,c){u.attr("class",ca+" qtip "+c)},"^style.width|height":function(a,b,c){u.css(b,c)},"^style.widget|content.title":O,"^events.(render|show|move|hide|focus|blur)$":function(a,
c,d){u[(b.isFunction(d)?"":"un")+"bind"]("tooltip"+c,d)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){var a=n.position;u.attr("tracking","mouse"===a.target&&a.adjust.mouse);J();G()}};b.extend(h,{_triggerEvent:function(a,c,d){a=b.Event("tooltip"+a);return a.originalEvent=(d?b.extend({},d):K)||Q.event||K,u.trigger(a,[h].concat(c||[])),!a.isDefaultPrevented()},render:function(a){if(h.rendered)return h;var c=n.content.text,d=n.content.title,e=n.position;
return b.attr(v[0],"aria-describedby",D),u=I.tooltip=b("<div/>",{id:D,"class":[ca,wa,n.style.classes,ca+"-pos-"+n.position.my.abbrev()].join(" "),width:n.style.width||"",height:n.style.height||"",tracking:"mouse"===e.target&&e.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":k,"aria-describedby":D+"-content","aria-hidden":r}).toggleClass(X,Q.disabled).data("qtip",h).appendTo(n.position.container).append(I.content=b("<div />",{"class":ca+"-content",id:D+"-content","aria-atomic":r})),h.rendered=
-1,f=1,d.text?(xa(),b.isFunction(d.text)||y(d.text,k)):d.button&&A(),(!b.isFunction(c)||c.then)&&B(c,k),h.rendered=r,O(),b.each(n.events,function(a,c){b.isFunction(c)&&u.bind("toggle"===a?"tooltipshow tooltiphide":"tooltip"+a,c)}),b.each(C,function(){"render"===this.initialize&&this(h)}),G(),u.queue("fx",function(b){h._triggerEvent("render");f=0;(n.show.ready||a)&&h.toggle(r,Q.event,k);b()}),h},get:function(a){switch(a.toLowerCase()){case "dimensions":a={height:u.outerHeight(k),width:u.outerWidth(k)};
break;case "offset":a=C.offset(u,n.position.container);break;default:a=s(a.toLowerCase()),a=a[0][a[1]],a=a.precedance?a.string():a}return a},set:function(a,c){var d=/^position\.(my|at|adjust|target|container)|style|content|show\.ready/i,e=k,v=h.checks,m;return"string"==typeof a?(m=a,a={},a[m]=c):a=b.extend(r,{},a),b.each(a,function(c,x){var N=s(c.toLowerCase()),ga;ga=N[0][N[1]];N[0][N[1]]="object"==typeof x&&x.nodeType?b(x):x;a[c]=[N[0],N[1],x,ga];e=d.test(c)||e}),g(n),f=1,b.each(a,function(a,x){var b,
c,d;for(b in v)for(c in v[b])if(d=RegExp(c,"i").exec(a))x.push(d),v[b][c].apply(h,x)}),f=0,h.rendered&&0<u[0].offsetWidth&&e&&h.reposition("mouse"===n.position.target?K:Q.event),h},toggle:function(d,f,e){function v(){d?(b.browser.msie&&u[0].style.removeAttribute("filter"),u.css("overflow",""),"string"==typeof m.autofocus&&b(m.autofocus,u).focus(),m.target.trigger("qtip-"+P+"-inactive")):u.css({display:"",visibility:"",opacity:"",left:"",top:""});h._triggerEvent(d?"visible":"hidden")}if(f){if(/over|enter/.test(f.type)&&
/out|leave/.test(Q.event.type)&&n.show.target.add(f.target).length===n.show.target.length&&u.has(f.relatedTarget).length)return h;Q.event=b.extend({},f)}if(!h.rendered)return d?h.render(1):h;var q=d?"show":"hide",m=n[q],g=n.position,x=n.content,N=0<u[0].offsetWidth,ga=d||1===m.target.length,ha=!f||2>m.target.length||Q.target[0]===f.target;return(typeof d).search("boolean|number")&&(d=!N),!u.is(":animated")&&N===d&&ha?h:h._triggerEvent(q,[90])?(b.attr(u[0],"aria-hidden",!d),d?(Q.origin=b.extend({},
ja),h.focus(f),b.isFunction(x.text)&&B(x.text,k),b.isFunction(x.title.text)&&y(x.title.text,k),!ua&&"mouse"===g.target&&g.adjust.mouse&&(b(a).bind("mousemove.qtip",c),ua=r),h.reposition(f,e),!m.solo||b(aa,m.solo).not(u).qtip("hide",b.Event("tooltipsolo"))):(clearTimeout(h.timers.show),delete Q.origin,ua&&!b(aa+'[tracking="true"]:visible',m.solo).not(u).length&&(b(a).unbind("mousemove.qtip"),ua=k),h.blur(f)),m.effect===k||ga===k?(u[q](),v.call(u)):b.isFunction(m.effect)?(u.stop(1,1),m.effect.call(u,
h),u.queue("fx",function(a){v();a()})):u.fadeTo(90,d?1:0,v),d&&m.target.trigger("qtip-"+P+"-inactive"),h):h},show:function(a){return h.toggle(r,a)},hide:function(a){return h.toggle(k,a)},focus:function(a){if(!h.rendered)return h;var c=b(aa),d=parseInt(u[0].style.zIndex,10),f=L.zindex+c.length;a=b.extend({},a);return u.hasClass(pa)||h._triggerEvent("focus",[f],a)&&(d!==f&&(c.each(function(){this.style.zIndex>d&&(this.style.zIndex-=1)}),c.filter("."+pa).qtip("blur",a)),u.addClass(pa)[0].style.zIndex=
f),h},blur:function(a){return u.removeClass(pa),h._triggerEvent("blur",[u.css("zIndex")],a),h},reposition:function(c,e){if(!h.rendered||f)return h;f=1;var v=n.position.target,P=n.position,q=P.my,m=P.at,g=P.adjust,x=g.method.split(" "),N=u.outerWidth(k),ga=u.outerHeight(k),ha=0,sa=0,l=u.css("position"),G=P.viewport,z={left:0,top:0},s=P.container,r=0<u[0].offsetWidth,y=c&&"scroll"===c.type,J=b(d),U,X;if(b.isArray(v)&&2===v.length)m={x:W,y:V},z={left:v[0],top:v[1]};else if("mouse"===v&&(c&&c.pageX||
Q.event.pageX))m={x:W,y:V},c=ja&&ja.pageX&&(g.mouse||!c||!c.pageX)?{pageX:ja.pageX,pageY:ja.pageY}:(!c||"resize"!==c.type&&"scroll"!==c.type?c&&c.pageX&&"mousemove"===c.type?c:!g.mouse&&Q.origin&&Q.origin.pageX&&n.show.distance?Q.origin:c:Q.event)||c||Q.event||ja||{},"static"!==l&&(z=s.offset()),z={left:c.pageX-z.left,top:c.pageY-z.top},g.mouse&&y&&(z.left-=ja.scrollX-J.scrollLeft(),z.top-=ja.scrollY-J.scrollTop());else{"event"===v&&c&&c.target&&"scroll"!==c.type&&"resize"!==c.type?Q.target=b(c.target):
"event"!==v&&(Q.target=b(v.jquery?v:I.target));v=Q.target;v=b(v).eq(0);if(0===v.length)return h;v[0]===a||v[0]===d?(ha=C.iOS?d.innerWidth:v.width(),sa=C.iOS?d.innerHeight:v.height(),v[0]===d&&(z={top:(G||v).scrollTop(),left:(G||v).scrollLeft()})):C.imagemap&&v.is("area")?U=C.imagemap(h,v,m,C.viewport?x:k):C.svg&&v[0].ownerSVGElement?U=C.svg(h,v,m,C.viewport?x:k):(ha=v.outerWidth(k),sa=v.outerHeight(k),z=C.offset(v,s));U&&(ha=U.width,sa=U.height,X=U.offset,z=U.position);if(3.1<C.iOS&&4.1>C.iOS||4.3<=
C.iOS&&4.33>C.iOS||!C.iOS&&"fixed"===l)z.left-=J.scrollLeft(),z.top-=J.scrollTop();z.left+=m.x===Y?ha:m.x===M?ha/2:0;z.top+=m.y===w?sa:m.y===M?sa/2:0}return z.left+=g.x+(q.x===Y?-N:q.x===M?-N/2:0),z.top+=g.y+(q.y===w?-ga:q.y===M?-ga/2:0),C.viewport?(z.adjusted=C.viewport(h,z,P,ha,sa,N,ga),X&&z.adjusted.left&&(z.left+=X.left),X&&z.adjusted.top&&(z.top+=X.top)):z.adjusted={left:0,top:0},h._triggerEvent("move",[z,G.elem||G],c)?(delete z.adjusted,e===k||!r||isNaN(z.left)||isNaN(z.top)||"mouse"===v||!b.isFunction(P.effect)?
u.css(z):b.isFunction(P.effect)&&(P.effect.call(u,h,b.extend({},z)),u.queue(function(a){b(this).css({opacity:"",height:""});b.browser.msie&&this.style.removeAttribute("filter");a()})),f=0,h):h},disable:function(a){return"boolean"!=typeof a&&(a=!u.hasClass(X)&&!Q.disabled),h.rendered?(u.toggleClass(X,a),b.attr(u[0],"aria-disabled",a)):Q.disabled=!!a,h},enable:function(){return h.disable(k)},destroy:function(){var a=v[0],c=b.attr(a,la),d=v.data("qtip");h.destroyed=r;h.rendered&&(u.stop(1,0).remove(),
b.each(h.plugins,function(){this.destroy&&this.destroy()}));clearTimeout(h.timers.show);clearTimeout(h.timers.hide);J();if(!d||h===d)b.removeData(a,"qtip"),n.suppress&&c&&(b.attr(a,"title",c),v.removeAttr(la)),v.removeAttr("aria-describedby");return v.unbind(".qtip-"+P),delete S[h.id],v}})}function na(c,d){var e,U,s,E,O,t=b(this),A=b(a.body),w=this===a?A:t;U=t.metadata?t.metadata(d.metadata):K;E="html5"===d.metadata.type&&U?U[d.metadata.name]:K;var y=t.data(d.metadata.name||"qtipopts");try{y="string"==
typeof y?b.parseJSON(y):y}catch(F){}E=b.extend(r,{},L.defaults,d,"object"==typeof y?g(y):K,g(E||U));U=E.position;E.id=c;if("boolean"==typeof E.content.text){s=t.attr(E.content.attr);if(E.content.attr===k||!s)return k;E.content.text=s}U.container.length||(U.container=A);U.target===k&&(U.target=w);E.show.target===k&&(E.show.target=w);E.show.solo===r&&(E.show.solo=U.container.closest("body"));E.hide.target===k&&(E.hide.target=w);E.position.viewport===r&&(E.position.viewport=U.container);U.container=
U.container.eq(0);U.at=new C.Corner(U.at);U.my=new C.Corner(U.my);if(b.data(this,"qtip"))if(E.overwrite)t.qtip("destroy");else if(E.overwrite===k)return k;return E.suppress&&(O=b.attr(this,"title"))&&b(this).removeAttr("title").attr(la,O).attr("title",""),e=new l(t,E,c,!!s),b.data(this,"qtip",e),t.bind("remove.qtip-"+c+" removeqtip.qtip-"+c,function(){e.destroy()}),e}function Z(a){var c=this,d=a.elements.tooltip,e=a.options.content.ajax,g=L.defaults.content.ajax,l=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
O=r,t=k,A;a.checks.ajax={"^content.ajax":function(a,b,v){"ajax"===b&&(e=v);"once"===b?c.init():e&&e.url?c.load():d.unbind(".qtip-ajax")}};b.extend(c,{init:function(){return e&&e.url&&d.unbind(".qtip-ajax")[e.once?"one":"bind"]("tooltipshow.qtip-ajax",c.load),c},load:function(d){function P(){var c;a.destroyed||(O=k,D&&(t=r,a.show(d.originalEvent)),(c=g.complete||e.complete)&&b.isFunction(c)&&c.apply(e.context||a,arguments))}function F(c,d,f){var n;a.destroyed||(h&&"string"==typeof c&&(c=b("<div/>").append(c.replace(l,
"")).find(h)),(n=g.success||e.success)&&b.isFunction(n)?n.call(e.context||a,c,d,f):a.set("content.text",c))}function B(c,b,d){a.destroyed||0===c.status||a.set("content.text",b+": "+d)}if(t)t=k;else{var G=e.url.lastIndexOf(" "),J=e.url,h,D=!e.loading&&O;if(D)try{d.preventDefault()}catch(f){}else if(d&&d.isDefaultPrevented())return c;A&&A.abort&&A.abort();-1<G&&(h=J.substr(G),J=J.substr(0,G));A=b.ajax(b.extend({error:g.error||B,context:a},e,{url:J,success:F,complete:P}))}},destroy:function(){A&&A.abort&&
A.abort();a.destroyed=r}});c.init()}function ra(a,c,b){var d=Math.ceil(c/2),e=Math.ceil(b/2);c={bottomright:[[0,0],[c,b],[c,0]],bottomleft:[[0,0],[c,0],[0,b]],topright:[[0,b],[c,0],[c,b]],topleft:[[0,0],[0,b],[c,b]],topcenter:[[0,b],[d,0],[c,b]],bottomcenter:[[0,0],[c,0],[d,b]],rightcenter:[[0,0],[c,e],[0,b]],leftcenter:[[c,0],[c,b],[0,e]]};return c.lefttop=c.bottomright,c.righttop=c.bottomleft,c.leftbottom=c.topright,c.rightbottom=c.topleft,c[a.string()]}function ba(a,c){var d,g;function l(a){var c=
J.is(":visible");J.show();a();J.toggle(c)}function E(c,b,d,f){if(G.tip){c=F.corner.clone();b=d.adjusted;var n=a.options.position.adjust.method.split(" ");f=n[0];var n=n[1]||n[0],g=k,l=k,P=0,J=0,q,m={},s;F.corner.fixed!==r&&(f===ea&&c.precedance===ia&&b.left&&c.y!==M?c.precedance=c.precedance===ia?da:ia:f!==ea&&b.left&&(c.x=c.x===M?0<b.left?W:Y:c.x===W?Y:W),n===ea&&c.precedance===da&&b.top&&c.x!==M?c.precedance=c.precedance===da?ia:da:n!==ea&&b.top&&(c.y=c.y===M?0<b.top?V:w:c.y===V?w:V),c.string()!==
h.corner.string()&&(h.top!==b.top||h.left!==b.left)&&F.update(c,k));q=F.position(c,b);q[c.x]+=O(c,c.x);q[c.y]+=O(c,c.y);q.right!==e&&(q.left=-q.right);q.bottom!==e&&(q.top=-q.bottom);q.user=Math.max(0,B.offset);if(g=f===ea&&!!b.left)c.x===M?m["margin-left"]=P=q["margin-left"]:(s=q.right!==e?[b.left,-q.left]:[-b.left,q.left],(P=Math.max(s[0],s[1]))>s[0]&&(d.left-=b.left,g=k),m[q.right!==e?Y:W]=P);if(l=n===ea&&!!b.top)c.y===M?m["margin-top"]=J=q["margin-top"]:(s=q.bottom!==e?[b.top,-q.top]:[-b.top,
q.top],(J=Math.max(s[0],s[1]))>s[0]&&(d.top-=b.top,l=k),m[q.bottom!==e?w:V]=J);G.tip.css(m).toggle(!(P&&J||c.x===M&&J||c.y===M&&P));d.left-=q.left.charAt?q.user:f!==ea||l||!g&&!l?q.left:0;d.top-=q.top.charAt?q.user:n!==ea||g||!g&&!l?q.top:0;h.left=b.left;h.top=b.top;h.corner=c.clone()}}function O(a,c,b){c=c?c:a[a.precedance];var d=G.titlebar&&a.y===V?G.titlebar:J,f="border-"+c+"-width",e;return l(function(){e=(b?parseInt(b.css(f),10):parseInt(G.content.css(f),10)||parseInt(d.css(f),10)||parseInt(J.css(f),
10))||0}),e}function t(a){var c=G.titlebar&&a.y===V?G.titlebar:G.content,d=b.browser.mozilla?"-moz-":b.browser.webkit?"-webkit-":"",f="border-radius-"+a.y+a.x,e="border-"+a.y+"-"+a.x+"-radius",h=function(a){return parseInt(c.css(a),10)||parseInt(J.css(a),10)},n;return l(function(){n=h(e)||h(d+e)||h(d+f)||h(f)||0}),n}function A(a){function c(a,b,d){b=a.css(b)||n;return d&&b===a.css(d)?k:e.test(b)?k:b}var f=G.tip.css("cssText","");a=a||F.corner;var e=/rgba?\(0, 0, 0(, 0)?\)|transparent|#123456/i,h=
"border-"+a[a.precedance]+"-color",n="transparent",v=G.titlebar,y=v&&(a.y===V||a.y===M&&f.position().top+D.height/2+B.offset<v.outerHeight(r))?v:G.content;l(function(){d=c(f,"background-color")||c(y,"background-color")||c(G.content,"background-color")||c(J,"background-color")||f.css("background-color");g=c(f,h,"color")||c(y,h,"color")||c(G.content,h,"color")||c(J,h,"color")||J.css(h);b("*",f).add(f).css("cssText","background-color:"+n+" !important;border:0 !important;")})}function L(a){var c=a.precedance===
da,b=D[c?ka:R],d=D[c?R:ka];a=-1<a.string().indexOf(M);var e=b*(a?0.5:1),h=Math.pow,n=Math.round,g,v,k,m=Math.sqrt(h(e,2)+h(d,2)),e=[f/e*m,f/d*m];return e[2]=Math.sqrt(h(e[0],2)-h(f,2)),e[3]=Math.sqrt(h(e[1],2)-h(f,2)),g=m+e[2]+e[3]+(a?0:e[0]),v=g/m,k=[n(v*d),n(v*b)],{height:k[c?0:1],width:k[c?1:0]}}function y(a,c,b){return"<qvml:"+a+' xmlns="urn:schemas-microsoft.com:vml" class="qtip-vml" '+(c||"")+' style="behavior: url(#default#VML); '+(b||"")+'" />'}var F=this,B=a.options.style.tip,G=a.elements,
J=G.tooltip,h={top:0,left:0},D={width:B.width,height:B.height};g=d=void 0;var f=B.border||0,fa=!!(b("<canvas />")[0]||{}).getContext;F.corner=K;F.mimic=K;F.border=f;F.offset=B.offset;F.size=D;a.checks.tip={"^position.my|style.tip.(corner|mimic|border)$":function(){F.init()||F.destroy();a.reposition()},"^style.tip.(height|width)$":function(){D={width:B.width,height:B.height};F.create();F.update();a.reposition()},"^content.title.text|style.(classes|widget)$":function(){G.tip&&G.tip.length&&F.update()}};
b.extend(F,{init:function(){var c=B.corner,d=a.options.position,f=d.at,d=d.my.string?d.my.string():d.my,c=(c===k||d===k&&f===k?k:(c===r?F.corner=new C.Corner(d):c.string||(F.corner=new C.Corner(c),F.corner.fixed=r),h.corner=new C.Corner(F.corner.string()),"centercenter"!==F.corner.string()))&&(fa||b.browser.msie);return c&&(F.create(),F.update(),J.unbind(".qtip-tip").bind("tooltipmove.qtip-tip",E)),c},create:function(){var a=D.width,c=D.height,d;G.tip&&G.tip.remove();G.tip=b("<div />",{"class":"qtip-tip"}).css({width:a,
height:c}).prependTo(J);fa?b("<canvas />").appendTo(G.tip)[0].getContext("2d").save():(d=y("shape",'coordorigin="0,0"',"position:absolute;"),G.tip.html(d+d),b("*",G.tip).bind("click mousedown",function(a){a.stopPropagation()}))},update:function(a,c){var e=G.tip,n=e.children(),v=D.width,l=D.height,s=B.mimic,E=Math.round,t,q,m,H;a||(a=h.corner||F.corner);s===k?s=a:(s=new C.Corner(s),s.precedance=a.precedance,"inherit"===s.x?s.x=a.x:"inherit"===s.y?s.y=a.y:s.x===s.y&&(s[a.precedance]=a[a.precedance]));
a.precedance===ia?(D.width=B.height,D.height=B.width):(D.width=B.width,D.height=B.height);G.tip.css({width:v=D.width,height:l=D.height});A(a);"transparent"!==g?(f=O(a,K),0===B.border&&0<f&&(d=g),F.border=f=B.border!==r?B.border:f):F.border=f=0;q=ra(s,v,l);F.size=H=L(a);e.css(H).css("line-height",H.height+"px");a.precedance===da?m=[E(s.x===W?f:s.x===Y?H.width-v-f:(H.width-v)/2),E(s.y===V?H.height-l:0)]:m=[E(s.x===W?H.width-v:0),E(s.y===V?f:s.y===w?H.height-l-f:(H.height-l)/2)];fa?(n.attr(H),t=n[0].getContext("2d"),
t.restore(),t.save(),t.clearRect(0,0,3E3,3E3),t.fillStyle=d,t.strokeStyle=g,t.lineWidth=2*f,t.lineJoin="miter",t.miterLimit=100,t.translate(m[0],m[1]),t.beginPath(),t.moveTo(q[0][0],q[0][1]),t.lineTo(q[1][0],q[1][1]),t.lineTo(q[2][0],q[2][1]),t.closePath(),f&&("border-box"===J.css("background-clip")&&(t.strokeStyle=d,t.stroke()),t.strokeStyle=g,t.stroke()),t.fill()):(q="m"+q[0][0]+","+q[0][1]+" l"+q[1][0]+","+q[1][1]+" "+q[2][0]+","+q[2][1]+" xe",m[2]=f&&/^(r|b)/i.test(a.string())?8===parseFloat(b.browser.version,
10)?2:1:0,n.css({coordsize:v+f+" "+(l+f),antialias:""+(-1<s.string().indexOf(M)),left:m[0],top:m[1],width:v+f,height:l+f}).each(function(a){var c=b(this);c[c.prop?"prop":"attr"]({coordsize:v+f+" "+(l+f),path:q,fillcolor:d,filled:!!a,stroked:!a}).toggle(!!f||!!a);!a&&""===c.html()&&c.html(y("stroke",'weight="'+2*f+'px" color="'+g+'" miterlimit="1000" joinstyle="miter"'))}));c!==k&&F.position(a)},position:function(a){var c=G.tip,d={},f=Math.max(0,B.offset),e,h,n;return B.corner===k||!c?k:(a=a||F.corner,
e=a.precedance,h=L(a),n=[a.x,a.y],e===ia&&n.reverse(),b.each(n,function(c,b){var n,v,g;b===M?(n=e===da?W:V,d[n]="50%",d["margin-"+n]=-Math.round(h[e===da?ka:R]/2)+f):(n=O(a,b),v=O(a,b,G.content),g=t(a),d[b]=c?v:f+(g>n?g:-n))}),d[a[e]]-=h[e===ia?ka:R],c.css({top:"",bottom:"",left:"",right:"",margin:""}).css(d),d)},destroy:function(){G.tip&&G.tip.remove();G.tip=!1;J.unbind(".qtip-tip")}});F.init()}function ta(c){function e(){F=b(y,t).not("[disabled]").map(function(){return"function"==typeof this.focus?
this:null})}function g(a){1>F.length&&a.length?a.not("body").blur():F.first().focus()}function l(a){var c=b(a.target),d=c.closest(".qtip");!(1>d.length?k:parseInt(d[0].style.zIndex,10)>parseInt(t[0].style.zIndex,10))&&b(a.target).closest(aa)[0]!==t[0]&&g(c)}var s=this,E=c.options.show.modal,O=c.elements,t=O.tooltip,A=".qtipmodal"+c.id,w=b(a.body),y=C.modal.focusable.join(","),F={},B;c.checks.modal={"^show.modal.(on|blur)$":function(){s.init();O.overlay.toggle(t.is(":visible"))},"^content.text$":function(){e()}};
b.extend(s,{init:function(){return E.on?(B=s.create(),t.attr("is-modal-qtip",r).css("z-index",C.modal.zindex+b(aa+"[is-modal-qtip]").length).unbind(".qtipmodal").unbind(A).bind("tooltipshow.qtipmodal tooltiphide.qtipmodal",function(a,c,d){c=a.originalEvent;if(a.target===t[0])if(c&&"tooltiphide"===a.type&&/mouse(leave|enter)/.test(c.type)&&b(c.relatedTarget).closest(B[0]).length)try{a.preventDefault()}catch(e){}else(!c||c&&!c.solo)&&s[a.type.replace("tooltip","")](a,d)}).bind("tooltipfocus.qtipmodal",
function(a){if(!(a.isDefaultPrevented()||a.target!==t[0])){var c=b(aa).filter("[is-modal-qtip]"),d=C.modal.zindex+c.length,e=parseInt(t[0].style.zIndex,10);B[0].style.zIndex=d-2;c.each(function(){this.style.zIndex>e&&(this.style.zIndex-=1)});c.end().filter("."+pa).qtip("blur",a.originalEvent);t.addClass(pa)[0].style.zIndex=d;try{a.preventDefault()}catch(f){}}}).bind("tooltiphide.qtipmodal",function(a){a.target===t[0]&&b("[is-modal-qtip]").filter(":visible").not(t).last().qtip("focus",a)}),E.escape&&
b(a).unbind(A).bind("keydown"+A,function(a){27===a.keyCode&&t.hasClass(pa)&&c.hide(a)}),E.blur&&O.overlay.unbind(A).bind("click"+A,function(a){t.hasClass(pa)&&c.hide(a)}),e(),s):s},create:function(){function a(){B.css({height:e.height(),width:e.width()})}var c=b("#qtip-overlay"),e=b(d);return c.length?O.overlay=c.insertAfter(b(aa).last()):(B=O.overlay=b("<div />",{id:"qtip-overlay",html:"<div></div>",mousedown:function(){return k}}).hide().insertAfter(b(aa).last()),e.unbind(".qtipmodal").bind("resize.qtipmodal",
a),a(),B)},toggle:function(a,c,d){if(a&&a.isDefaultPrevented())return s;a=E.effect;var e=c?"show":"hide",f=B.is(":visible"),n=b("[is-modal-qtip]").filter(":visible").not(t);return B||(B=s.create()),B.is(":animated")&&f===c&&B.data("toggleState")!==k||!c&&n.length?s:(c?(B.css({left:0,top:0}),B.toggleClass("blurs",E.blur),E.stealfocus!==k&&(w.bind("focusin"+A,l),g(b("body :focus")))):w.unbind("focusin"+A),B.stop(r,k).data("toggleState",c),b.isFunction(a)?a.call(B,c):a===k?B[e]():B.fadeTo(parseInt(d,
10)||90,c?1:0,function(){c||b(this).hide()}),c||B.queue(function(a){B.css({left:"",top:""}).removeData("toggleState");a()}),s)},show:function(a,c){return s.toggle(a,r,c)},hide:function(a,c){return s.toggle(a,k,c)},destroy:function(){var d=B;return d&&(d=1>b("[is-modal-qtip]").not(t).length,d?(O.overlay.remove(),b(a).unbind(".qtipmodal")):O.overlay.unbind(".qtipmodal"+c.id),w.unbind("focusin"+A)),t.removeAttr("is-modal-qtip").unbind(".qtipmodal")}});s.init()}function oa(c){var e=this,g=c.elements,
l=c.options,s=g.tooltip,E=".ie6-"+c.id,O=1>b("select, object").length,t=0,A=k,w;c.checks.ie6={"^content|style$":function(a,c,b){redraw()}};b.extend(e,{init:function(){var c=b(d),v;O&&(g.bgiframe=b('<iframe class="qtip-bgiframe" frameborder="0" tabindex="-1" src="javascript:\'\';"  style="display:block; position:absolute; z-index:-1; filter:alpha(opacity=0); -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";"></iframe>'),g.bgiframe.appendTo(s),s.bind("tooltipmove"+E,e.adjustBGIFrame));
w=b("<div/>",{id:"qtip-rcontainer"}).appendTo(a.body);e.redraw();g.overlay&&!A&&(v=function(){g.overlay[0].style.top=c.scrollTop()+"px"},c.bind("scroll.qtip-ie6, resize.qtip-ie6",v),v(),g.overlay.addClass("qtipmodal-ie6fix"),A=r)},adjustBGIFrame:function(){var a=c.get("dimensions"),b=c.plugins.tip,d=g.tip,e,n;n=parseInt(s.css("border-left-width"),10)||0;n={left:-n,top:-n};b&&d&&(e="x"===b.corner.precedance?["width","left"]:["height","top"],n[e[1]]-=d[e[0]]());g.bgiframe.css(n).css(a)},redraw:function(){if(1>
c.rendered||t)return e;var a=l.style,b=l.position.container,d,g,k,h;return t=1,a.height&&s.css(R,a.height),a.width?s.css(ka,a.width):(s.css(ka,"").appendTo(w),g=s.width(),1>g%2&&(g+=1),k=s.css("max-width")||"",h=s.css("min-width")||"",d=-1<(k+h).indexOf("%")?b.width()/100:0,k=(-1<k.indexOf("%")?d:1)*parseInt(k,10)||g,h=(-1<h.indexOf("%")?d:1)*parseInt(h,10)||0,g=k+h?Math.min(Math.max(g,h),k):g,s.css(ka,Math.round(g)).appendTo(b)),t=0,e},destroy:function(){O&&g.bgiframe.remove();s.unbind(E)}});e.init()}
var r=!0,k=!1,K=null,ia="x",da="y",ka="width",R="height",V="top",W="left",w="bottom",Y="right",M="center",qa="flipinvert",ea="shift",L,C,ja,ca="qtip",S={},T=["ui-widget","ui-tooltip"],aa="div.qtip."+ca,wa=ca+"-default",pa=ca+"-focus",ya=ca+"-hover",la="oldtitle",ua;L=b.fn.qtip=function(a,c,d){var l=(""+a).toLowerCase(),s=K,E=b.makeArray(arguments).slice(1),w=E[E.length-1],t=this[0]?b.data(this[0],"qtip"):K;if(!arguments.length&&t||"api"===l)return t;if("string"==typeof a)return this.each(function(){var a=
b.data(this,"qtip");if(!a)return r;w&&w.timeStamp&&(a.cache.event=w);if("option"!==l&&"options"!==l||!c)a[l]&&a[l].apply(a[l],E);else{if(!b.isPlainObject(c)&&d===e)return s=a.get(c),k;a.set(c,d)}}),s!==K?s:this;if("object"==typeof a||!arguments.length)return t=g(b.extend(r,{},a)),L.bind.call(this,t,w)};L.bind=function(a,d){return this.each(function(g){function l(a){function c(){A.render("object"==typeof a||s.show.ready);E.show.add(E.hide).unbind(t)}if(A.cache.disabled)return k;A.cache.event=b.extend({},
a);A.cache.target=a?b(a.target):[e];0<s.show.delay?(clearTimeout(A.timers.show),A.timers.show=setTimeout(c,s.show.delay),w.show!==w.hide&&E.hide.bind(w.hide,function(){clearTimeout(A.timers.show)})):c()}var s,E,w,t,A;g=b.isArray(a.id)?a.id[g]:a.id;g=!g||g===k||1>g.length||S[g]?L.nextid++:S[g]=g;t=".qtip-"+g+"-create";A=na.call(this,g,a);if(A===k)return r;s=A.options;b.each(C,function(){"initialize"===this.initialize&&this(A)});E={show:s.show.target,hide:s.hide.target};w={show:b.trim(""+s.show.event).replace(/ /g,
t+" ")+t,hide:b.trim(""+s.hide.event).replace(/ /g,t+" ")+t};/mouse(over|enter)/i.test(w.show)&&!/mouse(out|leave)/i.test(w.hide)&&(w.hide+=" mouseleave"+t);E.show.bind("mousemove"+t,function(a){c(a);A.cache.onTarget=r});E.show.bind(w.show,l);(s.show.ready||s.prerender)&&l(d)}).attr("data-hasqtip",r)};C=L.plugins={Corner:function(a){a=(""+a).replace(/([A-Z])/," $1").replace(/middle/gi,M).toLowerCase();this.x=(a.match(/left|right/i)||a.match(/center/)||["inherit"])[0].toLowerCase();this.y=(a.match(/top|bottom|center/i)||
["inherit"])[0].toLowerCase();a=a.charAt(0);this.precedance="t"===a||"b"===a?da:ia;this.string=function(){return this.precedance===da?this.y+this.x:this.x+this.y};this.abbrev=function(){var a=this.x.substr(0,1),c=this.y.substr(0,1);return a===c?a:this.precedance===da?c+a:a+c};this.invertx=function(a){this.x=this.x===W?Y:this.x===Y?W:a||this.x};this.inverty=function(a){this.y=this.y===V?w:this.y===w?V:a||this.y};this.clone=function(){return{x:this.x,y:this.y,precedance:this.precedance,string:this.string,
abbrev:this.abbrev,clone:this.clone,invertx:this.invertx,inverty:this.inverty}}},offset:function(c,d){var e=c.offset(),g=c.closest("body"),k=b.browser.msie&&"CSS1Compat"!==a.compatMode,l=d,r,t,w;if(l){do"static"!==l.css("position")&&(t=l.position(),e.left-=t.left+(parseInt(l.css("borderLeftWidth"),10)||0)+(parseInt(l.css("marginLeft"),10)||0),e.top-=t.top+(parseInt(l.css("borderTopWidth"),10)||0)+(parseInt(l.css("marginTop"),10)||0),!r&&"hidden"!==(w=l.css("overflow"))&&"visible"!==w&&(r=l));while((l=
b(l[0].offsetParent)).length);if(r&&r[0]!==g[0]||k)g=r||g,e.left+=1*g.scrollLeft(),e.top+=1*g.scrollTop()}return e},iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||k,fn:{attr:function(a,c){if(this.length){var d=this[0],e=b.data(d,"qtip");if("title"===a&&e&&"object"==typeof e&&e.options.suppress)return 2>arguments.length?b.attr(d,la):(e&&"title"===e.options.content.attr&&
e.cache.attr&&e.set("content.text",c),this.attr(la,c))}return b.fn.attr_replacedByqTip.apply(this,arguments)},clone:function(a){b([]);var c=b.fn.clone_replacedByqTip.apply(this,arguments);return a||c.filter("["+la+"]").attr("title",function(){return b.attr(this,la)}).removeAttr(la),c}}};b.each(C.fn,function(a,c){if(!c||b.fn[a+"_replacedByqTip"])return r;var d=b.fn[a+"_replacedByqTip"]=b.fn[a];b.fn[a]=function(){return c.apply(this,arguments)||d.apply(this,arguments)}});b.ui||(b.cleanData_replacedByqTip=
b.cleanData,b.cleanData=function(a){for(var c=0,d;(d=a[c])!==e;c++)try{b(d).triggerHandler("removeqtip")}catch(g){}b.cleanData_replacedByqTip(a)});L.version="2.0.1";L.nextid=0;L.inactiveEvents="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" ");L.zindex=15E3;L.defaults={prerender:k,id:k,overwrite:r,suppress:r,content:{text:r,attr:"title",deferred:k,title:{text:k,button:k}},position:{my:"top left",at:"bottom right",target:k,container:k,viewport:k,adjust:{x:0,y:0,mouse:r,resize:r,
method:"flipinvert flipinvert"},effect:function(a,c,d){b(this).animate(c,{duration:200,queue:k})}},show:{target:k,event:"mouseenter",effect:r,delay:90,solo:k,ready:k,autofocus:k},hide:{target:k,event:"mouseleave",effect:r,delay:0,fixed:k,inactive:k,leave:"window",distance:k},style:{classes:"",widget:k,width:k,height:k,def:r},events:{render:K,move:K,show:K,hide:K,toggle:K,visible:K,hidden:K,focus:K,blur:K}};C.svg=function(c,d,e,g){c=b(a);var l=d[0];d={width:0,height:0,position:{top:1E10,left:1E10}};
for(var k;!l.getBBox;)l=l.parentNode;if(l.getBBox&&l.parentNode){e=l.getBBox();g=l.getScreenCTM();l=l.farthestViewportElement||l;if(!l.createSVGPoint)return d;l=l.createSVGPoint();l.x=e.x;l.y=e.y;k=l.matrixTransform(g);d.position.left=k.x;d.position.top=k.y;l.x+=e.width;l.y+=e.height;k=l.matrixTransform(g);d.width=k.x-d.position.left;d.height=k.y-d.position.top;d.position.left+=c.scrollLeft();d.position.top+=c.scrollTop()}return d};C.ajax=function(a){var c=a.plugins.ajax;return"object"==typeof c?
c:a.plugins.ajax=new Z(a)};C.ajax.initialize="render";C.ajax.sanitize=function(a){var c=a.content,b;c&&"ajax"in c&&(b=c.ajax,"object"!=typeof b&&(b=a.content.ajax={url:b}),"boolean"!=typeof b.once&&b.once&&(b.once=!!b.once))};b.extend(r,L.defaults,{content:{ajax:{loading:r,once:r}}});C.tip=function(a){var c=a.plugins.tip;return"object"==typeof c?c:a.plugins.tip=new ba(a)};C.tip.initialize="render";C.tip.sanitize=function(a){var c=a.style,b;c&&"tip"in c&&(b=a.style.tip,"object"!=typeof b&&(a.style.tip=
{corner:b}),/string|boolean/i.test(typeof b.corner)||(b.corner=r),"number"!=typeof b.width&&delete b.width,"number"!=typeof b.height&&delete b.height,"number"!=typeof b.border&&b.border!==r&&delete b.border,"number"!=typeof b.offset&&delete b.offset)};b.extend(r,L.defaults,{style:{tip:{corner:r,mimic:k,width:6,height:6,border:r,offset:0}}});C.modal=function(a){var c=a.plugins.modal;return"object"==typeof c?c:a.plugins.modal=new ta(a)};C.modal.initialize="render";C.modal.sanitize=function(a){a.show&&
("object"!=typeof a.show.modal?a.show.modal={on:!!a.show.modal}:"undefined"==typeof a.show.modal.on&&(a.show.modal.on=r))};C.modal.zindex=L.zindex-200;C.modal.focusable="a[href] area[href] input select textarea button iframe object embed [tabindex] [contenteditable]".split(" ");b.extend(r,L.defaults,{show:{modal:{on:k,effect:r,blur:r,stealfocus:r,escape:r}}});C.viewport=function(c,b,e,g,l,k,r){function t(a,c,d,e,g,l,k,q,m){var r=b[g],x=y[a],N=F[a],ga=d===ea,ha=-D.offset[g]+h.offset[g]+h["scroll"+
g],sa=x===g?m:x===l?-m:-m/2,Aa=f&&f.size?f.size[k]||0:0,t=f&&f.corner&&f.corner.precedance===a&&!ga?Aa:0,s=ha-r+t;m=r+m-h[k]-ha+t;q=sa-(y.precedance===a||x===y[c]?N===g?q:N===l?-q:-q/2:0)-(N===M?q/2:0);return ga?(t=f&&f.corner&&f.corner.precedance===c?Aa:0,q=(x===g?1:-1)*sa-t,b[g]+=0<s?s:0<m?-m:0,b[g]=Math.max(-D.offset[g]+h.offset[g]+(t&&f.corner[a]===M?f.offset:0),r-q,Math.min(Math.max(-D.offset[g]+h.offset[g]+h[k],r+q),b[g]))):(e*=d===qa?2:0,0<s&&(x!==g||0<m)?(b[g]-=q+e,u["invert"+a](g)):0<m&&
(x!==l||0<s)&&(b[g]-=(x===M?-q:q)+e,u["invert"+a](l)),b[g]<ha&&-b[g]>m&&(b[g]=r,u=y.clone())),b[g]-r}var A=e.target,C=c.elements.tooltip,y=e.my,F=e.at,B=e.adjust,G=B.method.split(" "),J=G[0],G=G[1]||G[0],h=e.viewport,D=e.container;e=c.cache;var f=c.plugins.tip,K={left:0,top:0},u,z;if(!h.jquery||A[0]===d||A[0]===a.body||"none"===B.method)return K;A="fixed"===C.css("position");h={elem:h,height:h[(h[0]===d?"h":"outerH")+"eight"](),width:h[(h[0]===d?"w":"outerW")+"idth"](),scrollleft:A?0:h.scrollLeft(),
scrolltop:A?0:h.scrollTop(),offset:h.offset()||{left:0,top:0}};D={elem:D,scrollLeft:D.scrollLeft(),scrollTop:D.scrollTop(),offset:D.offset()||{left:0,top:0}};if("shift"!==J||"shift"!==G)u=y.clone();return K={left:"none"!==J?t(ia,da,J,B.x,W,Y,ka,g,k):0,top:"none"!==G?t(da,ia,G,B.y,V,w,R,l,r):0},u&&e.lastClass!==(z=ca+"-pos-"+u.abbrev())&&C.removeClass(c.cache.lastClass).addClass(c.cache.lastClass=z),K};C.imagemap=function(a,c,d,e){function g(a,c,b){for(var d=0,e=1,l=1,k=0,n=0,r=a.width,s=a.height;0<
r&&0<s&&0<e&&0<l;){r=Math.floor(r/2);s=Math.floor(s/2);b.x===W?e=r:b.x===Y?e=a.width-r:e+=Math.floor(r/2);b.y===V?l=s:b.y===w?l=a.height-s:l+=Math.floor(s/2);for(d=c.length;d--&&!(2>c.length);)k=c[d][0]-a.position.left,n=c[d][1]-a.position.top,(b.x===W&&k>=e||b.x===Y&&k<=e||b.x===M&&(k<e||k>a.width-e)||b.y===V&&n>=l||b.y===w&&n<=l||b.y===M&&(n<l||n>a.height-l))&&c.splice(d,1)}return{left:c[0][0],top:c[0][1]}}c.jquery||(c=b(c));a=a.cache.areas={};var l=(c[0].shape||c.attr("shape")).toLowerCase(),k=
c[0].coords||c.attr("coords"),r=k.split(","),A=[];c=b('img[usemap="#'+c.parent("map").attr("name")+'"]');var C=c.offset(),y={width:0,height:0,position:{top:1E10,right:0,bottom:0,left:1E10}},F=0,B=0;C.left+=Math.ceil((c.outerWidth()-c.width())/2);C.top+=Math.ceil((c.outerHeight()-c.height())/2);if("poly"===l)for(F=r.length;F--;)B=[parseInt(r[--F],10),parseInt(r[F+1],10)],B[0]>y.position.right&&(y.position.right=B[0]),B[0]<y.position.left&&(y.position.left=B[0]),B[1]>y.position.bottom&&(y.position.bottom=
B[1]),B[1]<y.position.top&&(y.position.top=B[1]),A.push(B);else for(F=-1;F++<r.length;)A.push(parseInt(r[F],10));switch(l){case "rect":y={width:Math.abs(A[2]-A[0]),height:Math.abs(A[3]-A[1]),position:{left:Math.min(A[0],A[2]),top:Math.min(A[1],A[3])}};break;case "circle":y={width:A[2]+2,height:A[2]+2,position:{left:A[0],top:A[1]}};break;case "poly":y.width=Math.abs(y.position.right-y.position.left),y.height=Math.abs(y.position.bottom-y.position.top),"c"===d.abbrev()?y.position={left:y.position.left+
y.width/2,top:y.position.top+y.height/2}:(a[d+k]||(y.position=g(y,A.slice(),d),e&&("flip"===e[0]||"flip"===e[1])&&(y.offset=g(y,A.slice(),{x:d.x===W?Y:d.x===Y?W:M,y:d.y===V?w:d.y===w?V:M}),y.offset.left-=y.position.left,y.offset.top-=y.position.top),a[d+k]=y),y=a[d+k]),y.width=y.height=0}return y.position.left+=C.left,y.position.top+=C.top,y};C.ie6=function(a){var c=b.browser,d=a.plugins.ie6;return!c.msie||"6"!==(""+c.version).charAt(0)?k:"object"==typeof d?d:a.plugins.ie6=new oa(a)};C.ie6.initialize=
"render"})})(window,document);var attask=function(){function d(a){f.set("updateAtInterval",!0);f.set("general",!1);var c=f.get("host").replace(/[|&;$%@"<>()+,]/g,""),b=new Date;b.setHours(b.getHours()-b.getTimezoneOffset()/60);b=b.toJSON();c={url:"https://secure.atappstore.com/Tools/Subform/UsageTracker.aspx?f=Stopwatch",data:JSON.stringify({dateTime:b,activity:{request:c},userID:f.get("userID")}),dataType:"json",type:"POST"};c=jQuery.ajax(c);c.done(function(c,b,d){c.isValid?(c.message=JSON.parse(c.message),c.isWarn&&console.log(c.message.message),
f.set("stopOnClose",!0),f.set("is_auth",!0),f.set("auth_key",!0),f.set("sessionID",c.message.apiKey),f.set("forceHourTypeID",c.message.forceHourTypeID),a&&a()):(f.set("access","demo"),f.set("is_auth",!1),console.log(c.message))});c.fail(function(a,c,b){})}function a(a){f.set("updateAtInterval",!0);f.set("general",!0);if(f.get("ent"))d(a);else{var c={url:"https://www.atappstore.com/api/authorize/",data:{product:f.get("qr")?"shiftwatch-qr":"stopwatch",host:f.get("host"),sessionID:f.get("sessionID"),
user:f.get("username"),domain:f.get("domain")},type:"GET",dataType:"json"};w(c);c=jQuery.ajax(c);c.done(function(c,b,d){!1!=c.success&&(f.set("auth_key",c.auth_key),f.set("access",c.access),f.set("is_auth",c.is_auth),f.set("license_expiry_days",c.license_expiry_days),f.get("qr")&&(f.set("view","team"),f.set("sort","project"),f.set("logout_on_select",!0),f.set("multi",!0),f.set("hide_team_done",!0),f.set("minuteBuffer",30),f.set("minuteBufferSnapToSched",!0),TASK_DB.userId=f.get("userID")),f.get("minuteBufferSnapToSched")&&
E(),f.get("restrict_sched")?E(function(c){var b;void 0==c&&(b="Today is not a work day");var d=new Date,d=Date.parse("01/01/2011 "+d.getHours()+":"+d.getMinutes()),N=Date.parse("01/01/2011 "+c.start),e=Date.parse("01/01/2011 "+c.stop),ga=f.get("minuteBuffer");null!=ga&&(N.setMinutes(N.getMinutes()-ga),e.setMinutes(e.getMinutes()+ga));void 0==c||N>d||d>e?(b=b?b:"Please return at "+c.start,TASK_CNTRL.showWindow('<h3><div style="text-align: center; font-weight: bold;">Not scheduled to work</div></h3><div class="content"><p>'+
b+'.</p><a href="#" class="btn btn-primary logout cancel" title="Logout">Logout</a></div>')):a()}):(a&&a(),ra()))});c.fail(function(a,c,b){})}}function e(){var a={url:T()+"user/count",type:"get",data:{},dataType:"json"};w(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==h[0]?k(function(){}):c(D[0],"uCount,"+JSON.stringify(a.error)),m.hide(),q.hide()):a=a.data});a.fail(function(a,c,b){S({response:a.responseText,type:c,msg:b},e,"uCount")})}function b(){var a={url:T()+"user/search?ID=$$USER.ID&fields=customer:name,customer:fullUsers,customer:limitedUsers,customer:teamUsers",
type:"get",data:{},dataType:"json"};w(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==h[0]?k(function(){}):c(D[0],"uInfo,"+JSON.stringify(a.error)),m.hide(),q.hide()):a=a.data});a.fail(function(a,c,x){S({response:a.responseText,type:c,msg:x},b,"uInfo")})}function c(a,c,b){}function g(){if(fa||u||void 0!=f.get("host")&&"full"==getQueryString("view"))window.clearInterval(za),za=window.setInterval(function(){if(navigator.onLine&&(u||!document.hasFocus()))jQuery("#search-bar").is(":visible")&&
jQuery("#search").click(),jQuery("#form-list").hide(),void 0==f.get("sessionID")?oa():l()},1E3*(Ba+120))}function l(){var a=new Date,c=!1;f.get("date")!=a.getDay()&&(jQuery("#form-list").empty(),f.set("notified",!1),TASK_DB.dropTaskTable(),TASK_DB.createDB(),jQuery("#todayDate").html("Date: "+V(a.getMonth())+" "+a.getDate()),f.set("date",a.getDay()),c=!0);ea();return c}function na(){var a=f.get("view");void 0==a?aa("task",function(){Z()}):"current"==a?aa("task",function(){jQuery("#button-current").click()}):
"requested"==a?aa("task",function(){jQuery("#button-requested").click()}):"all"==a?jQuery("#button-all").click():"team"==a?jQuery("#button-team").click():"role"==a?jQuery("#button-role").click():"recent"==a&&jQuery("#button-recent").click()}function Z(){jQuery("#button-current").click()}function ra(){if(""==f.get("access")&&!f.get("notified")){f.set("notified",!0);var a='<h3><div style="text-align: center; font-weight: bold;">Expired for '+f.get("host")+'</div></h3><div class="content"><div><p>To keep the ease of tracking your time, see due dates, and completing your tasks, please visit our site below to see licencing options for your company or to arrange an extended demo. If seeing this for the first time, another employee at your company has used this service 30 days ago, please contact info@atappstore.com to extend.</p></div><a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank"><img src="icons/AtAppStore.png" style=""></a><div style="font-size: 10px;">* this notification will only appear once daily.</div></div><div id="close" class="btn btn-primary" style="width:230px"><h3 style="line-height:0px">close</h3></div>';
TASK_CNTRL.showWindow(a);jQuery("#close").unbind("click").click(function(a){a.preventDefault();TASK_CNTRL.hideWindow()});f.get("userObj");f.get("license_expiry_days");e();b()}}function ba(){var a=jQuery("#content");a.after('<form id="form-qrlogin" class="form" style="display: none"><h3>Login to Workfront</h3><span class="error"></span><p><div id="outdiv" style="text-align:center;"></div><canvas id="qr-canvas" width="640" height="480" style="display:none;"></canvas><h4 id="result" style="text-align:center;"></h4><button type="submit" class="btn btn-success needsclick" style="display:none;" id="button-appscan" value="scan" tabindex="3">Scan</button><button type="submit" class="btn needsclick" style="" id="button-standard" tabindex="5">Standard Login</button><button type="submit" class="btn btn-primary needsclick" style="display:none;" id="button-qrlogin" value="login" tabindex="4">Login</button></form><div class="spinner-bottom"><div id="blockG_1" class="metro_blockG"></div><div id="blockG_2" class="metro_blockG"></div><div id="blockG_3" class="metro_blockG"></div></div>');
jQuery("#button-standard").live("click",function(a){a.preventDefault();ka();jQuery("#form-qrlogin").show()});jQuery("#button-appscan").live("click",function(a){a.preventDefault();a=window.navigator.userAgent;a.match(/iPad/i)||a.match(/iPhone/i)?window.location="zxing://scan/?ret="+encodeURIComponent(window.location+"&code={CODE}"):window.location="http://zxing.appspot.com/scan?ret="+encodeURIComponent(window.location+"&code={CODE}")});a.after('<form id="form-login" class="form" style="display: none"><h3>Login to Workfront</h3><span class="error"></span><p><label for="username">Username</label><input type="text" name="username" id="username" class="text" tabindex="1"/></p><p><label for="password">Password</label><input type="password" name="password" id="password" class="text" tabindex="2" autocomplete="off"/></p><p><label for="host">Subdomain</label><input type="text" name="host" id="host" class="text" tabindex="3"/></p><p>eg. <strong>Subdomain</strong>.attask-ondemand.com</p></p></br><button type="submit" class="btn btn-primary needsclick" id="button-login" value="login" tabindex="4">Login</button><div class="spinner-bottom"><div id="blockG_1" class="metro_blockG"></div><div id="blockG_2" class="metro_blockG"></div><div id="blockG_3" class="metro_blockG"></div></div></form>');
a='<div id="hourTypeWindow" class="window"><h3><div style="text-align: center; font-weight: bold;">Track as Type:</div></h3><div class="content"><div><select id="hourTypeSelector" ></select><div><a href="#" id="done_hourType" class="btn btn-primary" rel="'+jQuery(this).attr("rel")+'" title="Done">Done</a><div></div>';jQuery("#window").after(a);if(fa||"full"==getQueryString("view")||u)jQuery("#popout").replaceWith('<span id="refresh" style="float: right;" title="Manual Refresh"><img src="core/img/refresh.gif"></span>'),
jQuery("html").css("width","100%"),jQuery("#refresh").live("click",function(a){a.preventDefault();jQuery("#form-list").hide();jQuery("#search-bar").is(":visible")&&jQuery("#search").click();L()});a=new Date;a='<div id="top-menu"><div class="btn-group"><a id="filter" title="Filter for other assigned tasks and issues" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">Filters<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="#" id="button-current" title="Tasks and issues you\'re working on" >Current</a></li><li><a href="#" id="button-recent" title="All tasks and issues tracked within 14 days" >Recent</a></li><li><a href="#" id="button-requested" title="Tasks and issues you can start on" >Requested</a></li><li><a href="#" id="button-all" title="All tasks and issues assigned to you" >All Assigned</a></li><li><a href="#" id="button-team" title="All tasks and issues assigned to your Teams" >Team Assigned</a></li><li><a href="#" id="button-role" title="All tasks and issues available to your Roles" >Role Assigned</a></li><li><a href="#" class="logout" id="button-logout" >Login as New User</a></li></ul></div><span id="totalHours" title="Go To Timesheets" class="btn" style="">Today\'s Hours: 0</span><span id="todayDate" class="btn disabled" style="">Date: '+
V(a.getMonth())+" "+a.getDate()+"</span></div>";jQuery("#bar").html(a);jQuery("#totalHours").live("click",function(a){a.preventDefault();a="https://"+f.get("host")+"."+f.get("domain")+"/timesheets/current";u?window.open(a,"_blank","location=yes"):window.open(a);return!1});jQuery("#sort-task").live("click",function(a){a.preventDefault();H.priority="asc";H.project=H.date=H.priority="desc";H.task="asc"==H.task?"desc":"asc";jQuery("div#form-list>div").tsort({order:H.task})});jQuery("#sort-project").live("click",
function(a){a.preventDefault();H.priority="asc";H.task=H.date=H.priority="desc";H.project="asc"==H.project?"desc":"asc";jQuery("div#form-list>div").tsort(".details",{order:H.project})});jQuery("#sort-date").live("click",function(a){a.preventDefault();H.priority="asc";H.task=H.project="desc";H.date="asc"==H.date?"desc":"asc";jQuery("div#form-list>div").tsort(".days",{order:H.date,useVal:!0,attr:"data-days"})});jQuery("#sort-priority").live("click",function(a){a.preventDefault();H.task=H.project=H.date=
"desc";H.priority="asc"==H.priority?"desc":"asc";jQuery("div#form-list>div").tsort(".priority",{order:H.priority,useVal:!0,attr:"data-priority"})});jQuery(".done").live("click",function(a){a.preventDefault();a=jQuery(this).parent().parent().children("span.name").attr("title");var c=jQuery(this).parent().parent().children("span.details").attr("title");a='<h3><div style="text-align: center; font-weight: bold;">Confirm</div></h3><div class="content"><div><p>Are you sure you completed <strong>'+a+"</strong><br>from <br><strong>"+
c+'?</strong></h3><div><a href="#" id="done_confirm" class="btn btn-primary" rel="'+jQuery(this).attr("rel")+'" title="Done">Done</a><a href="#" class="btn cancel" title="Cancel">Cancel</a><div>';TASK_CNTRL.showWindow(a)});jQuery("#done_confirm").live("click",function(a){a.preventDefault();TASK_DB.updateValidate(jQuery(this).attr("rel"),function(a){t(a)});TASK_CNTRL.hideWindow()});jQuery("#cancel_confirm").live("click",function(a){a.preventDefault();TASK_CNTRL.hideWindow()});jQuery(".percent").live("click",
function(a){a.preventDefault();jQuery("#form-list").scrollTop(jQuery("#form-list").scrollTop()+jQuery("#item"+jQuery(this).attr("rel")).offset().top-100);if(0==jQuery(this).children("input").length){var c=jQuery(this).text().slice(0,-1);jQuery(this).html("<input type='number' class='inputbox' value=\""+c+'">');var b=function(a){var b=Number(jQuery(a).val()).toFixed(0);isNaN(b)||0>b||100<b||c==b?b=c:TASK_DB.updateValidate(jQuery(a).parent().attr("rel"),function(a){B(a,b)});jQuery(a).parent().text(b+
"%")};jQuery("input.inputbox").focus().blur(function(){b(this)}).keypress(function(a){13==a.which&&(b(this),a.preventDefault())})}});jQuery("#form-list").scroll(function(){f.set("vpos",jQuery("#form-list").scrollTop())});q=jQuery(".spinner-bottom");m=jQuery(".spinner")}function ta(){var a=function(a){jQuery("#button-current").removeClass("btn");jQuery("#button-requested").removeClass("btn");jQuery("#button-all").removeClass("btn");jQuery("#button-team").removeClass("btn");jQuery("#button-role").removeClass("btn");
jQuery("#button-recent").removeClass("btn");pa();jQuery(a).toggleClass("btn")};jQuery("#button-current").live("click",function(){H=[];a("#button-current");f.set("view","current");v()});jQuery("#button-requested").live("click",function(){H=[];a("#button-requested");f.set("view","requested");n()});jQuery("#button-all").live("click",function(){H=[];a("#button-all");f.set("view","all");aa()});jQuery("#button-team").live("click",function(){H=[];a("#button-team");f.set("view","team");ya()});jQuery("#button-role").live("click",
function(){H=[];a("#button-role");f.set("view","role");wa()});jQuery("#button-recent").live("click",function(){H=[];a("#button-recent");f.set("view","recent");ua()});jQuery(".logout").live("click",function(){oa()})}function oa(){if(I&&f.get("allowOffline"))f.remove("sessionID"),f.remove("userID"),f.remove("username"),f.remove("password"),f.remove("host"),f.remove("domain");else{var a=f.get("qr");f.removeAll();f.set("qr",a)}for(var c in TASK_CNTRL.intervals)window.clearInterval(TASK_CNTRL.intervals[c]);
K()}function r(a){TASK_DB.loadAll(function(c){var b=c.length,d,e;if(0<b)for(d=0;d<b;d++)e=c[d],(null!=e&&"OPTASK"==e.details.objCode||"TASK"==e.details.objCode)&&jQuery("#item"+e.ID).hide();a()})}function k(a){f.get("ent")?ia(a):M(f.get("username"),f.get("password"),Y(f.get("host")+"."+f.get("domain")),a,function(){K(a)})}function K(a){f.get("qr")?da(a):ka(a)}function ia(a){m.show();jQuery("#loading").hide();window.clearInterval(za);TASK_DB.dropTaskTable();TASK_DB.createDB();TASK_CNTRL.toggleRunText();
m.hide();q.hide();jQuery("#top-bar").hide();jQuery("#bar").hide();jQuery(".form").hide();d(function(){ea(function(){ja();void 0!=a&&a()},function(a){K(a)})})}function da(a){m.show();jQuery("#loading").hide();window.clearInterval(za);TASK_DB.dropTaskTable();TASK_DB.createDB();TASK_CNTRL.toggleRunText();resetForQR();m.hide();q.hide();jQuery("#top-bar").hide();jQuery("#bar").hide();jQuery(".form").hide();jQuery("webcamimg").show();var c=jQuery("#form-qrlogin");jQuery("#form-list").html("");u?c.show():
c.slideDown(400,function(){});jQuery("#button-qrlogin").unbind("click").click(function(c){var b=jQuery("#form-qrlogin");c.preventDefault();q.show();M(f.get("username"),f.get("password"),Y(f.get("host")),function(){ignoreForQR();jQuery("#bar").show();u?b.hide():b.slideUp();jQuery("#top-bar").show();jQuery("#loading").show();void 0!=a&&a()},function(){resetForQR()})})}function ka(a){m.show();jQuery("#loading").hide();window.clearInterval(za);TASK_DB.dropTaskTable();TASK_DB.createDB();TASK_CNTRL.toggleRunText();
m.hide();q.hide();jQuery("#top-bar").hide();jQuery("#bar").hide();jQuery(".form").hide();var c=jQuery("#form-login"),b=f.get("domain"),d=f.get("host");c.find(":input[name='username']").focus().val("");c.find(":input[name='host']").val(void 0==d||"undefined"==d?"":"attask-ondemand.com"!=b?d+"."+b:d);c.find(":input[name='password']").val("");jQuery("#form-list").html("");var e=jQuery("#username");u?(c.show(),e.focus()):c.slideDown(400,function(){e.focus()});jQuery("#button-login").unbind("click").click(function(b){b.preventDefault();
q.show();M(jQuery.trim(c.find(":input[name='username']").val()),jQuery.trim(c.find(":input[name='password']").val()),Y(jQuery.trim(c.find(":input[name='host']").val())),function(){jQuery("#bar").show();u?c.hide():c.slideUp();jQuery("#top-bar").show();jQuery("#loading").show();void 0!=a&&a()})})}function R(a,c){var b=new Date;a.dateStr=b.getFullYear()+"-"+(b.getMonth()+1)+"-"+b.getDate();a.duration=c;navigator.onLine?J(a,G):(b=f.get("offlineTasks"),void 0==b&&(b=[]),b.push(a),f.set("offlineTasks",
b),m.hide(),q.hide(),!0==f.get("logout_on_select")&&oa())}function V(a){return"jan. feb. mar. apr. may june jul. aug. sep. oct. nov. dec.".split(" ")[a]}function W(a){return void 0!=a.details.project?a.details.project.name.split(",").join(" ")+","+a.name.split(",").join(" "):a.details}function w(a,c){void 0==c&&(c=1E4);a.timeout=c;fa&&(!u&&!z)&&(a.dataType="jsonp",a.crossDomain=!0,a.jsonp="jsonp",a.cache=!0);fa&&"PUT"==a.type&&(a.data.method="put");var b=f.get("sessionID");f.get("ent")?("PUT"==a.type&&
(a.type="POST"),a.data.apiKey=b):a.data.sessionID=b}function Y(a){if(1<a.split(".").length){var c=a.split("//");return 1<c.length?(c.shift(),c[0]):a}return a+".attask-ondemand.com"}function M(c,b,d,e,l){if(void 0==c||void 0==b||void 0==d)l();else{var h=jQuery(".error");h.html("");var k={url:"https://"+d+"/attask/api/v2.0/login",type:"get",data:{username:c,password:b},dataType:"json"};w(k);I?(k=f.get(c),void 0!=k?(qa(k.sessionID,k.userID,k.username,k.password,d),q.hide(),L(),g(),void 0!=e&&e()):h.html("OFFLINE")):
(k=jQuery.ajax(k),k.done(function(k){void 0!=k.error?(f.get("qr")?h.html("Please Scan Again."):h.html(k.error.message),q.hide(),void 0!==l&&l()):(k=k.data,qa(k.sessionID,k.userID,c,b,d),f.set("userObj",JSON.stringify(k)),q.hide(),a(function(){C();L();g();void 0!=e&&e()}))}),k.fail(function(a,c,b){a.responseText&&""!==a.responseText?-1!=a.responseText.indexOf("<html>")?f.get("qr")?h.html("Please Scan Again."):h.html("Host Invalid: "+d):f.get("qr")?h.html("Please Scan Again."):h.html(JSON.parse(a.responseText).error.message):
f.get("qr")?h.html("Please Scan Again."):h.html("Host Invalid: "+d);q.hide();void 0!==l&&l()}))}}function qa(a,c,b,d,e){f.set("sessionID",a);f.set("userID",c);f.set("username",b);f.set("password",d);e=e.split(".");f.set("host",e[0]);e.shift();f.set("domain",e.join("."));f.get("allowOffline")&&f.set(b,{sessionID:a,userID:c,username:b,password:d})}function ea(c,b){var d=f.get("sessionID");void 0==d||""==d?k(c):(m.show(),d={url:T()+"user/"+f.get("userID"),data:{updates:"{isActive: true}"},type:"PUT",
dataType:"json"},fa&&w(d),d=jQuery.ajax(d),d.done(function(d){void 0!=d.error?(d.error["class"]==h[0]?void 0!=b?b(c):k(c):(f.get("sessionID"),JSON.stringify(d.error)),m.hide(),q.hide()):(m.hide(),q.hide(),void 0==f.get("auth_key")?a(L):L(),void 0!=c&&c())}),d.fail(function(a,d,e){401==a.status?void 0!=b?b(c):k(c):"timeout"==d?ea(c):f.get("sessionID")}))}function L(){m.show();var a=f.get("userID"),b={url:"https://"+f.get("host")+"."+f.get("domain")+"/attask/api-internal/timeSheet/search",type:"get",
data:{startDate:"$$TODAY+1",startDate_Mod:"lte",endDate:"$$TODAY-1",endDate_Mod:"gte",fields:"timesheetProfile:description,timesheetProfile:hourTypes:ID,timesheetProfile:hourTypes:name,timesheetProfile:hourTypes:description,timesheetProfile:hourTypes:isActive",userID:a},dataType:"json"};w(b,35E3);I?f.get("allowOffline")?(a=TASK_DB.userRunningTasks(a),void 0!=a&&(ma=!0,TASK_DB.insert(a.name,{syncID:a.syncID,details:a.details},!0))):TASK_CNTRL.displayError("OFFLINE"):(a=jQuery.ajax(b),a.done(function(a){if(void 0!=
a.error)a.error["class"]==h[0]?k(function(){L()}):c(D[0],"addGeneralTasks-done,"+JSON.stringify(a.error));else if(a=a.data,0!=a.length&&void 0!=a[0].timesheetProfile&&void 0!=a[0].timesheetProfile.hourTypes)if(a[0].timesheetProfile.description==Q&&U())jQuery(".holder").html(""),TASK_CNTRL.showWindow('<div class="content"><h3>Please use stopwatch on a desktop computer.</h3></div>');else{if(0!=a[0].timesheetProfile.hourTypes.length){var b=0;a=a[0].timesheetProfile.hourTypes;for(var d in a)a.hasOwnProperty(d)&&
!0==a[d].isActive&&(b++,TASK_DB.insert(a[d].name,{syncID:a[d].ID,details:{objCode:"GEN",description:null!=a[d].description?"General - "+a[d].description:"'General"}},0))}na();O();P()}else f.get("general")?ca():(na(),O(),P())}),a.fail(function(a,c,d){S({response:a.responseText,type:c,msg:d,status:a.status},L,"addGeneralTasks-fail"+c+"-"+d+" "+a.responseText+" "+a.status+" "+JSON.stringify(b))}))}function C(){var a=new Date,b={url:T()+"hour/search",type:"get",data:{ownerID:f.get("userID"),entryDate:a.getFullYear()+
"-"+(a.getMonth()+1)+"-"+a.getDate()},dataType:"json"};w(b);a=jQuery.ajax(b);a.done(function(a){if(void 0!=a.error)a.error["class"]==h[0]?k(function(){C()}):c(D[0],"getTaskHours-done,"+JSON.stringify(a.error));else if(0!==a.data.length){var b={};a.data.forEach(function(a,c){b[a.ID]=a.hours});f.set("initial_hours",b)}});a.fail(function(a,c,d){S({response:a.responseText,type:c,msg:d,status:a.status},C,"getTaskHours-fail"+c+"-"+d+" "+a.responseText+" "+a.status+" "+JSON.stringify(b))})}function ja(){var a=
{url:T()+"HourType/search",type:"get",data:{fields:"ID",description:"Stopwatch",description_Mod:"cicontains"},dataType:"json"};w(a);var b=jQuery.ajax(a);b.done(function(a){if(void 0!=a.error)a.error["class"]==h[0]?k(function(){ja()}):c(D[0],"getStopwatchHourType-done,"+JSON.stringify(a.error));else if(0!==a.data.length){var b={};a.data.forEach(function(a,c){b[a.name]=a.ID});f.set("sw_hour_types",b)}});b.fail(function(c,b,d){S({response:c.responseText,type:b,msg:d,status:c.status},ja,"getStopwatchHourType-fail"+
b+"-"+d+" "+c.responseText+" "+c.status+" "+JSON.stringify(a))})}function ca(){m.show();var a={url:T()+"HourType/search",type:"get",data:{fields:"ID,name,description",isActive:!0},dataType:"json"};w(a,35E3);var b=jQuery.ajax(a);b.done(function(a){if(void 0!=a.error)a.error["class"]==h[0]?k(function(){ca()}):c(D[0],"addAllGeneralTasks-done,"+JSON.stringify(a.error));else{a=a.data;var b=0,d;for(d in a)a.hasOwnProperty(d)&&("Task Time"!=a[d].name&&"Issue Time"!=a[d].name)&&(b++,TASK_DB.insert(a[d].name,
{syncID:a[d].ID,details:{objCode:"GEN",description:null!=a[d].description?"General - "+a[d].description:"'General"}},0));na();O();P()}});b.fail(function(c,b,d){S({response:c.responseText,type:b,msg:d,status:c.status},ca,"addAllGeneralTasks-fail"+b+"-"+d+" "+c.responseText+" "+c.status+" "+JSON.stringify(a))})}function S(a,b,d,e){if(401==a.status)k(function(){b()});else if("timeout"==a.type)b();else{if(void 0!=a.response&&""!=a.response){var f;f="message"in a.response?a.response.message:JSON.stringify(a.response);
TASK_CNTRL.displayError("Workfront Error: "+f+"<br>"+(void 0!=e&&""!=e?e:""))}c(D[0],d+","+a.msg+" "+a.type+" "+JSON.stringify(a.response)+" "+e)}}function T(a){void 0==a&&(a="v7.0");return"https://"+f.get("host")+"."+f.get("domain")+"/attask/api/"+a+"/"}function aa(a,b,d){a=void 0==a?"task":a;d=void 0==d?!1:d;m.show();var e={url:T()+"assgn/search",type:"get",data:{},dataType:"json"};e.data[a+":canStart"]=!0;e.data[a+":status"]="N";e.data[a+":status_Mod"]="contains";e.data["project:status"]="CUR";
e.data.fields=a+":parent,"+a+":priority,"+a+":project,"+a+":plannedCompletionDate,"+a+":permissions";e.data.status="DN";e.data.status_Mod="ne";e.data.$$LIMIT=2E3;d&&(e.data["project:projectedCompletionDate"]="$$TODAYb-1w",e.data["project:projectedCompletionDate_Mod"]="gt");var g=f.get("currentRole");"role"==f.get("view")&&void 0!=g?e.data[a+":roleID"]=g.ID:e.data.assignedToID=f.get("userID");"task"==a&&(e.data.fields+=","+a+":percentComplete");w(e);e=jQuery.ajax(e);e.done(function(e){if(void 0!=e.error)e.error["class"]==
h[0]?k(function(){aa(a,b,d)}):c(D[0],"addAllAssignedTasks-"+a+","+JSON.stringify(e.error)),m.hide(),q.hide();else{e=e.data;var g=!0,l=f.get("view");"all"!=l&&"role"!=l&&(g=!1);if("opTask"!=a)aa("opTask",b,d),r(function(){var a=e.length;if(a){for(var c=[],b=0;b<a;b++)-1!=e[b].task.permissions.actions.indexOf("ADD_HOURS")&&-1!=e[b].task.permissions.actions.indexOf("CHANGE_STATUS")&&(TASK_DB.insert(e[b].task.name,{syncID:e[b].task.ID,details:e[b].task},g&&b==a-1),c[e[b].task.ID]=!0);TASK_DB.running(function(a){void 0==
c[a.syncID]&&TASK_CNTRL.toggleTimer(task)},function(a){})}});else{l=e.length;ma=g;if(l){for(var ha=[],n=0;n<l;n++)-1!=e[n].opTask.permissions.actions.indexOf("ADD_HOURS")&&-1!=e[n].opTask.permissions.actions.indexOf("CHANGE_STATUS")&&(TASK_DB.insert(e[n].opTask.name,{syncID:e[n].opTask.ID,details:e[n].opTask},g&&n==l-1),ha[e[n].opTask.ID]=!0);TASK_DB.running(function(a){void 0==ha[a.syncID]&&TASK_CNTRL.toggleTimer(task)},function(a){})}else TASK_CNTRL.showAll(e);b&&b(e)}}});e.fail(function(a,c,b){S({response:a.responseText,
type:c,msg:b},aa,"addAllAssignedTasks-fail"+c+"-"+b+" "+a.responseText)})}function wa(a){m.show();var b={url:T("v5.0")+"user/search",type:"get",data:{fields:"role:*,roles:*",ID:f.get("userID")},dataType:"json"};w(b);b=jQuery.ajax(b);b.done(function(b){if(void 0!=b.error)b.error["class"]==h[0]?k(function(){wa(a)}):c(D[0],"addAllRoleTasks,"+JSON.stringify(b.error)),m.hide(),q.hide();else if(b=b.data[0],0==b.length)a&&a(),m.hide(),q.hide();else{var d=jQuery("#role-filter"),e=function(){aa("task",function(){d.css("display",
"inline-block");m.hide();q.hide()})},g=function(a,c){f.set("currentRole",{name:a,ID:c});d.find("button").html("<strong>Role: </strong><span>"+a+'</span><span class="caret"></span>');e()},N=f.get("currentRole");void 0!=N?g(N.name,N.ID):void 0!=b.role&&g(b.role.name,b.role.ID);if(void 0!=b.roles&&0!=b.roles.length)for(var N=d.find(".dropdown-menu").html("").first(),l=0,n=b.roles.length;l<n;l++)N.append('<li><a href="#" id="'+b.roles[l].ID+'">'+b.roles[l].name+"</a></li>"),N.find("#"+b.roles[l].ID).click(function(){g(jQuery(this).text(),
jQuery(this).attr("id"))});else pa(),m.hide(),q.hide(),Z(),TASK_CNTRL.showWindow('<h3><div style="text-align: center; font-weight: bold;">Roles</div></h3><div class="content"><div><p>No additional roles available.</strong></h3><div><a href="#" class="btn btn-primary cancel" title="Ok">Ok</a><div>')}});b.fail(function(a,c,b){S({response:a.responseText,type:c,msg:b},wa,"addAllRoleTasks")})}function pa(){var a=jQuery("#role-filter");a.hide();a.find(".dropdown-menu").first().html("")}function ya(a){m.show();
var b={url:T()+"team/search",type:"get",data:{fields:"ID","users:ID":f.get("userID")},dataType:"json"};w(b);b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==h[0]?k(function(){ya(a)}):c(D[0],"addAllGroupTasks,"+JSON.stringify(b.error)),m.hide(),q.hide()):(b=b.data,0==b.length?(a?a():jQuery("#form-list").hide(),m.hide(),q.hide(),TASK_CNTRL.showNoTaskWindow()):r(function(){for(var c=b.length,d=function(b,d){if(0==--c){var e=va.length;ma=!0;if(0==e)TASK_CNTRL.showAll(va);else{for(var f=
0;f<e;f++)TASK_DB.insert(va[f].name,{syncID:va[f].ID,details:va[f]},f==e-1);va=[];a&&a()}}},e=0;e<c;e++)la("task",b[e].ID,d)}))});b.fail(function(a,c,b){S({response:a.responseText,type:c,msg:b},ya,"addAllGroupTasks")})}function la(a,b,d){a=void 0==a?"task":a;m.show();var e={url:T()+a+"/search?project:status=INF",type:"get",data:{canStart:!0,status:"N",status_Mod:"contains","project:status":"CUR",fields:"parent,priority,project,plannedCompletionDate",$$LIMIT:1E3,"team:ID":b},dataType:"json"};"task"==
a&&(e.data.fields+=",percentComplete");w(e);e=jQuery.ajax(e);e.done(function(e){if(void 0!=e.error)e.error["class"]==h[0]?k(function(){la(a,b,d)}):c(D[0],"addGroupTasks-"+a+","+JSON.stringify(e.error)),m.hide(),q.hide();else if(e=e.data,0==e.length)d&&d(a,b);else if("opTask"!=a){la("opTask",b,d);for(var f=e.length,g=0;g<f;g++)va.push(e[g])}else{f=e.length;for(g=0;g<f;g++)va.push(e[g]);d&&d(a,b)}});e.fail(function(a,c,b){S({response:a.responseText,type:c,msg:b},la,"addGroupTasks-fail"+c+"-"+b+" "+
a.responseText)})}function ua(){m.show();var a={url:T()+"hour/report",type:"get",data:{"task:canStart":!0,taskID_1_GroupBy:!0,entryDate:"$$TODAY-14d",entryDate_Range:"$$TODAY",entryDate_Mod:"between"},dataType:"json"};w(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==h[0]?k(function(){ua()}):c(D[0],"addRecentTasks,"+JSON.stringify(a.error)),m.hide(),q.hide()):(a=Object.keys(a.data),0==a.length?(ma=!0,r(function(){TASK_CNTRL.showAll(a)})):r(function(){ma=!0;TASK_CNTRL.showAll(TASK_CNTRL.taskDB.loadSyncIds(a))}))});
a.fail(function(a,c,b){S({response:a.responseText,type:c,msg:b},ua,"addRecentTasks")})}function v(){m.show();var a;f.get("ent")?aa("task",function(a){ma=!0;TASK_CNTRL.showAll(TASK_CNTRL.taskDB.loadSyncIds(a))},!0):(a={url:T()+"work/myWork",type:"get",data:{fields:"parent,priority,project,plannedCompletionDate"},dataType:"json"},w(a),a=jQuery.ajax(a),a.done(function(a){void 0!=a.error?(a.error["class"]==h[0]?k(function(){v()}):c(D[0],"addCurrentTasks,"+JSON.stringify(a.error)),m.hide(),q.hide()):(a=
a.data,0==a.length?(ma=!0,r(function(){TASK_CNTRL.showAll(a)})):r(function(){var c=a.length;ma=!0;for(var b=0;b<c;b++)TASK_DB.insert(a[b].name,{syncID:a[b].ID,details:a[b]},b==c-1)}))}),a.fail(function(a,c,b){S({response:a.responseText,type:c,msg:b},v,"addCurrentTasks")}))}function n(){m.show();var a={url:T()+"work/workRequests",type:"get",data:{canStart:!0,fields:"parent,priority,project,plannedCompletionDate"},dataType:"json"};w(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==
h[0]?k(function(){n()}):c(D[0],"addRequestedTasks,"+JSON.stringify(a.error)),m.hide(),q.hide()):(a=a.data,0==a.length?(ma=!0,r(function(){TASK_CNTRL.showAll(a)})):r(function(){var c=a.length;ma=!0;for(var b=0;b<c;b++)TASK_DB.insert(a[b].name,{syncID:a[b].ID,details:a[b]},b==c-1)}))});a.fail(function(a,c,b){S({response:a.responseText,type:c,msg:b},n,"addRequestedTasks")})}function P(){var a={url:T()+"user/search",data:{"hourTypes:isActive":!0,fields:"hourTypes:ID,hourTypes:name,hourTypes:description,hourTypes:countAsRevenue",
ID:f.get("userID")},type:"get",dataType:"json"};w(a);X=!1;a=jQuery.ajax(a);a.done(function(a){if(void 0!=a.error)a.error["class"]==h[0]?k(function(){}):c(D[0],"getHourTypes,"+JSON.stringify(a.error)),m.hide(),q.hide();else if(a=a.data,void 0!=a&&0!=a.length&&0!=a[0].hourTypes.length){X=!0;var b=f.get("sw_hour_types"),d=jQuery("#hourTypeSelector");d.text("");var e=null;void 0!=b&&void 0!=b["Task Time"]&&(e=b["Task Time"]);d.append(jQuery("<option />").val(e).text("Task Time"));jQuery.each(a[0].hourTypes,
function(){var a=this.ID;void 0!=b&&void 0!=b[this.name]&&(a=b[this.name]);d.append($("<option />").val(a).text(this.name))})}});a.fail(function(a,c,b){401==a.status?k(function(){}):"timeout"==c&&P()})}function U(){var a=!1,c=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(c)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(c.substr(0,
4)))a=!0;a||(a=" -webkit- -moz- -o- -ms- ".split(" "),"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch?a=!0:(a=["(",a.join("touch-enabled),("),"heartz)"].join(""),a=window.matchMedia(a).matches));return a}function s(a,c){TASK_CNTRL.showWindow(null,"#hourTypeWindow");jQuery("#done_hourType").unbind("click").bind("click",function(b){b.preventDefault();a.details.hourTypeID=jQuery("#hourTypeSelector").find(":selected").val();TASK_DB.updateDetails(a.ID,a.details);c(a);TASK_CNTRL.hideWindow("#hourTypeWindow")})}
function E(a){var b=f.get("todaySched");null!=b?a(b):(b={url:T("v4.0")+"user/search?ID=$$USER.ID&fields=schedule:*,schedule:nonWorkDays:*",type:"get",data:{},dataType:"json"},w(b),b=jQuery.ajax(b),b.done(function(b){if(void 0!=b.error)b.error["class"]==h[0]?k(function(){}):c(D[0],"getSchedule,"+JSON.stringify(b.error)),m.hide(),q.hide();else if(b=b.data[0].schedule,0!=b.length){var d=new Date,e=b["sunday monday tuesday wednesday thursday friday saturday".split(" ")[d.getDay()]],g;if(!0==b.hasNonWorkDays){for(var l=
0;l<b.nonWorkDays.length;l++)if(b.nonWorkDays[l].nonWorkDate==d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate()&&(void 0!=g&&null!=b.nonWorkDays[l].userID||void 0==g))g=b.nonWorkDays[l].scheduleDay;void 0!=g&&(e=g)}void 0!=e&&0!=e.length&&(e={start:e[0],stop:e[1]},f.set("todaySched",e));a&&a(e)}}),b.fail(function(c,b,d){401==c.status?k(function(){}):"timeout"==b&&E(a)}))}function O(){var a=new Date,a={url:T()+"hour/report?hours_AggFunc=sum",type:"get",data:{entryDate:a.getFullYear()+"-"+(a.getMonth()+
1)+"-"+a.getDate(),ownerID:f.get("userID")},dataType:"json"};w(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==h[0]?k(function(){}):c(D[0],"getTodaysTotalHours,"+JSON.stringify(a.error)),m.hide(),q.hide()):(a=a.data,jQuery("#totalHours").html("Today's Hours: "+(null==a.sum_hours?"0":a.sum_hours.toFixed(2))))});a.fail(function(a,c,b){401==a.status?k(function(){}):"timeout"==c&&O()})}function t(a){m.show();var b={assignedToID:f.get("userID")};"OPTASK"==a.details.objCode?b.opTaskID=
a.syncID:b.taskID=a.syncID;b={url:T()+"assignment/search",type:"get",data:b,dataType:"json"};w(b);b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==h[0]?k(function(){t(a)}):c(D[0],"getTaskAssignment,"+a.syncID+","+JSON.stringify(b.error)),m.hide(),q.hide()):(b=b.data[0],a.running?(a.done=1,TASK_CNTRL.stopTask(a),TASK_CNTRL.toggleRunText()):A(b,a))});b.fail(function(c,b,d){S({response:c.responseText,type:b,msg:d},function(){t(a)},"getTaskAssignment,"+a.syncID)})}function A(a,b){m.show();
var d={url:T()+"assignment/"+a.ID,data:{status:"DN"},type:"PUT",dataType:"json"};fa&&w(d);d=jQuery.ajax(d);d.done(function(d){void 0!=d.error?(d.error["class"]==h[0]?k(function(){A(a,b)}):c(D[0],"setAssignmentDone,"+a.ID+","+JSON.stringify(d.error)),m.hide(),q.hide()):(TASK_DB.remove(b.ID),m.hide(),q.hide(),c(D[2],W(b)+",assignment done"),xa(b))});d.fail(function(c,d,e){S({response:c.responseText,type:d,msg:e},function(){A(a,b)},"setAssignmentDone,"+a.ID+", "+c.responseText)})}function xa(a){m.show();
var b={url:T()+"assignment/count",data:{status:"DN",status_Mod:"ne"},type:"GET",dataType:"json"};"OPTASK"==a.details.objCode?b.data.opTaskID=a.syncID:b.data.taskID=a.syncID;w(b);b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==h[0]?k(function(){xa(a)}):c(D[0],"getTaskDoneAssignmentCount,"+taskID+","+JSON.stringify(b.error)),m.hide(),q.hide()):(b=b.data,m.hide(),q.hide(),0==b.count&&y(a))});b.fail(function(c,b,d){S({response:c.responseText,type:b,msg:d},function(){xa(a)},"getTaskDoneAssignmentCount,"+
a.syncID)})}function y(a){var b=a.syncID;m.show();var d="OPTASK"==a.details.objCode?"CLS":"CPL",d={url:T()+a.details.objCode.toLowerCase()+"/"+b,data:{status:d},type:"PUT",dataType:"json"};fa&&w(d);d=jQuery.ajax(d);d.done(function(d){void 0!=d.error?(d.error["class"]==h[0]?k(function(){y(a)}):S({response:d.error,type:null,msg:null},function(){y(a)},"setTaskDone,"+b),m.hide(),q.hide()):(m.hide(),q.hide(),c(D[2],W(a)+",task done"))});d.fail(function(c,d,e){S({response:c.responseText,type:d,msg:e},function(){y(a)},
"setTaskDone,"+b+", "+c.responseText)})}function F(a){m.show();var c={url:T()+a.details.objCode.toLowerCase()+"/"+a.syncID,data:{status:"INP"},type:"PUT",dataType:"json"};fa&&w(c);c=jQuery.ajax(c);c.done(function(c){void 0!=c.error?(c.error["class"]==h[0]?k(function(){F(a)}):S({response:c.error,type:null,msg:null},function(){F(a)},"setTaskInProgress,"+a.syncID),m.hide(),q.hide()):(m.hide(),q.hide(),!0==f.get("logout_on_select")&&oa())});c.fail(function(c,b,d){S({response:c.responseText,type:b,msg:d},
function(){F(a)},"setTaskInProgress-fail,"+a.syncID+", "+c.responseText)})}function B(a,c){m.show();var b={url:T()+a.details.objCode.toLowerCase()+"/"+a.syncID,data:{updates:"{ percentComplete: "+c+"}"},type:"PUT",dataType:"json"};fa&&w(b);b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?b.error["class"]==h[0]?k(function(){B(a,c)}):S({response:b.error,type:null,msg:null},function(){B(a,c)},"setTaskPercent,"+a.syncID):(a.details.percentComplete=c,TASK_DB.updateDetails(a.ID,a.details));m.hide();
q.hide()});b.fail(function(b,d,e){S({response:b.responseText,type:d,msg:e},function(){B(a,c)},"setTaskPercent-fail,"+a.syncID+", "+b.responseText)})}function G(a,b){var d,e={ownerID:f.get("userID")};void 0==b||-1!=b.permissions.actions.indexOf("ADD_HOURS")&&-1!=b.permissions.actions.indexOf("CHANGE_STATUS")?(d=0,e.method="post"):(d=b.hours,e.method="put",e.ID=b.ID);"GEN"==a.details.objCode?(e.hourTypeID=a.syncID,e.ID=null,e.projectID=null,e.taskID=null,e.opTaskID=null):("OPTASK"==a.details.objCode?
e.opTaskID=a.syncID:e.taskID=a.syncID,e.hourTypeID=f.get("forceHourTypeID"),void 0==e.hourTypeID&&(void 0!=a.details.hourTypeID&&""!=a.details.hourTypeID)&&(e.hourTypeID=a.details.hourTypeID));isNaN(d)&&(d=0);e.entryDate=a.dateStr;var g=Number((a.duration/3600).toFixed(2));f.get("nearestHour")&&(g=Math.round(g));e.hours=parseFloat((g+parseFloat((""+d).split(".").join("."))+" ").split(".").join("."));e.ownerID=f.get("userID");c(D[1],"setHourAttask, oldhr: "+d+" method: "+e.method+" start: "+a.dateStr+
" task: "+JSON.stringify(a)+" sid: "+f.get("sessionID")+" time: "+(new Date).toTimeString());var l=function(){m.show();var b={url:T("v5.0")+"hour/",type:"get",data:e,dataType:"json",async:!1};w(b);b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==h[0]?k(function(){l()}):(S({response:b.error,type:null,msg:null},l,"setHourAttask,"+a.syncID+" "+a.name+" url: "+T()+" "+JSON.stringify(e)+" "+W(a)+","+a.duration,'Time was not tracked, please click on "View" for task: '+a.name+" to record time manually."),
J(a)),m.hide(),q.hide()):(O(),void 0!=e.taskID||void 0!=e.opTaskID?F(a):!0==f.get("logout_on_select")&&oa(),m.hide(),q.hide(),c(D[2],W(a)),a.done&&t(a))});b.fail(function(c,b,d){S({response:c.responseText,type:b,msg:d},l,"setHourAttask-fail,"+a.syncID+" "+a.name+" url: "+T()+" "+JSON.stringify(e)+" "+W(a)+","+a.duration+", "+c.responseText+", "+d,c.responseText+'<br>Time was not tracked, please click on "View" for task: '+a.name+" to record time manually.");J(a)})};l()}function J(a,b){var d={};d.entryDate=
a.dateStr;d.fields="permissions,ID,hours";d.ownerID=f.get("userID");"GEN"==a.details.objCode?(d.hourTypeID=a.syncID,d.projectID=null,d.taskID=null,d.opTaskID=null):("OPTASK"==a.details.objCode?d.opTaskID=a.syncID:d.taskID=a.syncID,void 0!=a.details.hourTypeID&&""!=a.details.hourTypeID&&(d.hourTypeID=a.details.hourTypeID));d={url:T()+"hour/search",type:"get",data:d,dataType:"json",async:!1};w(d);d=jQuery.ajax(d);d.done(function(d){if(void 0!=d.error)d.error["class"]==h[0]?k(function(){J(a,b)}):c(D[0],
"getHour,"+a.syncID+","+JSON.stringify(d.error)),m.hide(),q.hide();else if(c(D[1],"getHour "+d.data.length+" "+JSON.stringify(d.data)),b){for(var e=d.data.length,f=0;f<e;f++)if(-1!=d.data[f].permissions.actions.indexOf("ADD_HOURS")&&-1!=d.data[f].permissions.actions.indexOf("CHANGE_STATUS")){b(a,d.data[f]);return}b(a,d.data[0])}});d.fail(function(a,c,b){JSON.stringify(b)})}var h=["com.attask.common.AuthenticationException"],D=["error","debug","informational"],f,fa=!(window.hasOwnProperty("chrome")&&
window.chrome.hasOwnProperty("windows")),u=-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")&&fa,z=-1!==document.URL.indexOf("dashboard.directory"),X=!1,I=!1,Q="Force Desktop Stopwatch Access",Ba=300,va=[];f=!fa||u?new Store("Attask"):{settings:[],set:function(a,c){switch(a){case "domain":case "host":case "userID":case "sessionID":case "username":case "date":case "view":this.setCookie(a,c,9999999999)}this.settings[a]=c},get:function(a){switch(a){case "domain":case "host":case "userID":case "sessionID":case "username":case "date":case "view":var c=
void 0===this.settings[a]?this.getCookie(a):this.settings[a];this.settings[a]=c;return"undefined"==c||void 0==c?void 0:c;default:return!this.settings.hasOwnProperty(a)||"undefined"==this.settings[a]||void 0==this.settings[a]?void 0:this.settings[a]}},removeAll:function(){var a=new Date,c;for(c in this.settings)this.settings.hasOwnProperty(c)&&(document.cookie=c+"="+this.settings[c]+";expires="+a.toGMTString()+";;");this.settings=[]},setCookie:function(a,c,b){var d=new Date;d.setHours(0);d.setMinutes(0);
d.setSeconds(0);d.setDate(d.getDate()+b);c=encodeURI(c)+(null==b?"":"; expires="+d.toUTCString());document.cookie=a+"="+c},getCookie:function(a){var c,b,d,e=document.cookie.split(";");for(c=0;c<e.length;c++)if(b=e[c].substr(0,e[c].indexOf("=")),d=e[c].substr(e[c].indexOf("=")+1),b=b.replace(/^\s+|\s+$/g,""),b==a)return decodeURI(d);return"undefined"}};window.addEventListener("offline",function(a){jQuery("#refresh").hide();jQuery(".done").hide();jQuery(".percent").hide();jQuery(".view").hide();I=!0});
window.addEventListener("online",function(a){jQuery("#refresh").show();jQuery(".done").show();jQuery(".percent").show();jQuery(".view").show();a=f.get("offlineTasks");for(var c=a.length,b=0;b<c;b++)R(a[b],a[b].duration);f.set("offlineTasks",[]);I=!1});var za;OB.init.add(function(){void 0==f.get("qr")&&f.set("qr","true"==jQuery.urlParam("qr")||!1!=jQuery.urlParam("code"));ba();ta();g();var a=jQuery.urlParam("s"),c=jQuery.urlParam("d");0!=c&&(0!=a&&f.set("sessionID",a),a=c.split("."),f.set("host",a[0]),
a.shift(),f.set("domain",a.join(".")),void 0==f.get("ent")&&(f.set("userID",jQuery.urlParam("u")),f.set("password",""),f.set("ent",void 0!=f.get("userID"))));l();!0==f.get("qr")&&void 0==f.get("sessionID")&&(!1!=jQuery.urlParam("code")?(document.getElementById("button-appscan").style.display="block",qrRead(jQuery.urlParam("code"),f)):qrLoad(f))});OB.onBeforeUnLoad.add(function(a){var c=TASK_CNTRL.getDuration(a);R(a,c.duration)});OB.onUnLoad.add(function(){TASK_DB.running(function(a){f.get("stopOnClose")&&
TASK_CNTRL.stopTask(a)})});OB.onLoad.add(function(){document.addEventListener("resume",function(){jQuery("#loading").show();l()||g()},!1);document.addEventListener("pause",function(){jQuery("#form-list").html("")},!1);document.addEventListener("menubutton",function(){TASK_CNTRL.showWindow('<h3><div style="text-align: center; font-weight: bold;">Welcome</div></h3><div class="content"><p>If you have any questions please visit <a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank" class="btn" >store.atappstore.com</a></p><a href="#" class="btn btn-primary cancel" title="Done">Done</a></div>')},
!1)});OB.updateAtInterval.add(function(a,c){f.get("updateAtInterval")&&(0==c?m.hide():(m.show(),R(a,c)))});OB.stop.add(function(a,c){m.show();var b,d;b=new Date(a.start);d=new Date;if(f.get("minuteBufferSnapToSched")){var e=f.get("todaySched"),g=f.get("minuteBuffer"),l=d.toLocaleDateString("en-US"),h=Date.parse(l+e.start),e=Date.parse(l+e.stop),l=new Date(h);b<h&&b>l.setMinutes(l.getMinutes()-g)&&(b=new Date(h));l=new Date(e);d>e&&d<l.setMinutes(l.getMinutes()+g)&&(d=new Date(e));if(b>=d){m.hide();
return}c=Math.floor((d.getTime()-b.getTime())/1E3)}0==c?m.hide():f.get("updateAtInterval")?R(a,c):X?s(a,function(a){R(a,c)}):R(a,c)});OB.update.add(function(a,c){q.show();R(a,c)});OB.preStart.add(function(a){a.running?TASK_CNTRL.toggleTimer(a):navigator.onLine&&function(){TASK_DB.loadAll(function(c){var b,d,e=!1,g=c.length;for(b=0;b<g;b++)if(d=c[b],null!=d&&d.running&&a.ID!=d.ID){TASK_CNTRL.toggleTimer(d);e=!0;break}X&&f.get("updateAtInterval")?s(a,function(a){TASK_CNTRL.toggleTimer(a)}):(TASK_CNTRL.toggleTimer(a),
!e&&!0==f.get("logout_on_select")&&oa())})}()});OB.postAllItemRender.add(function(){jQuery(".remove").css("display","none");jQuery(".update").css("display","none");jQuery(".reset").css("display","none");f.get("is_auth")?jQuery("#storelink").text("AtAppStore"):(jQuery("#sort-date").remove(),jQuery(".timer").remove(),jQuery(".done").remove(),jQuery(".percent").remove(),jQuery(".date").removeClass("date").addClass("date-tall").html('<a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank">Trial Expired</a>'),
jQuery("#storelink").text("Trial Expired - AtAppStore"));if(ma){var a=jQuery("#form-list"),c=f.get("vpos");void 0!=c&&a.scrollTop(c);"team"==f.get("view")&&!0==f.get("hide_team_done")&&jQuery(".done").remove();I?f.get("allowOffline")&&(jQuery(".done").remove(),jQuery(".percent").remove(),jQuery(".view").remove(),jQuery("#bar").hide()):jQuery("#bar").show();c=f.get("sort");void 0==c&&(c="date");jQuery("#sort-"+c).click();jQuery("#search-bar").is(":visible")&&jQuery("#search").click();jQuery("#loading").hide();
a.show();a=jQuery("#holder")[0];a.style.display="none";a.style.display="block";m.hide();ma=!1}});OB.postItemRender.add(function(a){if(0==jQuery("#item"+a.ID+" #buttons .view").length){var c=jQuery("#item"+a.ID+" #buttons"),b=["",{label:"Low",css:"default"},{label:"Normal",css:"success"},{label:"High",css:"warning"},{label:"Urgent",css:"danger"}];"GEN"!=a.details.objCode&&(void 0!=a.details.priority&&0!=a.details.priority)&&(b=b[a.details.priority],c.append('<span class="task priority '+b.css+'" title="'+
b.label+'" data-priority="'+a.details.priority+'">'+b.label[0]+"</span> "));var d;"GEN"==a.details.objCode?(d="General",jQuery("#item"+a.ID).css({background:"aliceblue"})):"OPTASK"==a.details.objCode?(d="Issue",c.append('<span class="issue" title="Issue">I</span> ')):"TASK"==a.details.objCode&&(d="Task",c.append('<span class="task" title="Task">T</span> '));"General"!=d&&(c.append('<a href="https://'+f.get("host")+"."+f.get("domain")+"/"+d.toLowerCase()+"/view?ID="+a.syncID+'" target="_blank" class="btn btn-mini view" rel="'+
a.ID+'" title="View '+d+'">View</a> '),c.append('<a href="#" class="btn btn-mini done" rel="'+a.ID+'" title="Done '+d+'">Done</a> '));"Task"==d&&void 0!=a.details.percentComplete&&c.append('<a href="#" class="btn btn-mini percent" rel="'+a.ID+'" title="Percent Completed">'+a.details.percentComplete+"%</a> ");c="#D2E0FF";b='<span class="date" style="background-color: #EEE;"><span class="days" data-days="9999"></span></span>';if("General"!=d&&void 0!=a.details.plannedCompletionDate){var b=a.details.plannedCompletionDate.split("T")[0],
b=b.split("-"),b=new Date(b[0],Number(b[1])-1,b[2]),e=new Date;e.setHours(0);e.setMinutes(0);e.setSeconds(0);e=Math.round((b-e)/1E3/60/60/24);0>e?c="#FFCDCD":1>=e&&(c="#FFD7AB");var g;g=0<e?"days due: "+e:"days late: "+Math.abs(e);b='<div class="date" style="background-color: '+c+';"><div class="days" data-days="'+e+'">'+g+"</div><div>"+V(b.getMonth())+" "+b.getDate()+", "+b.getFullYear()+"</div></div>"}c="";null!=a.details.parent&&(c="<br><br>Parent Task: <br>"+a.details.parent.name);jQuery("#item"+
a.ID+" .name").attr("title",d+": <br>"+a.name+c);"General"!=d?(d=a.details.project.name,jQuery("#item"+a.ID+" .details").html(d).attr("title","Project: <br>"+d).attr("data-priority",a.details.priority),jQuery("#item"+a.ID+" .c6").after(b)):jQuery("#item"+a.ID+" .details").html("~"+a.details.description).attr("title",a.details.description)}});OB.remove.add(function(a){jQuery("#item"+a).remove()});OB.reset.add(function(a,c){OB.update.dispatch(c,-c.time);jQuery("#item"+a+" .timer").text(TASK_CNTRL.hms(0))});
var ma=!1,q,m,H=[]}();var QUERY_LOOKUP=null;function getQueryString(d){if(null==QUERY_LOOKUP){var a=location.search.substring(1),e=/([^&=]+)=([^&]*)/g,b;for(QUERY_LOOKUP={};b=e.exec(a);)QUERY_LOOKUP[decodeURIComponent(b[1])]=decodeURIComponent(b[2])}return d in QUERY_LOOKUP?QUERY_LOOKUP[d]:null}
function taskController(d){var a,e=window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows"),b=-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")&&!e;jQuery.urlParam=function(a){a=RegExp("[\\?&]"+a+"=([^&#]*)").exec(window.location.href);return!a?0:a[1]||0};OB.start.add(function(a){startNotify(a)});OB.stop.add(function(a){stopNotify(a)});OB.onLoad.add(function(){});OB.postAllItemRender.add(function(){b&&(jQuery("#form-list").height(0),a=124);if(!e||"full"==
getQueryString("view")){var c=function(){var c=jQuery("#form-list"),b;b=c.height();b+=window.innerHeight-a;0!=window.innerHeight-a&&c.height(b);a=window.innerHeight};jQuery(window).unbind("resize");jQuery(window).bind("resize",c);c()}c={style:{tip:{corner:!0,width:5,height:5},def:!1,classes:"qtip-info"},position:{adjust:{method:"flip flip"},at:"bottom left",my:"top left",viewport:jQuery(window)},show:{},hide:{delay:0}};jQuery("span[title]").qtip(c);b||jQuery("a[title]").qtip(c);c.content="time < 30 seconds<br> time was not tracked";
c.show.event=!1;c.hide.delay=b?0:2E3;var d=jQuery(".timer");d.qtip(c);b||d.mouseover(function(){var a=jQuery(this).find(".time").hide(),c=jQuery(this).find(".timer-info").show();setTimeout(function(){a.show();c.hide()},3E3)}).mouseout(function(){jQuery(this).find(".time").show();jQuery(this).find(".timer-info").hide()});b&&(jQuery(".item").css("padding-right","5px"),jQuery(".task").css("padding-right","5px").css("padding-left","5px"),jQuery(".issue").css("padding-right","5px").css("padding-left",
"5px"),jQuery("body").css("font-size","12px"));jQuery("#searchfor").domsearch("#form-list",{unit:"div.item:visible",criteria:["span[oldtitle]"]})});return{display_intervals:[],update_intervals:[],taskDB:d,init:function(){this.bind();this.toggleRunText();var c=jQuery("#form-list");!e||"full"==getQueryString("view")?(c.css("max-height","100%"),c.css("height","439px")):c.css("max-height","439px");!e&&(window.webkitNotifications&&0!=window.webkitNotifications.checkPermission())&&window.open("core/js/permission.html",
"Permission","height=540,width=447");a=567},bind:function(){b&&jQuery("a[target='_blank']").live("click",function(a){a.preventDefault();window.open(jQuery(this).attr("href"),"_blank","location=yes");return!1});jQuery("#cover").hide();jQuery(".cancel").live("click",function(a){a.preventDefault();jQuery("#"+jQuery(this).attr("rel")).hide().hide().find("input:text").val("");jQuery("#form-list").show();jQuery("#top-bar").show();jQuery("#bar").show()});jQuery("#search").live("click",function(a){a.preventDefault();
jQuery("#sort-bar").toggle();jQuery("#search-bar").toggle();jQuery("#searchfor").focus().val("").domsearchClear()});jQuery("#popout").live("click",function(a){a.preventDefault();e&&window.chrome.windows.create({url:"index.html?view=full",type:"popup",width:393,height:600})});jQuery("#create").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#form-create").slideDown().find("input[name='task-name']").focus()});var a=this;jQuery("#button-create").live("click",function(){a.taskDB.insert(jQuery("#form-create :input[name='task-name']").val());
jQuery("#form-create").hide().find("input:text").val("")});jQuery("#task-name").keydown(function(b){13==b.keyCode&&(a.taskDB.insert(jQuery("#form-create :input[name='task-name']").val()),jQuery("#form-create").hide().find("input:text").val(""))});jQuery(".remove").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#button-remove").attr("rel",jQuery(this).attr("rel"));jQuery("#remove-confirm").html("Are you sure? You want to <strong>delete "+jQuery(this).attr("title")+"</strong>?");
jQuery("#form-remove").show()});jQuery("#button-remove").live("click",function(){jQuery("#form-remove").hide();a.taskDB.remove(jQuery(this).attr("rel"))});jQuery("#remove-all").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#form-remove-all").slideDown()});jQuery("#button-remove-all").live("click",function(){jQuery("#form-remove-all").hide();a.taskDB.removeall()});jQuery(".update").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#top-bar").hide();
jQuery("#bar").hide();a=jQuery(this).attr("rel");this.taskDB.updateValidate(a,this.update)});jQuery("#button-update").live("click",function(){jQuery("#form-update").hide();jQuery("#top-bar").show();jQuery("#bar").show();var b=jQuery("#form-update :input[name='task-id']").val(),d=jQuery("#form-update :input[name='task-name']").val(),e=jQuery("#form-update :input[name='task-time']").val();a.taskDB.update(b,d,e)});jQuery(".cancel").live("click",function(b){b.preventDefault();a.hideWindow()});jQuery(".reset").live("click",
function(b){b.preventDefault();b=jQuery(this).attr("rel");a.taskDB.reset(b)});var d=function(b){b.preventDefault();a.taskDB.updateValidate(jQuery(this).attr("rel"),function(a){OB.preStart.dispatch(a)});return!1};jQuery(".timer").live("click",d);jQuery("#running").click(d);jQuery("#holder").show()},displayError:function(a){this.showWindow('<h3><div style="text-align: center; font-weight: bold;">Error</div></h3><div class="content"><p>'+a+'</p><a href="#" id="cancel_confirm" class="btn btn-primary" title="Done">Done</a></div>')},
showWindow:function(a,d){d=void 0==d?"#window":d;null!=a&&jQuery(d).html(a);b?(jQuery("#cover").css("height","100%").css("opacity","0.8").show(),jQuery(d).animate({top:60+window.pageYOffset+"px"},{easing:"easeInCubic",duration:400,complete:function(){}})):jQuery("#cover").css("height","100%").show().animate({opacity:"0.8"},400,function(){jQuery(d).animate({top:60+window.pageYOffset+"px"},{easing:"easeInCubic",duration:400,complete:function(){}})})},hideWindow:function(a){a=void 0==a?"#window":a;b?
jQuery(a).animate({top:"-700px"},{easing:"easeOutCubic",duration:400,complete:function(){jQuery("#cover").hide()}}):jQuery(a).animate({top:"-700px"},{easing:"easeOutCubic",duration:400,complete:function(){jQuery("#cover").animate({opacity:"0"},{duration:400,complete:function(){jQuery("#cover").hide()}})}})},update:function(a){jQuery("#form-update :input[name='task-id']").val(a.ID);jQuery("#form-update :input[name='task-name']").val(a.name);jQuery("#form-update :input[name='task-time']").val(this.hms(a.time));
jQuery("#form-update").slideDown()},truncateString:function(a){return a},showTask:function(a){var b,d="";b=jQuery("#item"+a.ID);0!=b.length?b.show():(d+='<div class="item'+(a.running?" running":"")+'" id="item'+a.ID+'" rel="'+a.ID+'">',d=d+'<div class="c3">'+('<span class="name c1" title="Task: <br>'+a.name+'" ><strong>'+this.truncateString(a.name)+"</strong></span><br>"),d+='<span class="details" title="'+a.details+'" >'+this.truncateString(a.details)+"</span><br>",d+='<span id="buttons"><a href="#" class="btn btn-mini update" rel="'+
a.ID+'" title="Edit: '+a.name+'">Edit</a> ',d+='<a href="#" class="btn btn-mini reset" rel="'+a.ID+'" title="Reset: '+a.name+'">Reset</a> ',d+='<a href="#" class="btn btn-mini remove" rel="'+a.ID+'" title="Delete: '+a.name+'">Delete</a></span>',d+="</div>",d+='<div class="c8"><div class="c6">',a.running?(b=new Date(a.start),b=Number(a.time)+Math.floor(((new Date).getTime()-b.getTime())/1E3),d+='<a href="#" class="btn timer btn-primary" rel="'+a.ID+'"><span class="time">'+this.hms(b)+"</span>"):d+=
'<a href="#" class="btn timer" rel="'+a.ID+'"><span class="time">'+this.hms(a.time)+"</span>",d+='<span class="timer-info" style="display: none;">'+(a.running?"Stop":"Start")+"</span></a>",d+="</div>",d+="</div></div>",a.running&&(this.startTask(a),this.toggleRunText()),jQuery("#form-list").append(d),OB.postItemRender.dispatch(a))},showAll:function(a){var b,d=a.length;if(0!=d)for(b=0;b<d;b++)this.showTask(a[b]);0==jQuery(".item").length&&this.showNoTaskWindow();OB.postAllItemRender.dispatch()},showNoTaskWindow:function(){this.showWindow('<h3><div style="text-align: center; font-weight: bold;">No Tasks</div></h3><div class="content"><p>Please assign a task to yourself.</p><a href="#" id="cancel_confirm" class="btn btn-primary cancel" title="Done">Done</a></div>')},
toggleTimer:function(a){jQuery("#item"+a.ID+" .timer").toggleClass("btn-primary");a.running?this.stopTask(a):this.startTask(a);this.toggleRunText()},startTask:function(a){if(navigator.onLine){var b=this;window.clearInterval(b.display_intervals[a.ID]);window.clearInterval(b.update_intervals[a.ID]);var d=new Date;a.running?d=new Date(a.start):this.taskDB.start(a.ID,d);jQuery("#item"+a.ID+" .timer .timer-info").text("Stop");b.display_intervals[a.ID]=window.setInterval(function(){var e=Number(a.time)+
Math.floor(((new Date).getTime()-d.getTime())/1E3);jQuery("#item"+a.ID+" .timer .time").text(b.hms(e))},500);b.update_intervals[a.ID]=window.setInterval(function(){if(navigator.onLine){var e=Number(a.time)+Math.floor(((new Date).getTime()-d.getTime())/1E3);b.taskDB.updateAtInterval(a.ID,e,300)}},3E5)}},stopTask:function(a){window.clearInterval(this.display_intervals[a.ID]);window.clearInterval(this.update_intervals[a.ID]);var b=this.getDuration(a);0==b.duration&&jQuery("#item"+a.ID+" .timer").qtip("show");
this.taskDB.stop(a.ID,b.total,b.duration,a.done);jQuery("#item"+a.ID+" .timer .time").text(this.hms(b.total));jQuery("#item"+a.ID+" .timer .timer-info").text("Start")},getDuration:function(a){var b=Number(a.time);a=new Date(a.start);a=Math.floor(((new Date).getTime()-a.getTime())/1E3);30>a?a=0:60>a&&29<a&&(a=60);return{duration:a,total:b+a}},toggleRunText:function(){this.taskDB.running(function(a){e?window.chrome.browserAction.setBadgeText({text:"RUN"}):document.title="Stopwatch - Running: "+a.name;
jQuery("#running").text("Running: "+a.name).attr("rel",a.ID).show();jQuery("#storelink").hide()},function(a){0==a&&(e?window.chrome.browserAction.setBadgeText({text:""}):document.title="Stopwatch",jQuery("#running").hide(),jQuery("#storelink").show())})},hms:function(a){a=[0,0,a];var b;for(b=2;0<b;b--)a[b-1]=Math.floor(a[b]/60),a[b]%=60,10>a[b]&&(a[b]="0"+a[b]);return a.join(":")},sec:function(a){a=String(a).split(":");return Number(parseFloat(3600*a[0])+60*parseFloat(a[1])+parseFloat(a[2]))}}};function taskDB(){return{dm:[],lastId:0,sql:function(d,a,e,b,c,g){},init:function(){this.createDB();return this},onError:function(d){},createDB:function(){this.dm=[];this.lastId=0},dropTaskTable:function(){this.createDB()},start:function(d,a){this.dm[d].running=1;this.dm[d].start=a;OB.start.dispatch(this.dm[d])},updateAtInterval:function(d,a,e){this.dm[d].running=1;this.dm[d].time=Number(a);OB.updateAtInterval.dispatch(this.dm[d],Number(e));this.dm[d].start=new Date},stop:function(d,a,e,b){this.dm[d].running=
0;this.dm[d].done=b;this.dm[d].time=Number(a);OB.stop.dispatch(this.dm[d],Number(e))},running:function(d,a){for(var e in this.dm)if(null!=this.dm[e]&&this.dm[e].running)return d(this.dm[e]),!0;a();return!1},insert:function(d,a,e){var b="null",c="";void 0!=a&&(void 0!=a.syncID&&(b=a.syncID),void 0!=a.details&&(c=a.details));if("null"!=b){a=!1;for(var g in this.dm)if(null!=this.dm[g]&&this.dm[g].syncID==b){a=!0;break}a||(g=this.nextID(),this.dm[g]={ID:g,syncID:b,name:d,details:c,time:0,start:new Date,
running:0,done:0},OB.insert.dispatch(d,{syncID:b,details:c}));TASK_CNTRL.showTask(this.dm[g]);e&&OB.postAllItemRender.dispatch()}},nextID:function(){return this.lastId++},updateValidate:function(d,a){null!=this.dm[d]&&a(this.dm[d])},update:function(d,a,e){e=TASK_CNTRL.sec(e);var b;null!=this.dm[d]&&(this.dm[d].name=a,b=this.dm[d].time,this.dm[d].time=e);OB.update.dispatch(this.dm[d],e-b)},updateDetails:function(d,a){null!=this.dm[d]&&(this.dm[d].details=a)},remove:function(d){this.dm[d]=null;window.clearInterval(TASK_CNTRL.intervals[d]);
OB.remove.dispatch(d)},removeall:function(){this.createDB();for(var d in TASK_CNTRL.intervals)window.clearInterval(TASK_CNTRL.intervals[d]);OB.removeall.dispatch()},reset:function(d){null!=this.dm[d]&&(OB.reset.dispatch(d,this.dm[d]),this.dm[d].time=0)},loadAll:function(d){d(this.dm)}}.init()};function taskDBls(){return{ls:null,ps:null,userId:null,sql:function(d,a,e,b,c,g){},init:function(){this.ps=new Store("AttaskPersistModel");this.ls=new Store("AttaskModel");null==this.ls.get("list")&&this.createDB();return this},onError:function(d){},createDB:function(){this.ls.set("lastId",0);this.ls.set("list",[])},dropTaskTable:function(){this.ls.removeAll()},userRunningTasks:function(d){return p.ps.get(d+""+p.ps.get(d))},start:function(d,a){var e=this.ls.get(d);null!=e&&void 0!=e&&(e.running=1,
e.start=a,this.ls.set(d,e),null!=this.userId&&(this.ps.set(this.userId+""+e.syncID,e),this.ps.set(this.userId,e.syncID)),OB.start.dispatch(e))},updateAtInterval:function(d,a,e){var b=this.ls.get(d);null!=b&&void 0!=b&&(b.time=Number(a),b.running=1,OB.updateAtInterval.dispatch(b,Number(e)),b.start=new Date,this.ls.set(d,b))},stop:function(d,a,e,b){var c=this.ls.get(d);null!=c&&void 0!=c&&(c.running=0,c.done=b,c.time=Number(a),this.ls.set(d,c),null!=this.userId&&(this.ps.remove(this.userId+""+c.syncID),
this.ps.remove(this.userId)),OB.stop.dispatch(c,Number(e)))},running:function(d,a){var e=this.ls.get("list"),b,c=0,g;for(g in e)e.hasOwnProperty(g)&&(b=this.ls.get(g),null!=b&&(void 0!=b&&b.running)&&(void 0!=d&&d(b),c++));void 0!=a&&a(c);return 0!=c},getAllRunning:function(){return this.ps.toObject()},insert:function(d,a,e){var b=this,c="null",g="";void 0!=a&&(void 0!=a.syncID&&(c=a.syncID),void 0!=a.details&&(g=a.details));a=function(a,c,d,e){var g=b.nextID(),k={ID:g,syncID:a,name:c,details:d,time:0,
start:new Date,running:0};if(null!=b.userId){var l=b.ps.get(b.userId+""+a);null!=l&&l.running&&(k=l)}b.ls.set(g,k);l=b.ls.get("list");l[g]=a;b.ls.set("list",l);OB.insert.dispatch(c,{syncID:a,details:d});TASK_CNTRL.showTask(k);e&&OB.postAllItemRender.dispatch()};if("null"!=c){var l=b.ls.get("list"),na=!1,Z;for(Z in l)if(l.hasOwnProperty(Z)&&null!=l[Z]&&l[Z]==c){na=!0;break}na?(c=b.ls.get(Z),c.name=d,g&&Object.assign(c.details,g),b.ls.set(Z,c),TASK_CNTRL.showTask(c),e&&OB.postAllItemRender.dispatch()):
a(c,d,g,e)}else a(c,d,g,e)},nextID:function(){var d=this.ls.get("lastId");d++;this.ls.set("lastId",d);return d},updateValidate:function(d,a){var e=this.ls.get(d);null!=e&&void 0!=e&&a(e)},update:function(d,a,e){e=TASK_CNTRL.sec(e);d=this.ls.get(d);null!=d&&void 0!=d&&(d.name=a,a=d.time,d.time=e,OB.update.dispatch(d,e-a))},updateDetails:function(d,a){var e=this.ls.get(d);null!=e&&void 0!=e&&(e.details=a,this.ls.set(d,e))},remove:function(d){var a=this.ls.get("list");a[d]=null;this.ls.set("list",a);
this.ls.remove(d);window.clearInterval(TASK_CNTRL.intervals[d]);OB.remove.dispatch(d)},removeall:function(){this.createDB();for(var d=TASK_CNTRL.intervals.length,a=0;a<d;a++)window.clearInterval(TASK_CNTRL.intervals[a]);OB.removeall.dispatch()},reset:function(d){var a=this.ls.get(d);null!=a&&void 0!=a&&(OB.reset.dispatch(d,a),a.time=0,this.ls.set(d,a))},loadAll:function(d){var a=this.ls.get("list"),e=[],b,c;for(c in a)a.hasOwnProperty(c)&&(b=this.ls.get(c),null!=b&&void 0!=b&&e.push(b));d(e)},loadSyncIds:function(d){for(var a=
this.ls.get("list"),e=[],b,c=d.length,g=0;g<c;g++)b=a.indexOf(d[g]),-1!=b&&(b=this.ls.get(b),null!=b&&void 0!=b&&e.push(b));return e}}.init()};var TASK_DB;TASK_DB=window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows")||-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")?taskDBls():lscheck()?taskDBls():taskDB();var TASK_CNTRL=taskController(TASK_DB);jQuery(function(){TASK_CNTRL.init();OB.init.dispatch()});function onLoad(){OB.onLoad.dispatch()}
window.addEventListener("beforeunload",function(d){console.log("beforeunload");if(!TASK_CNTRL.IS_EXTENSION&&TASK_DB.running(function(a){OB.onBeforeUnLoad.dispatch(a)}))return(d||window.event).returnValue="Stopwatch has a task running, are you sure?"});window.addEventListener("unload",function(d){console.log("unload");OB.onUnLoad.dispatch()});function lscheck(){try{return localStorage.setItem("stopwatch","stopwatch"),localStorage.removeItem("stopwatch"),!0}catch(d){return!1}};var interval,notifyWorkIntervalTime=30;function startNotify(d){interval=setInterval(function(){notifyWorking(d)},6E4*notifyWorkIntervalTime)}function stopNotify(){clearInterval(interval)}function notifyWorking(d){if(window.webkitNotifications){var a=webkitNotifications.createNotification("../icons/timer48x48.png","Still working on Task:",d.name+"\n"+d.details.split(", Due:")[0]);a.show();setTimeout(function(){a.cancel()},7E3)}else stopNotify()}
function notifyFriday(){var d=webkitNotifications.createNotification("icons/timer48x48.png","Remember: Submit Timesheet!","");d.show();setTimeout(function(){d.cancel()},7E3)};
