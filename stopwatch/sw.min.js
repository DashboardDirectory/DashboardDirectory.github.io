(function(e){function a(c,a,b,d,e){this._listener=a;this._isOnce=b;this.context=d;this._signal=c;this._priority=e||0}function d(c,a){if("function"!==typeof c)throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",a));}function c(){this._bindings=[];this._prevParams=null;var a=this;this.dispatch=function(){c.prototype.dispatch.apply(a,arguments)}}a.prototype={active:!0,params:null,execute:function(c){var a;this.active&&this._listener&&(c=this.params?this.params.concat(c):
c,a=this._listener.apply(this.context,c),this._isOnce&&this.detach());return a},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal;delete this._listener;delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+
", isBound:"+this.isBound()+", active:"+this.active+"]"}};c.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(c,b,d,e){var na=this._indexOfListener(c,d);if(-1!==na){if(c=this._bindings[na],c.isOnce()!==b)throw Error("You cannot add"+(b?"":"Once")+"() then add"+(!b?"":"Once")+"() the same listener without removing the relationship first.");}else c=new a(this,c,b,d,e),this._addBinding(c);this.memorize&&this._prevParams&&c.execute(this._prevParams);return c},
_addBinding:function(c){var a=this._bindings.length;do--a;while(this._bindings[a]&&c._priority<=this._bindings[a]._priority);this._bindings.splice(a+1,0,c)},_indexOfListener:function(c,a){for(var b=this._bindings.length,d;b--;)if(d=this._bindings[b],d._listener===c&&d.context===a)return b;return-1},has:function(c,a){return-1!==this._indexOfListener(c,a)},add:function(c,a,b){d(c,"add");return this._registerListener(c,!1,a,b)},addOnce:function(c,a,b){d(c,"addOnce");return this._registerListener(c,!0,
a,b)},remove:function(c,a){d(c,"remove");var b=this._indexOfListener(c,a);-1!==b&&(this._bindings[b]._destroy(),this._bindings.splice(b,1));return c},removeAll:function(){for(var c=this._bindings.length;c--;)this._bindings[c]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(c){if(this.active){var a=Array.prototype.slice.call(arguments),b=this._bindings.length,d;this.memorize&&(this._prevParams=
a);if(b){d=this._bindings.slice();this._shouldPropagate=!0;do b--;while(d[b]&&this._shouldPropagate&&!1!==d[b].execute(a))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll();delete this._bindings;delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var b=c;b.Signal=c;"function"===typeof define&&define.amd?define(function(){return b}):"undefined"!==typeof module&&module.exports?module.exports=b:e.signals=
b})(this);var OB={start:new signals.Signal,stop:new signals.Signal,preStart:new signals.Signal,preStop:new signals.Signal,insert:new signals.Signal,update:new signals.Signal,reset:new signals.Signal,remove:new signals.Signal,removeAll:new signals.Signal,init:new signals.Signal,options:new signals.Signal,postItemRender:new signals.Signal,postAllItemRender:new signals.Signal,onLoad:new signals.Signal};(function(){var e=this.Store=function(a,d){var c;this.name=a;if(void 0!==d)for(c in d)d.hasOwnProperty(c)&&void 0===this.get(c)&&this.set(c,d[c])};e.prototype.get=function(a){a="store."+this.name+"."+a;if(null!==localStorage.getItem(a))try{return JSON.parse(localStorage.getItem(a))}catch(d){return null}};e.prototype.set=function(a,d){if(void 0===d)this.remove(a);else{if("function"===typeof d)d=null;else try{d=JSON.stringify(d)}catch(c){d=null}localStorage.setItem("store."+this.name+"."+a,d)}return this};
e.prototype.remove=function(a){localStorage.removeItem("store."+this.name+"."+a);return this};e.prototype.removeAll=function(){var a,d;a="store."+this.name+".";for(d=localStorage.length-1;0<=d;d--)localStorage.key(d).substring(0,a.length)===a&&localStorage.removeItem(localStorage.key(d));return this};e.prototype.toObject=function(){var a,d,c,b,e;a={};d="store."+this.name+".";for(c=localStorage.length-1;0<=c;c--)localStorage.key(c).substring(0,d.length)===d&&(b=localStorage.key(c).substring(d.length),
e=this.get(b),void 0!==e&&(a[b]=e));return a};e.prototype.fromObject=function(a,d){!0!==d&&this.removeAll();for(var c in a)a.hasOwnProperty(c)&&this.set(c,a[c]);return this}})();(function(e){function a(c,a){for(var b=0,e=c.length;b<e;b++)if(c[b]==a)return!d;return d}var d=!1,c=parseFloat,b=Math.min,h=/(-?\d+\.?\d*)$/g,n=[],ma=[];e.tinysort={id:"TinySort",version:"1.4.29",copyright:"Copyright (c) 2008-2012 Ron Valstar",uri:"http://tinysort.sjeiti.com/",licensed:{MIT:"http://www.opensource.org/licenses/mit-license.php",GPL:"http://www.gnu.org/licenses/gpl.html"},plugin:function(c,a){n.push(c);ma.push(a)},defaults:{order:"asc",attr:null,data:null,useVal:d,place:"start",returns:d,
cases:d,forceStrings:d,sortFunction:null}};e.fn.extend({tinysort:function(Y,na){Y&&"string"!=typeof Y&&(na=Y,Y=null);var S=e.extend({},e.tinysort.defaults,na),fa,J=e(this).length,t={},l=!(!Y||""==Y),O=!(null===S.attr||""==S.attr),ca=null!==S.data,X=l&&":"==Y[0],da=X?this.filter(Y):this,F=S.sortFunction,U="asc"==S.order?1:-1,W=[];e.each(n,function(c,a){a.call(a,S)});F||(F="rand"==S.order?function(){return 0.5>Math.random()?1:-1}:function(a,b){var l=d,n=!S.cases?a.s&&a.s.toLowerCase?a.s.toLowerCase():
a.s:a.s,t=!S.cases?b.s&&b.s.toLowerCase?b.s.toLowerCase():b.s:b.s;if(!S.forceStrings){var r=n&&n.match(h),F=t&&t.match(h);if(r&&F){var M=n.substr(0,n.length-r[0].length),J=t.substr(0,t.length-F[0].length);M==J&&(l=!d,n=c(r[0]),t=c(F[0]))}}var L=U*(n<t?-1:n>t?1:0);e.each(ma,function(c,a){L=a.call(a,l,n,t,L)});return L});this.each(function(c,a){var b=e(a),d=l?X?da.filter(a):b.find(Y):b,h=ca?""+d.data(S.data):O?d.attr(S.attr):S.useVal?d.val():d.text(),n=b.parent();t[n]||(t[n]={s:[],n:[]});0<d.length?
t[n].s.push({s:h,e:b,n:c}):t[n].n.push({e:b,n:c})});for(fa in t)t[fa].s.sort(F);for(fa in t){var F=t[fa],Z=[],V=J,L=[0,0],ka;switch(S.place){case "first":e.each(F.s,function(c,a){V=b(V,a.n)});break;case "org":e.each(F.s,function(c,a){Z.push(a.n)});break;case "end":V=F.n.length;break;default:V=0}for(ka=0;ka<J;ka++){var M=a(Z,ka)?!d:ka>=V&&ka<V+F.s.length,r=(M?F.s:F.n)[L[M?0:1]].e;r.parent().append(r);(M||!S.returns)&&W.push(r.get(0));L[M?0:1]++}}this.length=0;Array.prototype.push.apply(this,W);return this}});
e.fn.TinySort=e.fn.Tinysort=e.fn.tsort=e.fn.tinysort})(jQuery);Array.prototype.indexOf||(Array.prototype.indexOf=function(e,a){var d=this.length,c=Number(a)||0,c=0>c?Math.ceil(c):Math.floor(c);for(0>c&&(c+=d);c<d;c++)if(c in this&&this[c]===e)return c;return-1});jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,a,d,c,b){return jQuery.easing[jQuery.easing.def](e,a,d,c,b)},easeInQuad:function(e,a,d,c,b){return c*(a/=b)*a+d},easeOutQuad:function(e,a,d,c,b){return-c*(a/=b)*(a-2)+d},easeInOutQuad:function(e,a,d,c,b){return 1>(a/=b/2)?c/2*a*a+d:-c/2*(--a*(a-2)-1)+d},easeInCubic:function(e,a,d,c,b){return c*(a/=b)*a*a+d},easeOutCubic:function(e,a,d,c,b){return c*((a=a/b-1)*a*a+1)+d},easeInOutCubic:function(e,a,d,c,b){return 1>(a/=b/2)?c/2*a*a*a+d:
c/2*((a-=2)*a*a+2)+d},easeInQuart:function(e,a,d,c,b){return c*(a/=b)*a*a*a+d},easeOutQuart:function(e,a,d,c,b){return-c*((a=a/b-1)*a*a*a-1)+d},easeInOutQuart:function(e,a,d,c,b){return 1>(a/=b/2)?c/2*a*a*a*a+d:-c/2*((a-=2)*a*a*a-2)+d},easeInQuint:function(e,a,d,c,b){return c*(a/=b)*a*a*a*a+d},easeOutQuint:function(e,a,d,c,b){return c*((a=a/b-1)*a*a*a*a+1)+d},easeInOutQuint:function(e,a,d,c,b){return 1>(a/=b/2)?c/2*a*a*a*a*a+d:c/2*((a-=2)*a*a*a*a+2)+d},easeInSine:function(e,a,d,c,b){return-c*Math.cos(a/
b*(Math.PI/2))+c+d},easeOutSine:function(e,a,d,c,b){return c*Math.sin(a/b*(Math.PI/2))+d},easeInOutSine:function(e,a,d,c,b){return-c/2*(Math.cos(Math.PI*a/b)-1)+d},easeInExpo:function(e,a,d,c,b){return 0==a?d:c*Math.pow(2,10*(a/b-1))+d},easeOutExpo:function(e,a,d,c,b){return a==b?d+c:c*(-Math.pow(2,-10*a/b)+1)+d},easeInOutExpo:function(e,a,d,c,b){return 0==a?d:a==b?d+c:1>(a/=b/2)?c/2*Math.pow(2,10*(a-1))+d:c/2*(-Math.pow(2,-10*--a)+2)+d},easeInCirc:function(e,a,d,c,b){return-c*(Math.sqrt(1-(a/=b)*
a)-1)+d},easeOutCirc:function(e,a,d,c,b){return c*Math.sqrt(1-(a=a/b-1)*a)+d},easeInOutCirc:function(e,a,d,c,b){return 1>(a/=b/2)?-c/2*(Math.sqrt(1-a*a)-1)+d:c/2*(Math.sqrt(1-(a-=2)*a)+1)+d},easeInElastic:function(e,a,d,c,b){e=1.70158;var h=0,n=c;if(0==a)return d;if(1==(a/=b))return d+c;h||(h=0.3*b);n<Math.abs(c)?(n=c,e=h/4):e=h/(2*Math.PI)*Math.asin(c/n);return-(n*Math.pow(2,10*(a-=1))*Math.sin((a*b-e)*2*Math.PI/h))+d},easeOutElastic:function(e,a,d,c,b){e=1.70158;var h=0,n=c;if(0==a)return d;if(1==
(a/=b))return d+c;h||(h=0.3*b);n<Math.abs(c)?(n=c,e=h/4):e=h/(2*Math.PI)*Math.asin(c/n);return n*Math.pow(2,-10*a)*Math.sin((a*b-e)*2*Math.PI/h)+c+d},easeInOutElastic:function(e,a,d,c,b){e=1.70158;var h=0,n=c;if(0==a)return d;if(2==(a/=b/2))return d+c;h||(h=b*0.3*1.5);n<Math.abs(c)?(n=c,e=h/4):e=h/(2*Math.PI)*Math.asin(c/n);return 1>a?-0.5*n*Math.pow(2,10*(a-=1))*Math.sin((a*b-e)*2*Math.PI/h)+d:0.5*n*Math.pow(2,-10*(a-=1))*Math.sin((a*b-e)*2*Math.PI/h)+c+d},easeInBack:function(e,a,d,c,b,h){void 0==
h&&(h=1.70158);return c*(a/=b)*a*((h+1)*a-h)+d},easeOutBack:function(e,a,d,c,b,h){void 0==h&&(h=1.70158);return c*((a=a/b-1)*a*((h+1)*a+h)+1)+d},easeInOutBack:function(e,a,d,c,b,h){void 0==h&&(h=1.70158);return 1>(a/=b/2)?c/2*a*a*(((h*=1.525)+1)*a-h)+d:c/2*((a-=2)*a*(((h*=1.525)+1)*a+h)+2)+d},easeInBounce:function(e,a,d,c,b){return c-jQuery.easing.easeOutBounce(e,b-a,0,c,b)+d},easeOutBounce:function(e,a,d,c,b){return(a/=b)<1/2.75?c*7.5625*a*a+d:a<2/2.75?c*(7.5625*(a-=1.5/2.75)*a+0.75)+d:a<2.5/2.75?
c*(7.5625*(a-=2.25/2.75)*a+0.9375)+d:c*(7.5625*(a-=2.625/2.75)*a+0.984375)+d},easeInOutBounce:function(e,a,d,c,b){return a<b/2?0.5*jQuery.easing.easeInBounce(e,2*a,0,c,b)+d:0.5*jQuery.easing.easeOutBounce(e,2*a-b,0,c,b)+0.5*c+d}});var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(e){for(var a=0;a<e.length;a++){var d=e[a].string,c=e[a].prop;this.versionSearchString=e[a].versionSearch||e[a].identity;if(d){if(-1!=d.indexOf(e[a].subString))return e[a].identity}else if(c)return e[a].identity}},
searchVersion:function(e){var a=e.indexOf(this.versionSearchString);if(-1!=a)return parseFloat(e.substring(a+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",
identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",
identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();(function(e,a,d){(function(c){"function"==typeof define&&define.amd?define(["jquery"],c):jQuery&&!jQuery.fn.qtip&&c(jQuery)})(function(c){function b(c){ga={pageX:c.pageX,pageY:c.pageY,type:"mousemove",scrollX:e.pageXOffset||a.body.scrollLeft||a.documentElement.scrollLeft,scrollY:e.pageYOffset||a.body.scrollTop||a.documentElement.scrollTop}}function h(a){var b=function(c){return c===O||"object"!=typeof c},d=function(a){return!c.isFunction(a)&&(!a&&!a.attr||1>a.length||"object"==typeof a&&!a.jquery&&
!a.then)};if(!a||"object"!=typeof a)return l;b(a.metadata)&&(a.metadata={type:a.metadata});if("content"in a){if(b(a.content)||a.content.jquery)a.content={text:a.content};d(a.content.text||l)&&(a.content.text=l);"title"in a.content&&(b(a.content.title)&&(a.content.title={text:a.content.title}),d(a.content.title.text||l)&&(a.content.title.text=l))}return"position"in a&&b(a.position)&&(a.position={my:a.position,at:a.position}),"show"in a&&b(a.show)&&(a.show=a.show.jquery?{target:a.show}:{event:a.show}),
"hide"in a&&b(a.hide)&&(a.hide=a.hide.jquery?{target:a.hide}:{event:a.hide}),"style"in a&&b(a.style)&&(a.style={classes:a.style}),c.each(y,function(){this.sanitize&&this.sanitize(a)}),a}function n(N,s,ea,n){function H(f){var m=0,c,a=s;for(f=f.split(".");a=a[f[m++]];)m<f.length&&(c=a);return[c||s,f.pop()]}function G(f){return qa.concat("").join(f?"-"+f+" ":" ")}function aa(){var f=s.style.widget,m=v.hasClass(x);v.removeClass(x);x=f?"ui-state-disabled":"qtip-disabled";v.toggleClass(x,m);v.toggleClass("ui-helper-reset "+
G(),f).toggleClass(ra,s.style.def&&!f);B.content&&B.content.toggleClass(G("content"),f);B.titlebar&&B.titlebar.toggleClass(G("header"),f);B.button&&B.button.toggleClass(ba+"-icon",!f)}function C(f){B.title&&(B.titlebar.remove(),B.titlebar=B.title=B.button=O,f!==l&&k.reposition())}function E(){var f=s.content.title.button,m="string"==typeof f?f:"Close tooltip";B.button&&B.button.remove();f.jquery?B.button=f:B.button=c("<a />",{"class":"qtip-close "+(s.style.widget?"":ba+"-icon"),title:m,"aria-label":m}).prepend(c("<span />",
{"class":"ui-icon ui-icon-close",html:"&times;"}));B.button.appendTo(B.titlebar||v).attr("role","button").click(function(f){return v.hasClass(x)||k.hide(f),l})}function P(){var f=ia+"-title";B.titlebar&&C();B.titlebar=c("<div />",{"class":ba+"-titlebar "+(s.style.widget?G("header"):"")}).append(B.title=c("<div />",{id:f,"class":ba+"-title","aria-atomic":t})).insertBefore(B.content).delegate(".qtip-close","mousedown keydown mouseup keyup mouseout",function(f){c(this).toggleClass("ui-state-active ui-state-focus",
"down"===f.type.substr(-4))}).delegate(".qtip-close","mouseover mouseout",function(f){c(this).toggleClass("ui-state-hover","mouseover"===f.type)});s.content.title.button&&E()}function w(f,a){var R=B.title;if(!k.rendered||!f)return l;c.isFunction(f)&&(f=f.call(N,m.event,k));if(f===l||!f&&""!==f)return C(l);f.jquery&&0<f.length?R.empty().append(f.css({display:"block"})):R.html(f);a!==l&&k.rendered&&0<v[0].offsetWidth&&k.reposition(m.event)}function g(f){f&&c.isFunction(f.done)&&f.done(function(f){z(f,
null,l)})}function z(f,a,R){function b(f){function R(b){b&&(delete g[b.src],clearTimeout(k.timers.img[b.src]),c(b).unbind(u));c.isEmptyObject(g)&&(a!==l&&k.reposition(m.event),f())}var Q,g={};if(0===(Q=e.find("img[src]:not([height]):not([width])")).length)return R();Q.each(function(f,m){if(g[m.src]===d){var a=0;(function ua(){if(m.height||m.width||3<a)return R(m);a+=1;k.timers.img[m.src]=setTimeout(ua,700)})();c(m).bind("error"+u+" load"+u,function(){R(this)});g[m.src]=m}})}var e=B.content;return!k.rendered||
!f?l:(c.isFunction(f)&&(f=f.call(N,m.event,k)||""),R!==l&&g(s.content.deferred),f.jquery&&0<f.length?e.empty().append(f.css({display:"block"})):e.html(f),0>k.rendered?v.queue("fx",b):(F=0,b(c.noop)),k)}function A(){function f(f){if(v.hasClass(x))return l;clearTimeout(k.timers.show);clearTimeout(k.timers.hide);var m=function(){k.toggle(t,f)};0<s.show.delay?k.timers.show=setTimeout(m,s.show.delay):m()}function q(f){if(v.hasClass(x)||I||F)return l;var m=c(f.relatedTarget||f.target),a=m.closest(ha)[0]===
v[0],m=m[0]===g.show[0];clearTimeout(k.timers.show);clearTimeout(k.timers.hide);if("mouse"===d.target&&a||s.hide.fixed&&/mouse(out|leave|move)/.test(f.type)&&(a||m))try{f.preventDefault(),f.stopImmediatePropagation()}catch(q){}else 0<s.hide.delay?k.timers.hide=setTimeout(function(){k.hide(f)},s.hide.delay):k.hide(f)}function R(f){if(v.hasClass(x))return l;clearTimeout(k.timers.inactive);k.timers.inactive=setTimeout(function(){k.hide(f)},s.hide.inactive)}function Q(f){k.rendered&&0<v[0].offsetWidth&&
k.reposition(f)}var d=s.position,g={show:s.show.target,hide:s.hide.target,viewport:c(d.viewport),document:c(a),body:c(a.body),window:c(e)},h=c.trim(""+s.show.event).split(" "),A=c.trim(""+s.hide.event).split(" ");c.browser.msie&&parseInt(c.browser.version,10);v.bind("mouseenter"+u+" mouseleave"+u,function(f){var m="mouseenter"===f.type;m&&k.focus(f);v.toggleClass(sa,m)});/mouse(out|leave)/i.test(s.hide.event)&&"window"===s.hide.leave&&g.window.bind("mouseout"+u+" blur"+u,function(f){!/select|option/.test(f.target.nodeName)&&
!f.relatedTarget&&k.hide(f)});s.hide.fixed?(g.hide=g.hide.add(v),v.bind("mouseover"+u,function(){v.hasClass(x)||clearTimeout(k.timers.hide)})):/mouse(over|enter)/i.test(s.show.event)&&g.hide.bind("mouseleave"+u,function(f){clearTimeout(k.timers.show)});-1<(""+s.hide.event).indexOf("unfocus")&&d.container.closest("html").bind("mousedown"+u+" touchstart"+u,function(f){var m=c(f.target);k.rendered&&v.hasClass(x);var a=0<m.parents(ha).filter(v[0]).length;m[0]!==N[0]&&m[0]!==v[0]&&!a&&!N.has(m[0]).length&&
!m.attr("disabled")&&k.hide(f)});"number"==typeof s.hide.inactive&&(g.show.bind("qtip-"+ea+"-inactive",R),c.each(r.inactiveEvents,function(f,m){g.hide.add(B.tooltip).bind(m+u+"-inactive",R)}));c.each(A,function(m,a){var R=c.inArray(a,h),b=c(g.hide);-1<R&&b.add(g.show).length===b.length||"unfocus"===a?(g.show.bind(a+u,function(m){0<v[0].offsetWidth?q(m):f(m)}),delete h[R]):g.hide.bind(a+u,q)});c.each(h,function(m,a){g.show.bind(a+u,f)});"number"==typeof s.hide.distance&&g.show.add(v).bind("mousemove"+
u,function(f){var a=m.origin||{},c=s.hide.distance,q=Math.abs;(q(f.pageX-a.pageX)>=c||q(f.pageY-a.pageY)>=c)&&k.hide(f)});"mouse"===d.target&&(g.show.bind("mousemove"+u,b),d.adjust.mouse&&(s.hide.event&&(v.bind("mouseleave"+u,function(f){(f.relatedTarget||f.target)!==g.show[0]&&k.hide(f)}),B.target.bind("mouseenter"+u+" mouseleave"+u,function(f){m.onTarget="mouseenter"===f.type})),g.document.bind("mousemove"+u,function(f){k.rendered&&m.onTarget&&!v.hasClass(x)&&0<v[0].offsetWidth&&k.reposition(f||
ga)})));(d.adjust.resize||g.viewport.length)&&(c.event.special.resize?g.viewport:g.window).bind("resize"+u,Q);g.window.bind("scroll"+u,Q)}function T(){var f=[s.show.target[0],s.hide.target[0],k.rendered&&B.tooltip[0],s.position.container[0],s.position.viewport[0],s.position.container.closest("html")[0],e,a];k.rendered?c([]).pushStack(c.grep(f,function(f){return"object"==typeof f})).unbind(u):s.show.target.unbind(u+"-create")}var k=this,ia=ba+"-"+ea,I=0,F=0,v=c(),u=".qtip-"+ea,x="qtip-disabled",B,
m;k.id=ea;k.rendered=l;k.destroyed=l;k.elements=B={target:N};k.timers={img:{}};k.options=s;k.checks={};k.plugins={};k.cache=m={event:{},target:c(),disabled:l,attr:n,onTarget:l,lastClass:""};k.checks.builtin={"^id$":function(f,m,a){f=a===t?r.nextid:a;m=ba+"-"+f;f!==l&&0<f.length&&!c("#"+m).length&&(v[0].id=m,B.content[0].id=m+"-content",B.title[0].id=m+"-title")},"^content.text$":function(f,m,a){z(s.content.text)},"^content.deferred$":function(f,m,a){g(s.content.deferred)},"^content.title.text$":function(f,
m,a){if(!a)return C();!B.title&&a&&P();w(a)},"^content.title.button$":function(f,m,a){f=B.button;k.rendered&&(a?E():f.remove())},"^position.(my|at)$":function(f,m,a){"string"==typeof a&&(f[m]=new y.Corner(a))},"^position.container$":function(f,m,a){k.rendered&&v.appendTo(a)},"^show.ready$":function(){k.rendered?k.toggle(t):k.render(1)},"^style.classes$":function(f,m,a){v.attr("class",ba+" qtip "+a)},"^style.width|height":function(f,m,a){v.css(m,a)},"^style.widget|content.title":aa,"^events.(render|show|move|hide|focus|blur)$":function(f,
m,a){v[(c.isFunction(a)?"":"un")+"bind"]("tooltip"+m,a)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){var f=s.position;v.attr("tracking","mouse"===f.target&&f.adjust.mouse);T();A()}};c.extend(k,{_triggerEvent:function(f,a,b){f=c.Event("tooltip"+f);return f.originalEvent=(b?c.extend({},b):O)||m.event||O,v.trigger(f,[k].concat(a||[])),!f.isDefaultPrevented()},render:function(f){if(k.rendered)return k;var a=s.content.text,b=s.content.title,g=s.position;
return c.attr(N[0],"aria-describedby",ia),v=B.tooltip=c("<div/>",{id:ia,"class":[ba,ra,s.style.classes,ba+"-pos-"+s.position.my.abbrev()].join(" "),width:s.style.width||"",height:s.style.height||"",tracking:"mouse"===g.target&&g.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":l,"aria-describedby":ia+"-content","aria-hidden":t}).toggleClass(x,m.disabled).data("qtip",k).appendTo(s.position.container).append(B.content=c("<div />",{"class":ba+"-content",id:ia+"-content","aria-atomic":t})),
k.rendered=-1,I=1,b.text?(P(),c.isFunction(b.text)||w(b.text,l)):b.button&&E(),(!c.isFunction(a)||a.then)&&z(a,l),k.rendered=t,aa(),c.each(s.events,function(f,m){c.isFunction(m)&&v.bind("toggle"===f?"tooltipshow tooltiphide":"tooltip"+f,m)}),c.each(y,function(){"render"===this.initialize&&this(k)}),A(),v.queue("fx",function(a){k._triggerEvent("render");I=0;(s.show.ready||f)&&k.toggle(t,m.event,l);a()}),k},get:function(f){switch(f.toLowerCase()){case "dimensions":f={height:v.outerHeight(l),width:v.outerWidth(l)};
break;case "offset":f=y.offset(v,s.position.container);break;default:f=H(f.toLowerCase()),f=f[0][f[1]],f=f.precedance?f.string():f}return f},set:function(f,a){var b=/^position\.(my|at|adjust|target|container)|style|content|show\.ready/i,g=l,d=k.checks,e;return"string"==typeof f?(e=f,f={},f[e]=a):f=c.extend(t,{},f),c.each(f,function(m,a){var q=H(m.toLowerCase()),d;d=q[0][q[1]];q[0][q[1]]="object"==typeof a&&a.nodeType?c(a):a;f[m]=[q[0],q[1],a,d];g=b.test(m)||g}),h(s),I=1,c.each(f,function(f,m){var a,
c,q;for(a in d)for(c in d[a])if(q=RegExp(c,"i").exec(f))m.push(q),d[a][c].apply(k,m)}),I=0,k.rendered&&0<v[0].offsetWidth&&g&&k.reposition("mouse"===s.position.target?O:m.event),k},toggle:function(f,q,R){function g(){f?(c.browser.msie&&v[0].style.removeAttribute("filter"),v.css("overflow",""),"string"==typeof e.autofocus&&c(e.autofocus,v).focus(),e.target.trigger("qtip-"+ea+"-inactive")):v.css({display:"",visibility:"",opacity:"",left:"",top:""});k._triggerEvent(f?"visible":"hidden")}if(q){if(/over|enter/.test(q.type)&&
/out|leave/.test(m.event.type)&&s.show.target.add(q.target).length===s.show.target.length&&v.has(q.relatedTarget).length)return k;m.event=c.extend({},q)}if(!k.rendered)return f?k.render(1):k;var d=f?"show":"hide",e=s[d],N=s.position,u=s.content,x=0<v[0].offsetWidth,h=f||1===e.target.length,A=!q||2>e.target.length||m.target[0]===q.target;return(typeof f).search("boolean|number")&&(f=!x),!v.is(":animated")&&x===f&&A?k:k._triggerEvent(d,[90])?(c.attr(v[0],"aria-hidden",!f),f?(m.origin=c.extend({},ga),
k.focus(q),c.isFunction(u.text)&&z(u.text,l),c.isFunction(u.title.text)&&w(u.title.text,l),!oa&&"mouse"===N.target&&N.adjust.mouse&&(c(a).bind("mousemove.qtip",b),oa=t),k.reposition(q,R),!e.solo||c(ha,e.solo).not(v).qtip("hide",c.Event("tooltipsolo"))):(clearTimeout(k.timers.show),delete m.origin,oa&&!c(ha+'[tracking="true"]:visible',e.solo).not(v).length&&(c(a).unbind("mousemove.qtip"),oa=l),k.blur(q)),e.effect===l||h===l?(v[d](),g.call(v)):c.isFunction(e.effect)?(v.stop(1,1),e.effect.call(v,k),
v.queue("fx",function(f){g();f()})):v.fadeTo(90,f?1:0,g),f&&e.target.trigger("qtip-"+ea+"-inactive"),k):k},show:function(f){return k.toggle(t,f)},hide:function(f){return k.toggle(l,f)},focus:function(f){if(!k.rendered)return k;var m=c(ha),a=parseInt(v[0].style.zIndex,10),b=r.zindex+m.length;f=c.extend({},f);return v.hasClass(ja)||k._triggerEvent("focus",[b],f)&&(a!==b&&(m.each(function(){this.style.zIndex>a&&(this.style.zIndex-=1)}),m.filter("."+ja).qtip("blur",f)),v.addClass(ja)[0].style.zIndex=
b),k},blur:function(f){return v.removeClass(ja),k._triggerEvent("blur",[v.css("zIndex")],f),k},reposition:function(f,q){if(!k.rendered||I)return k;I=1;var b=s.position.target,g=s.position,d=g.my,u=g.at,N=g.adjust,ea=N.method.split(" "),x=v.outerWidth(l),h=v.outerHeight(l),A=0,n=0,w=v.css("position"),H=g.viewport,D={left:0,top:0},T=g.container,z=0<v[0].offsetWidth,t=f&&"scroll"===f.type,G=c(e),E,C;if(c.isArray(b)&&2===b.length)u={x:W,y:U},D={left:b[0],top:b[1]};else if("mouse"===b&&(f&&f.pageX||m.event.pageX))u=
{x:W,y:U},f=ga&&ga.pageX&&(N.mouse||!f||!f.pageX)?{pageX:ga.pageX,pageY:ga.pageY}:(!f||"resize"!==f.type&&"scroll"!==f.type?f&&f.pageX&&"mousemove"===f.type?f:!N.mouse&&m.origin&&m.origin.pageX&&s.show.distance?m.origin:f:m.event)||f||m.event||ga||{},"static"!==w&&(D=T.offset()),D={left:f.pageX-D.left,top:f.pageY-D.top},N.mouse&&t&&(D.left-=ga.scrollX-G.scrollLeft(),D.top-=ga.scrollY-G.scrollTop());else{"event"===b&&f&&f.target&&"scroll"!==f.type&&"resize"!==f.type?m.target=c(f.target):"event"!==
b&&(m.target=c(b.jquery?b:B.target));b=m.target;b=c(b).eq(0);if(0===b.length)return k;b[0]===a||b[0]===e?(A=y.iOS?e.innerWidth:b.width(),n=y.iOS?e.innerHeight:b.height(),b[0]===e&&(D={top:(H||b).scrollTop(),left:(H||b).scrollLeft()})):y.imagemap&&b.is("area")?E=y.imagemap(k,b,u,y.viewport?ea:l):y.svg&&b[0].ownerSVGElement?E=y.svg(k,b,u,y.viewport?ea:l):(A=b.outerWidth(l),n=b.outerHeight(l),D=y.offset(b,T));E&&(A=E.width,n=E.height,C=E.offset,D=E.position);if(3.1<y.iOS&&4.1>y.iOS||4.3<=y.iOS&&4.33>
y.iOS||!y.iOS&&"fixed"===w)D.left-=G.scrollLeft(),D.top-=G.scrollTop();D.left+=u.x===V?A:u.x===L?A/2:0;D.top+=u.y===Z?n:u.y===L?n/2:0}return D.left+=N.x+(d.x===V?-x:d.x===L?-x/2:0),D.top+=N.y+(d.y===Z?-h:d.y===L?-h/2:0),y.viewport?(D.adjusted=y.viewport(k,D,g,A,n,x,h),C&&D.adjusted.left&&(D.left+=C.left),C&&D.adjusted.top&&(D.top+=C.top)):D.adjusted={left:0,top:0},k._triggerEvent("move",[D,H.elem||H],f)?(delete D.adjusted,q===l||!z||isNaN(D.left)||isNaN(D.top)||"mouse"===b||!c.isFunction(g.effect)?
v.css(D):c.isFunction(g.effect)&&(g.effect.call(v,k,c.extend({},D)),v.queue(function(f){c(this).css({opacity:"",height:""});c.browser.msie&&this.style.removeAttribute("filter");f()})),I=0,k):k},disable:function(f){return"boolean"!=typeof f&&(f=!v.hasClass(x)&&!m.disabled),k.rendered?(v.toggleClass(x,f),c.attr(v[0],"aria-disabled",f)):m.disabled=!!f,k},enable:function(){return k.disable(l)},destroy:function(){var f=N[0],m=c.attr(f,la),a=N.data("qtip");k.destroyed=t;k.rendered&&(v.stop(1,0).remove(),
c.each(k.plugins,function(){this.destroy&&this.destroy()}));clearTimeout(k.timers.show);clearTimeout(k.timers.hide);T();if(!a||k===a)c.removeData(f,"qtip"),s.suppress&&m&&(c.attr(f,"title",m),N.removeAttr(la)),N.removeAttr("aria-describedby");return N.unbind(".qtip-"+ea),delete pa[k.id],N}})}function ma(b,d){var e,D,H,G,aa,C=c(this),E=c(a.body),P=this===a?E:C;D=C.metadata?C.metadata(d.metadata):O;G="html5"===d.metadata.type&&D?D[d.metadata.name]:O;var w=C.data(d.metadata.name||"qtipopts");try{w="string"==
typeof w?c.parseJSON(w):w}catch(g){}G=c.extend(t,{},r.defaults,d,"object"==typeof w?h(w):O,h(G||D));D=G.position;G.id=b;if("boolean"==typeof G.content.text){H=C.attr(G.content.attr);if(G.content.attr===l||!H)return l;G.content.text=H}D.container.length||(D.container=E);D.target===l&&(D.target=P);G.show.target===l&&(G.show.target=P);G.show.solo===t&&(G.show.solo=D.container.closest("body"));G.hide.target===l&&(G.hide.target=P);G.position.viewport===t&&(G.position.viewport=D.container);D.container=
D.container.eq(0);D.at=new y.Corner(D.at);D.my=new y.Corner(D.my);if(c.data(this,"qtip"))if(G.overwrite)C.qtip("destroy");else if(G.overwrite===l)return l;return G.suppress&&(aa=c.attr(this,"title"))&&c(this).removeAttr("title").attr(la,aa).attr("title",""),e=new n(C,G,b,!!H),c.data(this,"qtip",e),C.bind("remove.qtip-"+b+" removeqtip.qtip-"+b,function(){e.destroy()}),e}function Y(a){var b=this,d=a.elements.tooltip,e=a.options.content.ajax,h=r.defaults.content.ajax,n=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
aa=t,C=l,E;a.checks.ajax={"^content.ajax":function(a,c,g){"ajax"===c&&(e=g);"once"===c?b.init():e&&e.url?b.load():d.unbind(".qtip-ajax")}};c.extend(b,{init:function(){return e&&e.url&&d.unbind(".qtip-ajax")[e.once?"one":"bind"]("tooltipshow.qtip-ajax",b.load),b},load:function(d){function ea(){var b;a.destroyed||(aa=l,y&&(C=t,a.show(d.originalEvent)),(b=h.complete||e.complete)&&c.isFunction(b)&&b.apply(e.context||a,arguments))}function g(b,d,g){var s;a.destroyed||(k&&"string"==typeof b&&(b=c("<div/>").append(b.replace(n,
"")).find(k)),(s=h.success||e.success)&&c.isFunction(s)?s.call(e.context||a,b,d,g):a.set("content.text",b))}function z(c,b,d){a.destroyed||0===c.status||a.set("content.text",b+": "+d)}if(C)C=l;else{var A=e.url.lastIndexOf(" "),T=e.url,k,y=!e.loading&&aa;if(y)try{d.preventDefault()}catch(I){}else if(d&&d.isDefaultPrevented())return b;E&&E.abort&&E.abort();-1<A&&(k=T.substr(A),T=T.substr(0,A));E=c.ajax(c.extend({error:h.error||z,context:a},e,{url:T,success:g,complete:ea}))}},destroy:function(){E&&E.abort&&
E.abort();a.destroyed=t}});b.init()}function na(a,c,b){var d=Math.ceil(c/2),e=Math.ceil(b/2);c={bottomright:[[0,0],[c,b],[c,0]],bottomleft:[[0,0],[c,0],[0,b]],topright:[[0,b],[c,0],[c,b]],topleft:[[0,0],[0,b],[c,b]],topcenter:[[0,b],[d,0],[c,b]],bottomcenter:[[0,0],[c,0],[d,b]],rightcenter:[[0,0],[c,e],[0,b]],leftcenter:[[c,0],[c,b],[0,e]]};return c.lefttop=c.bottomright,c.righttop=c.bottomleft,c.leftbottom=c.topright,c.rightbottom=c.topleft,c[a.string()]}function S(a,b){var e,h;function n(a){var c=
T.is(":visible");T.show();a();T.toggle(c)}function G(c,b,e,s){if(A.tip){c=g.corner.clone();b=e.adjusted;var m=a.options.position.adjust.method.split(" ");s=m[0];var m=m[1]||m[0],f=l,q=l,R=0,Q=0,K,h={},n;g.corner.fixed!==t&&(s===M&&c.precedance===ca&&b.left&&c.y!==L?c.precedance=c.precedance===ca?X:ca:s!==M&&b.left&&(c.x=c.x===L?0<b.left?W:V:c.x===W?V:W),m===M&&c.precedance===X&&b.top&&c.x!==L?c.precedance=c.precedance===X?ca:X:m!==M&&b.top&&(c.y=c.y===L?0<b.top?U:Z:c.y===U?Z:U),c.string()!==k.corner.string()&&
(k.top!==b.top||k.left!==b.left)&&g.update(c,l));K=g.position(c,b);K[c.x]+=aa(c,c.x);K[c.y]+=aa(c,c.y);K.right!==d&&(K.left=-K.right);K.bottom!==d&&(K.top=-K.bottom);K.user=Math.max(0,z.offset);if(f=s===M&&!!b.left)c.x===L?h["margin-left"]=R=K["margin-left"]:(n=K.right!==d?[b.left,-K.left]:[-b.left,K.left],(R=Math.max(n[0],n[1]))>n[0]&&(e.left-=b.left,f=l),h[K.right!==d?V:W]=R);if(q=m===M&&!!b.top)c.y===L?h["margin-top"]=Q=K["margin-top"]:(n=K.bottom!==d?[b.top,-K.top]:[-b.top,K.top],(Q=Math.max(n[0],
n[1]))>n[0]&&(e.top-=b.top,q=l),h[K.bottom!==d?Z:U]=Q);A.tip.css(h).toggle(!(R&&Q||c.x===L&&Q||c.y===L&&R));e.left-=K.left.charAt?K.user:s!==M||q||!f&&!q?K.left:0;e.top-=K.top.charAt?K.user:m!==M||f||!f&&!q?K.top:0;k.left=b.left;k.top=b.top;k.corner=c.clone()}}function aa(a,c,b){c=c?c:a[a.precedance];var e=A.titlebar&&a.y===U?A.titlebar:T,m="border-"+c+"-width",f;return n(function(){f=(b?parseInt(b.css(m),10):parseInt(A.content.css(m),10)||parseInt(e.css(m),10)||parseInt(T.css(m),10))||0}),f}function C(a){var b=
A.titlebar&&a.y===U?A.titlebar:A.content,e=c.browser.mozilla?"-moz-":c.browser.webkit?"-webkit-":"",d="border-radius-"+a.y+a.x,m="border-"+a.y+"-"+a.x+"-radius",f=function(f){return parseInt(b.css(f),10)||parseInt(T.css(f),10)},q;return n(function(){q=f(m)||f(e+m)||f(e+d)||f(d)||0}),q}function E(a){function b(a,m,c){m=a.css(m)||f;return c&&m===a.css(c)?l:s.test(m)?l:m}var d=A.tip.css("cssText","");a=a||g.corner;var s=/rgba?\(0, 0, 0(, 0)?\)|transparent|#123456/i,m="border-"+a[a.precedance]+"-color",
f="transparent",q=A.titlebar,R=q&&(a.y===U||a.y===L&&d.position().top+r.height/2+z.offset<q.outerHeight(t))?q:A.content;n(function(){e=b(d,"background-color")||b(R,"background-color")||b(A.content,"background-color")||b(T,"background-color")||d.css("background-color");h=b(d,m,"color")||b(R,m,"color")||b(A.content,m,"color")||b(T,m,"color")||T.css(m);c("*",d).add(d).css("cssText","background-color:"+f+" !important;border:0 !important;")})}function P(a){var c=a.precedance===X,b=r[c?da:F],d=r[c?F:da];
a=-1<a.string().indexOf(L);var m=b*(a?0.5:1),f=Math.pow,q=Math.round,e,g,s,k=Math.sqrt(f(m,2)+f(d,2)),m=[I/m*k,I/d*k];return m[2]=Math.sqrt(f(m[0],2)-f(I,2)),m[3]=Math.sqrt(f(m[1],2)-f(I,2)),e=k+m[2]+m[3]+(a?0:m[0]),g=e/k,s=[q(g*d),q(g*b)],{height:s[c?0:1],width:s[c?1:0]}}function w(a,c,b){return"<qvml:"+a+' xmlns="urn:schemas-microsoft.com:vml" class="qtip-vml" '+(c||"")+' style="behavior: url(#default#VML); '+(b||"")+'" />'}var g=this,z=a.options.style.tip,A=a.elements,T=A.tooltip,k={top:0,left:0},
r={width:z.width,height:z.height};h=e=void 0;var I=z.border||0,J=!!(c("<canvas />")[0]||{}).getContext;g.corner=O;g.mimic=O;g.border=I;g.offset=z.offset;g.size=r;a.checks.tip={"^position.my|style.tip.(corner|mimic|border)$":function(){g.init()||g.destroy();a.reposition()},"^style.tip.(height|width)$":function(){r={width:z.width,height:z.height};g.create();g.update();a.reposition()},"^content.title.text|style.(classes|widget)$":function(){A.tip&&A.tip.length&&g.update()}};c.extend(g,{init:function(){var b=
z.corner,d=a.options.position,e=d.at,d=d.my.string?d.my.string():d.my,b=(b===l||d===l&&e===l?l:(b===t?g.corner=new y.Corner(d):b.string||(g.corner=new y.Corner(b),g.corner.fixed=t),k.corner=new y.Corner(g.corner.string()),"centercenter"!==g.corner.string()))&&(J||c.browser.msie);return b&&(g.create(),g.update(),T.unbind(".qtip-tip").bind("tooltipmove.qtip-tip",G)),b},create:function(){var a=r.width,b=r.height,d;A.tip&&A.tip.remove();A.tip=c("<div />",{"class":"qtip-tip"}).css({width:a,height:b}).prependTo(T);
J?c("<canvas />").appendTo(A.tip)[0].getContext("2d").save():(d=w("shape",'coordorigin="0,0"',"position:absolute;"),A.tip.html(d+d),c("*",A.tip).bind("click mousedown",function(a){a.stopPropagation()}))},update:function(a,b){var d=A.tip,s=d.children(),m=r.width,f=r.height,q=z.mimic,R=Math.round,Q,K,n,N;a||(a=k.corner||g.corner);q===l?q=a:(q=new y.Corner(q),q.precedance=a.precedance,"inherit"===q.x?q.x=a.x:"inherit"===q.y?q.y=a.y:q.x===q.y&&(q[a.precedance]=a[a.precedance]));a.precedance===ca?(r.width=
z.height,r.height=z.width):(r.width=z.width,r.height=z.height);A.tip.css({width:m=r.width,height:f=r.height});E(a);"transparent"!==h?(I=aa(a,O),0===z.border&&0<I&&(e=h),g.border=I=z.border!==t?z.border:I):g.border=I=0;K=na(q,m,f);g.size=N=P(a);d.css(N).css("line-height",N.height+"px");a.precedance===X?n=[R(q.x===W?I:q.x===V?N.width-m-I:(N.width-m)/2),R(q.y===U?N.height-f:0)]:n=[R(q.x===W?N.width-m:0),R(q.y===U?I:q.y===Z?N.height-f-I:(N.height-f)/2)];J?(s.attr(N),Q=s[0].getContext("2d"),Q.restore(),
Q.save(),Q.clearRect(0,0,3E3,3E3),Q.fillStyle=e,Q.strokeStyle=h,Q.lineWidth=2*I,Q.lineJoin="miter",Q.miterLimit=100,Q.translate(n[0],n[1]),Q.beginPath(),Q.moveTo(K[0][0],K[0][1]),Q.lineTo(K[1][0],K[1][1]),Q.lineTo(K[2][0],K[2][1]),Q.closePath(),I&&("border-box"===T.css("background-clip")&&(Q.strokeStyle=e,Q.stroke()),Q.strokeStyle=h,Q.stroke()),Q.fill()):(K="m"+K[0][0]+","+K[0][1]+" l"+K[1][0]+","+K[1][1]+" "+K[2][0]+","+K[2][1]+" xe",n[2]=I&&/^(r|b)/i.test(a.string())?8===parseFloat(c.browser.version,
10)?2:1:0,s.css({coordsize:m+I+" "+(f+I),antialias:""+(-1<q.string().indexOf(L)),left:n[0],top:n[1],width:m+I,height:f+I}).each(function(a){var b=c(this);b[b.prop?"prop":"attr"]({coordsize:m+I+" "+(f+I),path:K,fillcolor:e,filled:!!a,stroked:!a}).toggle(!!I||!!a);!a&&""===b.html()&&b.html(w("stroke",'weight="'+2*I+'px" color="'+h+'" miterlimit="1000" joinstyle="miter"'))}));b!==l&&g.position(a)},position:function(a){var b=A.tip,d={},e=Math.max(0,z.offset),m,f,q;return z.corner===l||!b?l:(a=a||g.corner,
m=a.precedance,f=P(a),q=[a.x,a.y],m===ca&&q.reverse(),c.each(q,function(c,b){var q,g,s;b===L?(q=m===X?W:U,d[q]="50%",d["margin-"+q]=-Math.round(f[m===X?da:F]/2)+e):(q=aa(a,b),g=aa(a,b,A.content),s=C(a),d[b]=c?g:e+(s>q?s:-q))}),d[a[m]]-=f[m===ca?da:F],b.css({top:"",bottom:"",left:"",right:"",margin:""}).css(d),d)},destroy:function(){A.tip&&A.tip.remove();A.tip=!1;T.unbind(".qtip-tip")}});g.init()}function fa(b){function d(){g=c(w,C).not("[disabled]").map(function(){return"function"==typeof this.focus?
this:null})}function h(a){1>g.length&&a.length?a.not("body").blur():g.first().focus()}function n(a){var b=c(a.target),d=b.closest(".qtip");!(1>d.length?l:parseInt(d[0].style.zIndex,10)>parseInt(C[0].style.zIndex,10))&&c(a.target).closest(ha)[0]!==C[0]&&h(b)}var H=this,G=b.options.show.modal,r=b.elements,C=r.tooltip,E=".qtipmodal"+b.id,P=c(a.body),w=y.modal.focusable.join(","),g={},z;b.checks.modal={"^show.modal.(on|blur)$":function(){H.init();r.overlay.toggle(C.is(":visible"))},"^content.text$":function(){d()}};
c.extend(H,{init:function(){return G.on?(z=H.create(),C.attr("is-modal-qtip",t).css("z-index",y.modal.zindex+c(ha+"[is-modal-qtip]").length).unbind(".qtipmodal").unbind(E).bind("tooltipshow.qtipmodal tooltiphide.qtipmodal",function(a,b,d){b=a.originalEvent;if(a.target===C[0])if(b&&"tooltiphide"===a.type&&/mouse(leave|enter)/.test(b.type)&&c(b.relatedTarget).closest(z[0]).length)try{a.preventDefault()}catch(e){}else(!b||b&&!b.solo)&&H[a.type.replace("tooltip","")](a,d)}).bind("tooltipfocus.qtipmodal",
function(a){if(!(a.isDefaultPrevented()||a.target!==C[0])){var b=c(ha).filter("[is-modal-qtip]"),d=y.modal.zindex+b.length,e=parseInt(C[0].style.zIndex,10);z[0].style.zIndex=d-2;b.each(function(){this.style.zIndex>e&&(this.style.zIndex-=1)});b.end().filter("."+ja).qtip("blur",a.originalEvent);C.addClass(ja)[0].style.zIndex=d;try{a.preventDefault()}catch(g){}}}).bind("tooltiphide.qtipmodal",function(a){a.target===C[0]&&c("[is-modal-qtip]").filter(":visible").not(C).last().qtip("focus",a)}),G.escape&&
c(a).unbind(E).bind("keydown"+E,function(a){27===a.keyCode&&C.hasClass(ja)&&b.hide(a)}),G.blur&&r.overlay.unbind(E).bind("click"+E,function(a){C.hasClass(ja)&&b.hide(a)}),d(),H):H},create:function(){function a(){z.css({height:d.height(),width:d.width()})}var b=c("#qtip-overlay"),d=c(e);return b.length?r.overlay=b.insertAfter(c(ha).last()):(z=r.overlay=c("<div />",{id:"qtip-overlay",html:"<div></div>",mousedown:function(){return l}}).hide().insertAfter(c(ha).last()),d.unbind(".qtipmodal").bind("resize.qtipmodal",
a),a(),z)},toggle:function(a,b,d){if(a&&a.isDefaultPrevented())return H;a=G.effect;var e=b?"show":"hide",g=z.is(":visible"),s=c("[is-modal-qtip]").filter(":visible").not(C);return z||(z=H.create()),z.is(":animated")&&g===b&&z.data("toggleState")!==l||!b&&s.length?H:(b?(z.css({left:0,top:0}),z.toggleClass("blurs",G.blur),G.stealfocus!==l&&(P.bind("focusin"+E,n),h(c("body :focus")))):P.unbind("focusin"+E),z.stop(t,l).data("toggleState",b),c.isFunction(a)?a.call(z,b):a===l?z[e]():z.fadeTo(parseInt(d,
10)||90,b?1:0,function(){b||c(this).hide()}),b||z.queue(function(a){z.css({left:"",top:""}).removeData("toggleState");a()}),H)},show:function(a,c){return H.toggle(a,t,c)},hide:function(a,c){return H.toggle(a,l,c)},destroy:function(){var d=z;return d&&(d=1>c("[is-modal-qtip]").not(C).length,d?(r.overlay.remove(),c(a).unbind(".qtipmodal")):r.overlay.unbind(".qtipmodal"+b.id),P.unbind("focusin"+E)),C.removeAttr("is-modal-qtip").unbind(".qtipmodal")}});H.init()}function J(b){var d=this,h=b.elements,n=
b.options,H=h.tooltip,G=".ie6-"+b.id,r=1>c("select, object").length,C=0,E=l,y;b.checks.ie6={"^content|style$":function(a,c,b){redraw()}};c.extend(d,{init:function(){var b=c(e),g;r&&(h.bgiframe=c('<iframe class="qtip-bgiframe" frameborder="0" tabindex="-1" src="javascript:\'\';"  style="display:block; position:absolute; z-index:-1; filter:alpha(opacity=0); -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";"></iframe>'),h.bgiframe.appendTo(H),H.bind("tooltipmove"+G,d.adjustBGIFrame));
y=c("<div/>",{id:"qtip-rcontainer"}).appendTo(a.body);d.redraw();h.overlay&&!E&&(g=function(){h.overlay[0].style.top=b.scrollTop()+"px"},b.bind("scroll.qtip-ie6, resize.qtip-ie6",g),g(),h.overlay.addClass("qtipmodal-ie6fix"),E=t)},adjustBGIFrame:function(){var a=b.get("dimensions"),c=b.plugins.tip,d=h.tip,e,s;s=parseInt(H.css("border-left-width"),10)||0;s={left:-s,top:-s};c&&d&&(e="x"===c.corner.precedance?["width","left"]:["height","top"],s[e[1]]-=d[e[0]]());h.bgiframe.css(s).css(a)},redraw:function(){if(1>
b.rendered||C)return d;var a=n.style,c=n.position.container,e,h,l,k;return C=1,a.height&&H.css(F,a.height),a.width?H.css(da,a.width):(H.css(da,"").appendTo(y),h=H.width(),1>h%2&&(h+=1),l=H.css("max-width")||"",k=H.css("min-width")||"",e=-1<(l+k).indexOf("%")?c.width()/100:0,l=(-1<l.indexOf("%")?e:1)*parseInt(l,10)||h,k=(-1<k.indexOf("%")?e:1)*parseInt(k,10)||0,h=l+k?Math.min(Math.max(h,k),l):h,H.css(da,Math.round(h)).appendTo(c)),C=0,d},destroy:function(){r&&h.bgiframe.remove();H.unbind(G)}});d.init()}
var t=!0,l=!1,O=null,ca="x",X="y",da="width",F="height",U="top",W="left",Z="bottom",V="right",L="center",ka="flipinvert",M="shift",r,y,ga,ba="qtip",pa={},qa=["ui-widget","ui-tooltip"],ha="div.qtip."+ba,ra=ba+"-default",ja=ba+"-focus",sa=ba+"-hover",la="oldtitle",oa;r=c.fn.qtip=function(a,b,e){var n=(""+a).toLowerCase(),H=O,G=c.makeArray(arguments).slice(1),y=G[G.length-1],C=this[0]?c.data(this[0],"qtip"):O;if(!arguments.length&&C||"api"===n)return C;if("string"==typeof a)return this.each(function(){var a=
c.data(this,"qtip");if(!a)return t;y&&y.timeStamp&&(a.cache.event=y);if("option"!==n&&"options"!==n||!b)a[n]&&a[n].apply(a[n],G);else{if(!c.isPlainObject(b)&&e===d)return H=a.get(b),l;a.set(b,e)}}),H!==O?H:this;if("object"==typeof a||!arguments.length)return C=h(c.extend(t,{},a)),r.bind.call(this,C,y)};r.bind=function(a,e){return this.each(function(h){function n(a){function b(){E.render("object"==typeof a||H.show.ready);G.show.add(G.hide).unbind(C)}if(E.cache.disabled)return l;E.cache.event=c.extend({},
a);E.cache.target=a?c(a.target):[d];0<H.show.delay?(clearTimeout(E.timers.show),E.timers.show=setTimeout(b,H.show.delay),F.show!==F.hide&&G.hide.bind(F.hide,function(){clearTimeout(E.timers.show)})):b()}var H,G,F,C,E;h=c.isArray(a.id)?a.id[h]:a.id;h=!h||h===l||1>h.length||pa[h]?r.nextid++:pa[h]=h;C=".qtip-"+h+"-create";E=ma.call(this,h,a);if(E===l)return t;H=E.options;c.each(y,function(){"initialize"===this.initialize&&this(E)});G={show:H.show.target,hide:H.hide.target};F={show:c.trim(""+H.show.event).replace(/ /g,
C+" ")+C,hide:c.trim(""+H.hide.event).replace(/ /g,C+" ")+C};/mouse(over|enter)/i.test(F.show)&&!/mouse(out|leave)/i.test(F.hide)&&(F.hide+=" mouseleave"+C);G.show.bind("mousemove"+C,function(a){b(a);E.cache.onTarget=t});G.show.bind(F.show,n);(H.show.ready||H.prerender)&&n(e)}).attr("data-hasqtip",t)};y=r.plugins={Corner:function(a){a=(""+a).replace(/([A-Z])/," $1").replace(/middle/gi,L).toLowerCase();this.x=(a.match(/left|right/i)||a.match(/center/)||["inherit"])[0].toLowerCase();this.y=(a.match(/top|bottom|center/i)||
["inherit"])[0].toLowerCase();a=a.charAt(0);this.precedance="t"===a||"b"===a?X:ca;this.string=function(){return this.precedance===X?this.y+this.x:this.x+this.y};this.abbrev=function(){var a=this.x.substr(0,1),c=this.y.substr(0,1);return a===c?a:this.precedance===X?c+a:a+c};this.invertx=function(a){this.x=this.x===W?V:this.x===V?W:a||this.x};this.inverty=function(a){this.y=this.y===U?Z:this.y===Z?U:a||this.y};this.clone=function(){return{x:this.x,y:this.y,precedance:this.precedance,string:this.string,
abbrev:this.abbrev,clone:this.clone,invertx:this.invertx,inverty:this.inverty}}},offset:function(b,d){var e=b.offset(),h=b.closest("body"),n=c.browser.msie&&"CSS1Compat"!==a.compatMode,l=d,t,r,E;if(l){do"static"!==l.css("position")&&(r=l.position(),e.left-=r.left+(parseInt(l.css("borderLeftWidth"),10)||0)+(parseInt(l.css("marginLeft"),10)||0),e.top-=r.top+(parseInt(l.css("borderTopWidth"),10)||0)+(parseInt(l.css("marginTop"),10)||0),!t&&"hidden"!==(E=l.css("overflow"))&&"visible"!==E&&(t=l));while((l=
c(l[0].offsetParent)).length);if(t&&t[0]!==h[0]||n)h=t||h,e.left+=1*h.scrollLeft(),e.top+=1*h.scrollTop()}return e},iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||l,fn:{attr:function(a,b){if(this.length){var d=this[0],e=c.data(d,"qtip");if("title"===a&&e&&"object"==typeof e&&e.options.suppress)return 2>arguments.length?c.attr(d,la):(e&&"title"===e.options.content.attr&&
e.cache.attr&&e.set("content.text",b),this.attr(la,b))}return c.fn.attr_replacedByqTip.apply(this,arguments)},clone:function(a){c([]);var b=c.fn.clone_replacedByqTip.apply(this,arguments);return a||b.filter("["+la+"]").attr("title",function(){return c.attr(this,la)}).removeAttr(la),b}}};c.each(y.fn,function(a,b){if(!b||c.fn[a+"_replacedByqTip"])return t;var d=c.fn[a+"_replacedByqTip"]=c.fn[a];c.fn[a]=function(){return b.apply(this,arguments)||d.apply(this,arguments)}});c.ui||(c.cleanData_replacedByqTip=
c.cleanData,c.cleanData=function(a){for(var b=0,e;(e=a[b])!==d;b++)try{c(e).triggerHandler("removeqtip")}catch(h){}c.cleanData_replacedByqTip(a)});r.version="2.0.1";r.nextid=0;r.inactiveEvents="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" ");r.zindex=15E3;r.defaults={prerender:l,id:l,overwrite:t,suppress:t,content:{text:t,attr:"title",deferred:l,title:{text:l,button:l}},position:{my:"top left",at:"bottom right",target:l,container:l,viewport:l,adjust:{x:0,y:0,mouse:t,resize:t,
method:"flipinvert flipinvert"},effect:function(a,b,d){c(this).animate(b,{duration:200,queue:l})}},show:{target:l,event:"mouseenter",effect:t,delay:90,solo:l,ready:l,autofocus:l},hide:{target:l,event:"mouseleave",effect:t,delay:0,fixed:l,inactive:l,leave:"window",distance:l},style:{classes:"",widget:l,width:l,height:l,def:t},events:{render:O,move:O,show:O,hide:O,toggle:O,visible:O,hidden:O,focus:O,blur:O}};y.svg=function(b,d,e,h){b=c(a);var n=d[0];d={width:0,height:0,position:{top:1E10,left:1E10}};
for(var l;!n.getBBox;)n=n.parentNode;if(n.getBBox&&n.parentNode){e=n.getBBox();h=n.getScreenCTM();n=n.farthestViewportElement||n;if(!n.createSVGPoint)return d;n=n.createSVGPoint();n.x=e.x;n.y=e.y;l=n.matrixTransform(h);d.position.left=l.x;d.position.top=l.y;n.x+=e.width;n.y+=e.height;l=n.matrixTransform(h);d.width=l.x-d.position.left;d.height=l.y-d.position.top;d.position.left+=b.scrollLeft();d.position.top+=b.scrollTop()}return d};y.ajax=function(a){var c=a.plugins.ajax;return"object"==typeof c?
c:a.plugins.ajax=new Y(a)};y.ajax.initialize="render";y.ajax.sanitize=function(a){var c=a.content,b;c&&"ajax"in c&&(b=c.ajax,"object"!=typeof b&&(b=a.content.ajax={url:b}),"boolean"!=typeof b.once&&b.once&&(b.once=!!b.once))};c.extend(t,r.defaults,{content:{ajax:{loading:t,once:t}}});y.tip=function(a){var c=a.plugins.tip;return"object"==typeof c?c:a.plugins.tip=new S(a)};y.tip.initialize="render";y.tip.sanitize=function(a){var c=a.style,b;c&&"tip"in c&&(b=a.style.tip,"object"!=typeof b&&(a.style.tip=
{corner:b}),/string|boolean/i.test(typeof b.corner)||(b.corner=t),"number"!=typeof b.width&&delete b.width,"number"!=typeof b.height&&delete b.height,"number"!=typeof b.border&&b.border!==t&&delete b.border,"number"!=typeof b.offset&&delete b.offset)};c.extend(t,r.defaults,{style:{tip:{corner:t,mimic:l,width:6,height:6,border:t,offset:0}}});y.modal=function(a){var c=a.plugins.modal;return"object"==typeof c?c:a.plugins.modal=new fa(a)};y.modal.initialize="render";y.modal.sanitize=function(a){a.show&&
("object"!=typeof a.show.modal?a.show.modal={on:!!a.show.modal}:"undefined"==typeof a.show.modal.on&&(a.show.modal.on=t))};y.modal.zindex=r.zindex-200;y.modal.focusable="a[href] area[href] input select textarea button iframe object embed [tabindex] [contenteditable]".split(" ");c.extend(t,r.defaults,{show:{modal:{on:l,effect:t,blur:t,stealfocus:t,escape:t}}});y.viewport=function(c,b,d,h,n,l,t){function r(a,c,m,f,q,d,e,h,n){var l=b[q],u=w[a],t=g[a],E=m===M,z=-O.offset[q]+k.offset[q]+k["scroll"+q],
A=u===q?n:u===d?-n:-n/2,y=I&&I.size?I.size[e]||0:0,C=I&&I.corner&&I.corner.precedance===a&&!E?y:0,D=z-l+C;n=l+n-k[e]-z+C;h=A-(w.precedance===a||u===w[c]?t===q?h:t===d?-h:-h/2:0)-(t===L?h/2:0);return E?(C=I&&I.corner&&I.corner.precedance===c?y:0,h=(u===q?1:-1)*A-C,b[q]+=0<D?D:0<n?-n:0,b[q]=Math.max(-O.offset[q]+k.offset[q]+(C&&I.corner[a]===L?I.offset:0),l-h,Math.min(Math.max(-O.offset[q]+k.offset[q]+k[e],l+h),b[q]))):(f*=m===ka?2:0,0<D&&(u!==q||0<n)?(b[q]-=h+f,v["invert"+a](q)):0<n&&(u!==d||0<D)&&
(b[q]-=(u===L?-h:h)+f,v["invert"+a](d)),b[q]<z&&-b[q]>n&&(b[q]=l,v=w.clone())),b[q]-l}var E=d.target,y=c.elements.tooltip,w=d.my,g=d.at,z=d.adjust,A=z.method.split(" "),J=A[0],A=A[1]||A[0],k=d.viewport,O=d.container;d=c.cache;var I=c.plugins.tip,S={left:0,top:0},v,u;if(!k.jquery||E[0]===e||E[0]===a.body||"none"===z.method)return S;E="fixed"===y.css("position");k={elem:k,height:k[(k[0]===e?"h":"outerH")+"eight"](),width:k[(k[0]===e?"w":"outerW")+"idth"](),scrollleft:E?0:k.scrollLeft(),scrolltop:E?
0:k.scrollTop(),offset:k.offset()||{left:0,top:0}};O={elem:O,scrollLeft:O.scrollLeft(),scrollTop:O.scrollTop(),offset:O.offset()||{left:0,top:0}};if("shift"!==J||"shift"!==A)v=w.clone();return S={left:"none"!==J?r(ca,X,J,z.x,W,V,da,h,l):0,top:"none"!==A?r(X,ca,A,z.y,U,Z,F,n,t):0},v&&d.lastClass!==(u=ba+"-pos-"+v.abbrev())&&y.removeClass(c.cache.lastClass).addClass(c.cache.lastClass=u),S};y.imagemap=function(a,b,d,e){function h(a,b,c){for(var d=0,e=1,g=1,n=0,l=0,r=a.width,s=a.height;0<r&&0<s&&0<e&&
0<g;){r=Math.floor(r/2);s=Math.floor(s/2);c.x===W?e=r:c.x===V?e=a.width-r:e+=Math.floor(r/2);c.y===U?g=s:c.y===Z?g=a.height-s:g+=Math.floor(s/2);for(d=b.length;d--&&!(2>b.length);)n=b[d][0]-a.position.left,l=b[d][1]-a.position.top,(c.x===W&&n>=e||c.x===V&&n<=e||c.x===L&&(n<e||n>a.width-e)||c.y===U&&l>=g||c.y===Z&&l<=g||c.y===L&&(l<g||l>a.height-g))&&b.splice(d,1)}return{left:b[0][0],top:b[0][1]}}b.jquery||(b=c(b));a=a.cache.areas={};var n=(b[0].shape||b.attr("shape")).toLowerCase(),l=b[0].coords||
b.attr("coords"),t=l.split(","),r=[];b=c('img[usemap="#'+b.parent("map").attr("name")+'"]');var y=b.offset(),w={width:0,height:0,position:{top:1E10,right:0,bottom:0,left:1E10}},g=0,z=0;y.left+=Math.ceil((b.outerWidth()-b.width())/2);y.top+=Math.ceil((b.outerHeight()-b.height())/2);if("poly"===n)for(g=t.length;g--;)z=[parseInt(t[--g],10),parseInt(t[g+1],10)],z[0]>w.position.right&&(w.position.right=z[0]),z[0]<w.position.left&&(w.position.left=z[0]),z[1]>w.position.bottom&&(w.position.bottom=z[1]),
z[1]<w.position.top&&(w.position.top=z[1]),r.push(z);else for(g=-1;g++<t.length;)r.push(parseInt(t[g],10));switch(n){case "rect":w={width:Math.abs(r[2]-r[0]),height:Math.abs(r[3]-r[1]),position:{left:Math.min(r[0],r[2]),top:Math.min(r[1],r[3])}};break;case "circle":w={width:r[2]+2,height:r[2]+2,position:{left:r[0],top:r[1]}};break;case "poly":w.width=Math.abs(w.position.right-w.position.left),w.height=Math.abs(w.position.bottom-w.position.top),"c"===d.abbrev()?w.position={left:w.position.left+w.width/
2,top:w.position.top+w.height/2}:(a[d+l]||(w.position=h(w,r.slice(),d),e&&("flip"===e[0]||"flip"===e[1])&&(w.offset=h(w,r.slice(),{x:d.x===W?V:d.x===V?W:L,y:d.y===U?Z:d.y===Z?U:L}),w.offset.left-=w.position.left,w.offset.top-=w.position.top),a[d+l]=w),w=a[d+l]),w.width=w.height=0}return w.position.left+=y.left,w.position.top+=y.top,w};y.ie6=function(a){var b=c.browser,d=a.plugins.ie6;return!b.msie||"6"!==(""+b.version).charAt(0)?l:"object"==typeof d?d:a.plugins.ie6=new J(a)};y.ie6.initialize="render"})})(window,
document);var attask=function(){function e(a){var f={url:"https://www.atappstore.com/api/authorize/",data:{product:g.get("qr")?"shiftwatch-qr":"stopwatch",host:g.get("host"),sessionID:g.get("sessionID"),user:g.get("username"),domain:g.get("domain")},type:"GET",dataType:"json"};F(f);f=jQuery.ajax(f);f.done(function(f,b,c){!1!=f.success&&(g.set("auth_key",f.auth_key),g.set("access",f.access),g.set("is_auth",f.is_auth),g.set("license_expiry_days",f.license_expiry_days),g.get("qr")&&(g.set("view","team"),g.set("sort",
"project"),g.set("logout_on_select",!0),g.set("multi",!0),g.set("hide_team_done",!0),g.set("minuteBuffer",30),g.set("minuteBufferSnapToSched",!0),TASK_DB.userId=g.get("userID")),g.get("minuteBufferSnapToSched")&&oa(),g.get("restrict_sched")?oa(function(f){var b;void 0==f&&(b="Today is not a work day");var c=new Date,c=Date.parse("01/01/2011 "+c.getHours()+":"+c.getMinutes()),d=Date.parse("01/01/2011 "+f.start),q=Date.parse("01/01/2011 "+f.stop),e=g.get("minuteBuffer");null!=e&&(d.setMinutes(d.getMinutes()-
e),q.setMinutes(q.getMinutes()+e));void 0==f||d>c||c>q?(b=b?b:"Please return at "+f.start,TASK_CNTRL.showWindow('<h3><div style="text-align: center; font-weight: bold;">Not scheduled to work</div></h3><div class="content"><p>'+b+'.</p><a href="#" class="btn btn-primary logout cancel" title="Logout">Logout</a></div>')):a()}):(a&&a(),ma()))});f.fail(function(a,f,b){})}function a(){var b={url:r()+"user/count",type:"get",data:{},dataType:"json"};F(b);b=jQuery.ajax(b);b.done(function(a){void 0!=a.error?
(a.error["class"]==P[0]?J(function(){}):c(w[0],"uCount,"+JSON.stringify(a.error)),x.hide(),u.hide()):a=a.data});b.fail(function(b,c,m){M({response:b.responseText,type:c,msg:m},a,"uCount")})}function d(){var a={url:r()+"user/search?ID=$$USER.ID&fields=customer:name,customer:fullUsers,customer:limitedUsers,customer:teamUsers",type:"get",data:{},dataType:"json"};F(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==P[0]?J(function(){}):c(w[0],"uInfo,"+JSON.stringify(a.error)),x.hide(),
u.hide()):a=a.data});a.fail(function(a,b,c){M({response:a.responseText,type:b,msg:c},d,"uInfo")})}function c(a,b,c){}function b(){if((z||A||"full"==getQueryString("view"))&&void 0!=g.get("host"))clearInterval(ta),ta=self.setInterval(function(){if(!document.hasFocus()||A)jQuery("#search-bar").is(":visible")&&jQuery("#search").click(),jQuery("#form-list").hide(),void 0==g.get("sessionID")?S():h()||L()},12E4)}function h(){var a=new Date,b=!1;g.get("date")!=a.getDay()&&(jQuery("#form-list").empty(),g.set("notified",
!1),TASK_DB.dropTaskTable(),TASK_DB.createDB(),jQuery("#todayDate").html("Date: "+X(a.getMonth())+" "+a.getDate()),g.set("date",a.getDay()),b=!0);V();return b}function n(){var a=g.get("view");void 0==a||"current"==a?y("task",function(){jQuery("#button-current").click()}):"requested"==a?y("task",function(){jQuery("#button-requested").click()}):"all"==a?jQuery("#button-all").click():"team"==a?jQuery("#button-team").click():"role"==a?jQuery("#button-role").click():"recent"==a&&jQuery("#button-recent").click()}
function ma(){if(""==g.get("access")&&!g.get("notified")){g.set("notified",!0);var b='<h3><div style="text-align: center; font-weight: bold;">Expired for '+g.get("host")+'</div></h3><div class="content"><div><p>To keep the ease of tracking your time, see due dates, and completing your tasks, please visit our site below to see licencing options for your company or to arrange an extended demo. If seeing this for the first time, another employee at your company has used this service 30 days ago, please contact info@atappstore.com to extend.</p></div><a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank"><img src="icons/AtAppStore.png" style=""></a><div style="font-size: 10px;">* this notification will only appear once daily.</div></div><div id="close" class="btn btn-primary" style="width:230px"><h3 style="line-height:0px">close</h3></div>';
TASK_CNTRL.showWindow(b);jQuery("#close").unbind("click").click(function(a){a.preventDefault();TASK_CNTRL.hideWindow()});g.get("userObj");g.get("license_expiry_days");a();d()}}function Y(){var a=jQuery("#content");a.after('<form id="form-qrlogin" class="form" style="display: none"><h3>Login to Workfront</h3><span class="error"></span><p><div id="outdiv" style="text-align:center;"></div><canvas id="qr-canvas" width="640" height="480" style="display:none;"></canvas><h4 id="result" style="text-align:center;"></h4><button type="submit" class="btn btn-success needsclick" style="display:none;" id="button-appscan" value="scan" tabindex="3">Scan</button><button type="submit" class="btn needsclick" style="" id="button-standard" tabindex="5">Standard Login</button><button type="submit" class="btn btn-primary needsclick" style="display:none;" id="button-qrlogin" value="login" tabindex="4">Login</button></form><div class="spinner-bottom"><div id="blockG_1" class="metro_blockG"></div><div id="blockG_2" class="metro_blockG"></div><div id="blockG_3" class="metro_blockG"></div></div>');
jQuery("#button-standard").live("click",function(a){a.preventDefault();O();jQuery("#form-qrlogin").show()});jQuery("#button-appscan").live("click",function(a){a.preventDefault();a=window.navigator.userAgent;a.match(/iPad/i)||a.match(/iPhone/i)?window.location="zxing://scan/?ret="+encodeURIComponent(window.location+"&code={CODE}"):window.location="http://zxing.appspot.com/scan?ret="+encodeURIComponent(window.location+"&code={CODE}")});a.after('<form id="form-login" class="form" style="display: none"><h3>Login to Workfront</h3><span class="error"></span><p><label for="username">Username</label><input type="text" name="username" id="username" class="text" tabindex="1"/></p><p><label for="password">Password</label><input type="password" name="password" id="password" class="text" tabindex="2" autocomplete="off"/></p><p><label for="host">Subdomain</label><input type="text" name="host" id="host" class="text" tabindex="3"/></p><p>eg. <strong>Subdomain</strong>.attask-ondemand.com</p></p></br><button type="submit" class="btn btn-primary needsclick" id="button-login" value="login" tabindex="4">Login</button><div class="spinner-bottom"><div id="blockG_1" class="metro_blockG"></div><div id="blockG_2" class="metro_blockG"></div><div id="blockG_3" class="metro_blockG"></div></div></form>');
a='<div id="hourTypeWindow" class="window"><h3><div style="text-align: center; font-weight: bold;">Track as Type:</div></h3><div class="content"><div><select id="hourTypeSelector" ></select><div><a href="#" id="done_hourType" class="btn btn-primary" rel="'+jQuery(this).attr("rel")+'" title="Done">Done</a><div></div>';jQuery("#window").after(a);if(z||"full"==getQueryString("view")||A)jQuery("#popout").replaceWith('<span id="refresh" style="float: right;" title="Manual Refresh"><img src="core/img/refresh.gif"></span>'),
jQuery("html").css("width","100%"),jQuery("#refresh").live("click",function(a){a.preventDefault();jQuery("#form-list").hide();jQuery("#search-bar").is(":visible")&&jQuery("#search").click();L()});a=new Date;a='<div class="btn-group"><a id="filter" title="Filter for other assigned tasks and issues" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">Filters<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="#" id="button-current" title="Tasks and issues you\'re working on" >Current</a></li><li><a href="#" id="button-recent" title="All tasks and issues tracked within 14 days" >Recent</a></li><li><a href="#" id="button-requested" title="Tasks and issues you can start on" >Requested</a></li><li><a href="#" id="button-all" title="All tasks and issues assigned to you" >All Assigned</a></li><li><a href="#" id="button-team" title="All tasks and issues assigned to your Teams" >Team Assigned</a></li><li><a href="#" id="button-role" title="All tasks and issues available to your Roles" >Role Assigned</a></li><li><a href="#" class="logout" id="button-logout" >Login as New User</a></li></ul></div><span id="totalHours" title="Go To Timesheets" class="btn" style="">Today\'s Hours: 0</span><span id="todayDate" class="btn disabled" style="">Date: '+
X(a.getMonth())+" "+a.getDate()+"</span>";jQuery("#bar").html(a);jQuery("#totalHours").live("click",function(a){a.preventDefault();a="https://"+g.get("host")+"."+g.get("domain")+"/timesheets/current";A?window.open(a,"_blank","location=yes"):window.open(a);return!1});jQuery("#sort-task").live("click",function(a){a.preventDefault();B.priority="asc";B.project=B.date=B.priority="desc";B.task="asc"==B.task?"desc":"asc";jQuery("div#form-list>div").tsort({order:B.task})});jQuery("#sort-project").live("click",
function(a){a.preventDefault();B.priority="asc";B.task=B.date=B.priority="desc";B.project="asc"==B.project?"desc":"asc";jQuery("div#form-list>div").tsort(".details",{order:B.project})});jQuery("#sort-date").live("click",function(a){a.preventDefault();B.priority="asc";B.task=B.project="desc";B.date="asc"==B.date?"desc":"asc";jQuery("div#form-list>div").tsort(".days",{order:B.date,useVal:!0,attr:"data-days"})});jQuery("#sort-priority").live("click",function(a){a.preventDefault();B.task=B.project=B.date=
"desc";B.priority="asc"==B.priority?"desc":"asc";jQuery("div#form-list>div").tsort(".priority",{order:B.priority,useVal:!0,attr:"data-priority"})});jQuery(".done").live("click",function(a){a.preventDefault();a=jQuery(this).parent().parent().children("span.name").attr("title");var b=jQuery(this).parent().parent().children("span.details").attr("title");a='<h3><div style="text-align: center; font-weight: bold;">Confirm</div></h3><div class="content"><div><p>Are you sure you completed <strong>'+a+"</strong><br>from <br><strong>"+
b+'?</strong></h3><div><a href="#" id="done_confirm" class="btn btn-primary" rel="'+jQuery(this).attr("rel")+'" title="Done">Done</a><a href="#" class="btn cancel" title="Cancel">Cancel</a><div>';TASK_CNTRL.showWindow(a)});jQuery("#done_confirm").live("click",function(a){a.preventDefault();TASK_DB.updateValidate(jQuery(this).attr("rel"),function(a){s(a)});TASK_CNTRL.hideWindow()});jQuery("#cancel_confirm").live("click",function(a){a.preventDefault();TASK_CNTRL.hideWindow()});jQuery(".percent").live("click",
function(a){a.preventDefault();jQuery("#form-list").scrollTop(jQuery("#form-list").scrollTop()+jQuery("#item"+jQuery(this).attr("rel")).offset().top-100);if(0==jQuery(this).children("input").length){var b=jQuery(this).text().slice(0,-1);jQuery(this).html("<input type='number' class='inputbox' value=\""+b+'">');var c=function(a){var c=Number(jQuery(a).val()).toFixed(0);isNaN(c)||0>c||100<c||b==c?c=b:TASK_DB.updateValidate(jQuery(a).parent().attr("rel"),function(a){aa(a,c)});jQuery(a).parent().text(c+
"%")};jQuery("input.inputbox").focus().blur(function(){c(this)}).keypress(function(a){13==a.which&&(c(this),a.preventDefault())})}});jQuery("#form-list").scroll(function(){g.set("vpos",jQuery("#form-list").scrollTop())});u=jQuery(".spinner-bottom");x=jQuery(".spinner")}function na(){var a=function(a){jQuery("#button-current").removeClass("btn");jQuery("#button-requested").removeClass("btn");jQuery("#button-all").removeClass("btn");jQuery("#button-team").removeClass("btn");jQuery("#button-role").removeClass("btn");
jQuery("#button-recent").removeClass("btn");ba();jQuery(a).toggleClass("btn")};jQuery("#button-current").live("click",function(){B=[];a("#button-current");g.set("view","current");ra()});jQuery("#button-requested").live("click",function(){B=[];a("#button-requested");g.set("view","requested");ja()});jQuery("#button-all").live("click",function(){B=[];a("#button-all");g.set("view","all");y()});jQuery("#button-team").live("click",function(){B=[];a("#button-team");g.set("view","team");pa()});jQuery("#button-role").live("click",
function(){B=[];a("#button-role");g.set("view","role");ga()});jQuery("#button-recent").live("click",function(){B=[];a("#button-recent");g.set("view","recent");ha()});jQuery(".logout").live("click",function(){S()})}function S(){if(ia&&g.get("allowOffline"))g.remove("sessionID"),g.remove("userID"),g.remove("username"),g.remove("password"),g.remove("host"),g.remove("domain");else{var a=g.get("qr");g.removeAll();g.set("qr",a)}for(var b in TASK_CNTRL.intervals)window.clearInterval(TASK_CNTRL.intervals[b]);
t()}function fa(a){TASK_DB.loadAll(function(b){var c=b.length,d,e;if(0<c)for(d=0;d<c;d++)e=b[d],(null!=e&&"OPTASK"==e.details.objCode||"TASK"==e.details.objCode)&&jQuery("#item"+e.ID).hide();a()})}function J(a){W(g.get("username"),g.get("password"),U(g.get("host")+"."+g.get("domain")),a,function(){t(a)})}function t(a){g.get("qr")?l(a):g.get("ent")?(x.show(),jQuery("#loading").hide(),clearInterval(ta),TASK_DB.dropTaskTable(),TASK_DB.createDB(),TASK_CNTRL.toggleRunText(),x.hide(),u.hide(),jQuery("#top-bar").hide(),
jQuery("#bar").hide(),jQuery(".form").hide(),V(a)):O(a)}function l(a){x.show();jQuery("#loading").hide();clearInterval(ta);TASK_DB.dropTaskTable();TASK_DB.createDB();TASK_CNTRL.toggleRunText();resetForQR();x.hide();u.hide();jQuery("#top-bar").hide();jQuery("#bar").hide();jQuery(".form").hide();jQuery("webcamimg").show();var b=jQuery("#form-qrlogin");jQuery("#form-list").html("");A?b.show():b.slideDown(400,function(){});jQuery("#button-qrlogin").unbind("click").click(function(b){var c=jQuery("#form-qrlogin");
b.preventDefault();u.show();W(g.get("username"),g.get("password"),U(g.get("host")),function(){ignoreForQR();jQuery("#bar").show();A?c.hide():c.slideUp();jQuery("#top-bar").show();jQuery("#loading").show();void 0!=a&&a()},function(){resetForQR()})})}function O(a){x.show();jQuery("#loading").hide();clearInterval(ta);TASK_DB.dropTaskTable();TASK_DB.createDB();TASK_CNTRL.toggleRunText();x.hide();u.hide();jQuery("#top-bar").hide();jQuery("#bar").hide();jQuery(".form").hide();var b=jQuery("#form-login"),
c=g.get("domain"),d=g.get("host");b.find(":input[name='username']").focus().val("");b.find(":input[name='host']").val(void 0==d||"undefined"==d?"":"attask-ondemand.com"!=c?d+"."+c:d);b.find(":input[name='password']").val("");jQuery("#form-list").html("");var e=jQuery("#username");A?(b.show(),e.focus()):b.slideDown(400,function(){e.focus()});jQuery("#button-login").unbind("click").click(function(c){c.preventDefault();u.show();W(jQuery.trim(b.find(":input[name='username']").val()),jQuery.trim(b.find(":input[name='password']").val()),
U(jQuery.trim(b.find(":input[name='host']").val())),function(){jQuery("#bar").show();A?b.hide():b.slideUp();jQuery("#top-bar").show();jQuery("#loading").show();void 0!=a&&a()})})}function ca(a,b){var c=new Date;a.dateStr=c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate();a.duration=b;ia&&g.get("allowOffline")?(a.username=g.get("username"),a.userID=g.get("userID"),c=g.get("offlineTasks"),void 0==c&&(c=[]),c.push(a),g.set("offlineTasks"),x.hide(),u.hide(),!0==g.get("logout_on_select")&&S()):E(a,C)}
function X(a){return"jan. feb. mar. apr. may june jul. aug. sep. oct. nov. dec.".split(" ")[a]}function da(a){return void 0!=a.details.project?a.details.project.name.split(",").join(" ")+","+a.name.split(",").join(" "):a.details}function F(a,b){void 0==b&&(b=1E4);a.timeout=b;z&&(!A&&!T)&&(a.dataType="jsonp",a.crossDomain=!0,a.jsonp="jsonp",a.cache=!0);var c=g.get("sessionID");g.get("ent")?a.data.apiKey=c:a.data.sessionID=c}function U(a){if(1<a.split(".").length){var b=a.split("//");return 1<b.length?
(b.shift(),b[0]):a}return a+".attask-ondemand.com"}function W(a,c,d,h,n){if(void 0==a||void 0==c||void 0==d)n();else{var l=jQuery(".error");l.html("");var k={url:"https://"+d+"/attask/api/v2.0/login",type:"get",data:{username:a,password:c},dataType:"json"};F(k);ia?g.get("allowOffline")?(k=g.get(a),void 0!=k?(Z(k.sessionID,k.userID,k.username,k.password,d),u.hide(),L(),b(),void 0!=h&&h()):l.html("OFFLINE")):l.html("OFFLINE"):(k=jQuery.ajax(k),k.done(function(k){void 0!=k.error?(g.get("qr")?l.html("Please Scan Again."):
l.html(k.error.message),u.hide(),void 0!==n&&n()):(k=k.data,Z(k.sessionID,k.userID,a,c,d),g.set("userObj",JSON.stringify(k)),u.hide(),e(function(){L();b();void 0!=h&&h()}))}),k.fail(function(a,b,c){a.responseText&&""!==a.responseText?-1!=a.responseText.indexOf("<html>")?g.get("qr")?l.html("Please Scan Again."):l.html("Host Invalid: "+d):g.get("qr")?l.html("Please Scan Again."):l.html(JSON.parse(a.responseText).error.message):g.get("qr")?l.html("Please Scan Again."):l.html("Host Invalid: "+d);u.hide();
void 0!==n&&n()}))}}function Z(a,b,c,d,e){g.set("sessionID",a);g.set("userID",b);g.set("username",c);g.set("password",d);e=e.split(".");g.set("host",e[0]);e.shift();g.set("domain",e.join("."));g.get("allowOffline")&&g.set(c,{sessionID:a,userID:b,username:c,password:d})}function V(a){var c=g.get("sessionID");void 0==c||""==c?J(a):(x.show(),c={url:r()+"user/"+g.get("userID"),data:{updates:"{isActive: true}"},type:"PUT",dataType:"json"},z&&(c.data={method:"put"},F(c)),c=jQuery.ajax(c),c.done(function(c){void 0!=
c.error?(c.error["class"]==P[0]?J(a):(g.get("sessionID"),JSON.stringify(c.error)),x.hide(),u.hide()):(x.hide(),u.hide(),b(),!g.get("ent")&&void 0==g.get("auth_key")?e(L):L(),void 0!=a&&a())}),c.fail(function(b,c,f){401==b.status?J(a):"timeout"==c?V(a):g.get("sessionID")}))}function L(){x.show();var a=g.get("userID"),b={url:"https://"+g.get("host")+"."+g.get("domain")+"/attask/api-unsupported/timeSheet/search",type:"get",data:{startDate:"$$TODAY+1",startDate_Mod:"lte",endDate:"$$TODAY-1",endDate_Mod:"gte",
fields:"timesheetProfile:hourTypes:ID,timesheetProfile:hourTypes:name,timesheetProfile:hourTypes:description,timesheetProfile:hourTypes:isActive",userID:a},dataType:"json"};F(b,35E3);ia?g.get("allowOffline")?(a=TASK_DB.userRunningTasks(a),void 0!=a&&(v=!0,TASK_DB.insert(a.name,{syncID:a.syncID,details:a.details},!0))):TASK_CNTRL.displayError("OFFLINE"):(a=jQuery.ajax(b),a.done(function(a){if(void 0!=a.error)a.error["class"]==P[0]?J(function(){L()}):c(w[0],"addGeneralTasks-done,"+JSON.stringify(a.error));
else if(a=a.data,0!=a.length&&void 0!=a[0].timesheetProfile&&void 0!=a[0].timesheetProfile.hourTypes){if(0!=a[0].timesheetProfile.hourTypes.length){var b=0;a=a[0].timesheetProfile.hourTypes;for(var f in a)a.hasOwnProperty(f)&&!0==a[f].isActive&&(b++,TASK_DB.insert(a[f].name,{syncID:a[f].ID,details:{objCode:"GEN",description:null!=a[f].description?"General - "+a[f].description:"'General"}},0))}n();N();sa()}else ka()}),a.fail(function(a,c,m){M({response:a.responseText,type:c,msg:m,status:a.status},
L,"addGeneralTasks-fail"+c+"-"+m+" "+a.responseText+" "+a.status+" "+JSON.stringify(b))}))}function ka(){x.show();var a={url:r()+"HourType/search",type:"get",data:{fields:"ID,name,description",isActive:!0},dataType:"json"};F(a,35E3);var b=jQuery.ajax(a);b.done(function(a){if(void 0!=a.error)a.error["class"]==P[0]?J(function(){ka()}):c(w[0],"addAllGeneralTasks-done,"+JSON.stringify(a.error));else{a=a.data;var b=0,f;for(f in a)a.hasOwnProperty(f)&&("Task Time"!=a[f].name&&"Issue Time"!=a[f].name)&&
(b++,TASK_DB.insert(a[f].name,{syncID:a[f].ID,details:{objCode:"GEN",description:null!=a[f].description?"General - "+a[f].description:"'General"}},0));n();N();sa()}});b.fail(function(b,c,f){M({response:b.responseText,type:c,msg:f,status:b.status},ka,"addAllGeneralTasks-fail"+c+"-"+f+" "+b.responseText+" "+b.status+" "+JSON.stringify(a))})}function M(a,b,d,e){if(401==a.status)J(function(){b()});else if("timeout"==a.type)b();else{if(void 0!=a.response&&""!=a.response){var g;g="message"in a.response?
a.response.message:JSON.stringify(a.response);TASK_CNTRL.displayError("Workfront Error: "+g+"<br>"+(void 0!=e&&""!=e?e:""))}c(w[0],d+","+a.msg+" "+a.type+" "+JSON.stringify(a.response)+" "+e)}}function r(a){void 0==a&&(a="v7.0");return"https://"+g.get("host")+"."+g.get("domain")+"/attask/api/"+a+"/"}function y(a,b){a=void 0==a?"task":a;x.show();var d={url:r()+a+"/search",type:"get",data:{canStart:!0,status:"N",status_Mod:"contains","project:status":"CUR",fields:"parent,priority,project,plannedCompletionDate,permissions",
"assignments:status":"DN","assignments:status_Mod":"ne",$$LIMIT:2E3},dataType:"json"},e=g.get("currentRole");"role"==g.get("view")&&void 0!=e?d.data.roleID=e.ID:d.data["assignments:assignedToID"]=g.get("userID");"task"==a&&(d.data.fields+=",percentComplete");F(d);d=jQuery.ajax(d);d.done(function(d){if(void 0!=d.error)d.error["class"]==P[0]?J(function(){y(a,b)}):c(w[0],"addAllAssignedTasks-"+a+","+JSON.stringify(d.error)),x.hide(),u.hide();else{d=d.data;var e=!0,q=g.get("view");"all"!=q&&"role"!=q&&
(e=!1);if("optask"!=a)y("optask",b),fa(function(){var a=d.length;if(a)for(var b=0;b<a;b++)-1!=d[b].permissions.actions.indexOf("ADD_HOURS")&&-1!=d[b].permissions.actions.indexOf("CHANGE_STATUS")&&TASK_DB.insert(d[b].name,{syncID:d[b].ID,details:d[b]},e&&b==a-1)});else{q=d.length;v=e;if(q)for(var h=0;h<q;h++)-1!=d[h].permissions.actions.indexOf("ADD_HOURS")&&-1!=d[h].permissions.actions.indexOf("CHANGE_STATUS")&&TASK_DB.insert(d[h].name,{syncID:d[h].ID,details:d[h]},e&&h==q-1);else TASK_CNTRL.showAll(d);
b&&b()}}});d.fail(function(a,b,c){M({response:a.responseText,type:b,msg:c},y,"addAllAssignedTasks-fail"+b+"-"+c+" "+a.responseText)})}function ga(a){x.show();var b={url:r("v5.0")+"user/search",type:"get",data:{fields:"role:*,roles:*",ID:g.get("userID")},dataType:"json"};F(b);b=jQuery.ajax(b);b.done(function(b){if(void 0!=b.error)b.error["class"]==P[0]?J(function(){ga(a)}):c(w[0],"addAllRoleTasks,"+JSON.stringify(b.error)),x.hide(),u.hide();else if(b=b.data[0],0==b.length)a&&a(),x.hide(),u.hide();
else{var f=jQuery("#role-filter"),d=function(){y("task",function(){f.css("display","inline-block");x.hide();u.hide()})},e=function(a,b){g.set("currentRole",{name:a,ID:b});f.find("button").html("<strong>Role: </strong><span>"+a+'</span><span class="caret"></span>');d()},h=g.get("currentRole");void 0!=h?e(h.name,h.ID):void 0!=b.role&&e(b.role.name,b.role.ID);if(void 0!=b.roles&&0!=b.roles.length)for(var h=f.find(".dropdown-menu").html("").first(),n=0,k=b.roles.length;n<k;n++)h.append('<li><a href="#" id="'+
b.roles[n].ID+'">'+b.roles[n].name+"</a></li>"),h.find("#"+b.roles[n].ID).click(function(){e(jQuery(this).text(),jQuery(this).attr("id"))});else ba(),x.hide(),u.hide(),jQuery("#button-current").click(),TASK_CNTRL.showWindow('<h3><div style="text-align: center; font-weight: bold;">Roles</div></h3><div class="content"><div><p>No additional roles available.</strong></h3><div><a href="#" class="btn btn-primary cancel" title="Ok">Ok</a><div>')}});b.fail(function(a,b,c){M({response:a.responseText,type:b,
msg:c},ga,"addAllRoleTasks")})}function ba(){var a=jQuery("#role-filter");a.hide();a.find(".dropdown-menu").first().html("")}function pa(a){x.show();var b={url:r()+"team/search",type:"get",data:{fields:"ID","users:ID":g.get("userID")},dataType:"json"};F(b);b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==P[0]?J(function(){pa(a)}):c(w[0],"addAllGroupTasks,"+JSON.stringify(b.error)),x.hide(),u.hide()):(b=b.data,0==b.length?(a?a():jQuery("#form-list").hide(),x.hide(),u.hide(),TASK_CNTRL.showNoTaskWindow()):
fa(function(){for(var c=b.length,f=function(b,f){if(0==--c){var d=I.length;v=!0;if(0==d)TASK_CNTRL.showAll(I);else{for(var e=0;e<d;e++)TASK_DB.insert(I[e].name,{syncID:I[e].ID,details:I[e]},e==d-1);I=[];a&&a()}}},d=0;d<c;d++)qa("task",b[d].ID,f)}))});b.fail(function(a,b,c){M({response:a.responseText,type:b,msg:c},pa,"addAllGroupTasks")})}function qa(a,b,d){a=void 0==a?"task":a;x.show();var e={url:r()+a+"/search?project:status=INF",type:"get",data:{canStart:!0,status:"N",status_Mod:"contains","project:status":"CUR",
fields:"parent,priority,project,plannedCompletionDate",$$LIMIT:1E3,"team:ID":b},dataType:"json"};"task"==a&&(e.data.fields+=",percentComplete");F(e);e=jQuery.ajax(e);e.done(function(e){if(void 0!=e.error)e.error["class"]==P[0]?J(function(){qa(a,b,d)}):c(w[0],"addGroupTasks-"+a+","+JSON.stringify(e.error)),x.hide(),u.hide();else if(e=e.data,0==e.length)d&&d(a,b);else if("optask"!=a){qa("optask",b,d);for(var g=e.length,h=0;h<g;h++)I.push(e[h])}else{g=e.length;for(h=0;h<g;h++)I.push(e[h]);d&&d(a,b)}});
e.fail(function(a,b,c){M({response:a.responseText,type:b,msg:c},qa,"addGroupTasks-fail"+b+"-"+c+" "+a.responseText)})}function ha(){x.show();var a={url:r()+"hour/report",type:"get",data:{"task:canStart":!0,taskID_1_GroupBy:!0,entryDate:"$$TODAY-14d",entryDate_Range:"$$TODAY",entryDate_Mod:"between"},dataType:"json"};F(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==P[0]?J(function(){ha()}):c(w[0],"addRecentTasks,"+JSON.stringify(a.error)),x.hide(),u.hide()):(a=Object.keys(a.data),
0==a.length?(v=!0,fa(function(){TASK_CNTRL.showAll(a)})):fa(function(){v=!0;TASK_CNTRL.showAll(TASK_CNTRL.taskDB.loadSyncIds(a))}))});a.fail(function(a,b,c){M({response:a.responseText,type:b,msg:c},ha,"addRecentTasks")})}function ra(){x.show();var a={url:r()+"work/myWork",type:"get",data:{fields:"parent,priority,project,plannedCompletionDate"},dataType:"json"};F(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==P[0]?J(function(){ra()}):c(w[0],"addCurrentTasks,"+JSON.stringify(a.error)),
x.hide(),u.hide()):(a=a.data,0==a.length?(v=!0,fa(function(){TASK_CNTRL.showAll(a)})):fa(function(){var b=a.length;v=!0;for(var c=0;c<b;c++)TASK_DB.insert(a[c].name,{syncID:a[c].ID,details:a[c]},c==b-1)}))});a.fail(function(a,b,c){M({response:a.responseText,type:b,msg:c},ra,"addCurrentTasks")})}function ja(){x.show();var a={url:r()+"work/workRequests",type:"get",data:{canStart:!0,fields:"parent,priority,project,plannedCompletionDate"},dataType:"json"};F(a);a=jQuery.ajax(a);a.done(function(a){void 0!=
a.error?(a.error["class"]==P[0]?J(function(){ja()}):c(w[0],"addRequestedTasks,"+JSON.stringify(a.error)),x.hide(),u.hide()):(a=a.data,0==a.length?(v=!0,fa(function(){TASK_CNTRL.showAll(a)})):fa(function(){var b=a.length;v=!0;for(var c=0;c<b;c++)TASK_DB.insert(a[c].name,{syncID:a[c].ID,details:a[c]},c==b-1)}))});a.fail(function(a,b,c){M({response:a.responseText,type:b,msg:c},ja,"addRequestedTasks")})}function sa(){var a={url:r()+"user/search",data:{"hourTypes:isActive":!0,fields:"hourTypes:ID,hourTypes:name,hourTypes:description,hourTypes:countAsRevenue",
ID:g.get("userID")},type:"get",dataType:"json"};F(a);k=!1;a=jQuery.ajax(a);a.done(function(a){if(void 0!=a.error)a.error["class"]==P[0]?J(function(){}):c(w[0],"getHourTypes,"+JSON.stringify(a.error)),x.hide(),u.hide();else if(a=a.data,void 0!=a&&0!=a.length&&0!=a[0].hourTypes.length){k=!0;var b=jQuery("#hourTypeSelector");b.text("");b.append(jQuery("<option />").val(null).text("Task Time"));jQuery.each(a[0].hourTypes,function(){b.append($("<option />").val(this.ID).text(this.name))})}});a.fail(function(a,
b,c){401==a.status?J(function(){}):"timeout"==b&&sa()})}function la(a,b){TASK_CNTRL.showWindow(null,"#hourTypeWindow");jQuery("#done_hourType").unbind("click").bind("click",function(c){c.preventDefault();a.hourTypeID=jQuery("#hourTypeSelector").find(":selected").val();b(a);TASK_CNTRL.hideWindow("#hourTypeWindow")})}function oa(a){var b=g.get("todaySched");null!=b?a(b):(b={url:r("v4.0")+"user/search?ID=$$USER.ID&fields=schedule:*,schedule:nonWorkDays:*",type:"get",data:{},dataType:"json"},F(b),b=jQuery.ajax(b),
b.done(function(b){if(void 0!=b.error)b.error["class"]==P[0]?J(function(){}):c(w[0],"getSchedule,"+JSON.stringify(b.error)),x.hide(),u.hide();else if(b=b.data[0].schedule,0!=b.length){var d=new Date,f=b["sunday monday tuesday wednesday thursday friday saturday".split(" ")[d.getDay()]],e;if(!0==b.hasNonWorkDays){for(var h=0;h<b.nonWorkDays.length;h++)if(b.nonWorkDays[h].nonWorkDate==d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate()&&(void 0!=e&&null!=b.nonWorkDays[h].userID||void 0==e))e=b.nonWorkDays[h].scheduleDay;
void 0!=e&&(f=e)}void 0!=f&&0!=f.length&&(f={start:f[0],stop:f[1]},g.set("todaySched",f));a&&a(f)}}),b.fail(function(b,c,d){401==b.status?J(function(){}):"timeout"==c&&oa(a)}))}function N(){var a=new Date,a={url:r()+"hour/report?hours_AggFunc=sum",type:"get",data:{entryDate:a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate(),ownerID:g.get("userID")},dataType:"json"};F(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==P[0]?J(function(){}):c(w[0],"getTodaysTotalHours,"+JSON.stringify(a.error)),
x.hide(),u.hide()):(a=a.data,jQuery("#totalHours").html("Today's Hours: "+(null==a.sum_hours?"0":a.sum_hours.toFixed(2))))});a.fail(function(a,b,c){401==a.status?J(function(){}):"timeout"==b&&N()})}function s(a){x.show();var b={assignedToID:g.get("userID")};"OPTASK"==a.details.objCode?b.opTaskID=a.syncID:b.taskID=a.syncID;b={url:r()+"assignment/search",type:"get",data:b,dataType:"json"};F(b);b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==P[0]?J(function(){s(a)}):c(w[0],"getTaskAssignment,"+
a.syncID+","+JSON.stringify(b.error)),x.hide(),u.hide()):(b=b.data[0],a.running?(a.done=1,TASK_CNTRL.stopTask(a),TASK_CNTRL.toggleRunText()):ea(b,a))});b.fail(function(b,c,d){M({response:b.responseText,type:c,msg:d},function(){s(a)},"getTaskAssignment,"+a.syncID)})}function ea(a,b){x.show();var d={url:r()+"assignment/"+a.ID,data:{status:"DN"},type:"PUT",dataType:"json"};z&&(d.data={method:"put"},F(d));d=jQuery.ajax(d);d.done(function(d){void 0!=d.error?(d.error["class"]==P[0]?J(function(){ea(a,b)}):
c(w[0],"setAssignmentDone,"+a.ID+","+JSON.stringify(d.error)),x.hide(),u.hide()):(TASK_DB.remove(b.ID),x.hide(),u.hide(),c(w[2],da(b)+",assignment done"),D(b))});d.fail(function(c,d,e){M({response:c.responseText,type:d,msg:e},function(){ea(a,b)},"setAssignmentDone,"+a.ID+", "+c.responseText)})}function D(a){x.show();var b={url:r()+"assignment/count",data:{status:"DN",status_Mod:"ne"},type:"GET",dataType:"json"};"OPTASK"==a.details.objCode?b.data.opTaskID=a.syncID:b.data.taskID=a.syncID;F(b);b=jQuery.ajax(b);
b.done(function(b){void 0!=b.error?(b.error["class"]==P[0]?J(function(){D(a)}):c(w[0],"getTaskDoneAssignmentCount,"+taskID+","+JSON.stringify(b.error)),x.hide(),u.hide()):(b=b.data,x.hide(),u.hide(),0==b.count&&H(a))});b.fail(function(b,c,d){M({response:b.responseText,type:c,msg:d},function(){D(a)},"getTaskDoneAssignmentCount,"+a.syncID)})}function H(a){var b=a.syncID;x.show();var d="OPTASK"==a.details.objCode?"CLS":"CPL",d={url:r()+a.details.objCode.toLowerCase()+"/"+b,data:{status:d},type:"PUT",
dataType:"json"};z&&(d.data={method:"put"},F(d));d=jQuery.ajax(d);d.done(function(d){void 0!=d.error?(d.error["class"]==P[0]?J(function(){H(a)}):M({response:d.error,type:null,msg:null},function(){H(a)},"setTaskDone,"+b),x.hide(),u.hide()):(x.hide(),u.hide(),c(w[2],da(a)+",task done"))});d.fail(function(c,d,e){M({response:c.responseText,type:d,msg:e},function(){H(a)},"setTaskDone,"+b+", "+c.responseText)})}function G(a){x.show();var b={url:r()+a.details.objCode.toLowerCase()+"/"+a.syncID,data:{status:"INP"},
type:"PUT",dataType:"json"};z&&(b.data={method:"put"},F(b));b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==P[0]?J(function(){G(a)}):M({response:b.error,type:null,msg:null},function(){G(a)},"setTaskInProgress,"+a.syncID),x.hide(),u.hide()):(x.hide(),u.hide(),!0==g.get("logout_on_select")&&S())});b.fail(function(b,c,d){M({response:b.responseText,type:c,msg:d},function(){G(a)},"setTaskInProgress-fail,"+a.syncID+", "+b.responseText)})}function aa(a,b){x.show();var c={url:r()+a.details.objCode.toLowerCase()+
"/"+a.syncID,data:{updates:"{ percentComplete: "+b+"}"},type:"PUT",dataType:"json"};z&&(c.data={method:"put"},F(c));c=jQuery.ajax(c);c.done(function(c){void 0!=c.error?c.error["class"]==P[0]?J(function(){aa(a,b)}):M({response:c.error,type:null,msg:null},function(){aa(a,b)},"setTaskPercent,"+a.syncID):(a.details.percentComplete=b,TASK_DB.updateDetails(a.ID,a.details));x.hide();u.hide()});c.fail(function(c,d,e){M({response:c.responseText,type:d,msg:e},function(){aa(a,b)},"setTaskPercent-fail,"+a.syncID+
", "+c.responseText)})}function C(a,b){var d,e={ownerID:g.get("userID")};void 0==b||-1!=b.permissions.actions.indexOf("ADD_HOURS")&&-1!=b.permissions.actions.indexOf("CHANGE_STATUS")?(d=0,e.method="post"):(d=b.hours,e.method="put",e.ID=b.ID);"GEN"==a.details.objCode?(e.hourTypeID=a.syncID,e.ID=null,e.projectID=null,e.taskID=null,e.opTaskID=null):("OPTASK"==a.details.objCode?e.opTaskID=a.syncID:e.taskID=a.syncID,void 0!=a.hourTypeID&&""!=a.hourTypeID&&(e.hourTypeID=a.hourTypeID));isNaN(d)&&(d=0);e.entryDate=
a.dateStr;var h=Number((a.duration/3600).toFixed(2));g.get("nearestHour")&&(h=Math.round(h));e.hours=parseFloat((h+parseFloat((""+d).split(".").join("."))+" ").split(".").join("."));e.sessionID=g.get("sessionID");e.ownerID=g.get("userID");c(w[1],"setHourAttask, oldhr: "+d+" method: "+e.method+" start: "+a.dateStr+" task: "+JSON.stringify(a)+" sid: "+g.get("sessionID")+" time: "+(new Date).toTimeString());var n=function(){x.show();var b={url:r("v5.0")+"hour/",type:"get",data:e,dataType:"json"};F(b);
b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==P[0]?J(function(){n()}):(M({response:b.error,type:null,msg:null},n,"setHourAttask,"+a.syncID+" "+a.name+" url: "+r()+" "+JSON.stringify(e)+" "+da(a)+","+a.duration,'Time was not tracked, please click on "View" for task: '+a.name+" to record time manually."),E(a)),x.hide(),u.hide()):(N(),void 0!=e.taskID||void 0!=e.opTaskID?G(a):!0==g.get("logout_on_select")&&S(),x.hide(),u.hide(),c(w[2],da(a)),a.done&&s(a))});b.fail(function(b,
c,d){M({response:b.responseText,type:c,msg:d},n,"setHourAttask-fail,"+a.syncID+" "+a.name+" url: "+r()+" "+JSON.stringify(e)+" "+da(a)+","+a.duration+", "+b.responseText+", "+d,b.responseText+'<br>Time was not tracked, please click on "View" for task: '+a.name+" to record time manually.");E(a)})};n()}function E(a,b){var d={};d.entryDate=a.dateStr;d.sessionID=g.get("sessionID");d.fields="permissions,ID,hours";d.ownerID=g.get("userID");"GEN"==a.details.objCode?(d.hourTypeID=a.syncID,d.projectID=null,
d.taskID=null,d.opTaskID=null):("OPTASK"==a.details.objCode?d.opTaskID=a.syncID:d.taskID=a.syncID,void 0!=a.hourTypeID&&""!=a.hourTypeID&&(d.hourTypeID=a.hourTypeID));d={url:r()+"hour/search",type:"get",data:d,dataType:"json"};F(d);d=jQuery.ajax(d);d.done(function(d){if(void 0!=d.error)d.error["class"]==P[0]?J(function(){E(a,b)}):c(w[0],"getHour,"+a.syncID+","+JSON.stringify(d.error)),x.hide(),u.hide();else if(c(w[1],"getHour "+d.data.length+" "+JSON.stringify(d.data)),b){for(var e=d.data.length,
g=0;g<e;g++)if(-1!=d.data[g].permissions.actions.indexOf("ADD_HOURS")&&-1!=d.data[g].permissions.actions.indexOf("CHANGE_STATUS")){b(a,d.data[g]);return}b(a,d.data[0])}});d.fail(function(a,b,c){JSON.stringify(c)})}var P=["com.attask.common.AuthenticationException"],w=["error","debug","informational"],g,z=!(window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows")),A=-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")&&z,T=-1!==document.URL.indexOf("dashboard.directory"),
k=!1,ia=!1,I=[];g=!z||A?new Store("Attask"):{settings:[],set:function(a,b){switch(a){case "domain":case "host":case "userID":case "sessionID":case "username":case "date":case "view":this.setCookie(a,b,9999999999)}this.settings[a]=b},get:function(a){switch(a){case "domain":case "host":case "userID":case "sessionID":case "username":case "date":case "view":var b=void 0===this.settings[a]?this.getCookie(a):this.settings[a];this.settings[a]=b;return"undefined"==b||void 0==b?void 0:b;default:return!this.settings.hasOwnProperty(a)||
"undefined"==this.settings[a]||void 0==this.settings[a]?void 0:this.settings[a]}},removeAll:function(){var a=new Date,b;for(b in this.settings)this.settings.hasOwnProperty(b)&&(document.cookie=b+"="+this.settings[b]+";expires="+a.toGMTString()+";;");this.settings=[]},setCookie:function(a,b,c){var d=new Date;d.setHours(0);d.setMinutes(0);d.setSeconds(0);d.setDate(d.getDate()+c);b=encodeURI(b)+(null==c?"":"; expires="+d.toUTCString());document.cookie=a+"="+b},getCookie:function(a){var b,c,d,e=document.cookie.split(";");
for(b=0;b<e.length;b++)if(c=e[b].substr(0,e[b].indexOf("=")),d=e[b].substr(e[b].indexOf("=")+1),c=c.replace(/^\s+|\s+$/g,""),c==a)return decodeURI(d);return"undefined"}};var ta;OB.init.add(function(){void 0==g.get("qr")&&g.set("qr","true"==jQuery.urlParam("qr")||!1!=jQuery.urlParam("code"));Y();na();b();var a=jQuery.urlParam("s"),c=jQuery.urlParam("d");0!=c&&0!=a&&(g.set("sessionID",a),a=c.split("."),g.set("host",a[0]),a.shift(),g.set("domain",a.join(".")),void 0==g.get("ent")&&(g.set("userID",jQuery.urlParam("u")),
g.set("ent",g.get("sessionID")&&g.get("userID"))));h();!0==g.get("qr")&&void 0==g.get("sessionID")&&(!1!=jQuery.urlParam("code")?(document.getElementById("button-appscan").style.display="block",qrRead(jQuery.urlParam("code"),g)):qrLoad(g))});OB.onLoad.add(function(){document.addEventListener("resume",function(){jQuery("#loading").show();h()||b()},!1);document.addEventListener("pause",function(){jQuery("#form-list").html("")},!1);document.addEventListener("menubutton",function(){TASK_CNTRL.showWindow('<h3><div style="text-align: center; font-weight: bold;">Welcome</div></h3><div class="content"><p>If you have any questions please visit <a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank" class="btn" >store.atappstore.com</a></p><a href="#" class="btn btn-primary cancel" title="Done">Done</a></div>')},
!1);document.addEventListener("offline",function(a){ia=!0});document.addEventListener("online",function(a){a=g.get("offlineTasks");JSON.stringify(a);g.set("offlineTasks",[]);ia=!1})});OB.stop.add(function(a,b){x.show();var c,d;c=new Date(a.start);d=new Date;if(g.get("minuteBufferSnapToSched")){var e=g.get("todaySched"),h=g.get("minuteBuffer"),n=d.toLocaleDateString("en-US"),l=Date.parse(n+e.start),e=Date.parse(n+e.stop),n=new Date(l);c<l&&c>n.setMinutes(n.getMinutes()-h)&&(c=new Date(l));n=new Date(e);
d>e&&d<n.setMinutes(n.getMinutes()+h)&&(d=new Date(e));if(c>=d){x.hide();return}b=Math.floor((d.getTime()-c.getTime())/1E3)}0==b?x.hide():k?la(a,function(a){ca(a,b)}):ca(a,b)});OB.update.add(function(a,b){u.show();ca(a,b)});OB.preStart.add(function(a){a.running?TASK_CNTRL.toggleTimer(a):function(){TASK_DB.loadAll(function(b){var c,d,e=!1,h=b.length;for(c=0;c<h;c++)if(d=b[c],null!=d&&d.running&&a.ID!=d.ID){TASK_CNTRL.toggleTimer(d);e=!0;break}TASK_CNTRL.toggleTimer(a);!e&&!0==g.get("logout_on_select")&&
S()})}()});OB.postAllItemRender.add(function(){jQuery(".remove").css("display","none");jQuery(".update").css("display","none");jQuery(".reset").css("display","none");g.get("is_auth")?jQuery("#storelink").text("AtAppStore"):(jQuery("#sort-date").remove(),jQuery(".timer").remove(),jQuery(".done").remove(),jQuery(".percent").remove(),jQuery(".date").removeClass("date").addClass("date-tall").html('<a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank">Trial Expired</a>'),
jQuery("#storelink").text("Trial Expired - AtAppStore"));if(v){var a=jQuery("#form-list"),b=g.get("vpos");void 0!=b&&a.scrollTop(b);"team"==g.get("view")&&!0==g.get("hide_team_done")&&jQuery(".done").remove();ia?g.get("allowOffline")&&(jQuery(".done").remove(),jQuery(".percent").remove(),jQuery(".view").remove(),jQuery("#bar").hide()):jQuery("#bar").show();b=g.get("sort");void 0==b&&(b="date");jQuery("#sort-"+b).click();jQuery("#search-bar").is(":visible")&&jQuery("#search").click();jQuery("#loading").hide();
a.show();a=jQuery("#holder")[0];a.style.display="none";a.style.display="block";x.hide();v=!1}});OB.postItemRender.add(function(a){if(0==jQuery("#item"+a.ID+" #buttons .view").length){var b=jQuery("#item"+a.ID+" #buttons"),c=["",{label:"Low",css:"default"},{label:"Normal",css:"success"},{label:"High",css:"warning"},{label:"Urgent",css:"danger"}];"GEN"!=a.details.objCode&&(void 0!=a.details.priority&&0!=a.details.priority)&&(c=c[a.details.priority],b.append('<span class="task priority '+c.css+'" title="'+
c.label+'" data-priority="'+a.details.priority+'">'+c.label[0]+"</span> "));var d;"GEN"==a.details.objCode?(d="General",jQuery("#item"+a.ID).css({background:"aliceblue"})):"OPTASK"==a.details.objCode?(d="Issue",b.append('<span class="issue" title="Issue">I</span> ')):"TASK"==a.details.objCode&&(d="Task",b.append('<span class="task" title="Task">T</span> '));"General"!=d&&(b.append('<a href="https://'+g.get("host")+"."+g.get("domain")+"/"+d.toLowerCase()+"/view?ID="+a.syncID+'" target="_blank" class="btn btn-mini view" rel="'+
a.ID+'" title="View '+d+'">View</a> '),b.append('<a href="#" class="btn btn-mini done" rel="'+a.ID+'" title="Done '+d+'">Done</a> '));"Task"==d&&void 0!=a.details.percentComplete&&b.append('<a href="#" class="btn btn-mini percent" rel="'+a.ID+'" title="Percent Completed">'+a.details.percentComplete+"%</a> ");b="#D2E0FF";c='<span class="date" style="background-color: #EEE;"></span>';if("General"!=d&&void 0!=a.details.plannedCompletionDate){var c=a.details.plannedCompletionDate.split("T")[0],c=c.split("-"),
c=new Date(c[0],Number(c[1])-1,c[2]),e=new Date;e.setHours(0);e.setMinutes(0);e.setSeconds(0);e=Math.round((c-e)/1E3/60/60/24);0>e?b="#FFCDCD":1>=e&&(b="#FFD7AB");var h;h=0<e?"days due: "+e:"days late: "+Math.abs(e);c='<div class="date" style="background-color: '+b+';"><div class="days" data-days="'+e+'">'+h+"</div><div>"+X(c.getMonth())+" "+c.getDate()+", "+c.getFullYear()+"</div></div>"}b="";null!=a.details.parent&&(b="<br><br>Parent Task: <br>"+a.details.parent.name);jQuery("#item"+a.ID+" .name").attr("title",
d+": <br>"+a.name+b);"General"!=d?(d=a.details.project.name,jQuery("#item"+a.ID+" .details").html(d).attr("title","Project: <br>"+d).attr("data-priority",a.details.priority),jQuery("#item"+a.ID+" .c6").after(c)):jQuery("#item"+a.ID+" .details").html("~"+a.details.description).attr("title",a.details.description)}});OB.remove.add(function(a){jQuery("#item"+a).remove()});OB.reset.add(function(a,b){OB.update.dispatch(b,-b.time);jQuery("#item"+a+" .timer").text(TASK_CNTRL.hms(0))});var v=!1,u,x,B=[]}();function taskController(e){var a,d=window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows"),c=-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")&&!d;jQuery.urlParam=function(a){a=RegExp("[\\?&]"+a+"=([^&#]*)").exec(window.location.href);return!a?0:a[1]||0};OB.start.add(function(a){startNotify(a)});OB.stop.add(function(a){stopNotify(a)});OB.onLoad.add(function(){});OB.postAllItemRender.add(function(){c&&(jQuery("#form-list").height(0),a=124);if(!d||"full"==
getQueryString("view")){var b=function(){var b=jQuery("#form-list"),c;c=b.height();c+=window.innerHeight-a;0!=window.innerHeight-a&&b.height(c);a=window.innerHeight};jQuery(window).unbind("resize");jQuery(window).bind("resize",b);b()}b={style:{tip:{corner:!0,width:5,height:5},def:!1,classes:"qtip-info"},position:{adjust:{method:"flip flip"},at:"bottom left",my:"top left",viewport:jQuery(window)},show:{},hide:{delay:0}};jQuery("span[title]").qtip(b);c||jQuery("a[title]").qtip(b);b.content="time < 30 seconds<br> time was not tracked";
b.show.event=!1;b.hide.delay=c?0:2E3;var e=jQuery(".timer");e.qtip(b);c||e.mouseover(function(){var a=jQuery(this).find(".time").hide(),b=jQuery(this).find(".timer-info").show();setTimeout(function(){a.show();b.hide()},3E3)}).mouseout(function(){jQuery(this).find(".time").show();jQuery(this).find(".timer-info").hide()});c&&(jQuery(".item").css("padding-right","5px"),jQuery(".task").css("padding-right","5px").css("padding-left","5px"),jQuery(".issue").css("padding-right","5px").css("padding-left",
"5px"),jQuery("body").css("font-size","12px"));jQuery("#searchfor").domsearch("#form-list",{unit:"div.item:visible",criteria:["span[oldtitle]"]})});return{intervals:[],taskDB:e,init:function(){this.bind();this.toggleRunText();var b=jQuery("#form-list");!d||"full"==getQueryString("view")?(b.css("max-height","100%"),b.css("height","439px")):b.css("max-height","439px");!d&&(window.webkitNotifications&&0!=window.webkitNotifications.checkPermission())&&window.open("core/js/permission.html","Permission",
"height=540,width=447");a=567},bind:function(){c&&jQuery("a[target='_blank']").live("click",function(a){a.preventDefault();window.open(jQuery(this).attr("href"),"_blank","location=yes");return!1});jQuery("#cover").hide();jQuery(".cancel").live("click",function(a){a.preventDefault();jQuery("#"+jQuery(this).attr("rel")).hide().hide().find("input:text").val("");jQuery("#form-list").show();jQuery("#top-bar").show();jQuery("#bar").show()});jQuery("#search").live("click",function(a){a.preventDefault();
jQuery("#sort-bar").toggle();jQuery("#search-bar").toggle();jQuery("#searchfor").focus().val("").domsearchClear()});jQuery("#popout").live("click",function(a){a.preventDefault();d&&window.chrome.windows.create({url:"index.html?view=full",type:"popup",width:393,height:600})});jQuery("#create").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#form-create").slideDown().find("input[name='task-name']").focus()});var a=this;jQuery("#button-create").live("click",function(){a.taskDB.insert(jQuery("#form-create :input[name='task-name']").val());
jQuery("#form-create").hide().find("input:text").val("")});jQuery("#task-name").keydown(function(c){13==c.keyCode&&(a.taskDB.insert(jQuery("#form-create :input[name='task-name']").val()),jQuery("#form-create").hide().find("input:text").val(""))});jQuery(".remove").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#button-remove").attr("rel",jQuery(this).attr("rel"));jQuery("#remove-confirm").html("Are you sure? You want to <strong>delete "+jQuery(this).attr("title")+"</strong>?");
jQuery("#form-remove").show()});jQuery("#button-remove").live("click",function(){jQuery("#form-remove").hide();a.taskDB.remove(jQuery(this).attr("rel"))});jQuery("#remove-all").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#form-remove-all").slideDown()});jQuery("#button-remove-all").live("click",function(){jQuery("#form-remove-all").hide();a.taskDB.removeall()});jQuery(".update").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#top-bar").hide();
jQuery("#bar").hide();a=jQuery(this).attr("rel");this.taskDB.updateValidate(a,this.update)});jQuery("#button-update").live("click",function(){jQuery("#form-update").hide();jQuery("#top-bar").show();jQuery("#bar").show();var c=jQuery("#form-update :input[name='task-id']").val(),d=jQuery("#form-update :input[name='task-name']").val(),e=jQuery("#form-update :input[name='task-time']").val();a.taskDB.update(c,d,e)});jQuery(".cancel").live("click",function(c){c.preventDefault();a.hideWindow()});jQuery(".reset").live("click",
function(c){c.preventDefault();c=jQuery(this).attr("rel");a.taskDB.reset(c)});var e=function(c){c.preventDefault();a.taskDB.updateValidate(jQuery(this).attr("rel"),function(a){OB.preStart.dispatch(a)});return!1};jQuery(".timer").live("click",e);jQuery("#running").click(e);jQuery("#holder").show()},displayError:function(a){this.showWindow('<h3><div style="text-align: center; font-weight: bold;">Error</div></h3><div class="content"><p>'+a+'</p><a href="#" id="cancel_confirm" class="btn btn-primary" title="Done">Done</a></div>')},
showWindow:function(a,d){d=void 0==d?"#window":d;null!=a&&jQuery(d).html(a);c?(jQuery("#cover").css("height","100%").css("opacity","0.8").show(),jQuery(d).animate({top:60+window.pageYOffset+"px"},{easing:"easeInCubic",duration:400,complete:function(){}})):jQuery("#cover").css("height","100%").show().animate({opacity:"0.8"},400,function(){jQuery(d).animate({top:60+window.pageYOffset+"px"},{easing:"easeInCubic",duration:400,complete:function(){}})})},hideWindow:function(a){a=void 0==a?"#window":a;c?
jQuery(a).animate({top:"-700px"},{easing:"easeOutCubic",duration:400,complete:function(){jQuery("#cover").hide()}}):jQuery(a).animate({top:"-700px"},{easing:"easeOutCubic",duration:400,complete:function(){jQuery("#cover").animate({opacity:"0"},{duration:400,complete:function(){jQuery("#cover").hide()}})}})},update:function(a){jQuery("#form-update :input[name='task-id']").val(a.ID);jQuery("#form-update :input[name='task-name']").val(a.name);jQuery("#form-update :input[name='task-time']").val(this.hms(a.time));
jQuery("#form-update").slideDown()},truncateString:function(a){return a},showTask:function(a){var c,d="";c=jQuery("#item"+a.ID);0!=c.length?c.show():(d+='<div class="item'+(a.running?" running":"")+'" id="item'+a.ID+'" rel="'+a.ID+'">',d=d+'<div class="c3">'+('<span class="name c1" title="Task: <br>'+a.name+'" ><strong>'+this.truncateString(a.name)+"</strong></span><br>"),d+='<span class="details" title="'+a.details+'" >'+this.truncateString(a.details)+"</span><br>",d+='<span id="buttons"><a href="#" class="btn btn-mini update" rel="'+
a.ID+'" title="Edit: '+a.name+'">Edit</a> ',d+='<a href="#" class="btn btn-mini reset" rel="'+a.ID+'" title="Reset: '+a.name+'">Reset</a> ',d+='<a href="#" class="btn btn-mini remove" rel="'+a.ID+'" title="Delete: '+a.name+'">Delete</a></span>',d+="</div>",d+='<div class="c8"><div class="c6">',a.running?(c=new Date(a.start),c=Number(a.time)+Math.floor(((new Date).getTime()-c.getTime())/1E3),d+='<a href="#" class="btn timer btn-primary" rel="'+a.ID+'"><span class="time">'+this.hms(c)+"</span>"):d+=
'<a href="#" class="btn timer" rel="'+a.ID+'"><span class="time">'+this.hms(a.time)+"</span>",d+='<span class="timer-info" style="display: none;">'+(a.running?"Stop":"Start")+"</span></a>",d+="</div>",d+="</div></div>",a.running&&(this.startTask(a),this.toggleRunText()),jQuery("#form-list").append(d),OB.postItemRender.dispatch(a))},showAll:function(a){var c,d=a.length;if(0!=d)for(c=0;c<d;c++)this.showTask(a[c]);0==jQuery(".item").length&&this.showNoTaskWindow();OB.postAllItemRender.dispatch()},showNoTaskWindow:function(){this.showWindow('<h3><div style="text-align: center; font-weight: bold;">No Tasks</div></h3><div class="content"><p>Please assign a task to yourself.</p><a href="#" id="cancel_confirm" class="btn btn-primary cancel" title="Done">Done</a></div>')},
toggleTimer:function(a){jQuery("#item"+a.ID+" .timer").toggleClass("btn-primary");a.running?this.stopTask(a):this.startTask(a);this.toggleRunText()},startTask:function(a){var c=this;window.clearInterval(c.intervals[a.ID]);var d=new Date;a.running?d=new Date(a.start):this.taskDB.start(a.ID,d);jQuery("#item"+a.ID+" .timer .timer-info").text("Stop");c.intervals[a.ID]=window.setInterval(function(){var e=Number(a.time)+Math.floor(((new Date).getTime()-d.getTime())/1E3);jQuery("#item"+a.ID+" .timer .time").text(c.hms(e))},
500)},stopTask:function(a){window.clearInterval(this.intervals[a.ID]);var c,d=Number(a.time);c=new Date(a.start);c=Math.floor(((new Date).getTime()-c.getTime())/1E3);30>c?(jQuery("#item"+a.ID+" .timer").qtip("show"),c=0):60>c&&29<c&&(c=60);d+=c;this.taskDB.stop(a.ID,d,c,a.done);jQuery("#item"+a.ID+" .timer .time").text(this.hms(d));jQuery("#item"+a.ID+" .timer .timer-info").text("Start")},toggleRunText:function(){this.taskDB.running(function(a){d?window.chrome.browserAction.setBadgeText({text:"RUN"}):
document.title="Stopwatch - Running: "+a.name;jQuery("#running").text("Running: "+a.name).attr("rel",a.ID).show();jQuery("#storelink").hide()},function(a){0==a&&(d?window.chrome.browserAction.setBadgeText({text:""}):document.title="Stopwatch",jQuery("#running").hide(),jQuery("#storelink").show())})},hms:function(a){a=[0,0,a];var c;for(c=2;0<c;c--)a[c-1]=Math.floor(a[c]/60),a[c]%=60,10>a[c]&&(a[c]="0"+a[c]);return a.join(":")},sec:function(a){a=String(a).split(":");return Number(parseFloat(3600*a[0])+
60*parseFloat(a[1])+parseFloat(a[2]))}}}var QUERY_LOOKUP=null;function getQueryString(e){if(null==QUERY_LOOKUP){var a=location.search.substring(1),d=/([^&=]+)=([^&]*)/g,c;for(QUERY_LOOKUP={};c=d.exec(a);)QUERY_LOOKUP[decodeURIComponent(c[1])]=decodeURIComponent(c[2])}return"foo"in QUERY_LOOKUP?QUERY_LOOKUP[e]:null};function taskDB(){return{dm:[],lastId:0,sql:function(e,a,d,c,b,h){},init:function(){this.createDB();return this},onError:function(e){},createDB:function(){this.dm=[];this.lastId=0},dropTaskTable:function(){this.createDB()},start:function(e,a){this.dm[e].running=1;this.dm[e].start=a;OB.start.dispatch(this.dm[e])},stop:function(e,a,d,c){this.dm[e].running=0;this.dm[e].done=c;this.dm[e].time=Number(a);OB.stop.dispatch(this.dm[e],Number(d))},running:function(e,a){for(var d in this.dm)if(null!=this.dm[d]&&
this.dm[d].running){e(this.dm[d]);return}a()},insert:function(e,a,d){var c="null",b="";void 0!=a&&(void 0!=a.syncID&&(c=a.syncID),void 0!=a.details&&(b=a.details));if("null"!=c){a=!1;for(var h in this.dm)if(null!=this.dm[h]&&this.dm[h].syncID==c){a=!0;break}a||(h=this.nextID(),this.dm[h]={ID:h,syncID:c,name:e,details:b,time:0,start:new Date,running:0,done:0},OB.insert.dispatch(e,{syncID:c,details:b}));TASK_CNTRL.showTask(this.dm[h]);d&&OB.postAllItemRender.dispatch()}},nextID:function(){return this.lastId++},
updateValidate:function(e,a){null!=this.dm[e]&&a(this.dm[e])},update:function(e,a,d){d=TASK_CNTRL.sec(d);var c;null!=this.dm[e]&&(this.dm[e].name=a,c=this.dm[e].time,this.dm[e].time=d);OB.update.dispatch(this.dm[e],d-c)},updateDetails:function(e,a){null!=this.dm[e]&&(this.dm[e].details=a)},remove:function(e){this.dm[e]=null;window.clearInterval(TASK_CNTRL.intervals[e]);OB.remove.dispatch(e)},removeall:function(){this.createDB();for(var e in TASK_CNTRL.intervals)window.clearInterval(TASK_CNTRL.intervals[e]);
OB.removeall.dispatch()},reset:function(e){null!=this.dm[e]&&(OB.reset.dispatch(e,this.dm[e]),this.dm[e].time=0)},loadAll:function(e){e(this.dm)}}.init()};function taskDBls(){return{ls:null,ps:null,userId:null,sql:function(e,a,d,c,b,h){},init:function(){this.ps=new Store("AttaskPersistModel");this.ls=new Store("AttaskModel");null==this.ls.get("list")&&this.createDB();return this},onError:function(e){},createDB:function(){this.ls.set("lastId",0);this.ls.set("list",[])},dropTaskTable:function(){this.ls.removeAll()},userRunningTasks:function(e){return p.ps.get(e+""+p.ps.get(e))},start:function(e,a){var d=this.ls.get(e);null!=d&&void 0!=d&&(d.running=1,
d.start=a,this.ls.set(e,d),null!=this.userId&&(this.ps.set(this.userId+""+d.syncID,d),this.ps.set(this.userId,d.syncID)),OB.start.dispatch(d))},stop:function(e,a,d,c){var b=this.ls.get(e);null!=b&&void 0!=b&&(b.running=0,b.done=c,b.time=Number(a),this.ls.set(e,b),null!=this.userId&&(this.ps.remove(this.userId+""+b.syncID),this.ps.remove(this.userId)),OB.stop.dispatch(b,Number(d)))},running:function(e,a){var d=this.ls.get("list"),c,b=0,h;for(h in d)d.hasOwnProperty(h)&&(c=this.ls.get(h),null!=c&&(void 0!=
c&&c.running)&&(e(c),b++));a(b)},getAllRunning:function(){return this.ps.toObject()},insert:function(e,a,d){var c=this,b="null",h="";void 0!=a&&(void 0!=a.syncID&&(b=a.syncID),void 0!=a.details&&(h=a.details));a=function(a,b,d,e){var h=c.nextID(),l={ID:h,syncID:a,name:b,details:d,time:0,start:new Date,running:0};if(null!=c.userId){var n=c.ps.get(c.userId+""+a);null!=n&&n.running&&(l=n)}c.ls.set(h,l);n=c.ls.get("list");n[h]=a;c.ls.set("list",n);OB.insert.dispatch(b,{syncID:a,details:d});TASK_CNTRL.showTask(l);
e&&OB.postAllItemRender.dispatch()};if("null"!=b){var n=c.ls.get("list"),ma=!1,Y;for(Y in n)if(n.hasOwnProperty(Y)&&null!=n[Y]&&n[Y]==b){ma=!0;break}ma?(TASK_CNTRL.showTask(c.ls.get(Y)),d&&OB.postAllItemRender.dispatch()):a(b,e,h,d)}else a(b,e,h,d)},nextID:function(){var e=this.ls.get("lastId");e++;this.ls.set("lastId",e);return e},updateValidate:function(e,a){var d=this.ls.get(e);null!=d&&void 0!=d&&a(d)},update:function(e,a,d){d=TASK_CNTRL.sec(d);e=this.ls.get(e);null!=e&&void 0!=e&&(e.name=a,a=
e.time,e.time=d,OB.update.dispatch(e,d-a))},updateDetails:function(e,a){var d=this.ls.get(e);null!=d&&void 0!=d&&(d.details=a)},remove:function(e){var a=this.ls.get("list");a[e]=null;this.ls.set("list",a);this.ls.remove(e);window.clearInterval(TASK_CNTRL.intervals[e]);OB.remove.dispatch(e)},removeall:function(){this.createDB();for(var e=TASK_CNTRL.intervals.length,a=0;a<e;a++)window.clearInterval(TASK_CNTRL.intervals[a]);OB.removeall.dispatch()},reset:function(e){var a=this.ls.get(e);null!=a&&void 0!=
a&&(OB.reset.dispatch(e,a),a.time=0,this.ls.set(e,a))},loadAll:function(e){var a=this.ls.get("list"),d=[],c,b;for(b in a)a.hasOwnProperty(b)&&(c=this.ls.get(b),null!=c&&void 0!=c&&d.push(c));e(d)},loadSyncIds:function(e){for(var a=this.ls.get("list"),d=[],c,b=e.length,h=0;h<b;h++)c=a.indexOf(e[h]),-1!=c&&(c=this.ls.get(c),null!=c&&void 0!=c&&d.push(c));return d}}.init()};var TASK_DB;TASK_DB=window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows")||-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")?taskDBls():lscheck()?taskDBls():taskDB();var TASK_CNTRL=taskController(TASK_DB);jQuery(function(){TASK_CNTRL.init();OB.init.dispatch()});function onLoad(){OB.onLoad.dispatch()}function lscheck(){try{return localStorage.setItem("stopwatch","stopwatch"),localStorage.removeItem("stopwatch"),!0}catch(e){return!1}};var interval,notifyWorkIntervalTime=30;function startNotify(e){interval=setInterval(function(){notifyWorking(e)},6E4*notifyWorkIntervalTime)}function stopNotify(){clearInterval(interval)}function notifyWorking(e){if(window.webkitNotifications){var a=webkitNotifications.createNotification("../icons/timer48x48.png","Still working on Task:",e.name+"\n"+e.details.split(", Due:")[0]);a.show();setTimeout(function(){a.cancel()},7E3)}else stopNotify()}
function notifyFriday(){var e=webkitNotifications.createNotification("icons/timer48x48.png","Remember: Submit Timesheet!","");e.show();setTimeout(function(){e.cancel()},7E3)};
