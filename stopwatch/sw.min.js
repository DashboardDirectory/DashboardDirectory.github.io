(function(e){function a(b,a,c,d,e){this._listener=a;this._isOnce=c;this.context=d;this._signal=b;this._priority=e||0}function d(b,a){if("function"!==typeof b)throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",a));}function b(){this._bindings=[];this._prevParams=null;var a=this;this.dispatch=function(){b.prototype.dispatch.apply(a,arguments)}}a.prototype={active:!0,params:null,execute:function(b){var a;this.active&&this._listener&&(b=this.params?this.params.concat(b):
b,a=this._listener.apply(this.context,b),this._isOnce&&this.detach());return a},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal;delete this._listener;delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+
", isBound:"+this.isBound()+", active:"+this.active+"]"}};b.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(b,c,d,e){var pa=this._indexOfListener(b,d);if(-1!==pa){if(b=this._bindings[pa],b.isOnce()!==c)throw Error("You cannot add"+(c?"":"Once")+"() then add"+(!c?"":"Once")+"() the same listener without removing the relationship first.");}else b=new a(this,b,c,d,e),this._addBinding(b);this.memorize&&this._prevParams&&b.execute(this._prevParams);return b},
_addBinding:function(b){var a=this._bindings.length;do--a;while(this._bindings[a]&&b._priority<=this._bindings[a]._priority);this._bindings.splice(a+1,0,b)},_indexOfListener:function(b,a){for(var c=this._bindings.length,d;c--;)if(d=this._bindings[c],d._listener===b&&d.context===a)return c;return-1},has:function(b,a){return-1!==this._indexOfListener(b,a)},add:function(b,a,c){d(b,"add");return this._registerListener(b,!1,a,c)},addOnce:function(b,a,c){d(b,"addOnce");return this._registerListener(b,!0,
a,c)},remove:function(b,a){d(b,"remove");var c=this._indexOfListener(b,a);-1!==c&&(this._bindings[c]._destroy(),this._bindings.splice(c,1));return b},removeAll:function(){for(var b=this._bindings.length;b--;)this._bindings[b]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(b){if(this.active){var a=Array.prototype.slice.call(arguments),c=this._bindings.length,d;this.memorize&&(this._prevParams=
a);if(c){d=this._bindings.slice();this._shouldPropagate=!0;do c--;while(d[c]&&this._shouldPropagate&&!1!==d[c].execute(a))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll();delete this._bindings;delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var c=b;c.Signal=b;"function"===typeof define&&define.amd?define(function(){return c}):"undefined"!==typeof module&&module.exports?module.exports=c:e.signals=
c})(this);var OB={start:new signals.Signal,stop:new signals.Signal,preStart:new signals.Signal,preStop:new signals.Signal,insert:new signals.Signal,update:new signals.Signal,reset:new signals.Signal,remove:new signals.Signal,removeAll:new signals.Signal,init:new signals.Signal,options:new signals.Signal,postItemRender:new signals.Signal,postAllItemRender:new signals.Signal,onLoad:new signals.Signal};(function(){var e=this.Store=function(a,d){var b;this.name=a;if(void 0!==d)for(b in d)d.hasOwnProperty(b)&&void 0===this.get(b)&&this.set(b,d[b])};e.prototype.get=function(a){a="store."+this.name+"."+a;if(null!==localStorage.getItem(a))try{return JSON.parse(localStorage.getItem(a))}catch(d){return null}};e.prototype.set=function(a,d){if(void 0===d)this.remove(a);else{if("function"===typeof d)d=null;else try{d=JSON.stringify(d)}catch(b){d=null}localStorage.setItem("store."+this.name+"."+a,d)}return this};
e.prototype.remove=function(a){localStorage.removeItem("store."+this.name+"."+a);return this};e.prototype.removeAll=function(){var a,d;a="store."+this.name+".";for(d=localStorage.length-1;0<=d;d--)localStorage.key(d).substring(0,a.length)===a&&localStorage.removeItem(localStorage.key(d));return this};e.prototype.toObject=function(){var a,d,b,c,e;a={};d="store."+this.name+".";for(b=localStorage.length-1;0<=b;b--)localStorage.key(b).substring(0,d.length)===d&&(c=localStorage.key(b).substring(d.length),
e=this.get(c),void 0!==e&&(a[c]=e));return a};e.prototype.fromObject=function(a,d){!0!==d&&this.removeAll();for(var b in a)a.hasOwnProperty(b)&&this.set(b,a[b]);return this}})();(function(e){function a(b,a){for(var c=0,e=b.length;c<e;c++)if(b[c]==a)return!d;return d}var d=!1,b=parseFloat,c=Math.min,k=/(-?\d+\.?\d*)$/g,l=[],oa=[];e.tinysort={id:"TinySort",version:"1.4.29",copyright:"Copyright (c) 2008-2012 Ron Valstar",uri:"http://tinysort.sjeiti.com/",licensed:{MIT:"http://www.opensource.org/licenses/mit-license.php",GPL:"http://www.gnu.org/licenses/gpl.html"},plugin:function(b,a){l.push(b);oa.push(a)},defaults:{order:"asc",attr:null,data:null,useVal:d,place:"start",returns:d,
cases:d,forceStrings:d,sortFunction:null}};e.fn.extend({tinysort:function(ba,pa){ba&&"string"!=typeof ba&&(pa=ba,ba=null);var T=e.extend({},e.tinysort.defaults,pa),ga,F=e(this).length,s={},m=!(!ba||""==ba),L=!(null===T.attr||""==T.attr),ha=null!==T.data,Z=m&&":"==ba[0],ia=Z?this.filter(ba):this,S=T.sortFunction,z="asc"==T.order?1:-1,V=[];e.each(l,function(b,a){a.call(a,T)});S||(S="rand"==T.order?function(){return 0.5>Math.random()?1:-1}:function(a,c){var m=d,l=!T.cases?a.s&&a.s.toLowerCase?a.s.toLowerCase():
a.s:a.s,s=!T.cases?c.s&&c.s.toLowerCase?c.s.toLowerCase():c.s:c.s;if(!T.forceStrings){var F=l&&l.match(k),L=s&&s.match(k);if(F&&L){var O=l.substr(0,l.length-F[0].length),Q=s.substr(0,s.length-L[0].length);O==Q&&(m=!d,l=b(F[0]),s=b(L[0]))}}var S=z*(l<s?-1:l>s?1:0);e.each(oa,function(b,a){S=a.call(a,m,l,s,S)});return S});this.each(function(b,a){var c=e(a),d=m?Z?ia.filter(a):c.find(ba):c,k=ha?""+d.data(T.data):L?d.attr(T.attr):T.useVal?d.val():d.text(),l=c.parent();s[l]||(s[l]={s:[],n:[]});0<d.length?
s[l].s.push({s:k,e:c,n:b}):s[l].n.push({e:c,n:b})});for(ga in s)s[ga].s.sort(S);for(ga in s){var S=s[ga],aa=[],X=F,O=[0,0],ea;switch(T.place){case "first":e.each(S.s,function(b,a){X=c(X,a.n)});break;case "org":e.each(S.s,function(b,a){aa.push(a.n)});break;case "end":X=S.n.length;break;default:X=0}for(ea=0;ea<F;ea++){var ca=a(aa,ea)?!d:ea>=X&&ea<X+S.s.length,Q=(ca?S.s:S.n)[O[ca?0:1]].e;Q.parent().append(Q);(ca||!T.returns)&&V.push(Q.get(0));O[ca?0:1]++}}this.length=0;Array.prototype.push.apply(this,
V);return this}});e.fn.TinySort=e.fn.Tinysort=e.fn.tsort=e.fn.tinysort})(jQuery);Array.prototype.indexOf||(Array.prototype.indexOf=function(e,a){var d=this.length,b=Number(a)||0,b=0>b?Math.ceil(b):Math.floor(b);for(0>b&&(b+=d);b<d;b++)if(b in this&&this[b]===e)return b;return-1});jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,a,d,b,c){return jQuery.easing[jQuery.easing.def](e,a,d,b,c)},easeInQuad:function(e,a,d,b,c){return b*(a/=c)*a+d},easeOutQuad:function(e,a,d,b,c){return-b*(a/=c)*(a-2)+d},easeInOutQuad:function(e,a,d,b,c){return 1>(a/=c/2)?b/2*a*a+d:-b/2*(--a*(a-2)-1)+d},easeInCubic:function(e,a,d,b,c){return b*(a/=c)*a*a+d},easeOutCubic:function(e,a,d,b,c){return b*((a=a/c-1)*a*a+1)+d},easeInOutCubic:function(e,a,d,b,c){return 1>(a/=c/2)?b/2*a*a*a+d:
b/2*((a-=2)*a*a+2)+d},easeInQuart:function(e,a,d,b,c){return b*(a/=c)*a*a*a+d},easeOutQuart:function(e,a,d,b,c){return-b*((a=a/c-1)*a*a*a-1)+d},easeInOutQuart:function(e,a,d,b,c){return 1>(a/=c/2)?b/2*a*a*a*a+d:-b/2*((a-=2)*a*a*a-2)+d},easeInQuint:function(e,a,d,b,c){return b*(a/=c)*a*a*a*a+d},easeOutQuint:function(e,a,d,b,c){return b*((a=a/c-1)*a*a*a*a+1)+d},easeInOutQuint:function(e,a,d,b,c){return 1>(a/=c/2)?b/2*a*a*a*a*a+d:b/2*((a-=2)*a*a*a*a+2)+d},easeInSine:function(e,a,d,b,c){return-b*Math.cos(a/
c*(Math.PI/2))+b+d},easeOutSine:function(e,a,d,b,c){return b*Math.sin(a/c*(Math.PI/2))+d},easeInOutSine:function(e,a,d,b,c){return-b/2*(Math.cos(Math.PI*a/c)-1)+d},easeInExpo:function(e,a,d,b,c){return 0==a?d:b*Math.pow(2,10*(a/c-1))+d},easeOutExpo:function(e,a,d,b,c){return a==c?d+b:b*(-Math.pow(2,-10*a/c)+1)+d},easeInOutExpo:function(e,a,d,b,c){return 0==a?d:a==c?d+b:1>(a/=c/2)?b/2*Math.pow(2,10*(a-1))+d:b/2*(-Math.pow(2,-10*--a)+2)+d},easeInCirc:function(e,a,d,b,c){return-b*(Math.sqrt(1-(a/=c)*
a)-1)+d},easeOutCirc:function(e,a,d,b,c){return b*Math.sqrt(1-(a=a/c-1)*a)+d},easeInOutCirc:function(e,a,d,b,c){return 1>(a/=c/2)?-b/2*(Math.sqrt(1-a*a)-1)+d:b/2*(Math.sqrt(1-(a-=2)*a)+1)+d},easeInElastic:function(e,a,d,b,c){e=1.70158;var k=0,l=b;if(0==a)return d;if(1==(a/=c))return d+b;k||(k=0.3*c);l<Math.abs(b)?(l=b,e=k/4):e=k/(2*Math.PI)*Math.asin(b/l);return-(l*Math.pow(2,10*(a-=1))*Math.sin((a*c-e)*2*Math.PI/k))+d},easeOutElastic:function(e,a,d,b,c){e=1.70158;var k=0,l=b;if(0==a)return d;if(1==
(a/=c))return d+b;k||(k=0.3*c);l<Math.abs(b)?(l=b,e=k/4):e=k/(2*Math.PI)*Math.asin(b/l);return l*Math.pow(2,-10*a)*Math.sin((a*c-e)*2*Math.PI/k)+b+d},easeInOutElastic:function(e,a,d,b,c){e=1.70158;var k=0,l=b;if(0==a)return d;if(2==(a/=c/2))return d+b;k||(k=c*0.3*1.5);l<Math.abs(b)?(l=b,e=k/4):e=k/(2*Math.PI)*Math.asin(b/l);return 1>a?-0.5*l*Math.pow(2,10*(a-=1))*Math.sin((a*c-e)*2*Math.PI/k)+d:0.5*l*Math.pow(2,-10*(a-=1))*Math.sin((a*c-e)*2*Math.PI/k)+b+d},easeInBack:function(e,a,d,b,c,k){void 0==
k&&(k=1.70158);return b*(a/=c)*a*((k+1)*a-k)+d},easeOutBack:function(e,a,d,b,c,k){void 0==k&&(k=1.70158);return b*((a=a/c-1)*a*((k+1)*a+k)+1)+d},easeInOutBack:function(e,a,d,b,c,k){void 0==k&&(k=1.70158);return 1>(a/=c/2)?b/2*a*a*(((k*=1.525)+1)*a-k)+d:b/2*((a-=2)*a*(((k*=1.525)+1)*a+k)+2)+d},easeInBounce:function(e,a,d,b,c){return b-jQuery.easing.easeOutBounce(e,c-a,0,b,c)+d},easeOutBounce:function(e,a,d,b,c){return(a/=c)<1/2.75?b*7.5625*a*a+d:a<2/2.75?b*(7.5625*(a-=1.5/2.75)*a+0.75)+d:a<2.5/2.75?
b*(7.5625*(a-=2.25/2.75)*a+0.9375)+d:b*(7.5625*(a-=2.625/2.75)*a+0.984375)+d},easeInOutBounce:function(e,a,d,b,c){return a<c/2?0.5*jQuery.easing.easeInBounce(e,2*a,0,b,c)+d:0.5*jQuery.easing.easeOutBounce(e,2*a-c,0,b,c)+0.5*b+d}});var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(e){for(var a=0;a<e.length;a++){var d=e[a].string,b=e[a].prop;this.versionSearchString=e[a].versionSearch||e[a].identity;if(d){if(-1!=d.indexOf(e[a].subString))return e[a].identity}else if(b)return e[a].identity}},
searchVersion:function(e){var a=e.indexOf(this.versionSearchString);if(-1!=a)return parseFloat(e.substring(a+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",
identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",
identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();(function(e,a,d){(function(b){"function"==typeof define&&define.amd?define(["jquery"],b):jQuery&&!jQuery.fn.qtip&&b(jQuery)})(function(b){function c(b){J={pageX:b.pageX,pageY:b.pageY,type:"mousemove",scrollX:e.pageXOffset||a.body.scrollLeft||a.documentElement.scrollLeft,scrollY:e.pageYOffset||a.body.scrollTop||a.documentElement.scrollTop}}function k(a){var c=function(b){return b===L||"object"!=typeof b},d=function(a){return!b.isFunction(a)&&(!a&&!a.attr||1>a.length||"object"==typeof a&&!a.jquery&&
!a.then)};if(!a||"object"!=typeof a)return m;c(a.metadata)&&(a.metadata={type:a.metadata});if("content"in a){if(c(a.content)||a.content.jquery)a.content={text:a.content};d(a.content.text||m)&&(a.content.text=m);"title"in a.content&&(c(a.content.title)&&(a.content.title={text:a.content.title}),d(a.content.title.text||m)&&(a.content.title.text=m))}return"position"in a&&c(a.position)&&(a.position={my:a.position,at:a.position}),"show"in a&&c(a.show)&&(a.show=a.show.jquery?{target:a.show}:{event:a.show}),
"hide"in a&&c(a.hide)&&(a.hide=a.hide.jquery?{target:a.hide}:{event:a.hide}),"style"in a&&c(a.style)&&(a.style={classes:a.style}),b.each(r,function(){this.sanitize&&this.sanitize(a)}),a}function l(N,q,da,l){function G(b){var g=0,n,a=q;for(b=b.split(".");a=a[b[g++]];)g<b.length&&(n=a);return[n||q,b.pop()]}function K(b){return ua.concat("").join(b?"-"+b+" ":" ")}function fa(){var b=q.style.widget,g=y.hasClass(R);y.removeClass(R);R=b?"ui-state-disabled":"qtip-disabled";y.toggleClass(R,g);y.toggleClass("ui-helper-reset "+
K(),b).toggleClass(sa,q.style.def&&!b);A.content&&A.content.toggleClass(K("content"),b);A.titlebar&&A.titlebar.toggleClass(K("header"),b);A.button&&A.button.toggleClass(W+"-icon",!b)}function E(b){A.title&&(A.titlebar.remove(),A.titlebar=A.title=A.button=L,b!==m&&h.reposition())}function D(){var a=q.content.title.button,g="string"==typeof a?a:"Close tooltip";A.button&&A.button.remove();a.jquery?A.button=a:A.button=b("<a />",{"class":"qtip-close "+(q.style.widget?"":W+"-icon"),title:g,"aria-label":g}).prepend(b("<span />",
{"class":"ui-icon ui-icon-close",html:"&times;"}));A.button.appendTo(A.titlebar||y).attr("role","button").click(function(g){return y.hasClass(R)||h.hide(g),m})}function F(){var a=Y+"-title";A.titlebar&&E();A.titlebar=b("<div />",{"class":W+"-titlebar "+(q.style.widget?K("header"):"")}).append(A.title=b("<div />",{id:a,"class":W+"-title","aria-atomic":s})).insertBefore(A.content).delegate(".qtip-close","mousedown keydown mouseup keyup mouseout",function(g){b(this).toggleClass("ui-state-active ui-state-focus",
"down"===g.type.substr(-4))}).delegate(".qtip-close","mouseover mouseout",function(g){b(this).toggleClass("ui-state-hover","mouseover"===g.type)});q.content.title.button&&D()}function C(a,g){var n=A.title;if(!h.rendered||!a)return m;b.isFunction(a)&&(a=a.call(N,w.event,h));if(a===m||!a&&""!==a)return E(m);a.jquery&&0<a.length?n.empty().append(a.css({display:"block"})):n.html(a);g!==m&&h.rendered&&0<y[0].offsetWidth&&h.reposition(w.event)}function B(a){a&&b.isFunction(a.done)&&a.done(function(g){v(g,
null,m)})}function v(a,g,n){function u(a){function n(u){u&&(delete c[u.src],clearTimeout(h.timers.img[u.src]),b(u).unbind(M));b.isEmptyObject(c)&&(g!==m&&h.reposition(w.event),a())}var u,c={};if(0===(u=t.find("img[src]:not([height]):not([width])")).length)return n();u.each(function(g,a){if(c[a.src]===d){var u=0;(function wa(){if(a.height||a.width||3<u)return n(a);u+=1;h.timers.img[a.src]=setTimeout(wa,700)})();b(a).bind("error"+M+" load"+M,function(){n(this)});c[a.src]=a}})}var t=A.content;return!h.rendered||
!a?m:(b.isFunction(a)&&(a=a.call(N,w.event,h)||""),n!==m&&B(q.content.deferred),a.jquery&&0<a.length?t.empty().append(a.css({display:"block"})):t.html(a),0>h.rendered?y.queue("fx",u):(na=0,u(b.noop)),h)}function f(){function f(g){if(y.hasClass(R))return m;clearTimeout(h.timers.show);clearTimeout(h.timers.hide);var a=function(){h.toggle(s,g)};0<q.show.delay?h.timers.show=setTimeout(a,q.show.delay):a()}function g(g){if(y.hasClass(R)||I||na)return m;var a=b(g.relatedTarget||g.target),n=a.closest(ja)[0]===
y[0],a=a[0]===H.show[0];clearTimeout(h.timers.show);clearTimeout(h.timers.hide);if("mouse"===t.target&&n||q.hide.fixed&&/mouse(out|leave|move)/.test(g.type)&&(n||a))try{g.preventDefault(),g.stopImmediatePropagation()}catch(u){}else 0<q.hide.delay?h.timers.hide=setTimeout(function(){h.hide(g)},q.hide.delay):h.hide(g)}function n(g){if(y.hasClass(R))return m;clearTimeout(h.timers.inactive);h.timers.inactive=setTimeout(function(){h.hide(g)},q.hide.inactive)}function u(g){h.rendered&&0<y[0].offsetWidth&&
h.reposition(g)}var t=q.position,H={show:q.show.target,hide:q.hide.target,viewport:b(t.viewport),document:b(a),body:b(a.body),window:b(e)},d=b.trim(""+q.show.event).split(" "),k=b.trim(""+q.hide.event).split(" ");b.browser.msie&&parseInt(b.browser.version,10);y.bind("mouseenter"+M+" mouseleave"+M,function(g){var a="mouseenter"===g.type;a&&h.focus(g);y.toggleClass(ta,a)});/mouse(out|leave)/i.test(q.hide.event)&&"window"===q.hide.leave&&H.window.bind("mouseout"+M+" blur"+M,function(g){!/select|option/.test(g.target.nodeName)&&
!g.relatedTarget&&h.hide(g)});q.hide.fixed?(H.hide=H.hide.add(y),y.bind("mouseover"+M,function(){y.hasClass(R)||clearTimeout(h.timers.hide)})):/mouse(over|enter)/i.test(q.show.event)&&H.hide.bind("mouseleave"+M,function(g){clearTimeout(h.timers.show)});-1<(""+q.hide.event).indexOf("unfocus")&&t.container.closest("html").bind("mousedown"+M+" touchstart"+M,function(g){var a=b(g.target);h.rendered&&y.hasClass(R);var n=0<a.parents(ja).filter(y[0]).length;a[0]!==N[0]&&a[0]!==y[0]&&!n&&!N.has(a[0]).length&&
!a.attr("disabled")&&h.hide(g)});"number"==typeof q.hide.inactive&&(H.show.bind("qtip-"+da+"-inactive",n),b.each(Q.inactiveEvents,function(g,a){H.hide.add(A.tooltip).bind(a+M+"-inactive",n)}));b.each(k,function(a,n){var u=b.inArray(n,d),t=b(H.hide);-1<u&&t.add(H.show).length===t.length||"unfocus"===n?(H.show.bind(n+M,function(a){0<y[0].offsetWidth?g(a):f(a)}),delete d[u]):H.hide.bind(n+M,g)});b.each(d,function(g,a){H.show.bind(a+M,f)});"number"==typeof q.hide.distance&&H.show.add(y).bind("mousemove"+
M,function(g){var a=w.origin||{},b=q.hide.distance,n=Math.abs;(n(g.pageX-a.pageX)>=b||n(g.pageY-a.pageY)>=b)&&h.hide(g)});"mouse"===t.target&&(H.show.bind("mousemove"+M,c),t.adjust.mouse&&(q.hide.event&&(y.bind("mouseleave"+M,function(g){(g.relatedTarget||g.target)!==H.show[0]&&h.hide(g)}),A.target.bind("mouseenter"+M+" mouseleave"+M,function(g){w.onTarget="mouseenter"===g.type})),H.document.bind("mousemove"+M,function(g){h.rendered&&w.onTarget&&!y.hasClass(R)&&0<y[0].offsetWidth&&h.reposition(g||
J)})));(t.adjust.resize||H.viewport.length)&&(b.event.special.resize?H.viewport:H.window).bind("resize"+M,u);H.window.bind("scroll"+M,u)}function x(){var c=[q.show.target[0],q.hide.target[0],h.rendered&&A.tooltip[0],q.position.container[0],q.position.viewport[0],q.position.container.closest("html")[0],e,a];h.rendered?b([]).pushStack(b.grep(c,function(g){return"object"==typeof g})).unbind(M):q.show.target.unbind(M+"-create")}var h=this,Y=W+"-"+da,I=0,na=0,y=b(),M=".qtip-"+da,R="qtip-disabled",A,w;
h.id=da;h.rendered=m;h.destroyed=m;h.elements=A={target:N};h.timers={img:{}};h.options=q;h.checks={};h.plugins={};h.cache=w={event:{},target:b(),disabled:m,attr:l,onTarget:m,lastClass:""};h.checks.builtin={"^id$":function(a,g,n){a=n===s?Q.nextid:n;g=W+"-"+a;a!==m&&0<a.length&&!b("#"+g).length&&(y[0].id=g,A.content[0].id=g+"-content",A.title[0].id=g+"-title")},"^content.text$":function(a,g,b){v(q.content.text)},"^content.deferred$":function(a,g,b){B(q.content.deferred)},"^content.title.text$":function(a,
g,b){if(!b)return E();!A.title&&b&&F();C(b)},"^content.title.button$":function(a,g,b){a=A.button;h.rendered&&(b?D():a.remove())},"^position.(my|at)$":function(a,g,b){"string"==typeof b&&(a[g]=new r.Corner(b))},"^position.container$":function(a,g,b){h.rendered&&y.appendTo(b)},"^show.ready$":function(){h.rendered?h.toggle(s):h.render(1)},"^style.classes$":function(a,g,b){y.attr("class",W+" qtip "+b)},"^style.width|height":function(a,g,b){y.css(g,b)},"^style.widget|content.title":fa,"^events.(render|show|move|hide|focus|blur)$":function(a,
g,n){y[(b.isFunction(n)?"":"un")+"bind"]("tooltip"+g,n)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){var a=q.position;y.attr("tracking","mouse"===a.target&&a.adjust.mouse);x();f()}};b.extend(h,{_triggerEvent:function(a,g,n){a=b.Event("tooltip"+a);return a.originalEvent=(n?b.extend({},n):L)||w.event||L,y.trigger(a,[h].concat(g||[])),!a.isDefaultPrevented()},render:function(a){if(h.rendered)return h;var g=q.content.text,n=q.content.title,u=q.position;
return b.attr(N[0],"aria-describedby",Y),y=A.tooltip=b("<div/>",{id:Y,"class":[W,sa,q.style.classes,W+"-pos-"+q.position.my.abbrev()].join(" "),width:q.style.width||"",height:q.style.height||"",tracking:"mouse"===u.target&&u.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":m,"aria-describedby":Y+"-content","aria-hidden":s}).toggleClass(R,w.disabled).data("qtip",h).appendTo(q.position.container).append(A.content=b("<div />",{"class":W+"-content",id:Y+"-content","aria-atomic":s})),h.rendered=
-1,I=1,n.text?(F(),b.isFunction(n.text)||C(n.text,m)):n.button&&D(),(!b.isFunction(g)||g.then)&&v(g,m),h.rendered=s,fa(),b.each(q.events,function(g,a){b.isFunction(a)&&y.bind("toggle"===g?"tooltipshow tooltiphide":"tooltip"+g,a)}),b.each(r,function(){"render"===this.initialize&&this(h)}),f(),y.queue("fx",function(g){h._triggerEvent("render");I=0;(q.show.ready||a)&&h.toggle(s,w.event,m);g()}),h},get:function(a){switch(a.toLowerCase()){case "dimensions":a={height:y.outerHeight(m),width:y.outerWidth(m)};
break;case "offset":a=r.offset(y,q.position.container);break;default:a=G(a.toLowerCase()),a=a[0][a[1]],a=a.precedance?a.string():a}return a},set:function(a,g){var n=/^position\.(my|at|adjust|target|container)|style|content|show\.ready/i,u=m,c=h.checks,f;return"string"==typeof a?(f=a,a={},a[f]=g):a=b.extend(s,{},a),b.each(a,function(g,c){var t=G(g.toLowerCase()),f;f=t[0][t[1]];t[0][t[1]]="object"==typeof c&&c.nodeType?b(c):c;a[g]=[t[0],t[1],c,f];u=n.test(g)||u}),k(q),I=1,b.each(a,function(g,a){var b,
n,u;for(b in c)for(n in c[b])if(u=RegExp(n,"i").exec(g))a.push(u),c[b][n].apply(h,a)}),I=0,h.rendered&&0<y[0].offsetWidth&&u&&h.reposition("mouse"===q.position.target?L:w.event),h},toggle:function(f,g,n){function u(){f?(b.browser.msie&&y[0].style.removeAttribute("filter"),y.css("overflow",""),"string"==typeof H.autofocus&&b(H.autofocus,y).focus(),H.target.trigger("qtip-"+da+"-inactive")):y.css({display:"",visibility:"",opacity:"",left:"",top:""});h._triggerEvent(f?"visible":"hidden")}if(g){if(/over|enter/.test(g.type)&&
/out|leave/.test(w.event.type)&&q.show.target.add(g.target).length===q.show.target.length&&y.has(g.relatedTarget).length)return h;w.event=b.extend({},g)}if(!h.rendered)return f?h.render(1):h;var t=f?"show":"hide",H=q[t],d=q.position,e=q.content,N=0<y[0].offsetWidth,k=f||1===H.target.length,l=!g||2>H.target.length||w.target[0]===g.target;return(typeof f).search("boolean|number")&&(f=!N),!y.is(":animated")&&N===f&&l?h:h._triggerEvent(t,[90])?(b.attr(y[0],"aria-hidden",!f),f?(w.origin=b.extend({},J),
h.focus(g),b.isFunction(e.text)&&v(e.text,m),b.isFunction(e.title.text)&&C(e.title.text,m),!qa&&"mouse"===d.target&&d.adjust.mouse&&(b(a).bind("mousemove.qtip",c),qa=s),h.reposition(g,n),!H.solo||b(ja,H.solo).not(y).qtip("hide",b.Event("tooltipsolo"))):(clearTimeout(h.timers.show),delete w.origin,qa&&!b(ja+'[tracking="true"]:visible',H.solo).not(y).length&&(b(a).unbind("mousemove.qtip"),qa=m),h.blur(g)),H.effect===m||k===m?(y[t](),u.call(y)):b.isFunction(H.effect)?(y.stop(1,1),H.effect.call(y,h),
y.queue("fx",function(g){u();g()})):y.fadeTo(90,f?1:0,u),f&&H.target.trigger("qtip-"+da+"-inactive"),h):h},show:function(a){return h.toggle(s,a)},hide:function(a){return h.toggle(m,a)},focus:function(a){if(!h.rendered)return h;var g=b(ja),n=parseInt(y[0].style.zIndex,10),u=Q.zindex+g.length;a=b.extend({},a);return y.hasClass(ka)||h._triggerEvent("focus",[u],a)&&(n!==u&&(g.each(function(){this.style.zIndex>n&&(this.style.zIndex-=1)}),g.filter("."+ka).qtip("blur",a)),y.addClass(ka)[0].style.zIndex=
u),h},blur:function(a){return y.removeClass(ka),h._triggerEvent("blur",[y.css("zIndex")],a),h},reposition:function(c,g){if(!h.rendered||I)return h;I=1;var n=q.position.target,u=q.position,t=u.my,f=u.at,d=u.adjust,N=d.method.split(" "),da=y.outerWidth(m),k=y.outerHeight(m),l=0,M=0,v=y.css("position"),G=u.viewport,x={left:0,top:0},R=u.container,U=0<y[0].offsetWidth,B=c&&"scroll"===c.type,C=b(e),s,D;if(b.isArray(n)&&2===n.length)f={x:V,y:z},x={left:n[0],top:n[1]};else if("mouse"===n&&(c&&c.pageX||w.event.pageX))f=
{x:V,y:z},c=J&&J.pageX&&(d.mouse||!c||!c.pageX)?{pageX:J.pageX,pageY:J.pageY}:(!c||"resize"!==c.type&&"scroll"!==c.type?c&&c.pageX&&"mousemove"===c.type?c:!d.mouse&&w.origin&&w.origin.pageX&&q.show.distance?w.origin:c:w.event)||c||w.event||J||{},"static"!==v&&(x=R.offset()),x={left:c.pageX-x.left,top:c.pageY-x.top},d.mouse&&B&&(x.left-=J.scrollX-C.scrollLeft(),x.top-=J.scrollY-C.scrollTop());else{"event"===n&&c&&c.target&&"scroll"!==c.type&&"resize"!==c.type?w.target=b(c.target):"event"!==n&&(w.target=
b(n.jquery?n:A.target));n=w.target;n=b(n).eq(0);if(0===n.length)return h;n[0]===a||n[0]===e?(l=r.iOS?e.innerWidth:n.width(),M=r.iOS?e.innerHeight:n.height(),n[0]===e&&(x={top:(G||n).scrollTop(),left:(G||n).scrollLeft()})):r.imagemap&&n.is("area")?s=r.imagemap(h,n,f,r.viewport?N:m):r.svg&&n[0].ownerSVGElement?s=r.svg(h,n,f,r.viewport?N:m):(l=n.outerWidth(m),M=n.outerHeight(m),x=r.offset(n,R));s&&(l=s.width,M=s.height,D=s.offset,x=s.position);if(3.1<r.iOS&&4.1>r.iOS||4.3<=r.iOS&&4.33>r.iOS||!r.iOS&&
"fixed"===v)x.left-=C.scrollLeft(),x.top-=C.scrollTop();x.left+=f.x===X?l:f.x===O?l/2:0;x.top+=f.y===aa?M:f.y===O?M/2:0}return x.left+=d.x+(t.x===X?-da:t.x===O?-da/2:0),x.top+=d.y+(t.y===aa?-k:t.y===O?-k/2:0),r.viewport?(x.adjusted=r.viewport(h,x,u,l,M,da,k),D&&x.adjusted.left&&(x.left+=D.left),D&&x.adjusted.top&&(x.top+=D.top)):x.adjusted={left:0,top:0},h._triggerEvent("move",[x,G.elem||G],c)?(delete x.adjusted,g===m||!U||isNaN(x.left)||isNaN(x.top)||"mouse"===n||!b.isFunction(u.effect)?y.css(x):
b.isFunction(u.effect)&&(u.effect.call(y,h,b.extend({},x)),y.queue(function(g){b(this).css({opacity:"",height:""});b.browser.msie&&this.style.removeAttribute("filter");g()})),I=0,h):h},disable:function(a){return"boolean"!=typeof a&&(a=!y.hasClass(R)&&!w.disabled),h.rendered?(y.toggleClass(R,a),b.attr(y[0],"aria-disabled",a)):w.disabled=!!a,h},enable:function(){return h.disable(m)},destroy:function(){var a=N[0],g=b.attr(a,la),n=N.data("qtip");h.destroyed=s;h.rendered&&(y.stop(1,0).remove(),b.each(h.plugins,
function(){this.destroy&&this.destroy()}));clearTimeout(h.timers.show);clearTimeout(h.timers.hide);x();if(!n||h===n)b.removeData(a,"qtip"),q.suppress&&g&&(b.attr(a,"title",g),N.removeAttr(la)),N.removeAttr("aria-describedby");return N.unbind(".qtip-"+da),delete ra[h.id],N}})}function oa(c,d){var e,U,G,K,fa,E=b(this),D=b(a.body),z=this===a?D:E;U=E.metadata?E.metadata(d.metadata):L;K="html5"===d.metadata.type&&U?U[d.metadata.name]:L;var C=E.data(d.metadata.name||"qtipopts");try{C="string"==typeof C?
b.parseJSON(C):C}catch(B){}K=b.extend(s,{},Q.defaults,d,"object"==typeof C?k(C):L,k(K||U));U=K.position;K.id=c;if("boolean"==typeof K.content.text){G=E.attr(K.content.attr);if(K.content.attr===m||!G)return m;K.content.text=G}U.container.length||(U.container=D);U.target===m&&(U.target=z);K.show.target===m&&(K.show.target=z);K.show.solo===s&&(K.show.solo=U.container.closest("body"));K.hide.target===m&&(K.hide.target=z);K.position.viewport===s&&(K.position.viewport=U.container);U.container=U.container.eq(0);
U.at=new r.Corner(U.at);U.my=new r.Corner(U.my);if(b.data(this,"qtip"))if(K.overwrite)E.qtip("destroy");else if(K.overwrite===m)return m;return K.suppress&&(fa=b.attr(this,"title"))&&b(this).removeAttr("title").attr(la,fa).attr("title",""),e=new l(E,K,c,!!G),b.data(this,"qtip",e),E.bind("remove.qtip-"+c+" removeqtip.qtip-"+c,function(){e.destroy()}),e}function ba(a){var c=this,d=a.elements.tooltip,e=a.options.content.ajax,k=Q.defaults.content.ajax,l=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
r=s,E=m,D;a.checks.ajax={"^content.ajax":function(a,b,k){"ajax"===b&&(e=k);"once"===b?c.init():e&&e.url?c.load():d.unbind(".qtip-ajax")}};b.extend(c,{init:function(){return e&&e.url&&d.unbind(".qtip-ajax")[e.once?"one":"bind"]("tooltipshow.qtip-ajax",c.load),c},load:function(d){function da(){var c;a.destroyed||(r=m,z&&(E=s,a.show(d.originalEvent)),(c=k.complete||e.complete)&&b.isFunction(c)&&c.apply(e.context||a,arguments))}function B(c,f,d){var q;a.destroyed||(h&&"string"==typeof c&&(c=b("<div/>").append(c.replace(l,
"")).find(h)),(q=k.success||e.success)&&b.isFunction(q)?q.call(e.context||a,c,f,d):a.set("content.text",c))}function v(b,c,f){a.destroyed||0===b.status||a.set("content.text",c+": "+f)}if(E)E=m;else{var f=e.url.lastIndexOf(" "),x=e.url,h,z=!e.loading&&r;if(z)try{d.preventDefault()}catch(I){}else if(d&&d.isDefaultPrevented())return c;D&&D.abort&&D.abort();-1<f&&(h=x.substr(f),x=x.substr(0,f));D=b.ajax(b.extend({error:k.error||v,context:a},e,{url:x,success:B,complete:da}))}},destroy:function(){D&&D.abort&&
D.abort();a.destroyed=s}});c.init()}function pa(a,b,c){var d=Math.ceil(b/2),e=Math.ceil(c/2);b={bottomright:[[0,0],[b,c],[b,0]],bottomleft:[[0,0],[b,0],[0,c]],topright:[[0,c],[b,0],[b,c]],topleft:[[0,0],[0,c],[b,c]],topcenter:[[0,c],[d,0],[b,c]],bottomcenter:[[0,0],[b,0],[d,c]],rightcenter:[[0,0],[b,e],[0,c]],leftcenter:[[b,0],[b,c],[0,e]]};return b.lefttop=b.bottomright,b.righttop=b.bottomleft,b.leftbottom=b.topright,b.rightbottom=b.topleft,b[a.string()]}function T(a,c){var e,k;function l(a){var b=
x.is(":visible");x.show();a();x.toggle(b)}function K(b,c,e,q){if(f.tip){b=B.corner.clone();c=e.adjusted;var k=a.options.position.adjust.method.split(" ");q=k[0];var k=k[1]||k[0],l=m,g=m,n=0,u=0,t,H={},x;B.corner.fixed!==s&&(q===ca&&b.precedance===ha&&c.left&&b.y!==O?b.precedance=b.precedance===ha?Z:ha:q!==ca&&c.left&&(b.x=b.x===O?0<c.left?V:X:b.x===V?X:V),k===ca&&b.precedance===Z&&c.top&&b.x!==O?b.precedance=b.precedance===Z?ha:Z:k!==ca&&c.top&&(b.y=b.y===O?0<c.top?z:aa:b.y===z?aa:z),b.string()!==
h.corner.string()&&(h.top!==c.top||h.left!==c.left)&&B.update(b,m));t=B.position(b,c);t[b.x]+=fa(b,b.x);t[b.y]+=fa(b,b.y);t.right!==d&&(t.left=-t.right);t.bottom!==d&&(t.top=-t.bottom);t.user=Math.max(0,v.offset);if(l=q===ca&&!!c.left)b.x===O?H["margin-left"]=n=t["margin-left"]:(x=t.right!==d?[c.left,-t.left]:[-c.left,t.left],(n=Math.max(x[0],x[1]))>x[0]&&(e.left-=c.left,l=m),H[t.right!==d?X:V]=n);if(g=k===ca&&!!c.top)b.y===O?H["margin-top"]=u=t["margin-top"]:(x=t.bottom!==d?[c.top,-t.top]:[-c.top,
t.top],(u=Math.max(x[0],x[1]))>x[0]&&(e.top-=c.top,g=m),H[t.bottom!==d?aa:z]=u);f.tip.css(H).toggle(!(n&&u||b.x===O&&u||b.y===O&&n));e.left-=t.left.charAt?t.user:q!==ca||g||!l&&!g?t.left:0;e.top-=t.top.charAt?t.user:k!==ca||l||!l&&!g?t.top:0;h.left=c.left;h.top=c.top;h.corner=b.clone()}}function fa(a,b,c){b=b?b:a[a.precedance];var d=f.titlebar&&a.y===z?f.titlebar:x,e="border-"+b+"-width",h;return l(function(){h=(c?parseInt(c.css(e),10):parseInt(f.content.css(e),10)||parseInt(d.css(e),10)||parseInt(x.css(e),
10))||0}),h}function E(a){var c=f.titlebar&&a.y===z?f.titlebar:f.content,e=b.browser.mozilla?"-moz-":b.browser.webkit?"-webkit-":"",d="border-radius-"+a.y+a.x,h="border-"+a.y+"-"+a.x+"-radius",q=function(a){return parseInt(c.css(a),10)||parseInt(x.css(a),10)},g;return l(function(){g=q(h)||q(e+h)||q(e+d)||q(d)||0}),g}function D(a){function c(a,g,b){g=a.css(g)||N;return b&&g===a.css(b)?m:h.test(g)?m:g}var d=f.tip.css("cssText","");a=a||B.corner;var h=/rgba?\(0, 0, 0(, 0)?\)|transparent|#123456/i,q=
"border-"+a[a.precedance]+"-color",N="transparent",g=f.titlebar,n=g&&(a.y===z||a.y===O&&d.position().top+Y.height/2+v.offset<g.outerHeight(s))?g:f.content;l(function(){e=c(d,"background-color")||c(n,"background-color")||c(f.content,"background-color")||c(x,"background-color")||d.css("background-color");k=c(d,q,"color")||c(n,q,"color")||c(f.content,q,"color")||c(x,q,"color")||x.css(q);b("*",d).add(d).css("cssText","background-color:"+N+" !important;border:0 !important;")})}function F(a){var b=a.precedance===
Z,c=Y[b?ia:S],f=Y[b?S:ia];a=-1<a.string().indexOf(O);var d=c*(a?0.5:1),e=Math.pow,g=Math.round,n,u,t,H=Math.sqrt(e(d,2)+e(f,2)),d=[I/d*H,I/f*H];return d[2]=Math.sqrt(e(d[0],2)-e(I,2)),d[3]=Math.sqrt(e(d[1],2)-e(I,2)),n=H+d[2]+d[3]+(a?0:d[0]),u=n/H,t=[g(u*f),g(u*c)],{height:t[b?0:1],width:t[b?1:0]}}function C(a,b,c){return"<qvml:"+a+' xmlns="urn:schemas-microsoft.com:vml" class="qtip-vml" '+(b||"")+' style="behavior: url(#default#VML); '+(c||"")+'" />'}var B=this,v=a.options.style.tip,f=a.elements,
x=f.tooltip,h={top:0,left:0},Y={width:v.width,height:v.height};k=e=void 0;var I=v.border||0,J=!!(b("<canvas />")[0]||{}).getContext;B.corner=L;B.mimic=L;B.border=I;B.offset=v.offset;B.size=Y;a.checks.tip={"^position.my|style.tip.(corner|mimic|border)$":function(){B.init()||B.destroy();a.reposition()},"^style.tip.(height|width)$":function(){Y={width:v.width,height:v.height};B.create();B.update();a.reposition()},"^content.title.text|style.(classes|widget)$":function(){f.tip&&f.tip.length&&B.update()}};
b.extend(B,{init:function(){var c=v.corner,f=a.options.position,d=f.at,f=f.my.string?f.my.string():f.my,c=(c===m||f===m&&d===m?m:(c===s?B.corner=new r.Corner(f):c.string||(B.corner=new r.Corner(c),B.corner.fixed=s),h.corner=new r.Corner(B.corner.string()),"centercenter"!==B.corner.string()))&&(J||b.browser.msie);return c&&(B.create(),B.update(),x.unbind(".qtip-tip").bind("tooltipmove.qtip-tip",K)),c},create:function(){var a=Y.width,c=Y.height,d;f.tip&&f.tip.remove();f.tip=b("<div />",{"class":"qtip-tip"}).css({width:a,
height:c}).prependTo(x);J?b("<canvas />").appendTo(f.tip)[0].getContext("2d").save():(d=C("shape",'coordorigin="0,0"',"position:absolute;"),f.tip.html(d+d),b("*",f.tip).bind("click mousedown",function(a){a.stopPropagation()}))},update:function(a,c){var d=f.tip,q=d.children(),l=Y.width,N=Y.height,g=v.mimic,n=Math.round,u,t,H,ma;a||(a=h.corner||B.corner);g===m?g=a:(g=new r.Corner(g),g.precedance=a.precedance,"inherit"===g.x?g.x=a.x:"inherit"===g.y?g.y=a.y:g.x===g.y&&(g[a.precedance]=a[a.precedance]));
a.precedance===ha?(Y.width=v.height,Y.height=v.width):(Y.width=v.width,Y.height=v.height);f.tip.css({width:l=Y.width,height:N=Y.height});D(a);"transparent"!==k?(I=fa(a,L),0===v.border&&0<I&&(e=k),B.border=I=v.border!==s?v.border:I):B.border=I=0;t=pa(g,l,N);B.size=ma=F(a);d.css(ma).css("line-height",ma.height+"px");a.precedance===Z?H=[n(g.x===V?I:g.x===X?ma.width-l-I:(ma.width-l)/2),n(g.y===z?ma.height-N:0)]:H=[n(g.x===V?ma.width-l:0),n(g.y===z?I:g.y===aa?ma.height-N-I:(ma.height-N)/2)];J?(q.attr(ma),
u=q[0].getContext("2d"),u.restore(),u.save(),u.clearRect(0,0,3E3,3E3),u.fillStyle=e,u.strokeStyle=k,u.lineWidth=2*I,u.lineJoin="miter",u.miterLimit=100,u.translate(H[0],H[1]),u.beginPath(),u.moveTo(t[0][0],t[0][1]),u.lineTo(t[1][0],t[1][1]),u.lineTo(t[2][0],t[2][1]),u.closePath(),I&&("border-box"===x.css("background-clip")&&(u.strokeStyle=e,u.stroke()),u.strokeStyle=k,u.stroke()),u.fill()):(t="m"+t[0][0]+","+t[0][1]+" l"+t[1][0]+","+t[1][1]+" "+t[2][0]+","+t[2][1]+" xe",H[2]=I&&/^(r|b)/i.test(a.string())?
8===parseFloat(b.browser.version,10)?2:1:0,q.css({coordsize:l+I+" "+(N+I),antialias:""+(-1<g.string().indexOf(O)),left:H[0],top:H[1],width:l+I,height:N+I}).each(function(a){var g=b(this);g[g.prop?"prop":"attr"]({coordsize:l+I+" "+(N+I),path:t,fillcolor:e,filled:!!a,stroked:!a}).toggle(!!I||!!a);!a&&""===g.html()&&g.html(C("stroke",'weight="'+2*I+'px" color="'+k+'" miterlimit="1000" joinstyle="miter"'))}));c!==m&&B.position(a)},position:function(a){var c=f.tip,d={},e=Math.max(0,v.offset),q,h,g;return v.corner===
m||!c?m:(a=a||B.corner,q=a.precedance,h=F(a),g=[a.x,a.y],q===ha&&g.reverse(),b.each(g,function(g,b){var c,H,k;b===O?(c=q===Z?V:z,d[c]="50%",d["margin-"+c]=-Math.round(h[q===Z?ia:S]/2)+e):(c=fa(a,b),H=fa(a,b,f.content),k=E(a),d[b]=g?H:e+(k>c?k:-c))}),d[a[q]]-=h[q===ha?ia:S],c.css({top:"",bottom:"",left:"",right:"",margin:""}).css(d),d)},destroy:function(){f.tip&&f.tip.remove();f.tip=!1;x.unbind(".qtip-tip")}});B.init()}function ga(c){function d(){B=b(C,E).not("[disabled]").map(function(){return"function"==
typeof this.focus?this:null})}function k(a){1>B.length&&a.length?a.not("body").blur():B.first().focus()}function l(a){var c=b(a.target),d=c.closest(".qtip");!(1>d.length?m:parseInt(d[0].style.zIndex,10)>parseInt(E[0].style.zIndex,10))&&b(a.target).closest(ja)[0]!==E[0]&&k(c)}var G=this,K=c.options.show.modal,z=c.elements,E=z.tooltip,D=".qtipmodal"+c.id,F=b(a.body),C=r.modal.focusable.join(","),B={},v;c.checks.modal={"^show.modal.(on|blur)$":function(){G.init();z.overlay.toggle(E.is(":visible"))},
"^content.text$":function(){d()}};b.extend(G,{init:function(){return K.on?(v=G.create(),E.attr("is-modal-qtip",s).css("z-index",r.modal.zindex+b(ja+"[is-modal-qtip]").length).unbind(".qtipmodal").unbind(D).bind("tooltipshow.qtipmodal tooltiphide.qtipmodal",function(a,c,d){c=a.originalEvent;if(a.target===E[0])if(c&&"tooltiphide"===a.type&&/mouse(leave|enter)/.test(c.type)&&b(c.relatedTarget).closest(v[0]).length)try{a.preventDefault()}catch(e){}else(!c||c&&!c.solo)&&G[a.type.replace("tooltip","")](a,
d)}).bind("tooltipfocus.qtipmodal",function(a){if(!(a.isDefaultPrevented()||a.target!==E[0])){var c=b(ja).filter("[is-modal-qtip]"),d=r.modal.zindex+c.length,e=parseInt(E[0].style.zIndex,10);v[0].style.zIndex=d-2;c.each(function(){this.style.zIndex>e&&(this.style.zIndex-=1)});c.end().filter("."+ka).qtip("blur",a.originalEvent);E.addClass(ka)[0].style.zIndex=d;try{a.preventDefault()}catch(q){}}}).bind("tooltiphide.qtipmodal",function(a){a.target===E[0]&&b("[is-modal-qtip]").filter(":visible").not(E).last().qtip("focus",
a)}),K.escape&&b(a).unbind(D).bind("keydown"+D,function(a){27===a.keyCode&&E.hasClass(ka)&&c.hide(a)}),K.blur&&z.overlay.unbind(D).bind("click"+D,function(a){E.hasClass(ka)&&c.hide(a)}),d(),G):G},create:function(){function a(){v.css({height:d.height(),width:d.width()})}var c=b("#qtip-overlay"),d=b(e);return c.length?z.overlay=c.insertAfter(b(ja).last()):(v=z.overlay=b("<div />",{id:"qtip-overlay",html:"<div></div>",mousedown:function(){return m}}).hide().insertAfter(b(ja).last()),d.unbind(".qtipmodal").bind("resize.qtipmodal",
a),a(),v)},toggle:function(a,c,d){if(a&&a.isDefaultPrevented())return G;a=K.effect;var e=c?"show":"hide",q=v.is(":visible"),N=b("[is-modal-qtip]").filter(":visible").not(E);return v||(v=G.create()),v.is(":animated")&&q===c&&v.data("toggleState")!==m||!c&&N.length?G:(c?(v.css({left:0,top:0}),v.toggleClass("blurs",K.blur),K.stealfocus!==m&&(F.bind("focusin"+D,l),k(b("body :focus")))):F.unbind("focusin"+D),v.stop(s,m).data("toggleState",c),b.isFunction(a)?a.call(v,c):a===m?v[e]():v.fadeTo(parseInt(d,
10)||90,c?1:0,function(){c||b(this).hide()}),c||v.queue(function(a){v.css({left:"",top:""}).removeData("toggleState");a()}),G)},show:function(a,b){return G.toggle(a,s,b)},hide:function(a,b){return G.toggle(a,m,b)},destroy:function(){var d=v;return d&&(d=1>b("[is-modal-qtip]").not(E).length,d?(z.overlay.remove(),b(a).unbind(".qtipmodal")):z.overlay.unbind(".qtipmodal"+c.id),F.unbind("focusin"+D)),E.removeAttr("is-modal-qtip").unbind(".qtipmodal")}});G.init()}function F(c){var d=this,k=c.elements,l=
c.options,G=k.tooltip,K=".ie6-"+c.id,r=1>b("select, object").length,E=0,D=m,z;c.checks.ie6={"^content|style$":function(a,b,c){redraw()}};b.extend(d,{init:function(){var c=b(e),l;r&&(k.bgiframe=b('<iframe class="qtip-bgiframe" frameborder="0" tabindex="-1" src="javascript:\'\';"  style="display:block; position:absolute; z-index:-1; filter:alpha(opacity=0); -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";"></iframe>'),k.bgiframe.appendTo(G),G.bind("tooltipmove"+K,d.adjustBGIFrame));
z=b("<div/>",{id:"qtip-rcontainer"}).appendTo(a.body);d.redraw();k.overlay&&!D&&(l=function(){k.overlay[0].style.top=c.scrollTop()+"px"},c.bind("scroll.qtip-ie6, resize.qtip-ie6",l),l(),k.overlay.addClass("qtipmodal-ie6fix"),D=s)},adjustBGIFrame:function(){var a=c.get("dimensions"),b=c.plugins.tip,d=k.tip,e,q;q=parseInt(G.css("border-left-width"),10)||0;q={left:-q,top:-q};b&&d&&(e="x"===b.corner.precedance?["width","left"]:["height","top"],q[e[1]]-=d[e[0]]());k.bgiframe.css(q).css(a)},redraw:function(){if(1>
c.rendered||E)return d;var a=l.style,b=l.position.container,e,f,k,h;return E=1,a.height&&G.css(S,a.height),a.width?G.css(ia,a.width):(G.css(ia,"").appendTo(z),f=G.width(),1>f%2&&(f+=1),k=G.css("max-width")||"",h=G.css("min-width")||"",e=-1<(k+h).indexOf("%")?b.width()/100:0,k=(-1<k.indexOf("%")?e:1)*parseInt(k,10)||f,h=(-1<h.indexOf("%")?e:1)*parseInt(h,10)||0,f=k+h?Math.min(Math.max(f,h),k):f,G.css(ia,Math.round(f)).appendTo(b)),E=0,d},destroy:function(){r&&k.bgiframe.remove();G.unbind(K)}});d.init()}
var s=!0,m=!1,L=null,ha="x",Z="y",ia="width",S="height",z="top",V="left",aa="bottom",X="right",O="center",ea="flipinvert",ca="shift",Q,r,J,W="qtip",ra={},ua=["ui-widget","ui-tooltip"],ja="div.qtip."+W,sa=W+"-default",ka=W+"-focus",ta=W+"-hover",la="oldtitle",qa;Q=b.fn.qtip=function(a,c,e){var l=(""+a).toLowerCase(),G=L,r=b.makeArray(arguments).slice(1),z=r[r.length-1],E=this[0]?b.data(this[0],"qtip"):L;if(!arguments.length&&E||"api"===l)return E;if("string"==typeof a)return this.each(function(){var a=
b.data(this,"qtip");if(!a)return s;z&&z.timeStamp&&(a.cache.event=z);if("option"!==l&&"options"!==l||!c)a[l]&&a[l].apply(a[l],r);else{if(!b.isPlainObject(c)&&e===d)return G=a.get(c),m;a.set(c,e)}}),G!==L?G:this;if("object"==typeof a||!arguments.length)return E=k(b.extend(s,{},a)),Q.bind.call(this,E,z)};Q.bind=function(a,e){return this.each(function(k){function l(a){function c(){D.render("object"==typeof a||G.show.ready);K.show.add(K.hide).unbind(E)}if(D.cache.disabled)return m;D.cache.event=b.extend({},
a);D.cache.target=a?b(a.target):[d];0<G.show.delay?(clearTimeout(D.timers.show),D.timers.show=setTimeout(c,G.show.delay),z.show!==z.hide&&K.hide.bind(z.hide,function(){clearTimeout(D.timers.show)})):c()}var G,K,z,E,D;k=b.isArray(a.id)?a.id[k]:a.id;k=!k||k===m||1>k.length||ra[k]?Q.nextid++:ra[k]=k;E=".qtip-"+k+"-create";D=oa.call(this,k,a);if(D===m)return s;G=D.options;b.each(r,function(){"initialize"===this.initialize&&this(D)});K={show:G.show.target,hide:G.hide.target};z={show:b.trim(""+G.show.event).replace(/ /g,
E+" ")+E,hide:b.trim(""+G.hide.event).replace(/ /g,E+" ")+E};/mouse(over|enter)/i.test(z.show)&&!/mouse(out|leave)/i.test(z.hide)&&(z.hide+=" mouseleave"+E);K.show.bind("mousemove"+E,function(a){c(a);D.cache.onTarget=s});K.show.bind(z.show,l);(G.show.ready||G.prerender)&&l(e)}).attr("data-hasqtip",s)};r=Q.plugins={Corner:function(a){a=(""+a).replace(/([A-Z])/," $1").replace(/middle/gi,O).toLowerCase();this.x=(a.match(/left|right/i)||a.match(/center/)||["inherit"])[0].toLowerCase();this.y=(a.match(/top|bottom|center/i)||
["inherit"])[0].toLowerCase();a=a.charAt(0);this.precedance="t"===a||"b"===a?Z:ha;this.string=function(){return this.precedance===Z?this.y+this.x:this.x+this.y};this.abbrev=function(){var a=this.x.substr(0,1),b=this.y.substr(0,1);return a===b?a:this.precedance===Z?b+a:a+b};this.invertx=function(a){this.x=this.x===V?X:this.x===X?V:a||this.x};this.inverty=function(a){this.y=this.y===z?aa:this.y===aa?z:a||this.y};this.clone=function(){return{x:this.x,y:this.y,precedance:this.precedance,string:this.string,
abbrev:this.abbrev,clone:this.clone,invertx:this.invertx,inverty:this.inverty}}},offset:function(c,d){var e=c.offset(),k=c.closest("body"),l=b.browser.msie&&"CSS1Compat"!==a.compatMode,m=d,s,r,z;if(m){do"static"!==m.css("position")&&(r=m.position(),e.left-=r.left+(parseInt(m.css("borderLeftWidth"),10)||0)+(parseInt(m.css("marginLeft"),10)||0),e.top-=r.top+(parseInt(m.css("borderTopWidth"),10)||0)+(parseInt(m.css("marginTop"),10)||0),!s&&"hidden"!==(z=m.css("overflow"))&&"visible"!==z&&(s=m));while((m=
b(m[0].offsetParent)).length);if(s&&s[0]!==k[0]||l)k=s||k,e.left+=1*k.scrollLeft(),e.top+=1*k.scrollTop()}return e},iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||m,fn:{attr:function(a,c){if(this.length){var d=this[0],e=b.data(d,"qtip");if("title"===a&&e&&"object"==typeof e&&e.options.suppress)return 2>arguments.length?b.attr(d,la):(e&&"title"===e.options.content.attr&&
e.cache.attr&&e.set("content.text",c),this.attr(la,c))}return b.fn.attr_replacedByqTip.apply(this,arguments)},clone:function(a){b([]);var c=b.fn.clone_replacedByqTip.apply(this,arguments);return a||c.filter("["+la+"]").attr("title",function(){return b.attr(this,la)}).removeAttr(la),c}}};b.each(r.fn,function(a,c){if(!c||b.fn[a+"_replacedByqTip"])return s;var d=b.fn[a+"_replacedByqTip"]=b.fn[a];b.fn[a]=function(){return c.apply(this,arguments)||d.apply(this,arguments)}});b.ui||(b.cleanData_replacedByqTip=
b.cleanData,b.cleanData=function(a){for(var c=0,e;(e=a[c])!==d;c++)try{b(e).triggerHandler("removeqtip")}catch(k){}b.cleanData_replacedByqTip(a)});Q.version="2.0.1";Q.nextid=0;Q.inactiveEvents="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" ");Q.zindex=15E3;Q.defaults={prerender:m,id:m,overwrite:s,suppress:s,content:{text:s,attr:"title",deferred:m,title:{text:m,button:m}},position:{my:"top left",at:"bottom right",target:m,container:m,viewport:m,adjust:{x:0,y:0,mouse:s,resize:s,
method:"flipinvert flipinvert"},effect:function(a,c,d){b(this).animate(c,{duration:200,queue:m})}},show:{target:m,event:"mouseenter",effect:s,delay:90,solo:m,ready:m,autofocus:m},hide:{target:m,event:"mouseleave",effect:s,delay:0,fixed:m,inactive:m,leave:"window",distance:m},style:{classes:"",widget:m,width:m,height:m,def:s},events:{render:L,move:L,show:L,hide:L,toggle:L,visible:L,hidden:L,focus:L,blur:L}};r.svg=function(c,d,e,k){c=b(a);var l=d[0];d={width:0,height:0,position:{top:1E10,left:1E10}};
for(var m;!l.getBBox;)l=l.parentNode;if(l.getBBox&&l.parentNode){e=l.getBBox();k=l.getScreenCTM();l=l.farthestViewportElement||l;if(!l.createSVGPoint)return d;l=l.createSVGPoint();l.x=e.x;l.y=e.y;m=l.matrixTransform(k);d.position.left=m.x;d.position.top=m.y;l.x+=e.width;l.y+=e.height;m=l.matrixTransform(k);d.width=m.x-d.position.left;d.height=m.y-d.position.top;d.position.left+=c.scrollLeft();d.position.top+=c.scrollTop()}return d};r.ajax=function(a){var b=a.plugins.ajax;return"object"==typeof b?
b:a.plugins.ajax=new ba(a)};r.ajax.initialize="render";r.ajax.sanitize=function(a){var b=a.content,c;b&&"ajax"in b&&(c=b.ajax,"object"!=typeof c&&(c=a.content.ajax={url:c}),"boolean"!=typeof c.once&&c.once&&(c.once=!!c.once))};b.extend(s,Q.defaults,{content:{ajax:{loading:s,once:s}}});r.tip=function(a){var b=a.plugins.tip;return"object"==typeof b?b:a.plugins.tip=new T(a)};r.tip.initialize="render";r.tip.sanitize=function(a){var b=a.style,c;b&&"tip"in b&&(c=a.style.tip,"object"!=typeof c&&(a.style.tip=
{corner:c}),/string|boolean/i.test(typeof c.corner)||(c.corner=s),"number"!=typeof c.width&&delete c.width,"number"!=typeof c.height&&delete c.height,"number"!=typeof c.border&&c.border!==s&&delete c.border,"number"!=typeof c.offset&&delete c.offset)};b.extend(s,Q.defaults,{style:{tip:{corner:s,mimic:m,width:6,height:6,border:s,offset:0}}});r.modal=function(a){var b=a.plugins.modal;return"object"==typeof b?b:a.plugins.modal=new ga(a)};r.modal.initialize="render";r.modal.sanitize=function(a){a.show&&
("object"!=typeof a.show.modal?a.show.modal={on:!!a.show.modal}:"undefined"==typeof a.show.modal.on&&(a.show.modal.on=s))};r.modal.zindex=Q.zindex-200;r.modal.focusable="a[href] area[href] input select textarea button iframe object embed [tabindex] [contenteditable]".split(" ");b.extend(s,Q.defaults,{show:{modal:{on:m,effect:s,blur:s,stealfocus:s,escape:s}}});r.viewport=function(b,c,d,k,l,m,s){function r(a,b,d,e,g,n,u,t,f){var k=c[g],l=C[a],m=B[a],s=d===ca,x=-J.offset[g]+h.offset[g]+h["scroll"+g],
v=l===g?f:l===n?-f:-f/2,z=I&&I.size?I.size[u]||0:0,D=I&&I.corner&&I.corner.precedance===a&&!s?z:0,E=x-k+D;f=k+f-h[u]-x+D;t=v-(C.precedance===a||l===C[b]?m===g?t:m===n?-t:-t/2:0)-(m===O?t/2:0);return s?(D=I&&I.corner&&I.corner.precedance===b?z:0,t=(l===g?1:-1)*v-D,c[g]+=0<E?E:0<f?-f:0,c[g]=Math.max(-J.offset[g]+h.offset[g]+(D&&I.corner[a]===O?I.offset:0),k-t,Math.min(Math.max(-J.offset[g]+h.offset[g]+h[u],k+t),c[g]))):(e*=d===ea?2:0,0<E&&(l!==g||0<f)?(c[g]-=t+e,y["invert"+a](g)):0<f&&(l!==n||0<E)&&
(c[g]-=(l===O?-t:t)+e,y["invert"+a](n)),c[g]<x&&-c[g]>f&&(c[g]=k,y=C.clone())),c[g]-k}var D=d.target,F=b.elements.tooltip,C=d.my,B=d.at,v=d.adjust,f=v.method.split(" "),x=f[0],f=f[1]||f[0],h=d.viewport,J=d.container;d=b.cache;var I=b.plugins.tip,L={left:0,top:0},y,M;if(!h.jquery||D[0]===e||D[0]===a.body||"none"===v.method)return L;D="fixed"===F.css("position");h={elem:h,height:h[(h[0]===e?"h":"outerH")+"eight"](),width:h[(h[0]===e?"w":"outerW")+"idth"](),scrollleft:D?0:h.scrollLeft(),scrolltop:D?
0:h.scrollTop(),offset:h.offset()||{left:0,top:0}};J={elem:J,scrollLeft:J.scrollLeft(),scrollTop:J.scrollTop(),offset:J.offset()||{left:0,top:0}};if("shift"!==x||"shift"!==f)y=C.clone();return L={left:"none"!==x?r(ha,Z,x,v.x,V,X,ia,k,m):0,top:"none"!==f?r(Z,ha,f,v.y,z,aa,S,l,s):0},y&&d.lastClass!==(M=W+"-pos-"+y.abbrev())&&F.removeClass(b.cache.lastClass).addClass(b.cache.lastClass=M),L};r.imagemap=function(a,c,d,e){function k(a,b,c){for(var d=0,e=1,l=1,m=0,q=0,r=a.width,s=a.height;0<r&&0<s&&0<e&&
0<l;){r=Math.floor(r/2);s=Math.floor(s/2);c.x===V?e=r:c.x===X?e=a.width-r:e+=Math.floor(r/2);c.y===z?l=s:c.y===aa?l=a.height-s:l+=Math.floor(s/2);for(d=b.length;d--&&!(2>b.length);)m=b[d][0]-a.position.left,q=b[d][1]-a.position.top,(c.x===V&&m>=e||c.x===X&&m<=e||c.x===O&&(m<e||m>a.width-e)||c.y===z&&q>=l||c.y===aa&&q<=l||c.y===O&&(q<l||q>a.height-l))&&b.splice(d,1)}return{left:b[0][0],top:b[0][1]}}c.jquery||(c=b(c));a=a.cache.areas={};var l=(c[0].shape||c.attr("shape")).toLowerCase(),m=c[0].coords||
c.attr("coords"),s=m.split(","),r=[];c=b('img[usemap="#'+c.parent("map").attr("name")+'"]');var F=c.offset(),C={width:0,height:0,position:{top:1E10,right:0,bottom:0,left:1E10}},B=0,v=0;F.left+=Math.ceil((c.outerWidth()-c.width())/2);F.top+=Math.ceil((c.outerHeight()-c.height())/2);if("poly"===l)for(B=s.length;B--;)v=[parseInt(s[--B],10),parseInt(s[B+1],10)],v[0]>C.position.right&&(C.position.right=v[0]),v[0]<C.position.left&&(C.position.left=v[0]),v[1]>C.position.bottom&&(C.position.bottom=v[1]),
v[1]<C.position.top&&(C.position.top=v[1]),r.push(v);else for(B=-1;B++<s.length;)r.push(parseInt(s[B],10));switch(l){case "rect":C={width:Math.abs(r[2]-r[0]),height:Math.abs(r[3]-r[1]),position:{left:Math.min(r[0],r[2]),top:Math.min(r[1],r[3])}};break;case "circle":C={width:r[2]+2,height:r[2]+2,position:{left:r[0],top:r[1]}};break;case "poly":C.width=Math.abs(C.position.right-C.position.left),C.height=Math.abs(C.position.bottom-C.position.top),"c"===d.abbrev()?C.position={left:C.position.left+C.width/
2,top:C.position.top+C.height/2}:(a[d+m]||(C.position=k(C,r.slice(),d),e&&("flip"===e[0]||"flip"===e[1])&&(C.offset=k(C,r.slice(),{x:d.x===V?X:d.x===X?V:O,y:d.y===z?aa:d.y===aa?z:O}),C.offset.left-=C.position.left,C.offset.top-=C.position.top),a[d+m]=C),C=a[d+m]),C.width=C.height=0}return C.position.left+=F.left,C.position.top+=F.top,C};r.ie6=function(a){var c=b.browser,d=a.plugins.ie6;return!c.msie||"6"!==(""+c.version).charAt(0)?m:"object"==typeof d?d:a.plugins.ie6=new F(a)};r.ie6.initialize="render"})})(window,
document);var attask=function(){function e(a){var b={url:"https://www.atappstore.com/api/authorize/",data:{product:f.get("qr")?"shiftwatch-qr":"stopwatch",host:f.get("host"),sessionID:f.get("sessionID"),user:f.get("username"),domain:f.get("domain")},type:"GET",dataType:"json"};z(b);b=jQuery.ajax(b);b.done(function(b,c,n){!1!=b.success&&(f.set("auth_key",b.auth_key),f.set("access",b.access),f.set("is_auth",b.is_auth),f.set("license_expiry_days",b.license_expiry_days),f.get("qr")&&(f.set("view","team"),f.set("sort",
"project"),f.set("logout_on_select",!0),f.set("multi",!0),f.set("hide_team_done",!0),f.set("minuteBuffer",30),f.set("minuteBufferSnapToSched",!0),TASK_DB.userId=f.get("userID")),f.get("minuteBufferSnapToSched")&&q(),f.get("restrict_sched")?q(function(b){var c;void 0==b&&(c="Today is not a work day");var n=new Date,n=Date.parse("01/01/2011 "+n.getHours()+":"+n.getMinutes()),d=Date.parse("01/01/2011 "+b.start),u=Date.parse("01/01/2011 "+b.stop),e=f.get("minuteBuffer");null!=e&&(d.setMinutes(d.getMinutes()-
e),u.setMinutes(u.getMinutes()+e));void 0==b||d>n||n>u?(c=c?c:"Please return at "+b.start,TASK_CNTRL.showWindow('<h3><div style="text-align: center; font-weight: bold;">Not scheduled to work</div></h3><div class="content"><p>'+c+'.</p><a href="#" class="btn btn-primary logout cancel" title="Logout">Logout</a></div>')):a()}):(a&&a(),oa()))});b.fail(function(a,b,g){})}function a(){var g={url:J()+"user/count",type:"get",data:{},dataType:"json"};z(g);g=jQuery.ajax(g);g.done(function(a){void 0!=a.error?
(a.error["class"]==B[0]?F(function(){}):b(v[0],"uCount,"+JSON.stringify(a.error)),w.hide(),A.hide()):a=a.data});g.fail(function(b,g,c){r({response:b.responseText,type:g,msg:c},a,"uCount")})}function d(){var a={url:J()+"user/search?ID=$$USER.ID&fields=customer:name,customer:fullUsers,customer:limitedUsers,customer:teamUsers",type:"get",data:{},dataType:"json"};z(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==B[0]?F(function(){}):b(v[0],"uInfo,"+JSON.stringify(a.error)),w.hide(),
A.hide()):a=a.data});a.fail(function(a,b,g){r({response:a.responseText,type:b,msg:g},d,"uInfo")})}function b(a,b,c){}function c(){if((x||h||"full"==getQueryString("view"))&&void 0!=f.get("host"))clearInterval(M),M=self.setInterval(function(){if(!document.hasFocus()||h)jQuery("#search-bar").is(":visible")&&jQuery("#search").click(),jQuery("#form-list").hide(),void 0==f.get("sessionID")?T():k()||ea()},12E4)}function k(){var a=new Date,b=!1;f.get("date")!=a.getDay()&&(jQuery("#form-list").empty(),f.set("notified",
!1),TASK_DB.dropTaskTable(),TASK_DB.createDB(),jQuery("#todayDate").html("Date: "+ia(a.getMonth())+" "+a.getDate()),f.set("date",a.getDay()),b=!0);O();return b}function l(){var a=f.get("view");void 0==a||"current"==a?W("task",function(){jQuery("#button-current").click()}):"requested"==a?W("task",function(){jQuery("#button-requested").click()}):"all"==a?jQuery("#button-all").click():"team"==a?jQuery("#button-team").click():"role"==a?jQuery("#button-role").click():"recent"==a&&jQuery("#button-recent").click()}
function oa(){if(""==f.get("access")&&!f.get("notified")){f.set("notified",!0);var b='<h3><div style="text-align: center; font-weight: bold;">Expired for '+f.get("host")+'</div></h3><div class="content"><div><p>To keep the ease of tracking your time, see due dates, and completing your tasks, please visit our site below to see licencing options for your company or to arrange an extended demo. If seeing this for the first time, another employee at your company has used this service 30 days ago, please contact info@atappstore.com to extend.</p></div><a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank"><img src="icons/AtAppStore.png" style=""></a><div style="font-size: 10px;">* this notification will only appear once daily.</div></div><div id="close" class="btn btn-primary" style="width:230px"><h3 style="line-height:0px">close</h3></div>';
TASK_CNTRL.showWindow(b);jQuery("#close").unbind("click").click(function(a){a.preventDefault();TASK_CNTRL.hideWindow()});f.get("userObj");f.get("license_expiry_days");a();d()}}function ba(){var a=jQuery("#content");a.after('<form id="form-qrlogin" class="form" style="display: none"><h3>Login to Workfront</h3><span class="error"></span><p><div id="outdiv" style="text-align:center;"></div><canvas id="qr-canvas" width="640" height="480" style="display:none;"></canvas><h4 id="result" style="text-align:center;"></h4><button type="submit" class="btn btn-success needsclick" style="display:none;" id="button-appscan" value="scan" tabindex="3">Scan</button><button type="submit" class="btn needsclick" style="" id="button-standard" tabindex="5">Standard Login</button><button type="submit" class="btn btn-primary needsclick" style="display:none;" id="button-qrlogin" value="login" tabindex="4">Login</button></form><div class="spinner-bottom"><div id="blockG_1" class="metro_blockG"></div><div id="blockG_2" class="metro_blockG"></div><div id="blockG_3" class="metro_blockG"></div></div>');
jQuery("#button-standard").live("click",function(a){a.preventDefault();ha();jQuery("#form-qrlogin").show()});jQuery("#button-appscan").live("click",function(a){a.preventDefault();a=window.navigator.userAgent;a.match(/iPad/i)||a.match(/iPhone/i)?window.location="zxing://scan/?ret="+encodeURIComponent(window.location+"&code={CODE}"):window.location="http://zxing.appspot.com/scan?ret="+encodeURIComponent(window.location+"&code={CODE}")});a.after('<form id="form-login" class="form" style="display: none"><h3>Login to Workfront</h3><span class="error"></span><p><label for="username">Username</label><input type="text" name="username" id="username" class="text" tabindex="1"/></p><p><label for="password">Password</label><input type="password" name="password" id="password" class="text" tabindex="2" autocomplete="off"/></p><p><label for="host">Subdomain</label><input type="text" name="host" id="host" class="text" tabindex="3"/></p><p>eg. <strong>Subdomain</strong>.attask-ondemand.com</p></p></br><button type="submit" class="btn btn-primary needsclick" id="button-login" value="login" tabindex="4">Login</button><div class="spinner-bottom"><div id="blockG_1" class="metro_blockG"></div><div id="blockG_2" class="metro_blockG"></div><div id="blockG_3" class="metro_blockG"></div></div></form>');
a='<div id="hourTypeWindow" class="window"><h3><div style="text-align: center; font-weight: bold;">Track as Type:</div></h3><div class="content"><div><select id="hourTypeSelector" ></select><div><a href="#" id="done_hourType" class="btn btn-primary" rel="'+jQuery(this).attr("rel")+'" title="Done">Done</a><div></div>';jQuery("#window").after(a);if(x||"full"==getQueryString("view")||h)jQuery("#popout").replaceWith('<span id="refresh" style="float: right;" title="Manual Refresh"><img src="core/img/refresh.gif"></span>'),
jQuery("html").css("width","100%"),jQuery("#refresh").live("click",function(a){a.preventDefault();jQuery("#form-list").hide();jQuery("#search-bar").is(":visible")&&jQuery("#search").click();ea()});a=new Date;a='<div class="btn-group"><a id="filter" title="Filter for other assigned tasks and issues" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">Filters<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="#" id="button-current" title="Tasks and issues you\'re working on" >Current</a></li><li><a href="#" id="button-recent" title="All tasks and issues tracked within 14 days" >Recent</a></li><li><a href="#" id="button-requested" title="Tasks and issues you can start on" >Requested</a></li><li><a href="#" id="button-all" title="All tasks and issues assigned to you" >All Assigned</a></li><li><a href="#" id="button-team" title="All tasks and issues assigned to your Teams" >Team Assigned</a></li><li><a href="#" id="button-role" title="All tasks and issues available to your Roles" >Role Assigned</a></li><li><a href="#" class="logout" id="button-logout" >Login as New User</a></li></ul></div><span id="totalHours" title="Go To Timesheets" class="btn" style="">Today\'s Hours: 0</span><span id="todayDate" class="btn disabled" style="">Date: '+
ia(a.getMonth())+" "+a.getDate()+"</span>";jQuery("#bar").html(a);jQuery("#totalHours").live("click",function(a){a.preventDefault();a="https://"+f.get("host")+"."+f.get("domain")+"/timesheets/current";h?window.open(a,"_blank","location=yes"):window.open(a);return!1});jQuery("#sort-task").live("click",function(a){a.preventDefault();P.priority="asc";P.project=P.date=P.priority="desc";P.task="asc"==P.task?"desc":"asc";jQuery("div#form-list>div").tsort({order:P.task})});jQuery("#sort-project").live("click",
function(a){a.preventDefault();P.priority="asc";P.task=P.date=P.priority="desc";P.project="asc"==P.project?"desc":"asc";jQuery("div#form-list>div").tsort(".details",{order:P.project})});jQuery("#sort-date").live("click",function(a){a.preventDefault();P.priority="asc";P.task=P.project="desc";P.date="asc"==P.date?"desc":"asc";jQuery("div#form-list>div").tsort(".days",{order:P.date,useVal:!0,attr:"data-days"})});jQuery("#sort-priority").live("click",function(a){a.preventDefault();P.task=P.project=P.date=
"desc";P.priority="asc"==P.priority?"desc":"asc";jQuery("div#form-list>div").tsort(".priority",{order:P.priority,useVal:!0,attr:"data-priority"})});jQuery(".done").live("click",function(a){a.preventDefault();a=jQuery(this).parent().parent().children("span.name").attr("title");var b=jQuery(this).parent().parent().children("span.details").attr("title");a='<h3><div style="text-align: center; font-weight: bold;">Confirm</div></h3><div class="content"><div><p>Are you sure you completed <strong>'+a+"</strong><br>from <br><strong>"+
b+'?</strong></h3><div><a href="#" id="done_confirm" class="btn btn-primary" rel="'+jQuery(this).attr("rel")+'" title="Done">Done</a><a href="#" class="btn cancel" title="Cancel">Cancel</a><div>';TASK_CNTRL.showWindow(a)});jQuery("#done_confirm").live("click",function(a){a.preventDefault();TASK_DB.updateValidate(jQuery(this).attr("rel"),function(a){U(a)});TASK_CNTRL.hideWindow()});jQuery("#cancel_confirm").live("click",function(a){a.preventDefault();TASK_CNTRL.hideWindow()});jQuery(".percent").live("click",
function(a){a.preventDefault();jQuery("#form-list").scrollTop(jQuery("#form-list").scrollTop()+jQuery("#item"+jQuery(this).attr("rel")).offset().top-100);if(0==jQuery(this).children("input").length){var b=jQuery(this).text().slice(0,-1);jQuery(this).html("<input type='number' class='inputbox' value=\""+b+'">');var c=function(a){var c=Number(jQuery(a).val()).toFixed(0);isNaN(c)||0>c||100<c||b==c?c=b:TASK_DB.updateValidate(jQuery(a).parent().attr("rel"),function(a){D(a,c)});jQuery(a).parent().text(c+
"%")};jQuery("input.inputbox").focus().blur(function(){c(this)}).keypress(function(a){13==a.which&&(c(this),a.preventDefault())})}});jQuery("#form-list").scroll(function(){f.set("vpos",jQuery("#form-list").scrollTop())});A=jQuery(".spinner-bottom");w=jQuery(".spinner")}function pa(){var a=function(a){jQuery("#button-current").removeClass("btn");jQuery("#button-requested").removeClass("btn");jQuery("#button-all").removeClass("btn");jQuery("#button-team").removeClass("btn");jQuery("#button-role").removeClass("btn");
jQuery("#button-recent").removeClass("btn");ua();jQuery(a).toggleClass("btn")};jQuery("#button-current").live("click",function(){P=[];a("#button-current");f.set("view","current");ta()});jQuery("#button-requested").live("click",function(){P=[];a("#button-requested");f.set("view","requested");la()});jQuery("#button-all").live("click",function(){P=[];a("#button-all");f.set("view","all");W()});jQuery("#button-team").live("click",function(){P=[];a("#button-team");f.set("view","team");ja()});jQuery("#button-role").live("click",
function(){P=[];a("#button-role");f.set("view","role");ra()});jQuery("#button-recent").live("click",function(){P=[];a("#button-recent");f.set("view","recent");ka()});jQuery(".logout").live("click",function(){T()})}function T(){if(na&&f.get("allowOffline"))f.remove("sessionID"),f.remove("userID"),f.remove("username"),f.remove("password"),f.remove("host"),f.remove("domain");else{var a=f.get("qr");f.removeAll();f.set("qr",a)}for(var b in TASK_CNTRL.intervals)window.clearInterval(TASK_CNTRL.intervals[b]);
s()}function ga(a){TASK_DB.loadAll(function(b){var c=b.length,d,e;if(0<c)for(d=0;d<c;d++)e=b[d],(null!=e&&"OPTASK"==e.details.objCode||"TASK"==e.details.objCode)&&jQuery("#item"+e.ID).hide();a()})}function F(a){aa(f.get("username"),f.get("password"),V(f.get("host")+"."+f.get("domain")),a,function(){s(a)})}function s(a){f.get("qr")?L(a):f.get("ent")?m(a):ha(a)}function m(a){w.show();jQuery("#loading").hide();clearInterval(M);TASK_DB.dropTaskTable();TASK_DB.createDB();TASK_CNTRL.toggleRunText();w.hide();
A.hide();jQuery("#top-bar").hide();jQuery("#bar").hide();jQuery(".form").hide();O(function(){ca();void 0!=a&&a()})}function L(a){w.show();jQuery("#loading").hide();clearInterval(M);TASK_DB.dropTaskTable();TASK_DB.createDB();TASK_CNTRL.toggleRunText();resetForQR();w.hide();A.hide();jQuery("#top-bar").hide();jQuery("#bar").hide();jQuery(".form").hide();jQuery("webcamimg").show();var b=jQuery("#form-qrlogin");jQuery("#form-list").html("");h?b.show():b.slideDown(400,function(){});jQuery("#button-qrlogin").unbind("click").click(function(b){var c=
jQuery("#form-qrlogin");b.preventDefault();A.show();aa(f.get("username"),f.get("password"),V(f.get("host")),function(){ignoreForQR();jQuery("#bar").show();h?c.hide():c.slideUp();jQuery("#top-bar").show();jQuery("#loading").show();void 0!=a&&a()},function(){resetForQR()})})}function ha(a){w.show();jQuery("#loading").hide();clearInterval(M);TASK_DB.dropTaskTable();TASK_DB.createDB();TASK_CNTRL.toggleRunText();w.hide();A.hide();jQuery("#top-bar").hide();jQuery("#bar").hide();jQuery(".form").hide();var b=
jQuery("#form-login"),c=f.get("domain"),d=f.get("host");b.find(":input[name='username']").focus().val("");b.find(":input[name='host']").val(void 0==d||"undefined"==d?"":"attask-ondemand.com"!=c?d+"."+c:d);b.find(":input[name='password']").val("");jQuery("#form-list").html("");var e=jQuery("#username");h?(b.show(),e.focus()):b.slideDown(400,function(){e.focus()});jQuery("#button-login").unbind("click").click(function(c){c.preventDefault();A.show();aa(jQuery.trim(b.find(":input[name='username']").val()),
jQuery.trim(b.find(":input[name='password']").val()),V(jQuery.trim(b.find(":input[name='host']").val())),function(){jQuery("#bar").show();h?b.hide():b.slideUp();jQuery("#top-bar").show();jQuery("#loading").show();void 0!=a&&a()})})}function Z(a,b){var c=new Date;a.dateStr=c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate();a.duration=b;na&&f.get("allowOffline")?(a.username=f.get("username"),a.userID=f.get("userID"),c=f.get("offlineTasks"),void 0==c&&(c=[]),c.push(a),f.set("offlineTasks"),w.hide(),
A.hide(),!0==f.get("logout_on_select")&&T()):C(a,va)}function ia(a){return"jan. feb. mar. apr. may june jul. aug. sep. oct. nov. dec.".split(" ")[a]}function S(a){return void 0!=a.details.project?a.details.project.name.split(",").join(" ")+","+a.name.split(",").join(" "):a.details}function z(a,b){void 0==b&&(b=1E4);a.timeout=b;x&&(!h&&!Y)&&(a.dataType="jsonp",a.crossDomain=!0,a.jsonp="jsonp",a.cache=!0);var c=f.get("sessionID");f.get("ent")?a.data.apiKey=c:a.data.sessionID=c}function V(a){if(1<a.split(".").length){var b=
a.split("//");return 1<b.length?(b.shift(),b[0]):a}return a+".attask-ondemand.com"}function aa(a,b,d,t,k){if(void 0==a||void 0==b||void 0==d)k();else{var l=jQuery(".error");l.html("");var h={url:"https://"+d+"/attask/api/v2.0/login",type:"get",data:{username:a,password:b},dataType:"json"};z(h);na?f.get("allowOffline")?(h=f.get(a),void 0!=h?(X(h.sessionID,h.userID,h.username,h.password,d),A.hide(),ea(),c(),void 0!=t&&t()):l.html("OFFLINE")):l.html("OFFLINE"):(h=jQuery.ajax(h),h.done(function(h){void 0!=
h.error?(f.get("qr")?l.html("Please Scan Again."):l.html(h.error.message),A.hide(),void 0!==k&&k()):(h=h.data,X(h.sessionID,h.userID,a,b,d),f.set("userObj",JSON.stringify(h)),A.hide(),e(function(){ea();c();void 0!=t&&t()}))}),h.fail(function(a,b,c){a.responseText&&""!==a.responseText?-1!=a.responseText.indexOf("<html>")?f.get("qr")?l.html("Please Scan Again."):l.html("Host Invalid: "+d):f.get("qr")?l.html("Please Scan Again."):l.html(JSON.parse(a.responseText).error.message):f.get("qr")?l.html("Please Scan Again."):
l.html("Host Invalid: "+d);A.hide();void 0!==k&&k()}))}}function X(a,b,c,d,e){f.set("sessionID",a);f.set("userID",b);f.set("username",c);f.set("password",d);e=e.split(".");f.set("host",e[0]);e.shift();f.set("domain",e.join("."));f.get("allowOffline")&&f.set(c,{sessionID:a,userID:b,username:c,password:d})}function O(a){var b=f.get("sessionID");void 0==b||""==b?F(a):(w.show(),b={url:J()+"user/"+f.get("userID"),data:{updates:"{isActive: true}"},type:"PUT",dataType:"json"},x&&(b.type="GET",b.data.method=
"PUT",z(b)),b=jQuery.ajax(b),b.done(function(b){void 0!=b.error?(b.error["class"]==B[0]?F(a):(f.get("sessionID"),JSON.stringify(b.error)),w.hide(),A.hide()):(w.hide(),A.hide(),c(),!f.get("ent")&&void 0==f.get("auth_key")?e(ea):ea(),void 0!=a&&a())}),b.fail(function(b,c,d){401==b.status?F(a):"timeout"==c?O(a):f.get("sessionID")}))}function ea(){w.show();var a=f.get("userID"),c={url:"https://"+f.get("host")+"."+f.get("domain")+"/attask/api-internal/timeSheet/search",type:"get",data:{startDate:"$$TODAY+1",
startDate_Mod:"lte",endDate:"$$TODAY-1",endDate_Mod:"gte",fields:"timesheetProfile:hourTypes:ID,timesheetProfile:hourTypes:name,timesheetProfile:hourTypes:description,timesheetProfile:hourTypes:isActive",userID:a},dataType:"json"};z(c,35E3);na?f.get("allowOffline")?(a=TASK_DB.userRunningTasks(a),void 0!=a&&(R=!0,TASK_DB.insert(a.name,{syncID:a.syncID,details:a.details},!0))):TASK_CNTRL.displayError("OFFLINE"):(a=jQuery.ajax(c),a.done(function(a){if(void 0!=a.error)a.error["class"]==B[0]?F(function(){ea()}):
b(v[0],"addGeneralTasks-done,"+JSON.stringify(a.error));else if(a=a.data,0!=a.length&&void 0!=a[0].timesheetProfile&&void 0!=a[0].timesheetProfile.hourTypes){if(0!=a[0].timesheetProfile.hourTypes.length){var c=0;a=a[0].timesheetProfile.hourTypes;for(var g in a)a.hasOwnProperty(g)&&!0==a[g].isActive&&(c++,TASK_DB.insert(a[g].name,{syncID:a[g].ID,details:{objCode:"GEN",description:null!=a[g].description?"General - "+a[g].description:"'General"}},0))}l();da();qa()}else Q()}),a.fail(function(a,b,g){r({response:a.responseText,
type:b,msg:g,status:a.status},ea,"addGeneralTasks-fail"+b+"-"+g+" "+a.responseText+" "+a.status+" "+JSON.stringify(c))}))}function ca(){var a={url:J()+"hourType/",data:{name:"Stopwatch",objCode:"HOURT",appGlobalID:"1",countAsRevenue:!0,customerID:null,description:"Hours recorded through stopwatch",descriptionKey:null,extRefID:null,isActive:!0,nameKey:null,objID:"1",objObjCode:"APGLOB",overheadType:0,scope:"G",method:"post"},type:"GET",dataType:"json"};z(a);var c=jQuery.ajax(a);c.done(function(a){void 0!=
a.error?a.error["class"]==B[0]?F(function(){ca()}):b(v[0],"addStopwatchHourType,"+JSON.stringify(a.error)):void 0!=a.data.ID&&f.set("swHourTypeID",a.data.ID)});c.fail(function(b,c,d){r({response:b.responseText,type:c,msg:d,status:b.status},ca,"addStopwatchHourType-fail"+c+"-"+d+" "+b.responseText+" "+b.status+" "+JSON.stringify(a))})}function Q(){w.show();var a={url:J()+"HourType/search",type:"get",data:{fields:"ID,name,description",isActive:!0},dataType:"json"};z(a,35E3);var c=jQuery.ajax(a);c.done(function(a){if(void 0!=
a.error)a.error["class"]==B[0]?F(function(){Q()}):b(v[0],"addAllGeneralTasks-done,"+JSON.stringify(a.error));else{a=a.data;var c=0,g;for(g in a)a.hasOwnProperty(g)&&("Task Time"!=a[g].name&&"Issue Time"!=a[g].name)&&(c++,TASK_DB.insert(a[g].name,{syncID:a[g].ID,details:{objCode:"GEN",description:null!=a[g].description?"General - "+a[g].description:"'General"}},0));l();da();qa()}});c.fail(function(b,c,d){r({response:b.responseText,type:c,msg:d,status:b.status},Q,"addAllGeneralTasks-fail"+c+"-"+d+" "+
b.responseText+" "+b.status+" "+JSON.stringify(a))})}function r(a,c,d,e){if(401==a.status)F(function(){c()});else if("timeout"==a.type)c();else{if(void 0!=a.response&&""!=a.response){var f;f="message"in a.response?a.response.message:JSON.stringify(a.response);TASK_CNTRL.displayError("Workfront Error: "+f+"<br>"+(void 0!=e&&""!=e?e:""))}b(v[0],d+","+a.msg+" "+a.type+" "+JSON.stringify(a.response)+" "+e)}}function J(a){void 0==a&&(a="v7.0");return"https://"+f.get("host")+"."+f.get("domain")+"/attask/api/"+
a+"/"}function W(a,c){a=void 0==a?"task":a;w.show();var d={url:J()+a+"/search",type:"get",data:{canStart:!0,status:"N",status_Mod:"contains","project:status":"CUR",fields:"parent,priority,project,plannedCompletionDate,permissions","assignments:status":"DN","assignments:status_Mod":"ne",$$LIMIT:2E3},dataType:"json"},e=f.get("currentRole");"role"==f.get("view")&&void 0!=e?d.data.roleID=e.ID:d.data["assignments:assignedToID"]=f.get("userID");"task"==a&&(d.data.fields+=",percentComplete");z(d);d=jQuery.ajax(d);
d.done(function(d){if(void 0!=d.error)d.error["class"]==B[0]?F(function(){W(a,c)}):b(v[0],"addAllAssignedTasks-"+a+","+JSON.stringify(d.error)),w.hide(),A.hide();else{d=d.data;var e=!0,u=f.get("view");"all"!=u&&"role"!=u&&(e=!1);if("optask"!=a)W("optask",c),ga(function(){var a=d.length;if(a)for(var b=0;b<a;b++)-1!=d[b].permissions.actions.indexOf("ADD_HOURS")&&-1!=d[b].permissions.actions.indexOf("CHANGE_STATUS")&&TASK_DB.insert(d[b].name,{syncID:d[b].ID,details:d[b]},e&&b==a-1)});else{u=d.length;
R=e;if(u)for(var t=0;t<u;t++)-1!=d[t].permissions.actions.indexOf("ADD_HOURS")&&-1!=d[t].permissions.actions.indexOf("CHANGE_STATUS")&&TASK_DB.insert(d[t].name,{syncID:d[t].ID,details:d[t]},e&&t==u-1);else TASK_CNTRL.showAll(d);c&&c()}}});d.fail(function(a,b,c){r({response:a.responseText,type:b,msg:c},W,"addAllAssignedTasks-fail"+b+"-"+c+" "+a.responseText)})}function ra(a){w.show();var c={url:J("v5.0")+"user/search",type:"get",data:{fields:"role:*,roles:*",ID:f.get("userID")},dataType:"json"};z(c);
c=jQuery.ajax(c);c.done(function(c){if(void 0!=c.error)c.error["class"]==B[0]?F(function(){ra(a)}):b(v[0],"addAllRoleTasks,"+JSON.stringify(c.error)),w.hide(),A.hide();else if(c=c.data[0],0==c.length)a&&a(),w.hide(),A.hide();else{var d=jQuery("#role-filter"),e=function(){W("task",function(){d.css("display","inline-block");w.hide();A.hide()})},n=function(a,b){f.set("currentRole",{name:a,ID:b});d.find("button").html("<strong>Role: </strong><span>"+a+'</span><span class="caret"></span>');e()},l=f.get("currentRole");
void 0!=l?n(l.name,l.ID):void 0!=c.role&&n(c.role.name,c.role.ID);if(void 0!=c.roles&&0!=c.roles.length)for(var l=d.find(".dropdown-menu").html("").first(),k=0,h=c.roles.length;k<h;k++)l.append('<li><a href="#" id="'+c.roles[k].ID+'">'+c.roles[k].name+"</a></li>"),l.find("#"+c.roles[k].ID).click(function(){n(jQuery(this).text(),jQuery(this).attr("id"))});else ua(),w.hide(),A.hide(),jQuery("#button-current").click(),TASK_CNTRL.showWindow('<h3><div style="text-align: center; font-weight: bold;">Roles</div></h3><div class="content"><div><p>No additional roles available.</strong></h3><div><a href="#" class="btn btn-primary cancel" title="Ok">Ok</a><div>')}});
c.fail(function(a,b,c){r({response:a.responseText,type:b,msg:c},ra,"addAllRoleTasks")})}function ua(){var a=jQuery("#role-filter");a.hide();a.find(".dropdown-menu").first().html("")}function ja(a){w.show();var c={url:J()+"team/search",type:"get",data:{fields:"ID","users:ID":f.get("userID")},dataType:"json"};z(c);c=jQuery.ajax(c);c.done(function(c){void 0!=c.error?(c.error["class"]==B[0]?F(function(){ja(a)}):b(v[0],"addAllGroupTasks,"+JSON.stringify(c.error)),w.hide(),A.hide()):(c=c.data,0==c.length?
(a?a():jQuery("#form-list").hide(),w.hide(),A.hide(),TASK_CNTRL.showNoTaskWindow()):ga(function(){for(var b=c.length,d=function(c,d){if(0==--b){var e=y.length;R=!0;if(0==e)TASK_CNTRL.showAll(y);else{for(var n=0;n<e;n++)TASK_DB.insert(y[n].name,{syncID:y[n].ID,details:y[n]},n==e-1);y=[];a&&a()}}},e=0;e<b;e++)sa("task",c[e].ID,d)}))});c.fail(function(a,b,c){r({response:a.responseText,type:b,msg:c},ja,"addAllGroupTasks")})}function sa(a,c,d){a=void 0==a?"task":a;w.show();var e={url:J()+a+"/search?project:status=INF",
type:"get",data:{canStart:!0,status:"N",status_Mod:"contains","project:status":"CUR",fields:"parent,priority,project,plannedCompletionDate",$$LIMIT:1E3,"team:ID":c},dataType:"json"};"task"==a&&(e.data.fields+=",percentComplete");z(e);e=jQuery.ajax(e);e.done(function(e){if(void 0!=e.error)e.error["class"]==B[0]?F(function(){sa(a,c,d)}):b(v[0],"addGroupTasks-"+a+","+JSON.stringify(e.error)),w.hide(),A.hide();else if(e=e.data,0==e.length)d&&d(a,c);else if("optask"!=a){sa("optask",c,d);for(var f=e.length,
l=0;l<f;l++)y.push(e[l])}else{f=e.length;for(l=0;l<f;l++)y.push(e[l]);d&&d(a,c)}});e.fail(function(a,b,c){r({response:a.responseText,type:b,msg:c},sa,"addGroupTasks-fail"+b+"-"+c+" "+a.responseText)})}function ka(){w.show();var a={url:J()+"hour/report",type:"get",data:{"task:canStart":!0,taskID_1_GroupBy:!0,entryDate:"$$TODAY-14d",entryDate_Range:"$$TODAY",entryDate_Mod:"between"},dataType:"json"};z(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==B[0]?F(function(){ka()}):
b(v[0],"addRecentTasks,"+JSON.stringify(a.error)),w.hide(),A.hide()):(a=Object.keys(a.data),0==a.length?(R=!0,ga(function(){TASK_CNTRL.showAll(a)})):ga(function(){R=!0;TASK_CNTRL.showAll(TASK_CNTRL.taskDB.loadSyncIds(a))}))});a.fail(function(a,b,c){r({response:a.responseText,type:b,msg:c},ka,"addRecentTasks")})}function ta(){w.show();var a={url:J()+"work/myWork",type:"get",data:{fields:"parent,priority,project,plannedCompletionDate"},dataType:"json"};z(a);a=jQuery.ajax(a);a.done(function(a){void 0!=
a.error?(a.error["class"]==B[0]?F(function(){ta()}):b(v[0],"addCurrentTasks,"+JSON.stringify(a.error)),w.hide(),A.hide()):(a=a.data,0==a.length?(R=!0,ga(function(){TASK_CNTRL.showAll(a)})):ga(function(){var b=a.length;R=!0;for(var c=0;c<b;c++)TASK_DB.insert(a[c].name,{syncID:a[c].ID,details:a[c]},c==b-1)}))});a.fail(function(a,b,c){r({response:a.responseText,type:b,msg:c},ta,"addCurrentTasks")})}function la(){w.show();var a={url:J()+"work/workRequests",type:"get",data:{canStart:!0,fields:"parent,priority,project,plannedCompletionDate"},
dataType:"json"};z(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==B[0]?F(function(){la()}):b(v[0],"addRequestedTasks,"+JSON.stringify(a.error)),w.hide(),A.hide()):(a=a.data,0==a.length?(R=!0,ga(function(){TASK_CNTRL.showAll(a)})):ga(function(){var b=a.length;R=!0;for(var c=0;c<b;c++)TASK_DB.insert(a[c].name,{syncID:a[c].ID,details:a[c]},c==b-1)}))});a.fail(function(a,b,c){r({response:a.responseText,type:b,msg:c},la,"addRequestedTasks")})}function qa(){var a={url:J()+"user/search",
data:{"hourTypes:isActive":!0,fields:"hourTypes:ID,hourTypes:name,hourTypes:description,hourTypes:countAsRevenue",ID:f.get("userID")},type:"get",dataType:"json"};z(a);I=!1;a=jQuery.ajax(a);a.done(function(a){if(void 0!=a.error)a.error["class"]==B[0]?F(function(){}):b(v[0],"getHourTypes,"+JSON.stringify(a.error)),w.hide(),A.hide();else if(a=a.data,void 0!=a&&0!=a.length&&0!=a[0].hourTypes.length){I=!0;var c=jQuery("#hourTypeSelector");c.text("");c.append(jQuery("<option />").val(null).text("Task Time"));
jQuery.each(a[0].hourTypes,function(){c.append($("<option />").val(this.ID).text(this.name))})}});a.fail(function(a,b,c){401==a.status?F(function(){}):"timeout"==b&&qa()})}function N(a,b){TASK_CNTRL.showWindow(null,"#hourTypeWindow");jQuery("#done_hourType").unbind("click").bind("click",function(c){c.preventDefault();a.hourTypeID=jQuery("#hourTypeSelector").find(":selected").val();b(a);TASK_CNTRL.hideWindow("#hourTypeWindow")})}function q(a){var c=f.get("todaySched");null!=c?a(c):(c={url:J("v4.0")+
"user/search?ID=$$USER.ID&fields=schedule:*,schedule:nonWorkDays:*",type:"get",data:{},dataType:"json"},z(c),c=jQuery.ajax(c),c.done(function(c){if(void 0!=c.error)c.error["class"]==B[0]?F(function(){}):b(v[0],"getSchedule,"+JSON.stringify(c.error)),w.hide(),A.hide();else if(c=c.data[0].schedule,0!=c.length){var d=new Date,e=c["sunday monday tuesday wednesday thursday friday saturday".split(" ")[d.getDay()]],n;if(!0==c.hasNonWorkDays){for(var l=0;l<c.nonWorkDays.length;l++)if(c.nonWorkDays[l].nonWorkDate==
d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate()&&(void 0!=n&&null!=c.nonWorkDays[l].userID||void 0==n))n=c.nonWorkDays[l].scheduleDay;void 0!=n&&(e=n)}void 0!=e&&0!=e.length&&(e={start:e[0],stop:e[1]},f.set("todaySched",e));a&&a(e)}}),c.fail(function(b,c,d){401==b.status?F(function(){}):"timeout"==c&&q(a)}))}function da(){var a=new Date,a={url:J()+"hour/report?hours_AggFunc=sum",type:"get",data:{entryDate:a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate(),ownerID:f.get("userID")},dataType:"json"};
z(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==B[0]?F(function(){}):b(v[0],"getTodaysTotalHours,"+JSON.stringify(a.error)),w.hide(),A.hide()):(a=a.data,jQuery("#totalHours").html("Today's Hours: "+(null==a.sum_hours?"0":a.sum_hours.toFixed(2))))});a.fail(function(a,b,c){401==a.status?F(function(){}):"timeout"==b&&da()})}function U(a){w.show();var c={assignedToID:f.get("userID")};"OPTASK"==a.details.objCode?c.opTaskID=a.syncID:c.taskID=a.syncID;c={url:J()+"assignment/search",
type:"get",data:c,dataType:"json"};z(c);c=jQuery.ajax(c);c.done(function(c){void 0!=c.error?(c.error["class"]==B[0]?F(function(){U(a)}):b(v[0],"getTaskAssignment,"+a.syncID+","+JSON.stringify(c.error)),w.hide(),A.hide()):(c=c.data[0],a.running?(a.done=1,TASK_CNTRL.stopTask(a),TASK_CNTRL.toggleRunText()):G(c,a))});c.fail(function(c,b,d){r({response:c.responseText,type:b,msg:d},function(){U(a)},"getTaskAssignment,"+a.syncID)})}function G(a,c){w.show();var d={url:J()+"assignment/"+a.ID,data:{status:"DN"},
type:"PUT",dataType:"json"};x&&(d.data={method:"put"},z(d));d=jQuery.ajax(d);d.done(function(d){void 0!=d.error?(d.error["class"]==B[0]?F(function(){G(a,c)}):b(v[0],"setAssignmentDone,"+a.ID+","+JSON.stringify(d.error)),w.hide(),A.hide()):(TASK_DB.remove(c.ID),w.hide(),A.hide(),b(v[2],S(c)+",assignment done"),K(c))});d.fail(function(b,d,e){r({response:b.responseText,type:d,msg:e},function(){G(a,c)},"setAssignmentDone,"+a.ID+", "+b.responseText)})}function K(a){w.show();var c={url:J()+"assignment/count",
data:{status:"DN",status_Mod:"ne"},type:"GET",dataType:"json"};"OPTASK"==a.details.objCode?c.data.opTaskID=a.syncID:c.data.taskID=a.syncID;z(c);c=jQuery.ajax(c);c.done(function(c){void 0!=c.error?(c.error["class"]==B[0]?F(function(){K(a)}):b(v[0],"getTaskDoneAssignmentCount,"+taskID+","+JSON.stringify(c.error)),w.hide(),A.hide()):(c=c.data,w.hide(),A.hide(),0==c.count&&fa(a))});c.fail(function(c,b,d){r({response:c.responseText,type:b,msg:d},function(){K(a)},"getTaskDoneAssignmentCount,"+a.syncID)})}
function fa(a){var c=a.syncID;w.show();var d="OPTASK"==a.details.objCode?"CLS":"CPL",d={url:J()+a.details.objCode.toLowerCase()+"/"+c,data:{status:d},type:"PUT",dataType:"json"};x&&(d.data={method:"put"},z(d));d=jQuery.ajax(d);d.done(function(d){void 0!=d.error?(d.error["class"]==B[0]?F(function(){fa(a)}):r({response:d.error,type:null,msg:null},function(){fa(a)},"setTaskDone,"+c),w.hide(),A.hide()):(w.hide(),A.hide(),b(v[2],S(a)+",task done"))});d.fail(function(b,d,e){r({response:b.responseText,type:d,
msg:e},function(){fa(a)},"setTaskDone,"+c+", "+b.responseText)})}function E(a){w.show();var c={url:J()+a.details.objCode.toLowerCase()+"/"+a.syncID,data:{status:"INP"},type:"PUT",dataType:"json"};x&&(c.data={method:"put"},z(c));c=jQuery.ajax(c);c.done(function(c){void 0!=c.error?(c.error["class"]==B[0]?F(function(){E(a)}):r({response:c.error,type:null,msg:null},function(){E(a)},"setTaskInProgress,"+a.syncID),w.hide(),A.hide()):(w.hide(),A.hide(),!0==f.get("logout_on_select")&&T())});c.fail(function(c,
b,d){r({response:c.responseText,type:b,msg:d},function(){E(a)},"setTaskInProgress-fail,"+a.syncID+", "+c.responseText)})}function D(a,c){w.show();var b={url:J()+a.details.objCode.toLowerCase()+"/"+a.syncID,data:{updates:"{ percentComplete: "+c+"}"},type:"PUT",dataType:"json"};x&&(b.data={method:"put"},z(b));b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?b.error["class"]==B[0]?F(function(){D(a,c)}):r({response:b.error,type:null,msg:null},function(){D(a,c)},"setTaskPercent,"+a.syncID):(a.details.percentComplete=
c,TASK_DB.updateDetails(a.ID,a.details));w.hide();A.hide()});b.fail(function(b,d,e){r({response:b.responseText,type:d,msg:e},function(){D(a,c)},"setTaskPercent-fail,"+a.syncID+", "+b.responseText)})}function va(a,c){var d,e={ownerID:f.get("userID")};void 0==c||-1!=c.permissions.actions.indexOf("ADD_HOURS")&&-1!=c.permissions.actions.indexOf("CHANGE_STATUS")?(d=0,e.method="post"):(d=c.hours,e.method="put",e.ID=c.ID);if("GEN"==a.details.objCode)e.hourTypeID=a.syncID,e.ID=null,e.projectID=null,e.taskID=
null,e.opTaskID=null;else if("OPTASK"==a.details.objCode?e.opTaskID=a.syncID:e.taskID=a.syncID,void 0!=(e.hourTypeID=f.get("swHourTypeID"))&&void 0!=a.hourTypeID&&""!=a.hourTypeID)e.hourTypeID=a.hourTypeID;isNaN(d)&&(d=0);e.entryDate=a.dateStr;var l=Number((a.duration/3600).toFixed(2));f.get("nearestHour")&&(l=Math.round(l));e.hours=parseFloat((l+parseFloat((""+d).split(".").join("."))+" ").split(".").join("."));e.ownerID=f.get("userID");b(v[1],"setHourAttask, oldhr: "+d+" method: "+e.method+" start: "+
a.dateStr+" task: "+JSON.stringify(a)+" sid: "+f.get("sessionID")+" time: "+(new Date).toTimeString());var k=function(){w.show();var c={url:J("v5.0")+"hour/",type:"get",data:e,dataType:"json"};z(c);c=jQuery.ajax(c);c.done(function(c){void 0!=c.error?(c.error["class"]==B[0]?F(function(){k()}):(r({response:c.error,type:null,msg:null},k,"setHourAttask,"+a.syncID+" "+a.name+" url: "+J()+" "+JSON.stringify(e)+" "+S(a)+","+a.duration,'Time was not tracked, please click on "View" for task: '+a.name+" to record time manually."),
C(a)),w.hide(),A.hide()):(da(),void 0!=e.taskID||void 0!=e.opTaskID?E(a):!0==f.get("logout_on_select")&&T(),w.hide(),A.hide(),b(v[2],S(a)),a.done&&U(a))});c.fail(function(c,b,d){r({response:c.responseText,type:b,msg:d},k,"setHourAttask-fail,"+a.syncID+" "+a.name+" url: "+J()+" "+JSON.stringify(e)+" "+S(a)+","+a.duration+", "+c.responseText+", "+d,c.responseText+'<br>Time was not tracked, please click on "View" for task: '+a.name+" to record time manually.");C(a)})};k()}function C(a,c){var d={};d.entryDate=
a.dateStr;d.fields="permissions,ID,hours";d.ownerID=f.get("userID");"GEN"==a.details.objCode?(d.hourTypeID=a.syncID,d.projectID=null,d.taskID=null,d.opTaskID=null):("OPTASK"==a.details.objCode?d.opTaskID=a.syncID:d.taskID=a.syncID,void 0!=a.hourTypeID&&""!=a.hourTypeID&&(d.hourTypeID=a.hourTypeID));d={url:J()+"hour/search",type:"get",data:d,dataType:"json"};z(d);d=jQuery.ajax(d);d.done(function(d){if(void 0!=d.error)d.error["class"]==B[0]?F(function(){C(a,c)}):b(v[0],"getHour,"+a.syncID+","+JSON.stringify(d.error)),
w.hide(),A.hide();else if(b(v[1],"getHour "+d.data.length+" "+JSON.stringify(d.data)),c){for(var e=d.data.length,f=0;f<e;f++)if(-1!=d.data[f].permissions.actions.indexOf("ADD_HOURS")&&-1!=d.data[f].permissions.actions.indexOf("CHANGE_STATUS")){c(a,d.data[f]);return}c(a,d.data[0])}});d.fail(function(a,c,b){JSON.stringify(b)})}var B=["com.attask.common.AuthenticationException"],v=["error","debug","informational"],f,x=!(window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows")),h=-1===
document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")&&x,Y=-1!==document.URL.indexOf("dashboard.directory"),I=!1,na=!1,y=[];f=!x||h?new Store("Attask"):{settings:[],set:function(a,c){switch(a){case "domain":case "host":case "userID":case "sessionID":case "username":case "date":case "view":this.setCookie(a,c,9999999999)}this.settings[a]=c},get:function(a){switch(a){case "domain":case "host":case "userID":case "sessionID":case "username":case "date":case "view":var c=void 0===this.settings[a]?
this.getCookie(a):this.settings[a];this.settings[a]=c;return"undefined"==c||void 0==c?void 0:c;default:return!this.settings.hasOwnProperty(a)||"undefined"==this.settings[a]||void 0==this.settings[a]?void 0:this.settings[a]}},removeAll:function(){var a=new Date,c;for(c in this.settings)this.settings.hasOwnProperty(c)&&(document.cookie=c+"="+this.settings[c]+";expires="+a.toGMTString()+";;");this.settings=[]},setCookie:function(a,c,b){var d=new Date;d.setHours(0);d.setMinutes(0);d.setSeconds(0);d.setDate(d.getDate()+
b);c=encodeURI(c)+(null==b?"":"; expires="+d.toUTCString());document.cookie=a+"="+c},getCookie:function(a){var c,b,d,e=document.cookie.split(";");for(c=0;c<e.length;c++)if(b=e[c].substr(0,e[c].indexOf("=")),d=e[c].substr(e[c].indexOf("=")+1),b=b.replace(/^\s+|\s+$/g,""),b==a)return decodeURI(d);return"undefined"}};var M;OB.init.add(function(){void 0==f.get("qr")&&f.set("qr","true"==jQuery.urlParam("qr")||!1!=jQuery.urlParam("code"));ba();pa();c();var a=jQuery.urlParam("s"),b=jQuery.urlParam("d");
0!=b&&0!=a&&(f.set("sessionID",a),a=b.split("."),f.set("host",a[0]),a.shift(),f.set("domain",a.join(".")),void 0==f.get("ent")&&(f.set("userID",jQuery.urlParam("u")),f.set("ent",f.get("sessionID")&&f.get("userID")),f.get("is_auth",f.get("ent"))));k();!0==f.get("qr")&&void 0==f.get("sessionID")&&(!1!=jQuery.urlParam("code")?(document.getElementById("button-appscan").style.display="block",qrRead(jQuery.urlParam("code"),f)):qrLoad(f))});OB.onLoad.add(function(){document.addEventListener("resume",function(){jQuery("#loading").show();
k()||c()},!1);document.addEventListener("pause",function(){jQuery("#form-list").html("")},!1);document.addEventListener("menubutton",function(){TASK_CNTRL.showWindow('<h3><div style="text-align: center; font-weight: bold;">Welcome</div></h3><div class="content"><p>If you have any questions please visit <a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank" class="btn" >store.atappstore.com</a></p><a href="#" class="btn btn-primary cancel" title="Done">Done</a></div>')},
!1);document.addEventListener("offline",function(a){na=!0});document.addEventListener("online",function(a){a=f.get("offlineTasks");JSON.stringify(a);f.set("offlineTasks",[]);na=!1})});OB.stop.add(function(a,c){w.show();var b,d;b=new Date(a.start);d=new Date;if(f.get("minuteBufferSnapToSched")){var e=f.get("todaySched"),l=f.get("minuteBuffer"),k=d.toLocaleDateString("en-US"),h=Date.parse(k+e.start),e=Date.parse(k+e.stop),k=new Date(h);b<h&&b>k.setMinutes(k.getMinutes()-l)&&(b=new Date(h));k=new Date(e);
d>e&&d<k.setMinutes(k.getMinutes()+l)&&(d=new Date(e));if(b>=d){w.hide();return}c=Math.floor((d.getTime()-b.getTime())/1E3)}0==c?w.hide():I?N(a,function(a){Z(a,c)}):Z(a,c)});OB.update.add(function(a,c){A.show();Z(a,c)});OB.preStart.add(function(a){a.running?TASK_CNTRL.toggleTimer(a):function(){TASK_DB.loadAll(function(c){var b,d,e=!1,l=c.length;for(b=0;b<l;b++)if(d=c[b],null!=d&&d.running&&a.ID!=d.ID){TASK_CNTRL.toggleTimer(d);e=!0;break}TASK_CNTRL.toggleTimer(a);!e&&!0==f.get("logout_on_select")&&
T()})}()});OB.postAllItemRender.add(function(){jQuery(".remove").css("display","none");jQuery(".update").css("display","none");jQuery(".reset").css("display","none");f.get("is_auth")?jQuery("#storelink").text("AtAppStore"):(jQuery("#sort-date").remove(),jQuery(".timer").remove(),jQuery(".done").remove(),jQuery(".percent").remove(),jQuery(".date").removeClass("date").addClass("date-tall").html('<a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank">Trial Expired</a>'),
jQuery("#storelink").text("Trial Expired - AtAppStore"));if(R){var a=jQuery("#form-list"),c=f.get("vpos");void 0!=c&&a.scrollTop(c);"team"==f.get("view")&&!0==f.get("hide_team_done")&&jQuery(".done").remove();na?f.get("allowOffline")&&(jQuery(".done").remove(),jQuery(".percent").remove(),jQuery(".view").remove(),jQuery("#bar").hide()):jQuery("#bar").show();c=f.get("sort");void 0==c&&(c="date");jQuery("#sort-"+c).click();jQuery("#search-bar").is(":visible")&&jQuery("#search").click();jQuery("#loading").hide();
a.show();a=jQuery("#holder")[0];a.style.display="none";a.style.display="block";w.hide();R=!1}});OB.postItemRender.add(function(a){if(0==jQuery("#item"+a.ID+" #buttons .view").length){var c=jQuery("#item"+a.ID+" #buttons"),b=["",{label:"Low",css:"default"},{label:"Normal",css:"success"},{label:"High",css:"warning"},{label:"Urgent",css:"danger"}];"GEN"!=a.details.objCode&&(void 0!=a.details.priority&&0!=a.details.priority)&&(b=b[a.details.priority],c.append('<span class="task priority '+b.css+'" title="'+
b.label+'" data-priority="'+a.details.priority+'">'+b.label[0]+"</span> "));var d;"GEN"==a.details.objCode?(d="General",jQuery("#item"+a.ID).css({background:"aliceblue"})):"OPTASK"==a.details.objCode?(d="Issue",c.append('<span class="issue" title="Issue">I</span> ')):"TASK"==a.details.objCode&&(d="Task",c.append('<span class="task" title="Task">T</span> '));"General"!=d&&(c.append('<a href="https://'+f.get("host")+"."+f.get("domain")+"/"+d.toLowerCase()+"/view?ID="+a.syncID+'" target="_blank" class="btn btn-mini view" rel="'+
a.ID+'" title="View '+d+'">View</a> '),c.append('<a href="#" class="btn btn-mini done" rel="'+a.ID+'" title="Done '+d+'">Done</a> '));"Task"==d&&void 0!=a.details.percentComplete&&c.append('<a href="#" class="btn btn-mini percent" rel="'+a.ID+'" title="Percent Completed">'+a.details.percentComplete+"%</a> ");c="#D2E0FF";b='<span class="date" style="background-color: #EEE;"></span>';if("General"!=d&&void 0!=a.details.plannedCompletionDate){var b=a.details.plannedCompletionDate.split("T")[0],b=b.split("-"),
b=new Date(b[0],Number(b[1])-1,b[2]),e=new Date;e.setHours(0);e.setMinutes(0);e.setSeconds(0);e=Math.round((b-e)/1E3/60/60/24);0>e?c="#FFCDCD":1>=e&&(c="#FFD7AB");var l;l=0<e?"days due: "+e:"days late: "+Math.abs(e);b='<div class="date" style="background-color: '+c+';"><div class="days" data-days="'+e+'">'+l+"</div><div>"+ia(b.getMonth())+" "+b.getDate()+", "+b.getFullYear()+"</div></div>"}c="";null!=a.details.parent&&(c="<br><br>Parent Task: <br>"+a.details.parent.name);jQuery("#item"+a.ID+" .name").attr("title",
d+": <br>"+a.name+c);"General"!=d?(d=a.details.project.name,jQuery("#item"+a.ID+" .details").html(d).attr("title","Project: <br>"+d).attr("data-priority",a.details.priority),jQuery("#item"+a.ID+" .c6").after(b)):jQuery("#item"+a.ID+" .details").html("~"+a.details.description).attr("title",a.details.description)}});OB.remove.add(function(a){jQuery("#item"+a).remove()});OB.reset.add(function(a,c){OB.update.dispatch(c,-c.time);jQuery("#item"+a+" .timer").text(TASK_CNTRL.hms(0))});var R=!1,A,w,P=[]}();function taskController(e){var a,d=window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows"),b=-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")&&!d;jQuery.urlParam=function(a){a=RegExp("[\\?&]"+a+"=([^&#]*)").exec(window.location.href);return!a?0:a[1]||0};OB.start.add(function(a){startNotify(a)});OB.stop.add(function(a){stopNotify(a)});OB.onLoad.add(function(){});OB.postAllItemRender.add(function(){b&&(jQuery("#form-list").height(0),a=124);if(!d||"full"==
getQueryString("view")){var c=function(){var c=jQuery("#form-list"),b;b=c.height();b+=window.innerHeight-a;0!=window.innerHeight-a&&c.height(b);a=window.innerHeight};jQuery(window).unbind("resize");jQuery(window).bind("resize",c);c()}c={style:{tip:{corner:!0,width:5,height:5},def:!1,classes:"qtip-info"},position:{adjust:{method:"flip flip"},at:"bottom left",my:"top left",viewport:jQuery(window)},show:{},hide:{delay:0}};jQuery("span[title]").qtip(c);b||jQuery("a[title]").qtip(c);c.content="time < 30 seconds<br> time was not tracked";
c.show.event=!1;c.hide.delay=b?0:2E3;var e=jQuery(".timer");e.qtip(c);b||e.mouseover(function(){var a=jQuery(this).find(".time").hide(),c=jQuery(this).find(".timer-info").show();setTimeout(function(){a.show();c.hide()},3E3)}).mouseout(function(){jQuery(this).find(".time").show();jQuery(this).find(".timer-info").hide()});b&&(jQuery(".item").css("padding-right","5px"),jQuery(".task").css("padding-right","5px").css("padding-left","5px"),jQuery(".issue").css("padding-right","5px").css("padding-left",
"5px"),jQuery("body").css("font-size","12px"));jQuery("#searchfor").domsearch("#form-list",{unit:"div.item:visible",criteria:["span[oldtitle]"]})});return{intervals:[],taskDB:e,init:function(){this.bind();this.toggleRunText();var c=jQuery("#form-list");!d||"full"==getQueryString("view")?(c.css("max-height","100%"),c.css("height","439px")):c.css("max-height","439px");!d&&(window.webkitNotifications&&0!=window.webkitNotifications.checkPermission())&&window.open("core/js/permission.html","Permission",
"height=540,width=447");a=567},bind:function(){b&&jQuery("a[target='_blank']").live("click",function(a){a.preventDefault();window.open(jQuery(this).attr("href"),"_blank","location=yes");return!1});jQuery("#cover").hide();jQuery(".cancel").live("click",function(a){a.preventDefault();jQuery("#"+jQuery(this).attr("rel")).hide().hide().find("input:text").val("");jQuery("#form-list").show();jQuery("#top-bar").show();jQuery("#bar").show()});jQuery("#search").live("click",function(a){a.preventDefault();
jQuery("#sort-bar").toggle();jQuery("#search-bar").toggle();jQuery("#searchfor").focus().val("").domsearchClear()});jQuery("#popout").live("click",function(a){a.preventDefault();d&&window.chrome.windows.create({url:"index.html?view=full",type:"popup",width:393,height:600})});jQuery("#create").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#form-create").slideDown().find("input[name='task-name']").focus()});var a=this;jQuery("#button-create").live("click",function(){a.taskDB.insert(jQuery("#form-create :input[name='task-name']").val());
jQuery("#form-create").hide().find("input:text").val("")});jQuery("#task-name").keydown(function(b){13==b.keyCode&&(a.taskDB.insert(jQuery("#form-create :input[name='task-name']").val()),jQuery("#form-create").hide().find("input:text").val(""))});jQuery(".remove").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#button-remove").attr("rel",jQuery(this).attr("rel"));jQuery("#remove-confirm").html("Are you sure? You want to <strong>delete "+jQuery(this).attr("title")+"</strong>?");
jQuery("#form-remove").show()});jQuery("#button-remove").live("click",function(){jQuery("#form-remove").hide();a.taskDB.remove(jQuery(this).attr("rel"))});jQuery("#remove-all").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#form-remove-all").slideDown()});jQuery("#button-remove-all").live("click",function(){jQuery("#form-remove-all").hide();a.taskDB.removeall()});jQuery(".update").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#top-bar").hide();
jQuery("#bar").hide();a=jQuery(this).attr("rel");this.taskDB.updateValidate(a,this.update)});jQuery("#button-update").live("click",function(){jQuery("#form-update").hide();jQuery("#top-bar").show();jQuery("#bar").show();var b=jQuery("#form-update :input[name='task-id']").val(),d=jQuery("#form-update :input[name='task-name']").val(),e=jQuery("#form-update :input[name='task-time']").val();a.taskDB.update(b,d,e)});jQuery(".cancel").live("click",function(b){b.preventDefault();a.hideWindow()});jQuery(".reset").live("click",
function(b){b.preventDefault();b=jQuery(this).attr("rel");a.taskDB.reset(b)});var e=function(b){b.preventDefault();a.taskDB.updateValidate(jQuery(this).attr("rel"),function(a){OB.preStart.dispatch(a)});return!1};jQuery(".timer").live("click",e);jQuery("#running").click(e);jQuery("#holder").show()},displayError:function(a){this.showWindow('<h3><div style="text-align: center; font-weight: bold;">Error</div></h3><div class="content"><p>'+a+'</p><a href="#" id="cancel_confirm" class="btn btn-primary" title="Done">Done</a></div>')},
showWindow:function(a,d){d=void 0==d?"#window":d;null!=a&&jQuery(d).html(a);b?(jQuery("#cover").css("height","100%").css("opacity","0.8").show(),jQuery(d).animate({top:60+window.pageYOffset+"px"},{easing:"easeInCubic",duration:400,complete:function(){}})):jQuery("#cover").css("height","100%").show().animate({opacity:"0.8"},400,function(){jQuery(d).animate({top:60+window.pageYOffset+"px"},{easing:"easeInCubic",duration:400,complete:function(){}})})},hideWindow:function(a){a=void 0==a?"#window":a;b?
jQuery(a).animate({top:"-700px"},{easing:"easeOutCubic",duration:400,complete:function(){jQuery("#cover").hide()}}):jQuery(a).animate({top:"-700px"},{easing:"easeOutCubic",duration:400,complete:function(){jQuery("#cover").animate({opacity:"0"},{duration:400,complete:function(){jQuery("#cover").hide()}})}})},update:function(a){jQuery("#form-update :input[name='task-id']").val(a.ID);jQuery("#form-update :input[name='task-name']").val(a.name);jQuery("#form-update :input[name='task-time']").val(this.hms(a.time));
jQuery("#form-update").slideDown()},truncateString:function(a){return a},showTask:function(a){var b,d="";b=jQuery("#item"+a.ID);0!=b.length?b.show():(d+='<div class="item'+(a.running?" running":"")+'" id="item'+a.ID+'" rel="'+a.ID+'">',d=d+'<div class="c3">'+('<span class="name c1" title="Task: <br>'+a.name+'" ><strong>'+this.truncateString(a.name)+"</strong></span><br>"),d+='<span class="details" title="'+a.details+'" >'+this.truncateString(a.details)+"</span><br>",d+='<span id="buttons"><a href="#" class="btn btn-mini update" rel="'+
a.ID+'" title="Edit: '+a.name+'">Edit</a> ',d+='<a href="#" class="btn btn-mini reset" rel="'+a.ID+'" title="Reset: '+a.name+'">Reset</a> ',d+='<a href="#" class="btn btn-mini remove" rel="'+a.ID+'" title="Delete: '+a.name+'">Delete</a></span>',d+="</div>",d+='<div class="c8"><div class="c6">',a.running?(b=new Date(a.start),b=Number(a.time)+Math.floor(((new Date).getTime()-b.getTime())/1E3),d+='<a href="#" class="btn timer btn-primary" rel="'+a.ID+'"><span class="time">'+this.hms(b)+"</span>"):d+=
'<a href="#" class="btn timer" rel="'+a.ID+'"><span class="time">'+this.hms(a.time)+"</span>",d+='<span class="timer-info" style="display: none;">'+(a.running?"Stop":"Start")+"</span></a>",d+="</div>",d+="</div></div>",a.running&&(this.startTask(a),this.toggleRunText()),jQuery("#form-list").append(d),OB.postItemRender.dispatch(a))},showAll:function(a){var b,d=a.length;if(0!=d)for(b=0;b<d;b++)this.showTask(a[b]);0==jQuery(".item").length&&this.showNoTaskWindow();OB.postAllItemRender.dispatch()},showNoTaskWindow:function(){this.showWindow('<h3><div style="text-align: center; font-weight: bold;">No Tasks</div></h3><div class="content"><p>Please assign a task to yourself.</p><a href="#" id="cancel_confirm" class="btn btn-primary cancel" title="Done">Done</a></div>')},
toggleTimer:function(a){jQuery("#item"+a.ID+" .timer").toggleClass("btn-primary");a.running?this.stopTask(a):this.startTask(a);this.toggleRunText()},startTask:function(a){var b=this;window.clearInterval(b.intervals[a.ID]);var d=new Date;a.running?d=new Date(a.start):this.taskDB.start(a.ID,d);jQuery("#item"+a.ID+" .timer .timer-info").text("Stop");b.intervals[a.ID]=window.setInterval(function(){var e=Number(a.time)+Math.floor(((new Date).getTime()-d.getTime())/1E3);jQuery("#item"+a.ID+" .timer .time").text(b.hms(e))},
500)},stopTask:function(a){window.clearInterval(this.intervals[a.ID]);var b,d=Number(a.time);b=new Date(a.start);b=Math.floor(((new Date).getTime()-b.getTime())/1E3);30>b?(jQuery("#item"+a.ID+" .timer").qtip("show"),b=0):60>b&&29<b&&(b=60);d+=b;this.taskDB.stop(a.ID,d,b,a.done);jQuery("#item"+a.ID+" .timer .time").text(this.hms(d));jQuery("#item"+a.ID+" .timer .timer-info").text("Start")},toggleRunText:function(){this.taskDB.running(function(a){d?window.chrome.browserAction.setBadgeText({text:"RUN"}):
document.title="Stopwatch - Running: "+a.name;jQuery("#running").text("Running: "+a.name).attr("rel",a.ID).show();jQuery("#storelink").hide()},function(a){0==a&&(d?window.chrome.browserAction.setBadgeText({text:""}):document.title="Stopwatch",jQuery("#running").hide(),jQuery("#storelink").show())})},hms:function(a){a=[0,0,a];var b;for(b=2;0<b;b--)a[b-1]=Math.floor(a[b]/60),a[b]%=60,10>a[b]&&(a[b]="0"+a[b]);return a.join(":")},sec:function(a){a=String(a).split(":");return Number(parseFloat(3600*a[0])+
60*parseFloat(a[1])+parseFloat(a[2]))}}}var QUERY_LOOKUP=null;function getQueryString(e){if(null==QUERY_LOOKUP){var a=location.search.substring(1),d=/([^&=]+)=([^&]*)/g,b;for(QUERY_LOOKUP={};b=d.exec(a);)QUERY_LOOKUP[decodeURIComponent(b[1])]=decodeURIComponent(b[2])}return"foo"in QUERY_LOOKUP?QUERY_LOOKUP[e]:null};function taskDB(){return{dm:[],lastId:0,sql:function(e,a,d,b,c,k){},init:function(){this.createDB();return this},onError:function(e){},createDB:function(){this.dm=[];this.lastId=0},dropTaskTable:function(){this.createDB()},start:function(e,a){this.dm[e].running=1;this.dm[e].start=a;OB.start.dispatch(this.dm[e])},stop:function(e,a,d,b){this.dm[e].running=0;this.dm[e].done=b;this.dm[e].time=Number(a);OB.stop.dispatch(this.dm[e],Number(d))},running:function(e,a){for(var d in this.dm)if(null!=this.dm[d]&&
this.dm[d].running){e(this.dm[d]);return}a()},insert:function(e,a,d){var b="null",c="";void 0!=a&&(void 0!=a.syncID&&(b=a.syncID),void 0!=a.details&&(c=a.details));if("null"!=b){a=!1;for(var k in this.dm)if(null!=this.dm[k]&&this.dm[k].syncID==b){a=!0;break}a||(k=this.nextID(),this.dm[k]={ID:k,syncID:b,name:e,details:c,time:0,start:new Date,running:0,done:0},OB.insert.dispatch(e,{syncID:b,details:c}));TASK_CNTRL.showTask(this.dm[k]);d&&OB.postAllItemRender.dispatch()}},nextID:function(){return this.lastId++},
updateValidate:function(e,a){null!=this.dm[e]&&a(this.dm[e])},update:function(e,a,d){d=TASK_CNTRL.sec(d);var b;null!=this.dm[e]&&(this.dm[e].name=a,b=this.dm[e].time,this.dm[e].time=d);OB.update.dispatch(this.dm[e],d-b)},updateDetails:function(e,a){null!=this.dm[e]&&(this.dm[e].details=a)},remove:function(e){this.dm[e]=null;window.clearInterval(TASK_CNTRL.intervals[e]);OB.remove.dispatch(e)},removeall:function(){this.createDB();for(var e in TASK_CNTRL.intervals)window.clearInterval(TASK_CNTRL.intervals[e]);
OB.removeall.dispatch()},reset:function(e){null!=this.dm[e]&&(OB.reset.dispatch(e,this.dm[e]),this.dm[e].time=0)},loadAll:function(e){e(this.dm)}}.init()};function taskDBls(){return{ls:null,ps:null,userId:null,sql:function(e,a,d,b,c,k){},init:function(){this.ps=new Store("AttaskPersistModel");this.ls=new Store("AttaskModel");null==this.ls.get("list")&&this.createDB();return this},onError:function(e){},createDB:function(){this.ls.set("lastId",0);this.ls.set("list",[])},dropTaskTable:function(){this.ls.removeAll()},userRunningTasks:function(e){return p.ps.get(e+""+p.ps.get(e))},start:function(e,a){var d=this.ls.get(e);null!=d&&void 0!=d&&(d.running=1,
d.start=a,this.ls.set(e,d),null!=this.userId&&(this.ps.set(this.userId+""+d.syncID,d),this.ps.set(this.userId,d.syncID)),OB.start.dispatch(d))},stop:function(e,a,d,b){var c=this.ls.get(e);null!=c&&void 0!=c&&(c.running=0,c.done=b,c.time=Number(a),this.ls.set(e,c),null!=this.userId&&(this.ps.remove(this.userId+""+c.syncID),this.ps.remove(this.userId)),OB.stop.dispatch(c,Number(d)))},running:function(e,a){var d=this.ls.get("list"),b,c=0,k;for(k in d)d.hasOwnProperty(k)&&(b=this.ls.get(k),null!=b&&(void 0!=
b&&b.running)&&(e(b),c++));a(c)},getAllRunning:function(){return this.ps.toObject()},insert:function(e,a,d){var b=this,c="null",k="";void 0!=a&&(void 0!=a.syncID&&(c=a.syncID),void 0!=a.details&&(k=a.details));a=function(a,c,d,e){var k=b.nextID(),l={ID:k,syncID:a,name:c,details:d,time:0,start:new Date,running:0};if(null!=b.userId){var L=b.ps.get(b.userId+""+a);null!=L&&L.running&&(l=L)}b.ls.set(k,l);L=b.ls.get("list");L[k]=a;b.ls.set("list",L);OB.insert.dispatch(c,{syncID:a,details:d});TASK_CNTRL.showTask(l);
e&&OB.postAllItemRender.dispatch()};if("null"!=c){var l=b.ls.get("list"),oa=!1,ba;for(ba in l)if(l.hasOwnProperty(ba)&&null!=l[ba]&&l[ba]==c){oa=!0;break}oa?(TASK_CNTRL.showTask(b.ls.get(ba)),d&&OB.postAllItemRender.dispatch()):a(c,e,k,d)}else a(c,e,k,d)},nextID:function(){var e=this.ls.get("lastId");e++;this.ls.set("lastId",e);return e},updateValidate:function(e,a){var d=this.ls.get(e);null!=d&&void 0!=d&&a(d)},update:function(e,a,d){d=TASK_CNTRL.sec(d);e=this.ls.get(e);null!=e&&void 0!=e&&(e.name=
a,a=e.time,e.time=d,OB.update.dispatch(e,d-a))},updateDetails:function(e,a){var d=this.ls.get(e);null!=d&&void 0!=d&&(d.details=a)},remove:function(e){var a=this.ls.get("list");a[e]=null;this.ls.set("list",a);this.ls.remove(e);window.clearInterval(TASK_CNTRL.intervals[e]);OB.remove.dispatch(e)},removeall:function(){this.createDB();for(var e=TASK_CNTRL.intervals.length,a=0;a<e;a++)window.clearInterval(TASK_CNTRL.intervals[a]);OB.removeall.dispatch()},reset:function(e){var a=this.ls.get(e);null!=a&&
void 0!=a&&(OB.reset.dispatch(e,a),a.time=0,this.ls.set(e,a))},loadAll:function(e){var a=this.ls.get("list"),d=[],b,c;for(c in a)a.hasOwnProperty(c)&&(b=this.ls.get(c),null!=b&&void 0!=b&&d.push(b));e(d)},loadSyncIds:function(e){for(var a=this.ls.get("list"),d=[],b,c=e.length,k=0;k<c;k++)b=a.indexOf(e[k]),-1!=b&&(b=this.ls.get(b),null!=b&&void 0!=b&&d.push(b));return d}}.init()};var TASK_DB;TASK_DB=window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows")||-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")?taskDBls():lscheck()?taskDBls():taskDB();var TASK_CNTRL=taskController(TASK_DB);jQuery(function(){TASK_CNTRL.init();OB.init.dispatch()});function onLoad(){OB.onLoad.dispatch()}function lscheck(){try{return localStorage.setItem("stopwatch","stopwatch"),localStorage.removeItem("stopwatch"),!0}catch(e){return!1}};var interval,notifyWorkIntervalTime=30;function startNotify(e){interval=setInterval(function(){notifyWorking(e)},6E4*notifyWorkIntervalTime)}function stopNotify(){clearInterval(interval)}function notifyWorking(e){if(window.webkitNotifications){var a=webkitNotifications.createNotification("../icons/timer48x48.png","Still working on Task:",e.name+"\n"+e.details.split(", Due:")[0]);a.show();setTimeout(function(){a.cancel()},7E3)}else stopNotify()}
function notifyFriday(){var e=webkitNotifications.createNotification("icons/timer48x48.png","Remember: Submit Timesheet!","");e.show();setTimeout(function(){e.cancel()},7E3)};
