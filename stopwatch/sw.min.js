(function(d){function a(b,a,c,d,f){this._listener=a;this._isOnce=c;this.context=d;this._signal=b;this._priority=f||0}function f(b,a){if("function"!==typeof b)throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",a));}function b(){this._bindings=[];this._prevParams=null;var a=this;this.dispatch=function(){b.prototype.dispatch.apply(a,arguments)}}a.prototype={active:!0,params:null,execute:function(b){var a;this.active&&this._listener&&(b=this.params?this.params.concat(b):
b,a=this._listener.apply(this.context,b),this._isOnce&&this.detach());return a},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal;delete this._listener;delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+
", isBound:"+this.isBound()+", active:"+this.active+"]"}};b.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(b,c,d,f){var qa=this._indexOfListener(b,d);if(-1!==qa){if(b=this._bindings[qa],b.isOnce()!==c)throw Error("You cannot add"+(c?"":"Once")+"() then add"+(!c?"":"Once")+"() the same listener without removing the relationship first.");}else b=new a(this,b,c,d,f),this._addBinding(b);this.memorize&&this._prevParams&&b.execute(this._prevParams);return b},
_addBinding:function(b){var a=this._bindings.length;do--a;while(this._bindings[a]&&b._priority<=this._bindings[a]._priority);this._bindings.splice(a+1,0,b)},_indexOfListener:function(b,a){for(var c=this._bindings.length,d;c--;)if(d=this._bindings[c],d._listener===b&&d.context===a)return c;return-1},has:function(b,a){return-1!==this._indexOfListener(b,a)},add:function(b,a,c){f(b,"add");return this._registerListener(b,!1,a,c)},addOnce:function(b,a,c){f(b,"addOnce");return this._registerListener(b,!0,
a,c)},remove:function(b,a){f(b,"remove");var c=this._indexOfListener(b,a);-1!==c&&(this._bindings[c]._destroy(),this._bindings.splice(c,1));return b},removeAll:function(){for(var b=this._bindings.length;b--;)this._bindings[b]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(b){if(this.active){var a=Array.prototype.slice.call(arguments),c=this._bindings.length,d;this.memorize&&(this._prevParams=
a);if(c){d=this._bindings.slice();this._shouldPropagate=!0;do c--;while(d[c]&&this._shouldPropagate&&!1!==d[c].execute(a))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll();delete this._bindings;delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var c=b;c.Signal=b;"function"===typeof define&&define.amd?define(function(){return c}):"undefined"!==typeof module&&module.exports?module.exports=c:d.signals=
c})(this);var OB={updateAtInterval:new signals.Signal,start:new signals.Signal,stop:new signals.Signal,preStart:new signals.Signal,preStop:new signals.Signal,insert:new signals.Signal,update:new signals.Signal,reset:new signals.Signal,remove:new signals.Signal,removeAll:new signals.Signal,init:new signals.Signal,options:new signals.Signal,postItemRender:new signals.Signal,postAllItemRender:new signals.Signal,onLoad:new signals.Signal};(function(){var d=this.Store=function(a,d){var b;this.name=a;if(void 0!==d)for(b in d)d.hasOwnProperty(b)&&void 0===this.get(b)&&this.set(b,d[b])};d.prototype.get=function(a){a="store."+this.name+"."+a;if(null!==localStorage.getItem(a))try{return JSON.parse(localStorage.getItem(a))}catch(d){return null}};d.prototype.set=function(a,d){if(void 0===d)this.remove(a);else{if("function"===typeof d)d=null;else try{d=JSON.stringify(d)}catch(b){d=null}localStorage.setItem("store."+this.name+"."+a,d)}return this};
d.prototype.remove=function(a){localStorage.removeItem("store."+this.name+"."+a);return this};d.prototype.removeAll=function(){var a,d;a="store."+this.name+".";for(d=localStorage.length-1;0<=d;d--)localStorage.key(d).substring(0,a.length)===a&&localStorage.removeItem(localStorage.key(d));return this};d.prototype.toObject=function(){var a,d,b,c,g;a={};d="store."+this.name+".";for(b=localStorage.length-1;0<=b;b--)localStorage.key(b).substring(0,d.length)===d&&(c=localStorage.key(b).substring(d.length),
g=this.get(c),void 0!==g&&(a[c]=g));return a};d.prototype.fromObject=function(a,d){!0!==d&&this.removeAll();for(var b in a)a.hasOwnProperty(b)&&this.set(b,a[b]);return this}})();(function(d){function a(b,a){for(var c=0,d=b.length;c<d;c++)if(b[c]==a)return!f;return f}var f=!1,b=parseFloat,c=Math.min,g=/(-?\d+\.?\d*)$/g,h=[],pa=[];d.tinysort={id:"TinySort",version:"1.4.29",copyright:"Copyright (c) 2008-2012 Ron Valstar",uri:"http://tinysort.sjeiti.com/",licensed:{MIT:"http://www.opensource.org/licenses/mit-license.php",GPL:"http://www.gnu.org/licenses/gpl.html"},plugin:function(b,a){h.push(b);pa.push(a)},defaults:{order:"asc",attr:null,data:null,useVal:f,place:"start",returns:f,
cases:f,forceStrings:f,sortFunction:null}};d.fn.extend({tinysort:function(ba,qa){ba&&"string"!=typeof ba&&(qa=ba,ba=null);var ca=d.extend({},d.tinysort.defaults,qa),ka,la=d(this).length,l={},k=!(!ba||""==ba),O=!(null===ca.attr||""==ca.attr),ga=null!==ca.data,da=k&&":"==ba[0],ha=da?this.filter(ba):this,Z=ca.sortFunction,U="asc"==ca.order?1:-1,s=[];d.each(h,function(b,a){a.call(a,ca)});Z||(Z="rand"==ca.order?function(){return 0.5>Math.random()?1:-1}:function(a,c){var k=f,h=!ca.cases?a.s&&a.s.toLowerCase?
a.s.toLowerCase():a.s:a.s,l=!ca.cases?c.s&&c.s.toLowerCase?c.s.toLowerCase():c.s:c.s;if(!ca.forceStrings){var s=h&&h.match(g),O=l&&l.match(g);if(s&&O){var Q=h.substr(0,h.length-s[0].length),S=l.substr(0,l.length-O[0].length);Q==S&&(k=!f,h=b(s[0]),l=b(O[0]))}}var T=U*(h<l?-1:h>l?1:0);d.each(pa,function(b,a){T=a.call(a,k,h,l,T)});return T});this.each(function(b,a){var c=d(a),f=k?da?ha.filter(a):c.find(ba):c,g=ga?""+f.data(ca.data):O?f.attr(ca.attr):ca.useVal?f.val():f.text(),h=c.parent();l[h]||(l[h]=
{s:[],n:[]});0<f.length?l[h].s.push({s:g,e:c,n:b}):l[h].n.push({e:c,n:b})});for(ka in l)l[ka].s.sort(Z);for(ka in l){var Z=l[ka],aa=[],T=la,Q=[0,0],oa;switch(ca.place){case "first":d.each(Z.s,function(b,a){T=c(T,a.n)});break;case "org":d.each(Z.s,function(b,a){aa.push(a.n)});break;case "end":T=Z.n.length;break;default:T=0}for(oa=0;oa<la;oa++){var W=a(aa,oa)?!f:oa>=T&&oa<T+Z.s.length,S=(W?Z.s:Z.n)[Q[W?0:1]].e;S.parent().append(S);(W||!ca.returns)&&s.push(S.get(0));Q[W?0:1]++}}this.length=0;Array.prototype.push.apply(this,
s);return this}});d.fn.TinySort=d.fn.Tinysort=d.fn.tsort=d.fn.tinysort})(jQuery);Array.prototype.indexOf||(Array.prototype.indexOf=function(d,a){var f=this.length,b=Number(a)||0,b=0>b?Math.ceil(b):Math.floor(b);for(0>b&&(b+=f);b<f;b++)if(b in this&&this[b]===d)return b;return-1});jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(d,a,f,b,c){return jQuery.easing[jQuery.easing.def](d,a,f,b,c)},easeInQuad:function(d,a,f,b,c){return b*(a/=c)*a+f},easeOutQuad:function(d,a,f,b,c){return-b*(a/=c)*(a-2)+f},easeInOutQuad:function(d,a,f,b,c){return 1>(a/=c/2)?b/2*a*a+f:-b/2*(--a*(a-2)-1)+f},easeInCubic:function(d,a,f,b,c){return b*(a/=c)*a*a+f},easeOutCubic:function(d,a,f,b,c){return b*((a=a/c-1)*a*a+1)+f},easeInOutCubic:function(d,a,f,b,c){return 1>(a/=c/2)?b/2*a*a*a+f:
b/2*((a-=2)*a*a+2)+f},easeInQuart:function(d,a,f,b,c){return b*(a/=c)*a*a*a+f},easeOutQuart:function(d,a,f,b,c){return-b*((a=a/c-1)*a*a*a-1)+f},easeInOutQuart:function(d,a,f,b,c){return 1>(a/=c/2)?b/2*a*a*a*a+f:-b/2*((a-=2)*a*a*a-2)+f},easeInQuint:function(d,a,f,b,c){return b*(a/=c)*a*a*a*a+f},easeOutQuint:function(d,a,f,b,c){return b*((a=a/c-1)*a*a*a*a+1)+f},easeInOutQuint:function(d,a,f,b,c){return 1>(a/=c/2)?b/2*a*a*a*a*a+f:b/2*((a-=2)*a*a*a*a+2)+f},easeInSine:function(d,a,f,b,c){return-b*Math.cos(a/
c*(Math.PI/2))+b+f},easeOutSine:function(d,a,f,b,c){return b*Math.sin(a/c*(Math.PI/2))+f},easeInOutSine:function(d,a,f,b,c){return-b/2*(Math.cos(Math.PI*a/c)-1)+f},easeInExpo:function(d,a,f,b,c){return 0==a?f:b*Math.pow(2,10*(a/c-1))+f},easeOutExpo:function(d,a,f,b,c){return a==c?f+b:b*(-Math.pow(2,-10*a/c)+1)+f},easeInOutExpo:function(d,a,f,b,c){return 0==a?f:a==c?f+b:1>(a/=c/2)?b/2*Math.pow(2,10*(a-1))+f:b/2*(-Math.pow(2,-10*--a)+2)+f},easeInCirc:function(d,a,f,b,c){return-b*(Math.sqrt(1-(a/=c)*
a)-1)+f},easeOutCirc:function(d,a,f,b,c){return b*Math.sqrt(1-(a=a/c-1)*a)+f},easeInOutCirc:function(d,a,f,b,c){return 1>(a/=c/2)?-b/2*(Math.sqrt(1-a*a)-1)+f:b/2*(Math.sqrt(1-(a-=2)*a)+1)+f},easeInElastic:function(d,a,f,b,c){d=1.70158;var g=0,h=b;if(0==a)return f;if(1==(a/=c))return f+b;g||(g=0.3*c);h<Math.abs(b)?(h=b,d=g/4):d=g/(2*Math.PI)*Math.asin(b/h);return-(h*Math.pow(2,10*(a-=1))*Math.sin((a*c-d)*2*Math.PI/g))+f},easeOutElastic:function(d,a,f,b,c){d=1.70158;var g=0,h=b;if(0==a)return f;if(1==
(a/=c))return f+b;g||(g=0.3*c);h<Math.abs(b)?(h=b,d=g/4):d=g/(2*Math.PI)*Math.asin(b/h);return h*Math.pow(2,-10*a)*Math.sin((a*c-d)*2*Math.PI/g)+b+f},easeInOutElastic:function(d,a,f,b,c){d=1.70158;var g=0,h=b;if(0==a)return f;if(2==(a/=c/2))return f+b;g||(g=c*0.3*1.5);h<Math.abs(b)?(h=b,d=g/4):d=g/(2*Math.PI)*Math.asin(b/h);return 1>a?-0.5*h*Math.pow(2,10*(a-=1))*Math.sin((a*c-d)*2*Math.PI/g)+f:0.5*h*Math.pow(2,-10*(a-=1))*Math.sin((a*c-d)*2*Math.PI/g)+b+f},easeInBack:function(d,a,f,b,c,g){void 0==
g&&(g=1.70158);return b*(a/=c)*a*((g+1)*a-g)+f},easeOutBack:function(d,a,f,b,c,g){void 0==g&&(g=1.70158);return b*((a=a/c-1)*a*((g+1)*a+g)+1)+f},easeInOutBack:function(d,a,f,b,c,g){void 0==g&&(g=1.70158);return 1>(a/=c/2)?b/2*a*a*(((g*=1.525)+1)*a-g)+f:b/2*((a-=2)*a*(((g*=1.525)+1)*a+g)+2)+f},easeInBounce:function(d,a,f,b,c){return b-jQuery.easing.easeOutBounce(d,c-a,0,b,c)+f},easeOutBounce:function(d,a,f,b,c){return(a/=c)<1/2.75?b*7.5625*a*a+f:a<2/2.75?b*(7.5625*(a-=1.5/2.75)*a+0.75)+f:a<2.5/2.75?
b*(7.5625*(a-=2.25/2.75)*a+0.9375)+f:b*(7.5625*(a-=2.625/2.75)*a+0.984375)+f},easeInOutBounce:function(d,a,f,b,c){return a<c/2?0.5*jQuery.easing.easeInBounce(d,2*a,0,b,c)+f:0.5*jQuery.easing.easeOutBounce(d,2*a-c,0,b,c)+0.5*b+f}});var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(d){for(var a=0;a<d.length;a++){var f=d[a].string,b=d[a].prop;this.versionSearchString=d[a].versionSearch||d[a].identity;if(f){if(-1!=f.indexOf(d[a].subString))return d[a].identity}else if(b)return d[a].identity}},
searchVersion:function(d){var a=d.indexOf(this.versionSearchString);if(-1!=a)return parseFloat(d.substring(a+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",
identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",
identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();(function(d,a,f){(function(b){"function"==typeof define&&define.amd?define(["jquery"],b):jQuery&&!jQuery.fn.qtip&&b(jQuery)})(function(b){function c(b){ia={pageX:b.pageX,pageY:b.pageY,type:"mousemove",scrollX:d.pageXOffset||a.body.scrollLeft||a.documentElement.scrollLeft,scrollY:d.pageYOffset||a.body.scrollTop||a.documentElement.scrollTop}}function g(a){var c=function(b){return b===O||"object"!=typeof b},d=function(a){return!b.isFunction(a)&&(!a&&!a.attr||1>a.length||"object"==typeof a&&!a.jquery&&
!a.then)};if(!a||"object"!=typeof a)return k;c(a.metadata)&&(a.metadata={type:a.metadata});if("content"in a){if(c(a.content)||a.content.jquery)a.content={text:a.content};d(a.content.text||k)&&(a.content.text=k);"title"in a.content&&(c(a.content.title)&&(a.content.title={text:a.content.title}),d(a.content.title.text||k)&&(a.content.title.text=k))}return"position"in a&&c(a.position)&&(a.position={my:a.position,at:a.position}),"show"in a&&c(a.show)&&(a.show=a.show.jquery?{target:a.show}:{event:a.show}),
"hide"in a&&c(a.hide)&&(a.hide=a.hide.jquery?{target:a.hide}:{event:a.hide}),"style"in a&&c(a.style)&&(a.style={classes:a.style}),b.each(B,function(){this.sanitize&&this.sanitize(a)}),a}function h(C,q,Y,h){function G(a){var b=0,e,n=q;for(a=a.split(".");n=n[a[b++]];)b<a.length&&(e=n);return[e||q,a.pop()]}function y(a){return ra.concat("").join(a?"-"+a+" ":" ")}function ea(){var a=q.style.widget,b=w.hasClass(V);w.removeClass(V);V=a?"ui-state-disabled":"qtip-disabled";w.toggleClass(V,b);w.toggleClass("ui-helper-reset "+
y(),a).toggleClass(va,q.style.def&&!a);M.content&&M.content.toggleClass(y("content"),a);M.titlebar&&M.titlebar.toggleClass(y("header"),a);M.button&&M.button.toggleClass(I+"-icon",!a)}function D(a){M.title&&(M.titlebar.remove(),M.titlebar=M.title=M.button=O,a!==k&&e.reposition())}function u(){var a=q.content.title.button,c="string"==typeof a?a:"Close tooltip";M.button&&M.button.remove();a.jquery?M.button=a:M.button=b("<a />",{"class":"qtip-close "+(q.style.widget?"":I+"-icon"),title:c,"aria-label":c}).prepend(b("<span />",
{"class":"ui-icon ui-icon-close",html:"&times;"}));M.button.appendTo(M.titlebar||w).attr("role","button").click(function(a){return w.hasClass(V)||e.hide(a),k})}function ta(){var a=L+"-title";M.titlebar&&D();M.titlebar=b("<div />",{"class":I+"-titlebar "+(q.style.widget?y("header"):"")}).append(M.title=b("<div />",{id:a,"class":I+"-title","aria-atomic":l})).insertBefore(M.content).delegate(".qtip-close","mousedown keydown mouseup keyup mouseout",function(a){b(this).toggleClass("ui-state-active ui-state-focus",
"down"===a.type.substr(-4))}).delegate(".qtip-close","mouseover mouseout",function(a){b(this).toggleClass("ui-state-hover","mouseover"===a.type)});q.content.title.button&&u()}function z(a,c){var d=M.title;if(!e.rendered||!a)return k;b.isFunction(a)&&(a=a.call(C,N.event,e));if(a===k||!a&&""!==a)return D(k);a.jquery&&0<a.length?d.empty().append(a.css({display:"block"})):d.html(a);c!==k&&e.rendered&&0<w[0].offsetWidth&&e.reposition(N.event)}function H(a){a&&b.isFunction(a.done)&&a.done(function(a){A(a,
null,k)})}function A(a,c,d){function n(a){function n(m){m&&(delete q[m.src],clearTimeout(e.timers.img[m.src]),b(m).unbind(x));b.isEmptyObject(q)&&(c!==k&&e.reposition(N.event),a())}var d,q={};if(0===(d=m.find("img[src]:not([height]):not([width])")).length)return n();d.each(function(a,m){if(q[m.src]===f){var r=0;(function xa(){if(m.height||m.width||3<r)return n(m);r+=1;e.timers.img[m.src]=setTimeout(xa,700)})();b(m).bind("error"+x+" load"+x,function(){n(this)});q[m.src]=m}})}var m=M.content;return!e.rendered||
!a?k:(b.isFunction(a)&&(a=a.call(C,N.event,e)||""),d!==k&&H(q.content.deferred),a.jquery&&0<a.length?m.empty().append(a.css({display:"block"})):m.html(a),0>e.rendered?w.queue("fx",n):(wa=0,n(b.noop)),e)}function v(){function J(a){if(w.hasClass(V))return k;clearTimeout(e.timers.show);clearTimeout(e.timers.hide);var n=function(){e.toggle(l,a)};0<q.show.delay?e.timers.show=setTimeout(n,q.show.delay):n()}function f(a){if(w.hasClass(V)||E||wa)return k;var n=b(a.relatedTarget||a.target),c=n.closest(ja)[0]===
w[0],n=n[0]===r.show[0];clearTimeout(e.timers.show);clearTimeout(e.timers.hide);if("mouse"===m.target&&c||q.hide.fixed&&/mouse(out|leave|move)/.test(a.type)&&(c||n))try{a.preventDefault(),a.stopImmediatePropagation()}catch(K){}else 0<q.hide.delay?e.timers.hide=setTimeout(function(){e.hide(a)},q.hide.delay):e.hide(a)}function v(a){if(w.hasClass(V))return k;clearTimeout(e.timers.inactive);e.timers.inactive=setTimeout(function(){e.hide(a)},q.hide.inactive)}function n(a){e.rendered&&0<w[0].offsetWidth&&
e.reposition(a)}var m=q.position,r={show:q.show.target,hide:q.hide.target,viewport:b(m.viewport),document:b(a),body:b(a.body),window:b(d)},K=b.trim(""+q.show.event).split(" "),fa=b.trim(""+q.hide.event).split(" ");b.browser.msie&&parseInt(b.browser.version,10);w.bind("mouseenter"+x+" mouseleave"+x,function(a){var n="mouseenter"===a.type;n&&e.focus(a);w.toggleClass(ua,n)});/mouse(out|leave)/i.test(q.hide.event)&&"window"===q.hide.leave&&r.window.bind("mouseout"+x+" blur"+x,function(a){!/select|option/.test(a.target.nodeName)&&
!a.relatedTarget&&e.hide(a)});q.hide.fixed?(r.hide=r.hide.add(w),w.bind("mouseover"+x,function(){w.hasClass(V)||clearTimeout(e.timers.hide)})):/mouse(over|enter)/i.test(q.show.event)&&r.hide.bind("mouseleave"+x,function(a){clearTimeout(e.timers.show)});-1<(""+q.hide.event).indexOf("unfocus")&&m.container.closest("html").bind("mousedown"+x+" touchstart"+x,function(a){var n=b(a.target);e.rendered&&w.hasClass(V);var m=0<n.parents(ja).filter(w[0]).length;n[0]!==C[0]&&n[0]!==w[0]&&!m&&!C.has(n[0]).length&&
!n.attr("disabled")&&e.hide(a)});"number"==typeof q.hide.inactive&&(r.show.bind("qtip-"+Y+"-inactive",v),b.each(S.inactiveEvents,function(a,n){r.hide.add(M.tooltip).bind(n+x+"-inactive",v)}));b.each(fa,function(a,n){var m=b.inArray(n,K),e=b(r.hide);-1<m&&e.add(r.show).length===e.length||"unfocus"===n?(r.show.bind(n+x,function(a){0<w[0].offsetWidth?f(a):J(a)}),delete K[m]):r.hide.bind(n+x,f)});b.each(K,function(a,n){r.show.bind(n+x,J)});"number"==typeof q.hide.distance&&r.show.add(w).bind("mousemove"+
x,function(a){var n=N.origin||{},m=q.hide.distance,b=Math.abs;(b(a.pageX-n.pageX)>=m||b(a.pageY-n.pageY)>=m)&&e.hide(a)});"mouse"===m.target&&(r.show.bind("mousemove"+x,c),m.adjust.mouse&&(q.hide.event&&(w.bind("mouseleave"+x,function(a){(a.relatedTarget||a.target)!==r.show[0]&&e.hide(a)}),M.target.bind("mouseenter"+x+" mouseleave"+x,function(a){N.onTarget="mouseenter"===a.type})),r.document.bind("mousemove"+x,function(a){e.rendered&&N.onTarget&&!w.hasClass(V)&&0<w[0].offsetWidth&&e.reposition(a||
ia)})));(m.adjust.resize||r.viewport.length)&&(b.event.special.resize?r.viewport:r.window).bind("resize"+x,n);r.window.bind("scroll"+x,n)}function F(){var c=[q.show.target[0],q.hide.target[0],e.rendered&&M.tooltip[0],q.position.container[0],q.position.viewport[0],q.position.container.closest("html")[0],d,a];e.rendered?b([]).pushStack(b.grep(c,function(a){return"object"==typeof a})).unbind(x):q.show.target.unbind(x+"-create")}var e=this,L=I+"-"+Y,E=0,wa=0,w=b(),x=".qtip-"+Y,V="qtip-disabled",M,N;e.id=
Y;e.rendered=k;e.destroyed=k;e.elements=M={target:C};e.timers={img:{}};e.options=q;e.checks={};e.plugins={};e.cache=N={event:{},target:b(),disabled:k,attr:h,onTarget:k,lastClass:""};e.checks.builtin={"^id$":function(a,e,c){a=c===l?S.nextid:c;e=I+"-"+a;a!==k&&0<a.length&&!b("#"+e).length&&(w[0].id=e,M.content[0].id=e+"-content",M.title[0].id=e+"-title")},"^content.text$":function(a,b,e){A(q.content.text)},"^content.deferred$":function(a,b,e){H(q.content.deferred)},"^content.title.text$":function(a,
b,e){if(!e)return D();!M.title&&e&&ta();z(e)},"^content.title.button$":function(a,b,c){a=M.button;e.rendered&&(c?u():a.remove())},"^position.(my|at)$":function(a,b,e){"string"==typeof e&&(a[b]=new B.Corner(e))},"^position.container$":function(a,b,c){e.rendered&&w.appendTo(c)},"^show.ready$":function(){e.rendered?e.toggle(l):e.render(1)},"^style.classes$":function(a,b,e){w.attr("class",I+" qtip "+e)},"^style.width|height":function(a,b,e){w.css(b,e)},"^style.widget|content.title":ea,"^events.(render|show|move|hide|focus|blur)$":function(a,
e,c){w[(b.isFunction(c)?"":"un")+"bind"]("tooltip"+e,c)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){var a=q.position;w.attr("tracking","mouse"===a.target&&a.adjust.mouse);F();v()}};b.extend(e,{_triggerEvent:function(a,c,d){a=b.Event("tooltip"+a);return a.originalEvent=(d?b.extend({},d):O)||N.event||O,w.trigger(a,[e].concat(c||[])),!a.isDefaultPrevented()},render:function(a){if(e.rendered)return e;var c=q.content.text,d=q.content.title,n=q.position;
return b.attr(C[0],"aria-describedby",L),w=M.tooltip=b("<div/>",{id:L,"class":[I,va,q.style.classes,I+"-pos-"+q.position.my.abbrev()].join(" "),width:q.style.width||"",height:q.style.height||"",tracking:"mouse"===n.target&&n.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":k,"aria-describedby":L+"-content","aria-hidden":l}).toggleClass(V,N.disabled).data("qtip",e).appendTo(q.position.container).append(M.content=b("<div />",{"class":I+"-content",id:L+"-content","aria-atomic":l})),e.rendered=
-1,E=1,d.text?(ta(),b.isFunction(d.text)||z(d.text,k)):d.button&&u(),(!b.isFunction(c)||c.then)&&A(c,k),e.rendered=l,ea(),b.each(q.events,function(a,n){b.isFunction(n)&&w.bind("toggle"===a?"tooltipshow tooltiphide":"tooltip"+a,n)}),b.each(B,function(){"render"===this.initialize&&this(e)}),v(),w.queue("fx",function(n){e._triggerEvent("render");E=0;(q.show.ready||a)&&e.toggle(l,N.event,k);n()}),e},get:function(a){switch(a.toLowerCase()){case "dimensions":a={height:w.outerHeight(k),width:w.outerWidth(k)};
break;case "offset":a=B.offset(w,q.position.container);break;default:a=G(a.toLowerCase()),a=a[0][a[1]],a=a.precedance?a.string():a}return a},set:function(a,c){var d=/^position\.(my|at|adjust|target|container)|style|content|show\.ready/i,n=k,m=e.checks,r;return"string"==typeof a?(r=a,a={},a[r]=c):a=b.extend(l,{},a),b.each(a,function(m,r){var e=G(m.toLowerCase()),c;c=e[0][e[1]];e[0][e[1]]="object"==typeof r&&r.nodeType?b(r):r;a[m]=[e[0],e[1],r,c];n=d.test(m)||n}),g(q),E=1,b.each(a,function(a,n){var b,
r,c;for(b in m)for(r in m[b])if(c=RegExp(r,"i").exec(a))n.push(c),m[b][r].apply(e,n)}),E=0,e.rendered&&0<w[0].offsetWidth&&n&&e.reposition("mouse"===q.position.target?O:N.event),e},toggle:function(d,f,C){function n(){d?(b.browser.msie&&w[0].style.removeAttribute("filter"),w.css("overflow",""),"string"==typeof r.autofocus&&b(r.autofocus,w).focus(),r.target.trigger("qtip-"+Y+"-inactive")):w.css({display:"",visibility:"",opacity:"",left:"",top:""});e._triggerEvent(d?"visible":"hidden")}if(f){if(/over|enter/.test(f.type)&&
/out|leave/.test(N.event.type)&&q.show.target.add(f.target).length===q.show.target.length&&w.has(f.relatedTarget).length)return e;N.event=b.extend({},f)}if(!e.rendered)return d?e.render(1):e;var m=d?"show":"hide",r=q[m],K=q.position,fa=q.content,v=0<w[0].offsetWidth,g=d||1===r.target.length,h=!f||2>r.target.length||N.target[0]===f.target;return(typeof d).search("boolean|number")&&(d=!v),!w.is(":animated")&&v===d&&h?e:e._triggerEvent(m,[90])?(b.attr(w[0],"aria-hidden",!d),d?(N.origin=b.extend({},ia),
e.focus(f),b.isFunction(fa.text)&&A(fa.text,k),b.isFunction(fa.title.text)&&z(fa.title.text,k),!sa&&"mouse"===K.target&&K.adjust.mouse&&(b(a).bind("mousemove.qtip",c),sa=l),e.reposition(f,C),!r.solo||b(ja,r.solo).not(w).qtip("hide",b.Event("tooltipsolo"))):(clearTimeout(e.timers.show),delete N.origin,sa&&!b(ja+'[tracking="true"]:visible',r.solo).not(w).length&&(b(a).unbind("mousemove.qtip"),sa=k),e.blur(f)),r.effect===k||g===k?(w[m](),n.call(w)):b.isFunction(r.effect)?(w.stop(1,1),r.effect.call(w,
e),w.queue("fx",function(a){n();a()})):w.fadeTo(90,d?1:0,n),d&&r.target.trigger("qtip-"+Y+"-inactive"),e):e},show:function(a){return e.toggle(l,a)},hide:function(a){return e.toggle(k,a)},focus:function(a){if(!e.rendered)return e;var c=b(ja),d=parseInt(w[0].style.zIndex,10),n=S.zindex+c.length;a=b.extend({},a);return w.hasClass(ma)||e._triggerEvent("focus",[n],a)&&(d!==n&&(c.each(function(){this.style.zIndex>d&&(this.style.zIndex-=1)}),c.filter("."+ma).qtip("blur",a)),w.addClass(ma)[0].style.zIndex=
n),e},blur:function(a){return w.removeClass(ma),e._triggerEvent("blur",[w.css("zIndex")],a),e},reposition:function(c,f){if(!e.rendered||E)return e;E=1;var C=q.position.target,n=q.position,m=n.my,r=n.at,K=n.adjust,fa=K.method.split(" "),v=w.outerWidth(k),Y=w.outerHeight(k),g=0,h=0,l=w.css("position"),F=n.viewport,x={left:0,top:0},G=n.container,X=0<w[0].offsetWidth,V=c&&"scroll"===c.type,z=b(d),y,u;if(b.isArray(C)&&2===C.length)r={x:s,y:U},x={left:C[0],top:C[1]};else if("mouse"===C&&(c&&c.pageX||N.event.pageX))r=
{x:s,y:U},c=ia&&ia.pageX&&(K.mouse||!c||!c.pageX)?{pageX:ia.pageX,pageY:ia.pageY}:(!c||"resize"!==c.type&&"scroll"!==c.type?c&&c.pageX&&"mousemove"===c.type?c:!K.mouse&&N.origin&&N.origin.pageX&&q.show.distance?N.origin:c:N.event)||c||N.event||ia||{},"static"!==l&&(x=G.offset()),x={left:c.pageX-x.left,top:c.pageY-x.top},K.mouse&&V&&(x.left-=ia.scrollX-z.scrollLeft(),x.top-=ia.scrollY-z.scrollTop());else{"event"===C&&c&&c.target&&"scroll"!==c.type&&"resize"!==c.type?N.target=b(c.target):"event"!==
C&&(N.target=b(C.jquery?C:M.target));C=N.target;C=b(C).eq(0);if(0===C.length)return e;C[0]===a||C[0]===d?(g=B.iOS?d.innerWidth:C.width(),h=B.iOS?d.innerHeight:C.height(),C[0]===d&&(x={top:(F||C).scrollTop(),left:(F||C).scrollLeft()})):B.imagemap&&C.is("area")?y=B.imagemap(e,C,r,B.viewport?fa:k):B.svg&&C[0].ownerSVGElement?y=B.svg(e,C,r,B.viewport?fa:k):(g=C.outerWidth(k),h=C.outerHeight(k),x=B.offset(C,G));y&&(g=y.width,h=y.height,u=y.offset,x=y.position);if(3.1<B.iOS&&4.1>B.iOS||4.3<=B.iOS&&4.33>
B.iOS||!B.iOS&&"fixed"===l)x.left-=z.scrollLeft(),x.top-=z.scrollTop();x.left+=r.x===T?g:r.x===Q?g/2:0;x.top+=r.y===aa?h:r.y===Q?h/2:0}return x.left+=K.x+(m.x===T?-v:m.x===Q?-v/2:0),x.top+=K.y+(m.y===aa?-Y:m.y===Q?-Y/2:0),B.viewport?(x.adjusted=B.viewport(e,x,n,g,h,v,Y),u&&x.adjusted.left&&(x.left+=u.left),u&&x.adjusted.top&&(x.top+=u.top)):x.adjusted={left:0,top:0},e._triggerEvent("move",[x,F.elem||F],c)?(delete x.adjusted,f===k||!X||isNaN(x.left)||isNaN(x.top)||"mouse"===C||!b.isFunction(n.effect)?
w.css(x):b.isFunction(n.effect)&&(n.effect.call(w,e,b.extend({},x)),w.queue(function(a){b(this).css({opacity:"",height:""});b.browser.msie&&this.style.removeAttribute("filter");a()})),E=0,e):e},disable:function(a){return"boolean"!=typeof a&&(a=!w.hasClass(V)&&!N.disabled),e.rendered?(w.toggleClass(V,a),b.attr(w[0],"aria-disabled",a)):N.disabled=!!a,e},enable:function(){return e.disable(k)},destroy:function(){var a=C[0],c=b.attr(a,na),d=C.data("qtip");e.destroyed=l;e.rendered&&(w.stop(1,0).remove(),
b.each(e.plugins,function(){this.destroy&&this.destroy()}));clearTimeout(e.timers.show);clearTimeout(e.timers.hide);F();if(!d||e===d)b.removeData(a,"qtip"),q.suppress&&c&&(b.attr(a,"title",c),C.removeAttr(na)),C.removeAttr("aria-describedby");return C.unbind(".qtip-"+Y),delete P[e.id],C}})}function pa(c,d){var f,X,G,y,ea,D=b(this),u=b(a.body),s=this===a?u:D;X=D.metadata?D.metadata(d.metadata):O;y="html5"===d.metadata.type&&X?X[d.metadata.name]:O;var z=D.data(d.metadata.name||"qtipopts");try{z="string"==
typeof z?b.parseJSON(z):z}catch(H){}y=b.extend(l,{},S.defaults,d,"object"==typeof z?g(z):O,g(y||X));X=y.position;y.id=c;if("boolean"==typeof y.content.text){G=D.attr(y.content.attr);if(y.content.attr===k||!G)return k;y.content.text=G}X.container.length||(X.container=u);X.target===k&&(X.target=s);y.show.target===k&&(y.show.target=s);y.show.solo===l&&(y.show.solo=X.container.closest("body"));y.hide.target===k&&(y.hide.target=s);y.position.viewport===l&&(y.position.viewport=X.container);X.container=
X.container.eq(0);X.at=new B.Corner(X.at);X.my=new B.Corner(X.my);if(b.data(this,"qtip"))if(y.overwrite)D.qtip("destroy");else if(y.overwrite===k)return k;return y.suppress&&(ea=b.attr(this,"title"))&&b(this).removeAttr("title").attr(na,ea).attr("title",""),f=new h(D,y,c,!!G),b.data(this,"qtip",f),D.bind("remove.qtip-"+c+" removeqtip.qtip-"+c,function(){f.destroy()}),f}function ba(a){var c=this,d=a.elements.tooltip,f=a.options.content.ajax,g=S.defaults.content.ajax,h=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
ea=l,D=k,u;a.checks.ajax={"^content.ajax":function(a,b,C){"ajax"===b&&(f=C);"once"===b?c.init():f&&f.url?c.load():d.unbind(".qtip-ajax")}};b.extend(c,{init:function(){return f&&f.url&&d.unbind(".qtip-ajax")[f.once?"one":"bind"]("tooltipshow.qtip-ajax",c.load),c},load:function(d){function Y(){var c;a.destroyed||(ea=k,s&&(D=l,a.show(d.originalEvent)),(c=g.complete||f.complete)&&b.isFunction(c)&&c.apply(f.context||a,arguments))}function H(c,d,q){var v;a.destroyed||(e&&"string"==typeof c&&(c=b("<div/>").append(c.replace(h,
"")).find(e)),(v=g.success||f.success)&&b.isFunction(v)?v.call(f.context||a,c,d,q):a.set("content.text",c))}function A(b,c,e){a.destroyed||0===b.status||a.set("content.text",c+": "+e)}if(D)D=k;else{var v=f.url.lastIndexOf(" "),F=f.url,e,s=!f.loading&&ea;if(s)try{d.preventDefault()}catch(E){}else if(d&&d.isDefaultPrevented())return c;u&&u.abort&&u.abort();-1<v&&(e=F.substr(v),F=F.substr(0,v));u=b.ajax(b.extend({error:g.error||A,context:a},f,{url:F,success:H,complete:Y}))}},destroy:function(){u&&u.abort&&
u.abort();a.destroyed=l}});c.init()}function qa(a,b,c){var d=Math.ceil(b/2),f=Math.ceil(c/2);b={bottomright:[[0,0],[b,c],[b,0]],bottomleft:[[0,0],[b,0],[0,c]],topright:[[0,c],[b,0],[b,c]],topleft:[[0,0],[0,c],[b,c]],topcenter:[[0,c],[d,0],[b,c]],bottomcenter:[[0,0],[b,0],[d,c]],rightcenter:[[0,0],[b,f],[0,c]],leftcenter:[[b,0],[b,c],[0,f]]};return b.lefttop=b.bottomright,b.righttop=b.bottomleft,b.leftbottom=b.topright,b.rightbottom=b.topleft,b[a.string()]}function ca(a,c){var d,g;function h(a){var b=
F.is(":visible");F.show();a();F.toggle(b)}function y(b,c,d,q){if(v.tip){b=H.corner.clone();c=d.adjusted;var g=a.options.position.adjust.method.split(" ");q=g[0];var g=g[1]||g[0],h=k,t=k,Y=0,n=0,m,r={},K;H.corner.fixed!==l&&(q===W&&b.precedance===ga&&c.left&&b.y!==Q?b.precedance=b.precedance===ga?da:ga:q!==W&&c.left&&(b.x=b.x===Q?0<c.left?s:T:b.x===s?T:s),g===W&&b.precedance===da&&c.top&&b.x!==Q?b.precedance=b.precedance===da?ga:da:g!==W&&c.top&&(b.y=b.y===Q?0<c.top?U:aa:b.y===U?aa:U),b.string()!==
e.corner.string()&&(e.top!==c.top||e.left!==c.left)&&H.update(b,k));m=H.position(b,c);m[b.x]+=ea(b,b.x);m[b.y]+=ea(b,b.y);m.right!==f&&(m.left=-m.right);m.bottom!==f&&(m.top=-m.bottom);m.user=Math.max(0,A.offset);if(h=q===W&&!!c.left)b.x===Q?r["margin-left"]=Y=m["margin-left"]:(K=m.right!==f?[c.left,-m.left]:[-c.left,m.left],(Y=Math.max(K[0],K[1]))>K[0]&&(d.left-=c.left,h=k),r[m.right!==f?T:s]=Y);if(t=g===W&&!!c.top)b.y===Q?r["margin-top"]=n=m["margin-top"]:(K=m.bottom!==f?[c.top,-m.top]:[-c.top,
m.top],(n=Math.max(K[0],K[1]))>K[0]&&(d.top-=c.top,t=k),r[m.bottom!==f?aa:U]=n);v.tip.css(r).toggle(!(Y&&n||b.x===Q&&n||b.y===Q&&Y));d.left-=m.left.charAt?m.user:q!==W||t||!h&&!t?m.left:0;d.top-=m.top.charAt?m.user:g!==W||h||!h&&!t?m.top:0;e.left=c.left;e.top=c.top;e.corner=b.clone()}}function ea(a,b,c){b=b?b:a[a.precedance];var e=v.titlebar&&a.y===U?v.titlebar:F,d="border-"+b+"-width",f;return h(function(){f=(c?parseInt(c.css(d),10):parseInt(v.content.css(d),10)||parseInt(e.css(d),10)||parseInt(F.css(d),
10))||0}),f}function D(a){var c=v.titlebar&&a.y===U?v.titlebar:v.content,e=b.browser.mozilla?"-moz-":b.browser.webkit?"-webkit-":"",d="border-radius-"+a.y+a.x,f="border-"+a.y+"-"+a.x+"-radius",q=function(a){return parseInt(c.css(a),10)||parseInt(F.css(a),10)},g;return h(function(){g=q(f)||q(e+f)||q(e+d)||q(d)||0}),g}function u(a){function c(a,b,r){b=a.css(b)||C;return r&&b===a.css(r)?k:f.test(b)?k:b}var e=v.tip.css("cssText","");a=a||H.corner;var f=/rgba?\(0, 0, 0(, 0)?\)|transparent|#123456/i,q=
"border-"+a[a.precedance]+"-color",C="transparent",t=v.titlebar,y=t&&(a.y===U||a.y===Q&&e.position().top+L.height/2+A.offset<t.outerHeight(l))?t:v.content;h(function(){d=c(e,"background-color")||c(y,"background-color")||c(v.content,"background-color")||c(F,"background-color")||e.css("background-color");g=c(e,q,"color")||c(y,q,"color")||c(v.content,q,"color")||c(F,q,"color")||F.css(q);b("*",e).add(e).css("cssText","background-color:"+C+" !important;border:0 !important;")})}function I(a){var b=a.precedance===
da,c=L[b?ha:Z],e=L[b?Z:ha];a=-1<a.string().indexOf(Q);var d=c*(a?0.5:1),f=Math.pow,q=Math.round,g,n,m,r=Math.sqrt(f(d,2)+f(e,2)),d=[E/d*r,E/e*r];return d[2]=Math.sqrt(f(d[0],2)-f(E,2)),d[3]=Math.sqrt(f(d[1],2)-f(E,2)),g=r+d[2]+d[3]+(a?0:d[0]),n=g/r,m=[q(n*e),q(n*c)],{height:m[b?0:1],width:m[b?1:0]}}function z(a,b,c){return"<qvml:"+a+' xmlns="urn:schemas-microsoft.com:vml" class="qtip-vml" '+(b||"")+' style="behavior: url(#default#VML); '+(c||"")+'" />'}var H=this,A=a.options.style.tip,v=a.elements,
F=v.tooltip,e={top:0,left:0},L={width:A.width,height:A.height};g=d=void 0;var E=A.border||0,P=!!(b("<canvas />")[0]||{}).getContext;H.corner=O;H.mimic=O;H.border=E;H.offset=A.offset;H.size=L;a.checks.tip={"^position.my|style.tip.(corner|mimic|border)$":function(){H.init()||H.destroy();a.reposition()},"^style.tip.(height|width)$":function(){L={width:A.width,height:A.height};H.create();H.update();a.reposition()},"^content.title.text|style.(classes|widget)$":function(){v.tip&&v.tip.length&&H.update()}};
b.extend(H,{init:function(){var c=A.corner,d=a.options.position,f=d.at,d=d.my.string?d.my.string():d.my,c=(c===k||d===k&&f===k?k:(c===l?H.corner=new B.Corner(d):c.string||(H.corner=new B.Corner(c),H.corner.fixed=l),e.corner=new B.Corner(H.corner.string()),"centercenter"!==H.corner.string()))&&(P||b.browser.msie);return c&&(H.create(),H.update(),F.unbind(".qtip-tip").bind("tooltipmove.qtip-tip",y)),c},create:function(){var a=L.width,c=L.height,e;v.tip&&v.tip.remove();v.tip=b("<div />",{"class":"qtip-tip"}).css({width:a,
height:c}).prependTo(F);P?b("<canvas />").appendTo(v.tip)[0].getContext("2d").save():(e=z("shape",'coordorigin="0,0"',"position:absolute;"),v.tip.html(e+e),b("*",v.tip).bind("click mousedown",function(a){a.stopPropagation()}))},update:function(a,c){var f=v.tip,q=f.children(),C=L.width,h=L.height,t=A.mimic,y=Math.round,n,m,r,K;a||(a=e.corner||H.corner);t===k?t=a:(t=new B.Corner(t),t.precedance=a.precedance,"inherit"===t.x?t.x=a.x:"inherit"===t.y?t.y=a.y:t.x===t.y&&(t[a.precedance]=a[a.precedance]));
a.precedance===ga?(L.width=A.height,L.height=A.width):(L.width=A.width,L.height=A.height);v.tip.css({width:C=L.width,height:h=L.height});u(a);"transparent"!==g?(E=ea(a,O),0===A.border&&0<E&&(d=g),H.border=E=A.border!==l?A.border:E):H.border=E=0;m=qa(t,C,h);H.size=K=I(a);f.css(K).css("line-height",K.height+"px");a.precedance===da?r=[y(t.x===s?E:t.x===T?K.width-C-E:(K.width-C)/2),y(t.y===U?K.height-h:0)]:r=[y(t.x===s?K.width-C:0),y(t.y===U?E:t.y===aa?K.height-h-E:(K.height-h)/2)];P?(q.attr(K),n=q[0].getContext("2d"),
n.restore(),n.save(),n.clearRect(0,0,3E3,3E3),n.fillStyle=d,n.strokeStyle=g,n.lineWidth=2*E,n.lineJoin="miter",n.miterLimit=100,n.translate(r[0],r[1]),n.beginPath(),n.moveTo(m[0][0],m[0][1]),n.lineTo(m[1][0],m[1][1]),n.lineTo(m[2][0],m[2][1]),n.closePath(),E&&("border-box"===F.css("background-clip")&&(n.strokeStyle=d,n.stroke()),n.strokeStyle=g,n.stroke()),n.fill()):(m="m"+m[0][0]+","+m[0][1]+" l"+m[1][0]+","+m[1][1]+" "+m[2][0]+","+m[2][1]+" xe",r[2]=E&&/^(r|b)/i.test(a.string())?8===parseFloat(b.browser.version,
10)?2:1:0,q.css({coordsize:C+E+" "+(h+E),antialias:""+(-1<t.string().indexOf(Q)),left:r[0],top:r[1],width:C+E,height:h+E}).each(function(a){var n=b(this);n[n.prop?"prop":"attr"]({coordsize:C+E+" "+(h+E),path:m,fillcolor:d,filled:!!a,stroked:!a}).toggle(!!E||!!a);!a&&""===n.html()&&n.html(z("stroke",'weight="'+2*E+'px" color="'+g+'" miterlimit="1000" joinstyle="miter"'))}));c!==k&&H.position(a)},position:function(a){var c=v.tip,e={},d=Math.max(0,A.offset),f,q,g;return A.corner===k||!c?k:(a=a||H.corner,
f=a.precedance,q=I(a),g=[a.x,a.y],f===ga&&g.reverse(),b.each(g,function(b,n){var c,r,K;n===Q?(c=f===da?s:U,e[c]="50%",e["margin-"+c]=-Math.round(q[f===da?ha:Z]/2)+d):(c=ea(a,n),r=ea(a,n,v.content),K=D(a),e[n]=b?r:d+(K>c?K:-c))}),e[a[f]]-=q[f===ga?ha:Z],c.css({top:"",bottom:"",left:"",right:"",margin:""}).css(e),e)},destroy:function(){v.tip&&v.tip.remove();v.tip=!1;F.unbind(".qtip-tip")}});H.init()}function ka(c){function f(){H=b(z,D).not("[disabled]").map(function(){return"function"==typeof this.focus?
this:null})}function g(a){1>H.length&&a.length?a.not("body").blur():H.first().focus()}function h(a){var c=b(a.target),e=c.closest(".qtip");!(1>e.length?k:parseInt(e[0].style.zIndex,10)>parseInt(D[0].style.zIndex,10))&&b(a.target).closest(ja)[0]!==D[0]&&g(c)}var G=this,y=c.options.show.modal,s=c.elements,D=s.tooltip,u=".qtipmodal"+c.id,I=b(a.body),z=B.modal.focusable.join(","),H={},A;c.checks.modal={"^show.modal.(on|blur)$":function(){G.init();s.overlay.toggle(D.is(":visible"))},"^content.text$":function(){f()}};
b.extend(G,{init:function(){return y.on?(A=G.create(),D.attr("is-modal-qtip",l).css("z-index",B.modal.zindex+b(ja+"[is-modal-qtip]").length).unbind(".qtipmodal").unbind(u).bind("tooltipshow.qtipmodal tooltiphide.qtipmodal",function(a,c,e){c=a.originalEvent;if(a.target===D[0])if(c&&"tooltiphide"===a.type&&/mouse(leave|enter)/.test(c.type)&&b(c.relatedTarget).closest(A[0]).length)try{a.preventDefault()}catch(d){}else(!c||c&&!c.solo)&&G[a.type.replace("tooltip","")](a,e)}).bind("tooltipfocus.qtipmodal",
function(a){if(!(a.isDefaultPrevented()||a.target!==D[0])){var c=b(ja).filter("[is-modal-qtip]"),e=B.modal.zindex+c.length,d=parseInt(D[0].style.zIndex,10);A[0].style.zIndex=e-2;c.each(function(){this.style.zIndex>d&&(this.style.zIndex-=1)});c.end().filter("."+ma).qtip("blur",a.originalEvent);D.addClass(ma)[0].style.zIndex=e;try{a.preventDefault()}catch(f){}}}).bind("tooltiphide.qtipmodal",function(a){a.target===D[0]&&b("[is-modal-qtip]").filter(":visible").not(D).last().qtip("focus",a)}),y.escape&&
b(a).unbind(u).bind("keydown"+u,function(a){27===a.keyCode&&D.hasClass(ma)&&c.hide(a)}),y.blur&&s.overlay.unbind(u).bind("click"+u,function(a){D.hasClass(ma)&&c.hide(a)}),f(),G):G},create:function(){function a(){A.css({height:e.height(),width:e.width()})}var c=b("#qtip-overlay"),e=b(d);return c.length?s.overlay=c.insertAfter(b(ja).last()):(A=s.overlay=b("<div />",{id:"qtip-overlay",html:"<div></div>",mousedown:function(){return k}}).hide().insertAfter(b(ja).last()),e.unbind(".qtipmodal").bind("resize.qtipmodal",
a),a(),A)},toggle:function(a,c,e){if(a&&a.isDefaultPrevented())return G;a=y.effect;var d=c?"show":"hide",f=A.is(":visible"),q=b("[is-modal-qtip]").filter(":visible").not(D);return A||(A=G.create()),A.is(":animated")&&f===c&&A.data("toggleState")!==k||!c&&q.length?G:(c?(A.css({left:0,top:0}),A.toggleClass("blurs",y.blur),y.stealfocus!==k&&(I.bind("focusin"+u,h),g(b("body :focus")))):I.unbind("focusin"+u),A.stop(l,k).data("toggleState",c),b.isFunction(a)?a.call(A,c):a===k?A[d]():A.fadeTo(parseInt(e,
10)||90,c?1:0,function(){c||b(this).hide()}),c||A.queue(function(a){A.css({left:"",top:""}).removeData("toggleState");a()}),G)},show:function(a,b){return G.toggle(a,l,b)},hide:function(a,b){return G.toggle(a,k,b)},destroy:function(){var d=A;return d&&(d=1>b("[is-modal-qtip]").not(D).length,d?(s.overlay.remove(),b(a).unbind(".qtipmodal")):s.overlay.unbind(".qtipmodal"+c.id),I.unbind("focusin"+u)),D.removeAttr("is-modal-qtip").unbind(".qtipmodal")}});G.init()}function la(c){var f=this,g=c.elements,
h=c.options,G=g.tooltip,y=".ie6-"+c.id,s=1>b("select, object").length,D=0,u=k,B;c.checks.ie6={"^content|style$":function(a,b,c){redraw()}};b.extend(f,{init:function(){var c=b(d),h;s&&(g.bgiframe=b('<iframe class="qtip-bgiframe" frameborder="0" tabindex="-1" src="javascript:\'\';"  style="display:block; position:absolute; z-index:-1; filter:alpha(opacity=0); -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";"></iframe>'),g.bgiframe.appendTo(G),G.bind("tooltipmove"+y,f.adjustBGIFrame));
B=b("<div/>",{id:"qtip-rcontainer"}).appendTo(a.body);f.redraw();g.overlay&&!u&&(h=function(){g.overlay[0].style.top=c.scrollTop()+"px"},c.bind("scroll.qtip-ie6, resize.qtip-ie6",h),h(),g.overlay.addClass("qtipmodal-ie6fix"),u=l)},adjustBGIFrame:function(){var a=c.get("dimensions"),b=c.plugins.tip,d=g.tip,f,q;q=parseInt(G.css("border-left-width"),10)||0;q={left:-q,top:-q};b&&d&&(f="x"===b.corner.precedance?["width","left"]:["height","top"],q[f[1]]-=d[f[0]]());g.bgiframe.css(q).css(a)},redraw:function(){if(1>
c.rendered||D)return f;var a=h.style,b=h.position.container,d,g,k,e;return D=1,a.height&&G.css(Z,a.height),a.width?G.css(ha,a.width):(G.css(ha,"").appendTo(B),g=G.width(),1>g%2&&(g+=1),k=G.css("max-width")||"",e=G.css("min-width")||"",d=-1<(k+e).indexOf("%")?b.width()/100:0,k=(-1<k.indexOf("%")?d:1)*parseInt(k,10)||g,e=(-1<e.indexOf("%")?d:1)*parseInt(e,10)||0,g=k+e?Math.min(Math.max(g,e),k):g,G.css(ha,Math.round(g)).appendTo(b)),D=0,f},destroy:function(){s&&g.bgiframe.remove();G.unbind(y)}});f.init()}
var l=!0,k=!1,O=null,ga="x",da="y",ha="width",Z="height",U="top",s="left",aa="bottom",T="right",Q="center",oa="flipinvert",W="shift",S,B,ia,I="qtip",P={},ra=["ui-widget","ui-tooltip"],ja="div.qtip."+I,va=I+"-default",ma=I+"-focus",ua=I+"-hover",na="oldtitle",sa;S=b.fn.qtip=function(a,c,d){var h=(""+a).toLowerCase(),G=O,y=b.makeArray(arguments).slice(1),s=y[y.length-1],D=this[0]?b.data(this[0],"qtip"):O;if(!arguments.length&&D||"api"===h)return D;if("string"==typeof a)return this.each(function(){var a=
b.data(this,"qtip");if(!a)return l;s&&s.timeStamp&&(a.cache.event=s);if("option"!==h&&"options"!==h||!c)a[h]&&a[h].apply(a[h],y);else{if(!b.isPlainObject(c)&&d===f)return G=a.get(c),k;a.set(c,d)}}),G!==O?G:this;if("object"==typeof a||!arguments.length)return D=g(b.extend(l,{},a)),S.bind.call(this,D,s)};S.bind=function(a,d){return this.each(function(g){function h(a){function c(){u.render("object"==typeof a||G.show.ready);y.show.add(y.hide).unbind(D)}if(u.cache.disabled)return k;u.cache.event=b.extend({},
a);u.cache.target=a?b(a.target):[f];0<G.show.delay?(clearTimeout(u.timers.show),u.timers.show=setTimeout(c,G.show.delay),s.show!==s.hide&&y.hide.bind(s.hide,function(){clearTimeout(u.timers.show)})):c()}var G,y,s,D,u;g=b.isArray(a.id)?a.id[g]:a.id;g=!g||g===k||1>g.length||P[g]?S.nextid++:P[g]=g;D=".qtip-"+g+"-create";u=pa.call(this,g,a);if(u===k)return l;G=u.options;b.each(B,function(){"initialize"===this.initialize&&this(u)});y={show:G.show.target,hide:G.hide.target};s={show:b.trim(""+G.show.event).replace(/ /g,
D+" ")+D,hide:b.trim(""+G.hide.event).replace(/ /g,D+" ")+D};/mouse(over|enter)/i.test(s.show)&&!/mouse(out|leave)/i.test(s.hide)&&(s.hide+=" mouseleave"+D);y.show.bind("mousemove"+D,function(a){c(a);u.cache.onTarget=l});y.show.bind(s.show,h);(G.show.ready||G.prerender)&&h(d)}).attr("data-hasqtip",l)};B=S.plugins={Corner:function(a){a=(""+a).replace(/([A-Z])/," $1").replace(/middle/gi,Q).toLowerCase();this.x=(a.match(/left|right/i)||a.match(/center/)||["inherit"])[0].toLowerCase();this.y=(a.match(/top|bottom|center/i)||
["inherit"])[0].toLowerCase();a=a.charAt(0);this.precedance="t"===a||"b"===a?da:ga;this.string=function(){return this.precedance===da?this.y+this.x:this.x+this.y};this.abbrev=function(){var a=this.x.substr(0,1),b=this.y.substr(0,1);return a===b?a:this.precedance===da?b+a:a+b};this.invertx=function(a){this.x=this.x===s?T:this.x===T?s:a||this.x};this.inverty=function(a){this.y=this.y===U?aa:this.y===aa?U:a||this.y};this.clone=function(){return{x:this.x,y:this.y,precedance:this.precedance,string:this.string,
abbrev:this.abbrev,clone:this.clone,invertx:this.invertx,inverty:this.inverty}}},offset:function(c,d){var f=c.offset(),g=c.closest("body"),h=b.browser.msie&&"CSS1Compat"!==a.compatMode,k=d,l,s,u;if(k){do"static"!==k.css("position")&&(s=k.position(),f.left-=s.left+(parseInt(k.css("borderLeftWidth"),10)||0)+(parseInt(k.css("marginLeft"),10)||0),f.top-=s.top+(parseInt(k.css("borderTopWidth"),10)||0)+(parseInt(k.css("marginTop"),10)||0),!l&&"hidden"!==(u=k.css("overflow"))&&"visible"!==u&&(l=k));while((k=
b(k[0].offsetParent)).length);if(l&&l[0]!==g[0]||h)g=l||g,f.left+=1*g.scrollLeft(),f.top+=1*g.scrollTop()}return f},iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||k,fn:{attr:function(a,c){if(this.length){var d=this[0],f=b.data(d,"qtip");if("title"===a&&f&&"object"==typeof f&&f.options.suppress)return 2>arguments.length?b.attr(d,na):(f&&"title"===f.options.content.attr&&
f.cache.attr&&f.set("content.text",c),this.attr(na,c))}return b.fn.attr_replacedByqTip.apply(this,arguments)},clone:function(a){b([]);var c=b.fn.clone_replacedByqTip.apply(this,arguments);return a||c.filter("["+na+"]").attr("title",function(){return b.attr(this,na)}).removeAttr(na),c}}};b.each(B.fn,function(a,c){if(!c||b.fn[a+"_replacedByqTip"])return l;var d=b.fn[a+"_replacedByqTip"]=b.fn[a];b.fn[a]=function(){return c.apply(this,arguments)||d.apply(this,arguments)}});b.ui||(b.cleanData_replacedByqTip=
b.cleanData,b.cleanData=function(a){for(var c=0,d;(d=a[c])!==f;c++)try{b(d).triggerHandler("removeqtip")}catch(g){}b.cleanData_replacedByqTip(a)});S.version="2.0.1";S.nextid=0;S.inactiveEvents="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" ");S.zindex=15E3;S.defaults={prerender:k,id:k,overwrite:l,suppress:l,content:{text:l,attr:"title",deferred:k,title:{text:k,button:k}},position:{my:"top left",at:"bottom right",target:k,container:k,viewport:k,adjust:{x:0,y:0,mouse:l,resize:l,
method:"flipinvert flipinvert"},effect:function(a,c,d){b(this).animate(c,{duration:200,queue:k})}},show:{target:k,event:"mouseenter",effect:l,delay:90,solo:k,ready:k,autofocus:k},hide:{target:k,event:"mouseleave",effect:l,delay:0,fixed:k,inactive:k,leave:"window",distance:k},style:{classes:"",widget:k,width:k,height:k,def:l},events:{render:O,move:O,show:O,hide:O,toggle:O,visible:O,hidden:O,focus:O,blur:O}};B.svg=function(c,d,f,g){c=b(a);var h=d[0];d={width:0,height:0,position:{top:1E10,left:1E10}};
for(var k;!h.getBBox;)h=h.parentNode;if(h.getBBox&&h.parentNode){f=h.getBBox();g=h.getScreenCTM();h=h.farthestViewportElement||h;if(!h.createSVGPoint)return d;h=h.createSVGPoint();h.x=f.x;h.y=f.y;k=h.matrixTransform(g);d.position.left=k.x;d.position.top=k.y;h.x+=f.width;h.y+=f.height;k=h.matrixTransform(g);d.width=k.x-d.position.left;d.height=k.y-d.position.top;d.position.left+=c.scrollLeft();d.position.top+=c.scrollTop()}return d};B.ajax=function(a){var c=a.plugins.ajax;return"object"==typeof c?
c:a.plugins.ajax=new ba(a)};B.ajax.initialize="render";B.ajax.sanitize=function(a){var c=a.content,b;c&&"ajax"in c&&(b=c.ajax,"object"!=typeof b&&(b=a.content.ajax={url:b}),"boolean"!=typeof b.once&&b.once&&(b.once=!!b.once))};b.extend(l,S.defaults,{content:{ajax:{loading:l,once:l}}});B.tip=function(a){var c=a.plugins.tip;return"object"==typeof c?c:a.plugins.tip=new ca(a)};B.tip.initialize="render";B.tip.sanitize=function(a){var c=a.style,b;c&&"tip"in c&&(b=a.style.tip,"object"!=typeof b&&(a.style.tip=
{corner:b}),/string|boolean/i.test(typeof b.corner)||(b.corner=l),"number"!=typeof b.width&&delete b.width,"number"!=typeof b.height&&delete b.height,"number"!=typeof b.border&&b.border!==l&&delete b.border,"number"!=typeof b.offset&&delete b.offset)};b.extend(l,S.defaults,{style:{tip:{corner:l,mimic:k,width:6,height:6,border:l,offset:0}}});B.modal=function(a){var c=a.plugins.modal;return"object"==typeof c?c:a.plugins.modal=new ka(a)};B.modal.initialize="render";B.modal.sanitize=function(a){a.show&&
("object"!=typeof a.show.modal?a.show.modal={on:!!a.show.modal}:"undefined"==typeof a.show.modal.on&&(a.show.modal.on=l))};B.modal.zindex=S.zindex-200;B.modal.focusable="a[href] area[href] input select textarea button iframe object embed [tabindex] [contenteditable]".split(" ");b.extend(l,S.defaults,{show:{modal:{on:k,effect:l,blur:l,stealfocus:l,escape:l}}});B.viewport=function(c,b,f,g,h,k,l){function D(a,c,d,f,g,h,n,m,r){var K=b[g],fa=z[a],k=H[a],l=d===W,v=-L.offset[g]+e.offset[g]+e["scroll"+g],
s=fa===g?r:fa===h?-r:-r/2,x=E&&E.size?E.size[n]||0:0,u=E&&E.corner&&E.corner.precedance===a&&!l?x:0,y=v-K+u;r=K+r-e[n]-v+u;m=s-(z.precedance===a||fa===z[c]?k===g?m:k===h?-m:-m/2:0)-(k===Q?m/2:0);return l?(u=E&&E.corner&&E.corner.precedance===c?x:0,m=(fa===g?1:-1)*s-u,b[g]+=0<y?y:0<r?-r:0,b[g]=Math.max(-L.offset[g]+e.offset[g]+(u&&E.corner[a]===Q?E.offset:0),K-m,Math.min(Math.max(-L.offset[g]+e.offset[g]+e[n],K+m),b[g]))):(f*=d===oa?2:0,0<y&&(fa!==g||0<r)?(b[g]-=m+f,w["invert"+a](g)):0<r&&(fa!==h||
0<y)&&(b[g]-=(fa===Q?-m:m)+f,w["invert"+a](h)),b[g]<v&&-b[g]>r&&(b[g]=K,w=z.clone())),b[g]-K}var u=f.target,B=c.elements.tooltip,z=f.my,H=f.at,A=f.adjust,v=A.method.split(" "),F=v[0],v=v[1]||v[0],e=f.viewport,L=f.container;f=c.cache;var E=c.plugins.tip,O={left:0,top:0},w,x;if(!e.jquery||u[0]===d||u[0]===a.body||"none"===A.method)return O;u="fixed"===B.css("position");e={elem:e,height:e[(e[0]===d?"h":"outerH")+"eight"](),width:e[(e[0]===d?"w":"outerW")+"idth"](),scrollleft:u?0:e.scrollLeft(),scrolltop:u?
0:e.scrollTop(),offset:e.offset()||{left:0,top:0}};L={elem:L,scrollLeft:L.scrollLeft(),scrollTop:L.scrollTop(),offset:L.offset()||{left:0,top:0}};if("shift"!==F||"shift"!==v)w=z.clone();return O={left:"none"!==F?D(ga,da,F,A.x,s,T,ha,g,k):0,top:"none"!==v?D(da,ga,v,A.y,U,aa,Z,h,l):0},w&&f.lastClass!==(x=I+"-pos-"+w.abbrev())&&B.removeClass(c.cache.lastClass).addClass(c.cache.lastClass=x),O};B.imagemap=function(a,c,d,f){function g(a,c,b){for(var d=0,f=1,h=1,k=0,l=0,q=a.width,u=a.height;0<q&&0<u&&0<
f&&0<h;){q=Math.floor(q/2);u=Math.floor(u/2);b.x===s?f=q:b.x===T?f=a.width-q:f+=Math.floor(q/2);b.y===U?h=u:b.y===aa?h=a.height-u:h+=Math.floor(u/2);for(d=c.length;d--&&!(2>c.length);)k=c[d][0]-a.position.left,l=c[d][1]-a.position.top,(b.x===s&&k>=f||b.x===T&&k<=f||b.x===Q&&(k<f||k>a.width-f)||b.y===U&&l>=h||b.y===aa&&l<=h||b.y===Q&&(l<h||l>a.height-h))&&c.splice(d,1)}return{left:c[0][0],top:c[0][1]}}c.jquery||(c=b(c));a=a.cache.areas={};var h=(c[0].shape||c.attr("shape")).toLowerCase(),k=c[0].coords||
c.attr("coords"),l=k.split(","),u=[];c=b('img[usemap="#'+c.parent("map").attr("name")+'"]');var B=c.offset(),z={width:0,height:0,position:{top:1E10,right:0,bottom:0,left:1E10}},H=0,A=0;B.left+=Math.ceil((c.outerWidth()-c.width())/2);B.top+=Math.ceil((c.outerHeight()-c.height())/2);if("poly"===h)for(H=l.length;H--;)A=[parseInt(l[--H],10),parseInt(l[H+1],10)],A[0]>z.position.right&&(z.position.right=A[0]),A[0]<z.position.left&&(z.position.left=A[0]),A[1]>z.position.bottom&&(z.position.bottom=A[1]),
A[1]<z.position.top&&(z.position.top=A[1]),u.push(A);else for(H=-1;H++<l.length;)u.push(parseInt(l[H],10));switch(h){case "rect":z={width:Math.abs(u[2]-u[0]),height:Math.abs(u[3]-u[1]),position:{left:Math.min(u[0],u[2]),top:Math.min(u[1],u[3])}};break;case "circle":z={width:u[2]+2,height:u[2]+2,position:{left:u[0],top:u[1]}};break;case "poly":z.width=Math.abs(z.position.right-z.position.left),z.height=Math.abs(z.position.bottom-z.position.top),"c"===d.abbrev()?z.position={left:z.position.left+z.width/
2,top:z.position.top+z.height/2}:(a[d+k]||(z.position=g(z,u.slice(),d),f&&("flip"===f[0]||"flip"===f[1])&&(z.offset=g(z,u.slice(),{x:d.x===s?T:d.x===T?s:Q,y:d.y===U?aa:d.y===aa?U:Q}),z.offset.left-=z.position.left,z.offset.top-=z.position.top),a[d+k]=z),z=a[d+k]),z.width=z.height=0}return z.position.left+=B.left,z.position.top+=B.top,z};B.ie6=function(a){var c=b.browser,d=a.plugins.ie6;return!c.msie||"6"!==(""+c.version).charAt(0)?k:"object"==typeof d?d:a.plugins.ie6=new la(a)};B.ie6.initialize="render"})})(window,
document);var attask=function(){function d(a){e.set("general",!1);var c=e.get("host").replace(/[|&;$%@"<>()+,]/g,""),b=new Date;b.setHours(b.getHours()-b.getTimezoneOffset()/60);b=b.toJSON();console.log(b);c={url:"https://secure.atappstore.com/Tools/Subform/UsageTracker.aspx?f=Stopwatch",data:JSON.stringify({dateTime:"2018-06-29T21:29:35.429Z",activity:{request:c},userID:e.get("userID")}),dataType:"json",type:"POST"};c=jQuery.ajax(c);c.done(function(c,b,m){c.isValid?(c.message=JSON.parse(c.message),c.isWarn&&
console.log(c.message.message),e.set("is_auth",!0),e.set("auth_key",!0),e.set("sessionID",c.message.apiKey),a&&a()):(e.set("access","demo"),e.set("is_auth",!1),console.log(c.message))});c.fail(function(a,c,b){})}function a(a){e.set("general",!0);if(e.get("ent"))d(a);else{var c={url:"https://www.atappstore.com/api/authorize/",data:{product:e.get("qr")?"shiftwatch-qr":"stopwatch",host:e.get("host"),sessionID:e.get("sessionID"),user:e.get("username"),domain:e.get("domain")},type:"GET",dataType:"json"};
s(c);c=jQuery.ajax(c);c.done(function(c,b,m){!1!=c.success&&(e.set("auth_key",c.auth_key),e.set("access",c.access),e.set("is_auth",c.is_auth),e.set("license_expiry_days",c.license_expiry_days),e.get("qr")&&(e.set("view","team"),e.set("sort","project"),e.set("logout_on_select",!0),e.set("multi",!0),e.set("hide_team_done",!0),e.set("minuteBuffer",30),e.set("minuteBufferSnapToSched",!0),TASK_DB.userId=e.get("userID")),e.get("minuteBufferSnapToSched")&&X(),e.get("restrict_sched")?X(function(c){var b;
void 0==c&&(b="Today is not a work day");var m=new Date,m=Date.parse("01/01/2011 "+m.getHours()+":"+m.getMinutes()),d=Date.parse("01/01/2011 "+c.start),r=Date.parse("01/01/2011 "+c.stop),f=e.get("minuteBuffer");null!=f&&(d.setMinutes(d.getMinutes()-f),r.setMinutes(r.getMinutes()+f));void 0==c||d>m||m>r?(b=b?b:"Please return at "+c.start,TASK_CNTRL.showWindow('<h3><div style="text-align: center; font-weight: bold;">Not scheduled to work</div></h3><div class="content"><p>'+b+'.</p><a href="#" class="btn btn-primary logout cancel" title="Logout">Logout</a></div>')):
a()}):(a&&a(),ba()))});c.fail(function(a,c,b){})}}function f(){var a={url:P()+"user/count",type:"get",data:{},dataType:"json"};s(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==v[0]?l(function(){}):c(F[0],"uCount,"+JSON.stringify(a.error)),t.hide(),J.hide()):a=a.data});a.fail(function(a,c,b){I({response:a.responseText,type:c,msg:b},f,"uCount")})}function b(){var a={url:P()+"user/search?ID=$$USER.ID&fields=customer:name,customer:fullUsers,customer:limitedUsers,customer:teamUsers",
type:"get",data:{},dataType:"json"};s(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==v[0]?l(function(){}):c(F[0],"uInfo,"+JSON.stringify(a.error)),t.hide(),J.hide()):a=a.data});a.fail(function(a,c,n){I({response:a.responseText,type:c,msg:n},b,"uInfo")})}function c(a,c,b){}function g(){if((L||E||"full"==getQueryString("view"))&&void 0!=e.get("host"))clearInterval(M),M=self.setInterval(function(){if(!document.hasFocus()||E)jQuery("#search-bar").is(":visible")&&jQuery("#search").click(),
jQuery("#form-list").hide(),void 0==e.get("sessionID")?ka():h()||W()},12E4)}function h(){var a=new Date,c=!1;e.get("date")!=a.getDay()&&(jQuery("#form-list").empty(),e.set("notified",!1),TASK_DB.dropTaskTable(),TASK_DB.createDB(),jQuery("#todayDate").html("Date: "+Z(a.getMonth())+" "+a.getDate()),e.set("date",a.getDay()),c=!0);oa();return c}function pa(){var a=e.get("view");void 0==a||"current"==a?ra("task",function(){jQuery("#button-current").click()}):"requested"==a?ra("task",function(){jQuery("#button-requested").click()}):
"all"==a?jQuery("#button-all").click():"team"==a?jQuery("#button-team").click():"role"==a?jQuery("#button-role").click():"recent"==a&&jQuery("#button-recent").click()}function ba(){if(""==e.get("access")&&!e.get("notified")){e.set("notified",!0);var a='<h3><div style="text-align: center; font-weight: bold;">Expired for '+e.get("host")+'</div></h3><div class="content"><div><p>To keep the ease of tracking your time, see due dates, and completing your tasks, please visit our site below to see licencing options for your company or to arrange an extended demo. If seeing this for the first time, another employee at your company has used this service 30 days ago, please contact info@atappstore.com to extend.</p></div><a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank"><img src="icons/AtAppStore.png" style=""></a><div style="font-size: 10px;">* this notification will only appear once daily.</div></div><div id="close" class="btn btn-primary" style="width:230px"><h3 style="line-height:0px">close</h3></div>';
TASK_CNTRL.showWindow(a);jQuery("#close").unbind("click").click(function(a){a.preventDefault();TASK_CNTRL.hideWindow()});e.get("userObj");e.get("license_expiry_days");f();b()}}function qa(){var a=jQuery("#content");a.after('<form id="form-qrlogin" class="form" style="display: none"><h3>Login to Workfront</h3><span class="error"></span><p><div id="outdiv" style="text-align:center;"></div><canvas id="qr-canvas" width="640" height="480" style="display:none;"></canvas><h4 id="result" style="text-align:center;"></h4><button type="submit" class="btn btn-success needsclick" style="display:none;" id="button-appscan" value="scan" tabindex="3">Scan</button><button type="submit" class="btn needsclick" style="" id="button-standard" tabindex="5">Standard Login</button><button type="submit" class="btn btn-primary needsclick" style="display:none;" id="button-qrlogin" value="login" tabindex="4">Login</button></form><div class="spinner-bottom"><div id="blockG_1" class="metro_blockG"></div><div id="blockG_2" class="metro_blockG"></div><div id="blockG_3" class="metro_blockG"></div></div>');
jQuery("#button-standard").live("click",function(a){a.preventDefault();da();jQuery("#form-qrlogin").show()});jQuery("#button-appscan").live("click",function(a){a.preventDefault();a=window.navigator.userAgent;a.match(/iPad/i)||a.match(/iPhone/i)?window.location="zxing://scan/?ret="+encodeURIComponent(window.location+"&code={CODE}"):window.location="http://zxing.appspot.com/scan?ret="+encodeURIComponent(window.location+"&code={CODE}")});a.after('<form id="form-login" class="form" style="display: none"><h3>Login to Workfront</h3><span class="error"></span><p><label for="username">Username</label><input type="text" name="username" id="username" class="text" tabindex="1"/></p><p><label for="password">Password</label><input type="password" name="password" id="password" class="text" tabindex="2" autocomplete="off"/></p><p><label for="host">Subdomain</label><input type="text" name="host" id="host" class="text" tabindex="3"/></p><p>eg. <strong>Subdomain</strong>.attask-ondemand.com</p></p></br><button type="submit" class="btn btn-primary needsclick" id="button-login" value="login" tabindex="4">Login</button><div class="spinner-bottom"><div id="blockG_1" class="metro_blockG"></div><div id="blockG_2" class="metro_blockG"></div><div id="blockG_3" class="metro_blockG"></div></div></form>');
a='<div id="hourTypeWindow" class="window"><h3><div style="text-align: center; font-weight: bold;">Track as Type:</div></h3><div class="content"><div><select id="hourTypeSelector" ></select><div><a href="#" id="done_hourType" class="btn btn-primary" rel="'+jQuery(this).attr("rel")+'" title="Done">Done</a><div></div>';jQuery("#window").after(a);if(L||"full"==getQueryString("view")||E)jQuery("#popout").replaceWith('<span id="refresh" style="float: right;" title="Manual Refresh"><img src="core/img/refresh.gif"></span>'),
jQuery("html").css("width","100%"),jQuery("#refresh").live("click",function(a){a.preventDefault();jQuery("#form-list").hide();jQuery("#search-bar").is(":visible")&&jQuery("#search").click();W()});a=new Date;a='<div class="btn-group"><a id="filter" title="Filter for other assigned tasks and issues" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">Filters<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="#" id="button-current" title="Tasks and issues you\'re working on" >Current</a></li><li><a href="#" id="button-recent" title="All tasks and issues tracked within 14 days" >Recent</a></li><li><a href="#" id="button-requested" title="Tasks and issues you can start on" >Requested</a></li><li><a href="#" id="button-all" title="All tasks and issues assigned to you" >All Assigned</a></li><li><a href="#" id="button-team" title="All tasks and issues assigned to your Teams" >Team Assigned</a></li><li><a href="#" id="button-role" title="All tasks and issues available to your Roles" >Role Assigned</a></li><li><a href="#" class="logout" id="button-logout" >Login as New User</a></li></ul></div><span id="totalHours" title="Go To Timesheets" class="btn" style="">Today\'s Hours: 0</span><span id="todayDate" class="btn disabled" style="">Date: '+
Z(a.getMonth())+" "+a.getDate()+"</span>";jQuery("#bar").html(a);jQuery("#totalHours").live("click",function(a){a.preventDefault();a="https://"+e.get("host")+"."+e.get("domain")+"/timesheets/current";E?window.open(a,"_blank","location=yes"):window.open(a);return!1});jQuery("#sort-task").live("click",function(a){a.preventDefault();R.priority="asc";R.project=R.date=R.priority="desc";R.task="asc"==R.task?"desc":"asc";jQuery("div#form-list>div").tsort({order:R.task})});jQuery("#sort-project").live("click",
function(a){a.preventDefault();R.priority="asc";R.task=R.date=R.priority="desc";R.project="asc"==R.project?"desc":"asc";jQuery("div#form-list>div").tsort(".details",{order:R.project})});jQuery("#sort-date").live("click",function(a){a.preventDefault();R.priority="asc";R.task=R.project="desc";R.date="asc"==R.date?"desc":"asc";jQuery("div#form-list>div").tsort(".days",{order:R.date,useVal:!0,attr:"data-days"})});jQuery("#sort-priority").live("click",function(a){a.preventDefault();R.task=R.project=R.date=
"desc";R.priority="asc"==R.priority?"desc":"asc";jQuery("div#form-list>div").tsort(".priority",{order:R.priority,useVal:!0,attr:"data-priority"})});jQuery(".done").live("click",function(a){a.preventDefault();a=jQuery(this).parent().parent().children("span.name").attr("title");var c=jQuery(this).parent().parent().children("span.details").attr("title");a='<h3><div style="text-align: center; font-weight: bold;">Confirm</div></h3><div class="content"><div><p>Are you sure you completed <strong>'+a+"</strong><br>from <br><strong>"+
c+'?</strong></h3><div><a href="#" id="done_confirm" class="btn btn-primary" rel="'+jQuery(this).attr("rel")+'" title="Done">Done</a><a href="#" class="btn cancel" title="Cancel">Cancel</a><div>';TASK_CNTRL.showWindow(a)});jQuery("#done_confirm").live("click",function(a){a.preventDefault();TASK_DB.updateValidate(jQuery(this).attr("rel"),function(a){y(a)});TASK_CNTRL.hideWindow()});jQuery("#cancel_confirm").live("click",function(a){a.preventDefault();TASK_CNTRL.hideWindow()});jQuery(".percent").live("click",
function(a){a.preventDefault();jQuery("#form-list").scrollTop(jQuery("#form-list").scrollTop()+jQuery("#item"+jQuery(this).attr("rel")).offset().top-100);if(0==jQuery(this).children("input").length){var c=jQuery(this).text().slice(0,-1);jQuery(this).html("<input type='number' class='inputbox' value=\""+c+'">');var b=function(a){var b=Number(jQuery(a).val()).toFixed(0);isNaN(b)||0>b||100<b||c==b?b=c:TASK_DB.updateValidate(jQuery(a).parent().attr("rel"),function(a){z(a,b)});jQuery(a).parent().text(b+
"%")};jQuery("input.inputbox").focus().blur(function(){b(this)}).keypress(function(a){13==a.which&&(b(this),a.preventDefault())})}});jQuery("#form-list").scroll(function(){e.set("vpos",jQuery("#form-list").scrollTop())});J=jQuery(".spinner-bottom");t=jQuery(".spinner")}function ca(){var a=function(a){jQuery("#button-current").removeClass("btn");jQuery("#button-requested").removeClass("btn");jQuery("#button-all").removeClass("btn");jQuery("#button-team").removeClass("btn");jQuery("#button-role").removeClass("btn");
jQuery("#button-recent").removeClass("btn");va();jQuery(a).toggleClass("btn")};jQuery("#button-current").live("click",function(){R=[];a("#button-current");e.set("view","current");sa()});jQuery("#button-requested").live("click",function(){R=[];a("#button-requested");e.set("view","requested");C()});jQuery("#button-all").live("click",function(){R=[];a("#button-all");e.set("view","all");ra()});jQuery("#button-team").live("click",function(){R=[];a("#button-team");e.set("view","team");ma()});jQuery("#button-role").live("click",
function(){R=[];a("#button-role");e.set("view","role");ja()});jQuery("#button-recent").live("click",function(){R=[];a("#button-recent");e.set("view","recent");na()});jQuery(".logout").live("click",function(){ka()})}function ka(){if(x&&e.get("allowOffline"))e.remove("sessionID"),e.remove("userID"),e.remove("username"),e.remove("password"),e.remove("host"),e.remove("domain");else{var a=e.get("qr");e.removeAll();e.set("qr",a)}for(var c in TASK_CNTRL.intervals)window.clearInterval(TASK_CNTRL.intervals[c]);
k()}function la(a){TASK_DB.loadAll(function(c){var b=c.length,d,e;if(0<b)for(d=0;d<b;d++)e=c[d],(null!=e&&"OPTASK"==e.details.objCode||"TASK"==e.details.objCode)&&jQuery("#item"+e.ID).hide();a()})}function l(a){e.get("ent")?O(a):T(e.get("username"),e.get("password"),aa(e.get("host")+"."+e.get("domain")),a,function(){k(a)})}function k(a){e.get("qr")?ga(a):da(a)}function O(a){t.show();jQuery("#loading").hide();clearInterval(M);TASK_DB.dropTaskTable();TASK_DB.createDB();TASK_CNTRL.toggleRunText();t.hide();
J.hide();jQuery("#top-bar").hide();jQuery("#bar").hide();jQuery(".form").hide();d(function(){oa(function(){B();a()},function(a){k(a)})})}function ga(a){t.show();jQuery("#loading").hide();clearInterval(M);TASK_DB.dropTaskTable();TASK_DB.createDB();TASK_CNTRL.toggleRunText();resetForQR();t.hide();J.hide();jQuery("#top-bar").hide();jQuery("#bar").hide();jQuery(".form").hide();jQuery("webcamimg").show();var c=jQuery("#form-qrlogin");jQuery("#form-list").html("");E?c.show():c.slideDown(400,function(){});
jQuery("#button-qrlogin").unbind("click").click(function(c){var b=jQuery("#form-qrlogin");c.preventDefault();J.show();T(e.get("username"),e.get("password"),aa(e.get("host")),function(){ignoreForQR();jQuery("#bar").show();E?b.hide():b.slideUp();jQuery("#top-bar").show();jQuery("#loading").show();void 0!=a&&a()},function(){resetForQR()})})}function da(a){t.show();jQuery("#loading").hide();clearInterval(M);TASK_DB.dropTaskTable();TASK_DB.createDB();TASK_CNTRL.toggleRunText();t.hide();J.hide();jQuery("#top-bar").hide();
jQuery("#bar").hide();jQuery(".form").hide();var c=jQuery("#form-login"),b=e.get("domain"),d=e.get("host");c.find(":input[name='username']").focus().val("");c.find(":input[name='host']").val(void 0==d||"undefined"==d?"":"attask-ondemand.com"!=b?d+"."+b:d);c.find(":input[name='password']").val("");jQuery("#form-list").html("");var f=jQuery("#username");E?(c.show(),f.focus()):c.slideDown(400,function(){f.focus()});jQuery("#button-login").unbind("click").click(function(b){b.preventDefault();J.show();
T(jQuery.trim(c.find(":input[name='username']").val()),jQuery.trim(c.find(":input[name='password']").val()),aa(jQuery.trim(c.find(":input[name='host']").val())),function(){jQuery("#bar").show();E?c.hide():c.slideUp();jQuery("#top-bar").show();jQuery("#loading").show();void 0!=a&&a()})})}function ha(a,c){var b=new Date;a.dateStr=b.getFullYear()+"-"+(b.getMonth()+1)+"-"+b.getDate();a.duration=c;x&&e.get("allowOffline")?(a.username=e.get("username"),a.userID=e.get("userID"),b=e.get("offlineTasks"),void 0==
b&&(b=[]),b.push(a),e.set("offlineTasks"),t.hide(),J.hide(),!0==e.get("logout_on_select")&&ka()):A(a,H)}function Z(a){return"jan. feb. mar. apr. may june jul. aug. sep. oct. nov. dec.".split(" ")[a]}function U(a){return void 0!=a.details.project?a.details.project.name.split(",").join(" ")+","+a.name.split(",").join(" "):a.details}function s(a,c){void 0==c&&(c=1E4);a.timeout=c;L&&(!E&&!wa)&&(a.dataType="jsonp",a.crossDomain=!0,a.jsonp="jsonp",a.cache=!0);var b=e.get("sessionID");e.get("ent")?a.data.apiKey=
b:a.data.sessionID=b}function aa(a){if(1<a.split(".").length){var c=a.split("//");return 1<c.length?(c.shift(),c[0]):a}return a+".attask-ondemand.com"}function T(c,b,d,f,h){if(void 0==c||void 0==b||void 0==d)h();else{var k=jQuery(".error");k.html("");var l={url:"https://"+d+"/attask/api/v2.0/login",type:"get",data:{username:c,password:b},dataType:"json"};s(l);x?e.get("allowOffline")?(l=e.get(c),void 0!=l?(Q(l.sessionID,l.userID,l.username,l.password,d),J.hide(),W(),g(),void 0!=f&&f()):k.html("OFFLINE")):
k.html("OFFLINE"):(l=jQuery.ajax(l),l.done(function(l){void 0!=l.error?(e.get("qr")?k.html("Please Scan Again."):k.html(l.error.message),J.hide(),void 0!==h&&h()):(l=l.data,Q(l.sessionID,l.userID,c,b,d),e.set("userObj",JSON.stringify(l)),J.hide(),a(function(){S();W();g();void 0!=f&&f()}))}),l.fail(function(a,c,b){a.responseText&&""!==a.responseText?-1!=a.responseText.indexOf("<html>")?e.get("qr")?k.html("Please Scan Again."):k.html("Host Invalid: "+d):e.get("qr")?k.html("Please Scan Again."):k.html(JSON.parse(a.responseText).error.message):
e.get("qr")?k.html("Please Scan Again."):k.html("Host Invalid: "+d);J.hide();void 0!==h&&h()}))}}function Q(a,c,b,d,f){e.set("sessionID",a);e.set("userID",c);e.set("username",b);e.set("password",d);f=f.split(".");e.set("host",f[0]);f.shift();e.set("domain",f.join("."));e.get("allowOffline")&&e.set(b,{sessionID:a,userID:c,username:b,password:d})}function oa(c,b){var d=e.get("sessionID");void 0==d||""==d?l(c):(t.show(),d={url:P()+"user/"+e.get("userID"),data:{updates:"{isActive: true}"},type:"PUT",
dataType:"json"},L&&(d.type="GET",d.data.method="PUT",s(d)),d=jQuery.ajax(d),d.done(function(d){void 0!=d.error?(d.error["class"]==v[0]?void 0!=b?b(c):l(c):(e.get("sessionID"),JSON.stringify(d.error)),t.hide(),J.hide()):(t.hide(),J.hide(),g(),void 0==e.get("auth_key")?a(W):W(),void 0!=c&&c())}),d.fail(function(a,d,r){401==a.status?void 0!=b?b(c):l(c):"timeout"==d?oa(c):e.get("sessionID")}))}function W(){t.show();var a=e.get("userID"),b={url:"https://"+e.get("host")+"."+e.get("domain")+"/attask/api-internal/timeSheet/search",
type:"get",data:{startDate:"$$TODAY+1",startDate_Mod:"lte",endDate:"$$TODAY-1",endDate_Mod:"gte",fields:"timesheetProfile:hourTypes:ID,timesheetProfile:hourTypes:name,timesheetProfile:hourTypes:description,timesheetProfile:hourTypes:isActive",userID:a},dataType:"json"};s(b,35E3);x?e.get("allowOffline")?(a=TASK_DB.userRunningTasks(a),void 0!=a&&(N=!0,TASK_DB.insert(a.name,{syncID:a.syncID,details:a.details},!0))):TASK_CNTRL.displayError("OFFLINE"):(a=jQuery.ajax(b),a.done(function(a){if(void 0!=a.error)a.error["class"]==
v[0]?l(function(){W()}):c(F[0],"addGeneralTasks-done,"+JSON.stringify(a.error));else if(a=a.data,0!=a.length&&void 0!=a[0].timesheetProfile&&void 0!=a[0].timesheetProfile.hourTypes){if(0!=a[0].timesheetProfile.hourTypes.length){var b=0;a=a[0].timesheetProfile.hourTypes;for(var d in a)a.hasOwnProperty(d)&&!0==a[d].isActive&&(b++,TASK_DB.insert(a[d].name,{syncID:a[d].ID,details:{objCode:"GEN",description:null!=a[d].description?"General - "+a[d].description:"'General"}},0))}pa();G();q()}else e.get("general")&&
ia()}),a.fail(function(a,c,d){I({response:a.responseText,type:c,msg:d,status:a.status},W,"addGeneralTasks-fail"+c+"-"+d+" "+a.responseText+" "+a.status+" "+JSON.stringify(b))}))}function S(){var a=new Date,b={url:P()+"hour/search",type:"get",data:{ownerID:e.get("userID"),entryDate:a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()},dataType:"json"};s(b);a=jQuery.ajax(b);a.done(function(a){if(void 0!=a.error)a.error["class"]==v[0]?l(function(){S()}):c(F[0],"getTaskHours-done,"+JSON.stringify(a.error));
else if(0!==a.data.length){var b={};a.data.forEach(function(a,c){b[a.ID]=a.hours});e.set("initial_hours",b)}});a.fail(function(a,c,d){I({response:a.responseText,type:c,msg:d,status:a.status},S,"getTaskHours-fail"+c+"-"+d+" "+a.responseText+" "+a.status+" "+JSON.stringify(b))})}function B(){var a={url:P()+"HourType/search",type:"get",data:{fields:"ID",name:"Stopwatch",name_Mod:"cicontains"},dataType:"json"};s(a);var b=jQuery.ajax(a);b.done(function(a){if(void 0!=a.error)a.error["class"]==v[0]?l(function(){B()}):
c(F[0],"getStopwatchHourType-done,"+JSON.stringify(a.error));else if(0!==a.data.length){var b={};a.data.forEach(function(a,c){b[a.name.replace("Stopwatch ","")]=a.ID});e.set("sw_hour_types",b)}});b.fail(function(c,b,d){I({response:c.responseText,type:b,msg:d,status:c.status},B,"getStopwatchHourType-fail"+b+"-"+d+" "+c.responseText+" "+c.status+" "+JSON.stringify(a))})}function ia(){t.show();var a={url:P()+"HourType/search",type:"get",data:{fields:"ID,name,description",isActive:!0},dataType:"json"};
s(a,35E3);var b=jQuery.ajax(a);b.done(function(a){if(void 0!=a.error)a.error["class"]==v[0]?l(function(){ia()}):c(F[0],"addAllGeneralTasks-done,"+JSON.stringify(a.error));else{a=a.data;var b=0,d;for(d in a)a.hasOwnProperty(d)&&("Task Time"!=a[d].name&&"Issue Time"!=a[d].name)&&(b++,TASK_DB.insert(a[d].name,{syncID:a[d].ID,details:{objCode:"GEN",description:null!=a[d].description?"General - "+a[d].description:"'General"}},0));pa();G();q()}});b.fail(function(c,b,d){I({response:c.responseText,type:b,
msg:d,status:c.status},ia,"addAllGeneralTasks-fail"+b+"-"+d+" "+c.responseText+" "+c.status+" "+JSON.stringify(a))})}function I(a,b,d,e){if(401==a.status)l(function(){b()});else if("timeout"==a.type)b();else{if(void 0!=a.response&&""!=a.response){var f;f="message"in a.response?a.response.message:JSON.stringify(a.response);TASK_CNTRL.displayError("Workfront Error: "+f+"<br>"+(void 0!=e&&""!=e?e:""))}c(F[0],d+","+a.msg+" "+a.type+" "+JSON.stringify(a.response)+" "+e)}}function P(a){void 0==a&&(a="v7.0");
return"https://"+e.get("host")+"."+e.get("domain")+"/attask/api/"+a+"/"}function ra(a,b){a=void 0==a?"task":a;t.show();var d={url:P()+a+"/search",type:"get",data:{canStart:!0,status:"N",status_Mod:"contains","project:status":"CUR",fields:"parent,priority,project,plannedCompletionDate,permissions","assignments:status":"DN","assignments:status_Mod":"ne",$$LIMIT:2E3},dataType:"json"},f=e.get("currentRole");"role"==e.get("view")&&void 0!=f?d.data.roleID=f.ID:d.data["assignments:assignedToID"]=e.get("userID");
"task"==a&&(d.data.fields+=",percentComplete");s(d);d=jQuery.ajax(d);d.done(function(d){if(void 0!=d.error)d.error["class"]==v[0]?l(function(){ra(a,b)}):c(F[0],"addAllAssignedTasks-"+a+","+JSON.stringify(d.error)),t.hide(),J.hide();else{d=d.data;var f=!0,r=e.get("view");"all"!=r&&"role"!=r&&(f=!1);if("optask"!=a)ra("optask",b),la(function(){var a=d.length;if(a){for(var c=[],b=0;b<a;b++)-1!=d[b].permissions.actions.indexOf("ADD_HOURS")&&-1!=d[b].permissions.actions.indexOf("CHANGE_STATUS")&&(TASK_DB.insert(d[b].name,
{syncID:d[b].ID,details:d[b]},f&&b==a-1),c[d[b].ID]=!0);TASK_DB.running(function(a){void 0==c[a.syncID]&&TASK_CNTRL.toggleTimer(task)},function(a){})}});else{r=d.length;N=f;if(r){for(var g=[],h=0;h<r;h++)-1!=d[h].permissions.actions.indexOf("ADD_HOURS")&&-1!=d[h].permissions.actions.indexOf("CHANGE_STATUS")&&(TASK_DB.insert(d[h].name,{syncID:d[h].ID,details:d[h]},f&&h==r-1),g[d[h].ID]=!0);TASK_DB.running(function(a){void 0==g[a.syncID]&&TASK_CNTRL.toggleTimer(task)},function(a){})}else TASK_CNTRL.showAll(d);
b&&b()}}});d.fail(function(a,c,b){I({response:a.responseText,type:c,msg:b},ra,"addAllAssignedTasks-fail"+c+"-"+b+" "+a.responseText)})}function ja(a){t.show();var b={url:P("v5.0")+"user/search",type:"get",data:{fields:"role:*,roles:*",ID:e.get("userID")},dataType:"json"};s(b);b=jQuery.ajax(b);b.done(function(b){if(void 0!=b.error)b.error["class"]==v[0]?l(function(){ja(a)}):c(F[0],"addAllRoleTasks,"+JSON.stringify(b.error)),t.hide(),J.hide();else if(b=b.data[0],0==b.length)a&&a(),t.hide(),J.hide();
else{var d=jQuery("#role-filter"),f=function(){ra("task",function(){d.css("display","inline-block");t.hide();J.hide()})},m=function(a,b){e.set("currentRole",{name:a,ID:b});d.find("button").html("<strong>Role: </strong><span>"+a+'</span><span class="caret"></span>');f()},g=e.get("currentRole");void 0!=g?m(g.name,g.ID):void 0!=b.role&&m(b.role.name,b.role.ID);if(void 0!=b.roles&&0!=b.roles.length)for(var g=d.find(".dropdown-menu").html("").first(),h=0,k=b.roles.length;h<k;h++)g.append('<li><a href="#" id="'+
b.roles[h].ID+'">'+b.roles[h].name+"</a></li>"),g.find("#"+b.roles[h].ID).click(function(){m(jQuery(this).text(),jQuery(this).attr("id"))});else va(),t.hide(),J.hide(),jQuery("#button-current").click(),TASK_CNTRL.showWindow('<h3><div style="text-align: center; font-weight: bold;">Roles</div></h3><div class="content"><div><p>No additional roles available.</strong></h3><div><a href="#" class="btn btn-primary cancel" title="Ok">Ok</a><div>')}});b.fail(function(a,b,c){I({response:a.responseText,type:b,
msg:c},ja,"addAllRoleTasks")})}function va(){var a=jQuery("#role-filter");a.hide();a.find(".dropdown-menu").first().html("")}function ma(a){t.show();var b={url:P()+"team/search",type:"get",data:{fields:"ID","users:ID":e.get("userID")},dataType:"json"};s(b);b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==v[0]?l(function(){ma(a)}):c(F[0],"addAllGroupTasks,"+JSON.stringify(b.error)),t.hide(),J.hide()):(b=b.data,0==b.length?(a?a():jQuery("#form-list").hide(),t.hide(),J.hide(),TASK_CNTRL.showNoTaskWindow()):
la(function(){for(var c=b.length,d=function(b,d){if(0==--c){var e=V.length;N=!0;if(0==e)TASK_CNTRL.showAll(V);else{for(var f=0;f<e;f++)TASK_DB.insert(V[f].name,{syncID:V[f].ID,details:V[f]},f==e-1);V=[];a&&a()}}},e=0;e<c;e++)ua("task",b[e].ID,d)}))});b.fail(function(a,b,c){I({response:a.responseText,type:b,msg:c},ma,"addAllGroupTasks")})}function ua(a,b,d){a=void 0==a?"task":a;t.show();var e={url:P()+a+"/search?project:status=INF",type:"get",data:{canStart:!0,status:"N",status_Mod:"contains","project:status":"CUR",
fields:"parent,priority,project,plannedCompletionDate",$$LIMIT:1E3,"team:ID":b},dataType:"json"};"task"==a&&(e.data.fields+=",percentComplete");s(e);e=jQuery.ajax(e);e.done(function(e){if(void 0!=e.error)e.error["class"]==v[0]?l(function(){ua(a,b,d)}):c(F[0],"addGroupTasks-"+a+","+JSON.stringify(e.error)),t.hide(),J.hide();else if(e=e.data,0==e.length)d&&d(a,b);else if("optask"!=a){ua("optask",b,d);for(var f=e.length,g=0;g<f;g++)V.push(e[g])}else{f=e.length;for(g=0;g<f;g++)V.push(e[g]);d&&d(a,b)}});
e.fail(function(a,b,c){I({response:a.responseText,type:b,msg:c},ua,"addGroupTasks-fail"+b+"-"+c+" "+a.responseText)})}function na(){t.show();var a={url:P()+"hour/report",type:"get",data:{"task:canStart":!0,taskID_1_GroupBy:!0,entryDate:"$$TODAY-14d",entryDate_Range:"$$TODAY",entryDate_Mod:"between"},dataType:"json"};s(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==v[0]?l(function(){na()}):c(F[0],"addRecentTasks,"+JSON.stringify(a.error)),t.hide(),J.hide()):(a=Object.keys(a.data),
0==a.length?(N=!0,la(function(){TASK_CNTRL.showAll(a)})):la(function(){N=!0;TASK_CNTRL.showAll(TASK_CNTRL.taskDB.loadSyncIds(a))}))});a.fail(function(a,b,c){I({response:a.responseText,type:b,msg:c},na,"addRecentTasks")})}function sa(){t.show();var a={url:P()+"work/myWork",type:"get",data:{fields:"parent,priority,project,plannedCompletionDate"},dataType:"json"};s(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==v[0]?l(function(){sa()}):c(F[0],"addCurrentTasks,"+JSON.stringify(a.error)),
t.hide(),J.hide()):(a=a.data,0==a.length?(N=!0,la(function(){TASK_CNTRL.showAll(a)})):la(function(){var b=a.length;N=!0;for(var c=0;c<b;c++)TASK_DB.insert(a[c].name,{syncID:a[c].ID,details:a[c]},c==b-1)}))});a.fail(function(a,b,c){I({response:a.responseText,type:b,msg:c},sa,"addCurrentTasks")})}function C(){t.show();var a={url:P()+"work/workRequests",type:"get",data:{canStart:!0,fields:"parent,priority,project,plannedCompletionDate"},dataType:"json"};s(a);a=jQuery.ajax(a);a.done(function(a){void 0!=
a.error?(a.error["class"]==v[0]?l(function(){C()}):c(F[0],"addRequestedTasks,"+JSON.stringify(a.error)),t.hide(),J.hide()):(a=a.data,0==a.length?(N=!0,la(function(){TASK_CNTRL.showAll(a)})):la(function(){var b=a.length;N=!0;for(var c=0;c<b;c++)TASK_DB.insert(a[c].name,{syncID:a[c].ID,details:a[c]},c==b-1)}))});a.fail(function(a,b,c){I({response:a.responseText,type:b,msg:c},C,"addRequestedTasks")})}function q(){var a={url:P()+"user/search",data:{"hourTypes:isActive":!0,fields:"hourTypes:ID,hourTypes:name,hourTypes:description,hourTypes:countAsRevenue",
ID:e.get("userID")},type:"get",dataType:"json"};s(a);w=!1;a=jQuery.ajax(a);a.done(function(a){if(void 0!=a.error)a.error["class"]==v[0]?l(function(){}):c(F[0],"getHourTypes,"+JSON.stringify(a.error)),t.hide(),J.hide();else if(a=a.data,void 0!=a&&0!=a.length&&0!=a[0].hourTypes.length){w=!0;var b=e.get("sw_hour_types"),d=jQuery("#hourTypeSelector");d.text("");var f=null;b&&void 0!=b["Task Time"]&&(f=b["Task Time"]);d.append(jQuery("<option />").val(f).text("Task Time"));jQuery.each(a[0].hourTypes,function(){var a=
this.ID;b&&void 0!=b[this.name]&&(a=b[this.name]);d.append($("<option />").val(a).text(this.name))})}});a.fail(function(a,b,c){401==a.status?l(function(){}):"timeout"==b&&q()})}function Y(a,b){TASK_CNTRL.showWindow(null,"#hourTypeWindow");jQuery("#done_hourType").unbind("click").bind("click",function(c){c.preventDefault();a.hourTypeID=jQuery("#hourTypeSelector").find(":selected").val();b(a);TASK_CNTRL.hideWindow("#hourTypeWindow")})}function X(a){var b=e.get("todaySched");null!=b?a(b):(b={url:P("v4.0")+
"user/search?ID=$$USER.ID&fields=schedule:*,schedule:nonWorkDays:*",type:"get",data:{},dataType:"json"},s(b),b=jQuery.ajax(b),b.done(function(b){if(void 0!=b.error)b.error["class"]==v[0]?l(function(){}):c(F[0],"getSchedule,"+JSON.stringify(b.error)),t.hide(),J.hide();else if(b=b.data[0].schedule,0!=b.length){var d=new Date,f=b["sunday monday tuesday wednesday thursday friday saturday".split(" ")[d.getDay()]],g;if(!0==b.hasNonWorkDays){for(var m=0;m<b.nonWorkDays.length;m++)if(b.nonWorkDays[m].nonWorkDate==
d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate()&&(void 0!=g&&null!=b.nonWorkDays[m].userID||void 0==g))g=b.nonWorkDays[m].scheduleDay;void 0!=g&&(f=g)}void 0!=f&&0!=f.length&&(f={start:f[0],stop:f[1]},e.set("todaySched",f));a&&a(f)}}),b.fail(function(b,c,d){401==b.status?l(function(){}):"timeout"==c&&X(a)}))}function G(){var a=new Date,a={url:P()+"hour/report?hours_AggFunc=sum",type:"get",data:{entryDate:a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate(),ownerID:e.get("userID")},dataType:"json"};
s(a);a=jQuery.ajax(a);a.done(function(a){void 0!=a.error?(a.error["class"]==v[0]?l(function(){}):c(F[0],"getTodaysTotalHours,"+JSON.stringify(a.error)),t.hide(),J.hide()):(a=a.data,jQuery("#totalHours").html("Today's Hours: "+(null==a.sum_hours?"0":a.sum_hours.toFixed(2))))});a.fail(function(a,b,c){401==a.status?l(function(){}):"timeout"==b&&G()})}function y(a){t.show();var b={assignedToID:e.get("userID")};"OPTASK"==a.details.objCode?b.opTaskID=a.syncID:b.taskID=a.syncID;b={url:P()+"assignment/search",
type:"get",data:b,dataType:"json"};s(b);b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==v[0]?l(function(){y(a)}):c(F[0],"getTaskAssignment,"+a.syncID+","+JSON.stringify(b.error)),t.hide(),J.hide()):(b=b.data[0],a.running?(a.done=1,TASK_CNTRL.stopTask(a),TASK_CNTRL.toggleRunText()):ea(b,a))});b.fail(function(b,c,d){I({response:b.responseText,type:c,msg:d},function(){y(a)},"getTaskAssignment,"+a.syncID)})}function ea(a,b){t.show();var d={url:P()+"assignment/"+a.ID,data:{status:"DN"},
type:"PUT",dataType:"json"};L&&(d.data={method:"put"},s(d));d=jQuery.ajax(d);d.done(function(d){void 0!=d.error?(d.error["class"]==v[0]?l(function(){ea(a,b)}):c(F[0],"setAssignmentDone,"+a.ID+","+JSON.stringify(d.error)),t.hide(),J.hide()):(TASK_DB.remove(b.ID),t.hide(),J.hide(),c(F[2],U(b)+",assignment done"),D(b))});d.fail(function(c,d,e){I({response:c.responseText,type:d,msg:e},function(){ea(a,b)},"setAssignmentDone,"+a.ID+", "+c.responseText)})}function D(a){t.show();var b={url:P()+"assignment/count",
data:{status:"DN",status_Mod:"ne"},type:"GET",dataType:"json"};"OPTASK"==a.details.objCode?b.data.opTaskID=a.syncID:b.data.taskID=a.syncID;s(b);b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==v[0]?l(function(){D(a)}):c(F[0],"getTaskDoneAssignmentCount,"+taskID+","+JSON.stringify(b.error)),t.hide(),J.hide()):(b=b.data,t.hide(),J.hide(),0==b.count&&u(a))});b.fail(function(b,c,d){I({response:b.responseText,type:c,msg:d},function(){D(a)},"getTaskDoneAssignmentCount,"+a.syncID)})}
function u(a){var b=a.syncID;t.show();var d="OPTASK"==a.details.objCode?"CLS":"CPL",d={url:P()+a.details.objCode.toLowerCase()+"/"+b,data:{status:d},type:"PUT",dataType:"json"};L&&(d.data={method:"put"},s(d));d=jQuery.ajax(d);d.done(function(d){void 0!=d.error?(d.error["class"]==v[0]?l(function(){u(a)}):I({response:d.error,type:null,msg:null},function(){u(a)},"setTaskDone,"+b),t.hide(),J.hide()):(t.hide(),J.hide(),c(F[2],U(a)+",task done"))});d.fail(function(c,d,e){I({response:c.responseText,type:d,
msg:e},function(){u(a)},"setTaskDone,"+b+", "+c.responseText)})}function ta(a){t.show();var b={url:P()+a.details.objCode.toLowerCase()+"/"+a.syncID,data:{status:"INP"},type:"PUT",dataType:"json"};L&&(b.data={method:"put"},s(b));b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==v[0]?l(function(){ta(a)}):I({response:b.error,type:null,msg:null},function(){ta(a)},"setTaskInProgress,"+a.syncID),t.hide(),J.hide()):(t.hide(),J.hide(),!0==e.get("logout_on_select")&&ka())});b.fail(function(b,
c,d){I({response:b.responseText,type:c,msg:d},function(){ta(a)},"setTaskInProgress-fail,"+a.syncID+", "+b.responseText)})}function z(a,b){t.show();var c={url:P()+a.details.objCode.toLowerCase()+"/"+a.syncID,data:{updates:"{ percentComplete: "+b+"}"},type:"PUT",dataType:"json"};L&&(c.data={method:"put"},s(c));c=jQuery.ajax(c);c.done(function(c){void 0!=c.error?c.error["class"]==v[0]?l(function(){z(a,b)}):I({response:c.error,type:null,msg:null},function(){z(a,b)},"setTaskPercent,"+a.syncID):(a.details.percentComplete=
b,TASK_DB.updateDetails(a.ID,a.details));t.hide();J.hide()});c.fail(function(c,d,e){I({response:c.responseText,type:d,msg:e},function(){z(a,b)},"setTaskPercent-fail,"+a.syncID+", "+c.responseText)})}function H(a,b){var d,f={ownerID:e.get("userID")};void 0==b||-1!=b.permissions.actions.indexOf("ADD_HOURS")&&-1!=b.permissions.actions.indexOf("CHANGE_STATUS")?(d=0,f.method="post"):(d=b.hours,f.method="put",f.ID=b.ID);if("GEN"==a.details.objCode)f.hourTypeID=a.syncID,f.ID=null,f.projectID=null,f.taskID=
null,f.opTaskID=null;else if("OPTASK"==a.details.objCode?f.opTaskID=a.syncID:f.taskID=a.syncID,void 0!=(f.hourTypeID=e.get("swHourTypeID"))&&void 0!=a.hourTypeID&&""!=a.hourTypeID)f.hourTypeID=a.hourTypeID;isNaN(d)&&(d=0);f.entryDate=a.dateStr;var g=Number((a.duration/3600).toFixed(2));e.get("nearestHour")&&(g=Math.round(g));f.hours=parseFloat((g+parseFloat((""+d).split(".").join("."))+" ").split(".").join("."));f.ownerID=e.get("userID");c(F[1],"setHourAttask, oldhr: "+d+" method: "+f.method+" start: "+
a.dateStr+" task: "+JSON.stringify(a)+" sid: "+e.get("sessionID")+" time: "+(new Date).toTimeString());var h=function(){t.show();var b={url:P("v5.0")+"hour/",type:"get",data:f,dataType:"json"};s(b);b=jQuery.ajax(b);b.done(function(b){void 0!=b.error?(b.error["class"]==v[0]?l(function(){h()}):(I({response:b.error,type:null,msg:null},h,"setHourAttask,"+a.syncID+" "+a.name+" url: "+P()+" "+JSON.stringify(f)+" "+U(a)+","+a.duration,'Time was not tracked, please click on "View" for task: '+a.name+" to record time manually."),
A(a)),t.hide(),J.hide()):(G(),void 0!=f.taskID||void 0!=f.opTaskID?ta(a):!0==e.get("logout_on_select")&&ka(),t.hide(),J.hide(),c(F[2],U(a)),a.done&&y(a))});b.fail(function(b,c,d){I({response:b.responseText,type:c,msg:d},h,"setHourAttask-fail,"+a.syncID+" "+a.name+" url: "+P()+" "+JSON.stringify(f)+" "+U(a)+","+a.duration+", "+b.responseText+", "+d,b.responseText+'<br>Time was not tracked, please click on "View" for task: '+a.name+" to record time manually.");A(a)})};h()}function A(a,b){var d={};d.entryDate=
a.dateStr;d.fields="permissions,ID,hours";d.ownerID=e.get("userID");"GEN"==a.details.objCode?(d.hourTypeID=a.syncID,d.projectID=null,d.taskID=null,d.opTaskID=null):("OPTASK"==a.details.objCode?d.opTaskID=a.syncID:d.taskID=a.syncID,void 0!=a.hourTypeID&&""!=a.hourTypeID&&(d.hourTypeID=a.hourTypeID));d={url:P()+"hour/search",type:"get",data:d,dataType:"json"};s(d);d=jQuery.ajax(d);d.done(function(d){if(void 0!=d.error)d.error["class"]==v[0]?l(function(){A(a,b)}):c(F[0],"getHour,"+a.syncID+","+JSON.stringify(d.error)),
t.hide(),J.hide();else if(c(F[1],"getHour "+d.data.length+" "+JSON.stringify(d.data)),b){for(var e=d.data.length,f=0;f<e;f++)if(-1!=d.data[f].permissions.actions.indexOf("ADD_HOURS")&&-1!=d.data[f].permissions.actions.indexOf("CHANGE_STATUS")){b(a,d.data[f]);return}b(a,d.data[0])}});d.fail(function(a,b,c){JSON.stringify(c)})}var v=["com.attask.common.AuthenticationException"],F=["error","debug","informational"],e,L=!(window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows")),E=-1===
document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")&&L,wa=-1!==document.URL.indexOf("dashboard.directory"),w=!1,x=!1,V=[];e=!L||E?new Store("Attask"):{settings:[],set:function(a,b){switch(a){case "domain":case "host":case "userID":case "sessionID":case "username":case "date":case "view":this.setCookie(a,b,9999999999)}this.settings[a]=b},get:function(a){switch(a){case "domain":case "host":case "userID":case "sessionID":case "username":case "date":case "view":var b=void 0===this.settings[a]?
this.getCookie(a):this.settings[a];this.settings[a]=b;return"undefined"==b||void 0==b?void 0:b;default:return!this.settings.hasOwnProperty(a)||"undefined"==this.settings[a]||void 0==this.settings[a]?void 0:this.settings[a]}},removeAll:function(){var a=new Date,b;for(b in this.settings)this.settings.hasOwnProperty(b)&&(document.cookie=b+"="+this.settings[b]+";expires="+a.toGMTString()+";;");this.settings=[]},setCookie:function(a,b,c){var d=new Date;d.setHours(0);d.setMinutes(0);d.setSeconds(0);d.setDate(d.getDate()+
c);b=encodeURI(b)+(null==c?"":"; expires="+d.toUTCString());document.cookie=a+"="+b},getCookie:function(a){var b,c,d,e=document.cookie.split(";");for(b=0;b<e.length;b++)if(c=e[b].substr(0,e[b].indexOf("=")),d=e[b].substr(e[b].indexOf("=")+1),c=c.replace(/^\s+|\s+$/g,""),c==a)return decodeURI(d);return"undefined"}};var M;OB.init.add(function(){void 0==e.get("qr")&&e.set("qr","true"==jQuery.urlParam("qr")||!1!=jQuery.urlParam("code"));qa();ca();g();var a=jQuery.urlParam("s"),b=jQuery.urlParam("d");
0!=b&&(0!=a&&e.set("sessionID",a),a=b.split("."),e.set("host",a[0]),a.shift(),e.set("domain",a.join(".")),void 0==e.get("ent")&&(e.set("userID",jQuery.urlParam("u")),e.set("password",""),e.set("ent",void 0!=e.get("userID"))));h();!0==e.get("qr")&&void 0==e.get("sessionID")&&(!1!=jQuery.urlParam("code")?(document.getElementById("button-appscan").style.display="block",qrRead(jQuery.urlParam("code"),e)):qrLoad(e))});OB.onLoad.add(function(){document.addEventListener("resume",function(){jQuery("#loading").show();
h()||g()},!1);document.addEventListener("pause",function(){jQuery("#form-list").html("")},!1);document.addEventListener("menubutton",function(){TASK_CNTRL.showWindow('<h3><div style="text-align: center; font-weight: bold;">Welcome</div></h3><div class="content"><p>If you have any questions please visit <a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank" class="btn" >store.atappstore.com</a></p><a href="#" class="btn btn-primary cancel" title="Done">Done</a></div>')},
!1);document.addEventListener("offline",function(a){x=!0});document.addEventListener("online",function(a){a=e.get("offlineTasks");JSON.stringify(a);e.set("offlineTasks",[]);x=!1})});OB.stop.add(function(a,b){t.show();var c,d;c=new Date(a.start);d=new Date;if(e.get("minuteBufferSnapToSched")){var f=e.get("todaySched"),g=e.get("minuteBuffer"),h=d.toLocaleDateString("en-US"),k=Date.parse(h+f.start),f=Date.parse(h+f.stop),h=new Date(k);c<k&&c>h.setMinutes(h.getMinutes()-g)&&(c=new Date(k));h=new Date(f);
d>f&&d<h.setMinutes(h.getMinutes()+g)&&(d=new Date(f));if(c>=d){t.hide();return}b=Math.floor((d.getTime()-c.getTime())/1E3)}0==b?t.hide():w?Y(a,function(a){ha(a,b)}):ha(a,b)});OB.update.add(function(a,b){J.show();ha(a,b)});OB.preStart.add(function(a){a.running?TASK_CNTRL.toggleTimer(a):function(){TASK_DB.loadAll(function(b){var c,d,f=!1,g=b.length;for(c=0;c<g;c++)if(d=b[c],null!=d&&d.running&&a.ID!=d.ID){TASK_CNTRL.toggleTimer(d);f=!0;break}w&&e.get("track_interval")?Y(a,function(a){TASK_CNTRL.toggleTimer(a)}):
(TASK_CNTRL.toggleTimer(a),!f&&!0==e.get("logout_on_select")&&ka())})}()});OB.postAllItemRender.add(function(){jQuery(".remove").css("display","none");jQuery(".update").css("display","none");jQuery(".reset").css("display","none");e.get("is_auth")?jQuery("#storelink").text("AtAppStore"):(jQuery("#sort-date").remove(),jQuery(".timer").remove(),jQuery(".done").remove(),jQuery(".percent").remove(),jQuery(".date").removeClass("date").addClass("date-tall").html('<a href="http://store.atappstore.com/index.php/portfolio/stopwatch/" target="_blank">Trial Expired</a>'),
jQuery("#storelink").text("Trial Expired - AtAppStore"));if(N){var a=jQuery("#form-list"),b=e.get("vpos");void 0!=b&&a.scrollTop(b);"team"==e.get("view")&&!0==e.get("hide_team_done")&&jQuery(".done").remove();x?e.get("allowOffline")&&(jQuery(".done").remove(),jQuery(".percent").remove(),jQuery(".view").remove(),jQuery("#bar").hide()):jQuery("#bar").show();b=e.get("sort");void 0==b&&(b="date");jQuery("#sort-"+b).click();jQuery("#search-bar").is(":visible")&&jQuery("#search").click();jQuery("#loading").hide();
a.show();a=jQuery("#holder")[0];a.style.display="none";a.style.display="block";t.hide();N=!1}});OB.postItemRender.add(function(a){if(0==jQuery("#item"+a.ID+" #buttons .view").length){var b=jQuery("#item"+a.ID+" #buttons"),c=["",{label:"Low",css:"default"},{label:"Normal",css:"success"},{label:"High",css:"warning"},{label:"Urgent",css:"danger"}];"GEN"!=a.details.objCode&&(void 0!=a.details.priority&&0!=a.details.priority)&&(c=c[a.details.priority],b.append('<span class="task priority '+c.css+'" title="'+
c.label+'" data-priority="'+a.details.priority+'">'+c.label[0]+"</span> "));var d;"GEN"==a.details.objCode?(d="General",jQuery("#item"+a.ID).css({background:"aliceblue"})):"OPTASK"==a.details.objCode?(d="Issue",b.append('<span class="issue" title="Issue">I</span> ')):"TASK"==a.details.objCode&&(d="Task",b.append('<span class="task" title="Task">T</span> '));"General"!=d&&(b.append('<a href="https://'+e.get("host")+"."+e.get("domain")+"/"+d.toLowerCase()+"/view?ID="+a.syncID+'" target="_blank" class="btn btn-mini view" rel="'+
a.ID+'" title="View '+d+'">View</a> '),b.append('<a href="#" class="btn btn-mini done" rel="'+a.ID+'" title="Done '+d+'">Done</a> '));"Task"==d&&void 0!=a.details.percentComplete&&b.append('<a href="#" class="btn btn-mini percent" rel="'+a.ID+'" title="Percent Completed">'+a.details.percentComplete+"%</a> ");b="#D2E0FF";c='<span class="date" style="background-color: #EEE;"><span class="days" data-days="9999"></span></span>';if("General"!=d&&void 0!=a.details.plannedCompletionDate){var c=a.details.plannedCompletionDate.split("T")[0],
c=c.split("-"),c=new Date(c[0],Number(c[1])-1,c[2]),f=new Date;f.setHours(0);f.setMinutes(0);f.setSeconds(0);f=Math.round((c-f)/1E3/60/60/24);0>f?b="#FFCDCD":1>=f&&(b="#FFD7AB");var g;g=0<f?"days due: "+f:"days late: "+Math.abs(f);c='<div class="date" style="background-color: '+b+';"><div class="days" data-days="'+f+'">'+g+"</div><div>"+Z(c.getMonth())+" "+c.getDate()+", "+c.getFullYear()+"</div></div>"}b="";null!=a.details.parent&&(b="<br><br>Parent Task: <br>"+a.details.parent.name);jQuery("#item"+
a.ID+" .name").attr("title",d+": <br>"+a.name+b);"General"!=d?(d=a.details.project.name,jQuery("#item"+a.ID+" .details").html(d).attr("title","Project: <br>"+d).attr("data-priority",a.details.priority),jQuery("#item"+a.ID+" .c6").after(c)):jQuery("#item"+a.ID+" .details").html("~"+a.details.description).attr("title",a.details.description)}});OB.remove.add(function(a){jQuery("#item"+a).remove()});OB.reset.add(function(a,b){OB.update.dispatch(b,-b.time);jQuery("#item"+a+" .timer").text(TASK_CNTRL.hms(0))});
var N=!1,J,t,R=[]}();function taskController(d){var a,f=window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows"),b=-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")&&!f;jQuery.urlParam=function(a){a=RegExp("[\\?&]"+a+"=([^&#]*)").exec(window.location.href);return!a?0:a[1]||0};OB.start.add(function(a){startNotify(a)});OB.stop.add(function(a){stopNotify(a)});OB.onLoad.add(function(){});OB.postAllItemRender.add(function(){b&&(jQuery("#form-list").height(0),a=124);if(!f||"full"==
getQueryString("view")){var c=function(){var b=jQuery("#form-list"),c;c=b.height();c+=window.innerHeight-a;0!=window.innerHeight-a&&b.height(c);a=window.innerHeight};jQuery(window).unbind("resize");jQuery(window).bind("resize",c);c()}c={style:{tip:{corner:!0,width:5,height:5},def:!1,classes:"qtip-info"},position:{adjust:{method:"flip flip"},at:"bottom left",my:"top left",viewport:jQuery(window)},show:{},hide:{delay:0}};jQuery("span[title]").qtip(c);b||jQuery("a[title]").qtip(c);c.content="time < 30 seconds<br> time was not tracked";
c.show.event=!1;c.hide.delay=b?0:2E3;var d=jQuery(".timer");d.qtip(c);b||d.mouseover(function(){var a=jQuery(this).find(".time").hide(),b=jQuery(this).find(".timer-info").show();setTimeout(function(){a.show();b.hide()},3E3)}).mouseout(function(){jQuery(this).find(".time").show();jQuery(this).find(".timer-info").hide()});b&&(jQuery(".item").css("padding-right","5px"),jQuery(".task").css("padding-right","5px").css("padding-left","5px"),jQuery(".issue").css("padding-right","5px").css("padding-left",
"5px"),jQuery("body").css("font-size","12px"));jQuery("#searchfor").domsearch("#form-list",{unit:"div.item:visible",criteria:["span[oldtitle]"]})});return{intervals:[],taskDB:d,init:function(){this.bind();this.toggleRunText();var b=jQuery("#form-list");!f||"full"==getQueryString("view")?(b.css("max-height","100%"),b.css("height","439px")):b.css("max-height","439px");!f&&(window.webkitNotifications&&0!=window.webkitNotifications.checkPermission())&&window.open("core/js/permission.html","Permission",
"height=540,width=447");a=567},bind:function(){b&&jQuery("a[target='_blank']").live("click",function(a){a.preventDefault();window.open(jQuery(this).attr("href"),"_blank","location=yes");return!1});jQuery("#cover").hide();jQuery(".cancel").live("click",function(a){a.preventDefault();jQuery("#"+jQuery(this).attr("rel")).hide().hide().find("input:text").val("");jQuery("#form-list").show();jQuery("#top-bar").show();jQuery("#bar").show()});jQuery("#search").live("click",function(a){a.preventDefault();
jQuery("#sort-bar").toggle();jQuery("#search-bar").toggle();jQuery("#searchfor").focus().val("").domsearchClear()});jQuery("#popout").live("click",function(a){a.preventDefault();f&&window.chrome.windows.create({url:"index.html?view=full",type:"popup",width:393,height:600})});jQuery("#create").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#form-create").slideDown().find("input[name='task-name']").focus()});var a=this;jQuery("#button-create").live("click",function(){a.taskDB.insert(jQuery("#form-create :input[name='task-name']").val());
jQuery("#form-create").hide().find("input:text").val("")});jQuery("#task-name").keydown(function(b){13==b.keyCode&&(a.taskDB.insert(jQuery("#form-create :input[name='task-name']").val()),jQuery("#form-create").hide().find("input:text").val(""))});jQuery(".remove").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#button-remove").attr("rel",jQuery(this).attr("rel"));jQuery("#remove-confirm").html("Are you sure? You want to <strong>delete "+jQuery(this).attr("title")+"</strong>?");
jQuery("#form-remove").show()});jQuery("#button-remove").live("click",function(){jQuery("#form-remove").hide();a.taskDB.remove(jQuery(this).attr("rel"))});jQuery("#remove-all").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#form-remove-all").slideDown()});jQuery("#button-remove-all").live("click",function(){jQuery("#form-remove-all").hide();a.taskDB.removeall()});jQuery(".update").live("click",function(a){a.preventDefault();jQuery(".form").hide();jQuery("#top-bar").hide();
jQuery("#bar").hide();a=jQuery(this).attr("rel");this.taskDB.updateValidate(a,this.update)});jQuery("#button-update").live("click",function(){jQuery("#form-update").hide();jQuery("#top-bar").show();jQuery("#bar").show();var b=jQuery("#form-update :input[name='task-id']").val(),d=jQuery("#form-update :input[name='task-name']").val(),f=jQuery("#form-update :input[name='task-time']").val();a.taskDB.update(b,d,f)});jQuery(".cancel").live("click",function(b){b.preventDefault();a.hideWindow()});jQuery(".reset").live("click",
function(b){b.preventDefault();b=jQuery(this).attr("rel");a.taskDB.reset(b)});var d=function(b){b.preventDefault();a.taskDB.updateValidate(jQuery(this).attr("rel"),function(a){OB.preStart.dispatch(a)});return!1};jQuery(".timer").live("click",d);jQuery("#running").click(d);jQuery("#holder").show()},displayError:function(a){this.showWindow('<h3><div style="text-align: center; font-weight: bold;">Error</div></h3><div class="content"><p>'+a+'</p><a href="#" id="cancel_confirm" class="btn btn-primary" title="Done">Done</a></div>')},
showWindow:function(a,d){d=void 0==d?"#window":d;null!=a&&jQuery(d).html(a);b?(jQuery("#cover").css("height","100%").css("opacity","0.8").show(),jQuery(d).animate({top:60+window.pageYOffset+"px"},{easing:"easeInCubic",duration:400,complete:function(){}})):jQuery("#cover").css("height","100%").show().animate({opacity:"0.8"},400,function(){jQuery(d).animate({top:60+window.pageYOffset+"px"},{easing:"easeInCubic",duration:400,complete:function(){}})})},hideWindow:function(a){a=void 0==a?"#window":a;b?
jQuery(a).animate({top:"-700px"},{easing:"easeOutCubic",duration:400,complete:function(){jQuery("#cover").hide()}}):jQuery(a).animate({top:"-700px"},{easing:"easeOutCubic",duration:400,complete:function(){jQuery("#cover").animate({opacity:"0"},{duration:400,complete:function(){jQuery("#cover").hide()}})}})},update:function(a){jQuery("#form-update :input[name='task-id']").val(a.ID);jQuery("#form-update :input[name='task-name']").val(a.name);jQuery("#form-update :input[name='task-time']").val(this.hms(a.time));
jQuery("#form-update").slideDown()},truncateString:function(a){return a},showTask:function(a){var b,d="";b=jQuery("#item"+a.ID);0!=b.length?b.show():(d+='<div class="item'+(a.running?" running":"")+'" id="item'+a.ID+'" rel="'+a.ID+'">',d=d+'<div class="c3">'+('<span class="name c1" title="Task: <br>'+a.name+'" ><strong>'+this.truncateString(a.name)+"</strong></span><br>"),d+='<span class="details" title="'+a.details+'" >'+this.truncateString(a.details)+"</span><br>",d+='<span id="buttons"><a href="#" class="btn btn-mini update" rel="'+
a.ID+'" title="Edit: '+a.name+'">Edit</a> ',d+='<a href="#" class="btn btn-mini reset" rel="'+a.ID+'" title="Reset: '+a.name+'">Reset</a> ',d+='<a href="#" class="btn btn-mini remove" rel="'+a.ID+'" title="Delete: '+a.name+'">Delete</a></span>',d+="</div>",d+='<div class="c8"><div class="c6">',a.running?(b=new Date(a.start),b=Number(a.time)+Math.floor(((new Date).getTime()-b.getTime())/1E3),d+='<a href="#" class="btn timer btn-primary" rel="'+a.ID+'"><span class="time">'+this.hms(b)+"</span>"):d+=
'<a href="#" class="btn timer" rel="'+a.ID+'"><span class="time">'+this.hms(a.time)+"</span>",d+='<span class="timer-info" style="display: none;">'+(a.running?"Stop":"Start")+"</span></a>",d+="</div>",d+="</div></div>",a.running&&(this.startTask(a),this.toggleRunText()),jQuery("#form-list").append(d),OB.postItemRender.dispatch(a))},showAll:function(a){var b,d=a.length;if(0!=d)for(b=0;b<d;b++)this.showTask(a[b]);0==jQuery(".item").length&&this.showNoTaskWindow();OB.postAllItemRender.dispatch()},showNoTaskWindow:function(){this.showWindow('<h3><div style="text-align: center; font-weight: bold;">No Tasks</div></h3><div class="content"><p>Please assign a task to yourself.</p><a href="#" id="cancel_confirm" class="btn btn-primary cancel" title="Done">Done</a></div>')},
toggleTimer:function(a){jQuery("#item"+a.ID+" .timer").toggleClass("btn-primary");a.running?this.stopTask(a):this.startTask(a);this.toggleRunText()},startTask:function(a){var b=this;window.clearInterval(b.intervals[a.ID]);var d=new Date;a.running?d=new Date(a.start):this.taskDB.start(a.ID,d);jQuery("#item"+a.ID+" .timer .timer-info").text("Stop");b.intervals[a.ID]=window.setInterval(function(){var f=Number(a.time)+Math.floor(((new Date).getTime()-d.getTime())/1E3);jQuery("#item"+a.ID+" .timer .time").text(b.hms(f))},
500)},stopTask:function(a){window.clearInterval(this.intervals[a.ID]);var b,d=Number(a.time);b=new Date(a.start);b=Math.floor(((new Date).getTime()-b.getTime())/1E3);30>b?(jQuery("#item"+a.ID+" .timer").qtip("show"),b=0):60>b&&29<b&&(b=60);d+=b;this.taskDB.stop(a.ID,d,b,a.done);jQuery("#item"+a.ID+" .timer .time").text(this.hms(d));jQuery("#item"+a.ID+" .timer .timer-info").text("Start")},toggleRunText:function(){this.taskDB.running(function(a){f?window.chrome.browserAction.setBadgeText({text:"RUN"}):
document.title="Stopwatch - Running: "+a.name;jQuery("#running").text("Running: "+a.name).attr("rel",a.ID).show();jQuery("#storelink").hide()},function(a){0==a&&(f?window.chrome.browserAction.setBadgeText({text:""}):document.title="Stopwatch",jQuery("#running").hide(),jQuery("#storelink").show())})},hms:function(a){a=[0,0,a];var b;for(b=2;0<b;b--)a[b-1]=Math.floor(a[b]/60),a[b]%=60,10>a[b]&&(a[b]="0"+a[b]);return a.join(":")},sec:function(a){a=String(a).split(":");return Number(parseFloat(3600*a[0])+
60*parseFloat(a[1])+parseFloat(a[2]))}}}var QUERY_LOOKUP=null;function getQueryString(d){if(null==QUERY_LOOKUP){var a=location.search.substring(1),f=/([^&=]+)=([^&]*)/g,b;for(QUERY_LOOKUP={};b=f.exec(a);)QUERY_LOOKUP[decodeURIComponent(b[1])]=decodeURIComponent(b[2])}return d in QUERY_LOOKUP?QUERY_LOOKUP[d]:null};function taskDB(){return{dm:[],lastId:0,sql:function(d,a,f,b,c,g){},init:function(){this.createDB();return this},onError:function(d){},createDB:function(){this.dm=[];this.lastId=0},dropTaskTable:function(){this.createDB()},start:function(d,a){this.dm[d].running=1;this.dm[d].start=a;OB.start.dispatch(this.dm[d])},updateAtInterval:function(d,a,f){this.dm[d].running=1;this.dm[d].time=Number(a);OB.updateAtInterval.dispatch(this.dm[d],Number(f))},stop:function(d,a,f,b){this.dm[d].running=0;this.dm[d].done=
b;this.dm[d].time=Number(a);OB.stop.dispatch(this.dm[d],Number(f))},running:function(d,a){for(var f in this.dm)if(null!=this.dm[f]&&this.dm[f].running){d(this.dm[f]);return}a()},insert:function(d,a,f){var b="null",c="";void 0!=a&&(void 0!=a.syncID&&(b=a.syncID),void 0!=a.details&&(c=a.details));if("null"!=b){a=!1;for(var g in this.dm)if(null!=this.dm[g]&&this.dm[g].syncID==b){a=!0;break}a||(g=this.nextID(),this.dm[g]={ID:g,syncID:b,name:d,details:c,time:0,start:new Date,running:0,done:0},OB.insert.dispatch(d,
{syncID:b,details:c}));TASK_CNTRL.showTask(this.dm[g]);f&&OB.postAllItemRender.dispatch()}},nextID:function(){return this.lastId++},updateValidate:function(d,a){null!=this.dm[d]&&a(this.dm[d])},update:function(d,a,f){f=TASK_CNTRL.sec(f);var b;null!=this.dm[d]&&(this.dm[d].name=a,b=this.dm[d].time,this.dm[d].time=f);OB.update.dispatch(this.dm[d],f-b)},updateDetails:function(d,a){null!=this.dm[d]&&(this.dm[d].details=a)},remove:function(d){this.dm[d]=null;window.clearInterval(TASK_CNTRL.intervals[d]);
OB.remove.dispatch(d)},removeall:function(){this.createDB();for(var d in TASK_CNTRL.intervals)window.clearInterval(TASK_CNTRL.intervals[d]);OB.removeall.dispatch()},reset:function(d){null!=this.dm[d]&&(OB.reset.dispatch(d,this.dm[d]),this.dm[d].time=0)},loadAll:function(d){d(this.dm)}}.init()};function taskDBls(){return{ls:null,ps:null,userId:null,sql:function(d,a,f,b,c,g){},init:function(){this.ps=new Store("AttaskPersistModel");this.ls=new Store("AttaskModel");null==this.ls.get("list")&&this.createDB();return this},onError:function(d){},createDB:function(){this.ls.set("lastId",0);this.ls.set("list",[])},dropTaskTable:function(){this.ls.removeAll()},userRunningTasks:function(d){return p.ps.get(d+""+p.ps.get(d))},start:function(d,a){var f=this.ls.get(d);null!=f&&void 0!=f&&(f.running=1,
f.start=a,this.ls.set(d,f),null!=this.userId&&(this.ps.set(this.userId+""+f.syncID,f),this.ps.set(this.userId,f.syncID)),OB.start.dispatch(f))},updateAtInterval:function(d,a,f){var b=this.ls.get(d);null!=b&&void 0!=b&&(b.time=Number(a),this.ls.set(d,b),OB.updateAtInterval.dispatch(b,Number(f)))},stop:function(d,a,f,b){var c=this.ls.get(d);null!=c&&void 0!=c&&(c.running=0,c.done=b,c.time=Number(a),this.ls.set(d,c),null!=this.userId&&(this.ps.remove(this.userId+""+c.syncID),this.ps.remove(this.userId)),
OB.stop.dispatch(c,Number(f)))},running:function(d,a){var f=this.ls.get("list"),b,c=0,g;for(g in f)f.hasOwnProperty(g)&&(b=this.ls.get(g),null!=b&&(void 0!=b&&b.running)&&(d(b),c++));a(c)},getAllRunning:function(){return this.ps.toObject()},insert:function(d,a,f){var b=this,c="null",g="";void 0!=a&&(void 0!=a.syncID&&(c=a.syncID),void 0!=a.details&&(g=a.details));a=function(a,c,d,f){var g=b.nextID(),k={ID:g,syncID:a,name:c,details:d,time:0,start:new Date,running:0};if(null!=b.userId){var h=b.ps.get(b.userId+
""+a);null!=h&&h.running&&(k=h)}b.ls.set(g,k);h=b.ls.get("list");h[g]=a;b.ls.set("list",h);OB.insert.dispatch(c,{syncID:a,details:d});TASK_CNTRL.showTask(k);f&&OB.postAllItemRender.dispatch()};if("null"!=c){var h=b.ls.get("list"),pa=!1,ba;for(ba in h)if(h.hasOwnProperty(ba)&&null!=h[ba]&&h[ba]==c){pa=!0;break}pa?(TASK_CNTRL.showTask(b.ls.get(ba)),f&&OB.postAllItemRender.dispatch()):a(c,d,g,f)}else a(c,d,g,f)},nextID:function(){var d=this.ls.get("lastId");d++;this.ls.set("lastId",d);return d},updateValidate:function(d,
a){var f=this.ls.get(d);null!=f&&void 0!=f&&a(f)},update:function(d,a,f){f=TASK_CNTRL.sec(f);d=this.ls.get(d);null!=d&&void 0!=d&&(d.name=a,a=d.time,d.time=f,OB.update.dispatch(d,f-a))},updateDetails:function(d,a){var f=this.ls.get(d);null!=f&&void 0!=f&&(f.details=a)},remove:function(d){var a=this.ls.get("list");a[d]=null;this.ls.set("list",a);this.ls.remove(d);window.clearInterval(TASK_CNTRL.intervals[d]);OB.remove.dispatch(d)},removeall:function(){this.createDB();for(var d=TASK_CNTRL.intervals.length,
a=0;a<d;a++)window.clearInterval(TASK_CNTRL.intervals[a]);OB.removeall.dispatch()},reset:function(d){var a=this.ls.get(d);null!=a&&void 0!=a&&(OB.reset.dispatch(d,a),a.time=0,this.ls.set(d,a))},loadAll:function(d){var a=this.ls.get("list"),f=[],b,c;for(c in a)a.hasOwnProperty(c)&&(b=this.ls.get(c),null!=b&&void 0!=b&&f.push(b));d(f)},loadSyncIds:function(d){for(var a=this.ls.get("list"),f=[],b,c=d.length,g=0;g<c;g++)b=a.indexOf(d[g]),-1!=b&&(b=this.ls.get(b),null!=b&&void 0!=b&&f.push(b));return f}}.init()}
;var TASK_DB;TASK_DB=window.hasOwnProperty("chrome")&&window.chrome.hasOwnProperty("windows")||-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")?taskDBls():lscheck()?taskDBls():taskDB();var TASK_CNTRL=taskController(TASK_DB);jQuery(function(){TASK_CNTRL.init();OB.init.dispatch()});function onLoad(){OB.onLoad.dispatch()}function lscheck(){try{return localStorage.setItem("stopwatch","stopwatch"),localStorage.removeItem("stopwatch"),!0}catch(d){return!1}};var interval,notifyWorkIntervalTime=30;function startNotify(d){interval=setInterval(function(){notifyWorking(d)},6E4*notifyWorkIntervalTime)}function stopNotify(){clearInterval(interval)}function notifyWorking(d){if(window.webkitNotifications){var a=webkitNotifications.createNotification("../icons/timer48x48.png","Still working on Task:",d.name+"\n"+d.details.split(", Due:")[0]);a.show();setTimeout(function(){a.cancel()},7E3)}else stopNotify()}
function notifyFriday(){var d=webkitNotifications.createNotification("icons/timer48x48.png","Remember: Submit Timesheet!","");d.show();setTimeout(function(){d.cancel()},7E3)};
